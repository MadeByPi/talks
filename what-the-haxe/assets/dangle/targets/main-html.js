/** Cooked with Flambe, https://getflambe.com */
'use strict';(function(){function w(a,b){function c(){}c.prototype=a;var d=new c,e;for(e in b)d[e]=b[e];b.toString!==Object.prototype.toString&&(d.toString=b.toString);return d}function Mh(a){return a instanceof Array?function(){return P.iter(a)}:"function"==typeof a.iterator?q(a,a.iterator):a.iterator}function q(a,b){if(null==b)return null;null==b.__id__&&(b.__id__=Wh++);var c;null==a.hx__closures__?a.hx__closures__={}:c=a.hx__closures__[b.__id__];null==c&&(c=function(){return c.method.apply(c.scope,
arguments)},c.scope=a,c.method=b,a.hx__closures__[b.__id__]=c);return c}var h={},Kc=function(a,b){b=b.split("u").join("");this.r=RegExp(a,b)};h.EReg=Kc;Kc.__name__=!0;Kc.prototype={match:function(a){this.r.global&&(this.r.lastIndex=0);this.r.m=this.r.exec(a);this.r.s=a;return null!=this.r.m},matched:function(a){if(null!=this.r.m&&0<=a&&a<this.r.m.length)return this.r.m[a];throw"EReg::matched";},matchedPos:function(){if(null==this.r.m)throw"No string matched";return{pos:this.r.m.index,len:this.r.m[0].length}},
__class__:Kc};var P=function(){};h.HxOverrides=P;P.__name__=!0;P.cca=function(a,b){var c=a.charCodeAt(b);return c!=c?void 0:c};P.substr=function(a,b,c){if(null!=b&&0!=b&&null!=c&&0>c)return"";null==c&&(c=a.length);0>b?(b=a.length+b,0>b&&(b=0)):0>c&&(c=a.length+c-b);return a.substr(b,c)};P.remove=function(a,b){var c=a.indexOf(b);if(-1==c)return!1;a.splice(c,1);return!0};P.iter=function(a){return{cur:0,arr:a,hasNext:function(){return this.cur<this.arr.length},next:function(){return this.arr[this.cur++]}}};
var ze=function(){};h.Lambda=ze;ze.__name__=!0;ze.array=function(a){for(var b=[],a=Mh(a)();a.hasNext();){var c=a.next();b.push(c)}return b};ze.count=function(a,b){var c=0;if(null==b)for(var d=Mh(a)();d.hasNext();)d.next(),c++;else for(d=Mh(a)();d.hasNext();){var e=d.next();b(e)&&c++}return c};var Ae=function(){this.length=0};h.List=Ae;Ae.__name__=!0;Ae.prototype={add:function(a){a=[a];null==this.h?this.h=a:this.q[1]=a;this.q=a;this.length++},push:function(a){this.h=a=[a,this.h];null==this.q&&(this.q=
a);this.length++},pop:function(){if(null==this.h)return null;var a=this.h[0];this.h=this.h[1];null==this.h&&(this.q=null);this.length--;return a},clear:function(){this.q=this.h=null;this.length=0},iterator:function(){return{h:this.h,hasNext:function(){return null!=this.h},next:function(){if(null==this.h)return null;var a=this.h[0];this.h=this.h[1];return a}}},__class__:Ae};var Vf=function(){};h.IMap=Vf;Vf.__name__=!0;Math.__name__=!0;var ca=function(){};h.Reflect=ca;ca.__name__=!0;ca.field=function(a,
b){try{return a[b]}catch(c){return null}};ca.setField=function(a,b,c){a[b]=c};ca.callMethod=function(a,b,c){return b.apply(a,c)};ca.fields=function(a){var b=[];if(null!=a){var c=Object.prototype.hasOwnProperty,d;for(d in a)"__id__"!=d&&"hx__closures__"!=d&&c.call(a,d)&&b.push(d)}return b};ca.compare=function(a,b){return a==b?0:a>b?1:-1};ca.isEnumValue=function(a){return null!=a&&null!=a.__enum__};ca.copy=function(a){for(var b={},c=0,d=ca.fields(a);c<d.length;){var e=d[c];++c;ca.setField(b,e,ca.field(a,
e))}return b};var D=function(){};h.Std=D;D.__name__=!0;D.is=function(a,b){return Z.__instanceof(a,b)};D.instance=function(a,b){return a instanceof b?a:null};D.string=function(a){return Z.__string_rec(a,"")};D["int"]=function(a){return a|0};D.parseInt=function(a){var b=parseInt(a,10);if(0==b&&(120==P.cca(a,1)||88==P.cca(a,1)))b=parseInt(a);return isNaN(b)?null:b};D.parseFloat=function(a){return parseFloat(a)};var Be=function(){this.b=""};h.StringBuf=Be;Be.__name__=!0;Be.prototype={add:function(a){this.b+=
D.string(a)},addSub:function(a,b,c){this.b=null==c?this.b+P.substr(a,b,null):this.b+P.substr(a,b,c)},__class__:Be};var pd=function(){};h.StringTools=pd;pd.__name__=!0;pd.startsWith=function(a,b){return a.length>=b.length&&P.substr(a,0,b.length)==b};pd.fastCodeAt=function(a,b){return a.charCodeAt(b)};var lc=function(){};h.Type=lc;lc.__name__=!0;lc.getClass=function(a){return null==a?null:a instanceof Array&&null==a.__enum__?Array:a.__class__};lc.resolveClass=function(a){a=h[a];return null==a||!a.__name__?
null:a};lc.resolveEnum=function(a){a=h[a];return null==a||!a.__ename__?null:a};lc.createInstance=function(a,b){switch(b.length){case 0:return new a;case 1:return new a(b[0]);case 2:return new a(b[0],b[1]);case 3:return new a(b[0],b[1],b[2]);case 4:return new a(b[0],b[1],b[2],b[3]);case 5:return new a(b[0],b[1],b[2],b[3],b[4]);case 6:return new a(b[0],b[1],b[2],b[3],b[4],b[5]);case 7:return new a(b[0],b[1],b[2],b[3],b[4],b[5],b[6]);case 8:return new a(b[0],b[1],b[2],b[3],b[4],b[5],b[6],b[7]);default:throw"Too many arguments";
}};lc.allEnums=function(a){return a.__empty_constructs__};(h.XmlType={__ename__:!0,__constructs__:[]}).__empty_constructs__=[];var E=function(){};h.Xml=E;E.__name__=!0;E.parse=function(a){return mc.parse(a)};E.createElement=function(a){var b=new E;b.nodeType=E.Element;b._children=[];b._attributes=new Na;b.set_nodeName(a);return b};E.createPCData=function(a){var b=new E;b.nodeType=E.PCData;b.set_nodeValue(a);return b};E.createCData=function(a){var b=new E;b.nodeType=E.CData;b.set_nodeValue(a);return b};
E.createComment=function(a){var b=new E;b.nodeType=E.Comment;b.set_nodeValue(a);return b};E.createDocType=function(a){var b=new E;b.nodeType=E.DocType;b.set_nodeValue(a);return b};E.createProcessingInstruction=function(a){var b=new E;b.nodeType=E.ProcessingInstruction;b.set_nodeValue(a);return b};E.createDocument=function(){var a=new E;a.nodeType=E.Document;a._children=[];return a};E.prototype={get_nodeName:function(){if(this.nodeType!=E.Element)throw"bad nodeType";return this._nodeName},set_nodeName:function(a){if(this.nodeType!=
E.Element)throw"bad nodeType";return this._nodeName=a},set_nodeValue:function(a){if(this.nodeType==E.Element||this.nodeType==E.Document)throw"bad nodeType";return this._nodeValue=a},get:function(a){if(this.nodeType!=E.Element)throw"bad nodeType";return this._attributes.get(a)},set:function(a,b){if(this.nodeType!=E.Element)throw"bad nodeType";this._attributes.set(a,b)},exists:function(a){if(this.nodeType!=E.Element)throw"bad nodeType";return this._attributes.exists(a)},elements:function(){if(null==
this._children)throw"bad nodetype";return{cur:0,x:this._children,hasNext:function(){for(var a=this.cur,b=this.x.length;a<b&&!(this.x[a].nodeType==E.Element);)a+=1;this.cur=a;return a<b},next:function(){for(var a=this.cur,b=this.x.length;a<b;){var c=this.x[a],a=a+1;if(c.nodeType==E.Element)return this.cur=a,c}return null}}},elementsNamed:function(a){if(null==this._children)throw"bad nodetype";return{cur:0,x:this._children,hasNext:function(){for(var b=this.cur,c=this.x.length;b<c;){var d=this.x[b];
if(d.nodeType==E.Element&&d._nodeName==a)break;b++}this.cur=b;return b<c},next:function(){for(var b=this.cur,c=this.x.length;b<c;){var d=this.x[b];b++;if(d.nodeType==E.Element&&d._nodeName==a)return this.cur=b,d}return null}}},firstElement:function(){if(null==this._children)throw"bad nodetype";for(var a=0,b=this._children.length;a<b;){var c=this._children[a];if(c.nodeType==E.Element)return c;a++}return null},addChild:function(a){if(null==this._children)throw"bad nodetype";null!=a._parent&&P.remove(a._parent._children,
a);a._parent=this;this._children.push(a)},__class__:E};var Wf=function(a){this.Amatic48=new qd(a,"font/amatic_48");this.Amatic24=new qd(a,"font/amatic_24")};h["danglers.Fonts"]=Wf;Wf.__name__=!0;Wf.prototype={__class__:Wf};var nc=function(a){this.worldBounds=a};h["flambe.nape.NapeMain"]=nc;nc.__name__=!0;nc.prototype={onSuccess:function(a){var b=this;this.assets=a;this.stageWidth=o._platform.getStage().get_width();this.stageHeight=o._platform.getStage().get_height();o.root.addChild(this.world=new x);
o.root.addChild(this.ui=new x);this.ui.add(this.uiContainer=new F);this.stageWidth=o._platform.getStage().get_width();this.stageHeight=o._platform.getStage().get_height();this.worldContainer=new F;this.camera=new Ce;this.worldSceneryLayer=new x;this.worldNapeLayer=new x;this.worldUILayer=new x;this.world.add(this.worldContainer).add(this.camera).addChild(this.worldSceneryLayer).addChild(this.worldNapeLayer).addChild(this.worldUILayer);this.setupScenery();this.setupNapeWorld();this.setupCamera();this.setupUI();
this.onResize();o._platform.getStage().resize.connect(q(this,this.onResize));o._platform.getStage().orientation.get_changed().connect(function(a,d){if(a!=d)b.onResize()});this.world.add(this.gestureControl=new Ia);this.gestureControl.gesture.connect(q(this,this.firstUserInteraction)).once();this.gestureControl.gesture.connect(q(this,this.onGesture));o._platform.getKeyboard().get_supported()&&o._platform.getKeyboard().down.connect(q(this,this.onKey))},setupScenery:function(){},setupNapeWorld:function(){this.worldNapeLayer.add(this.spaceComponent=
new Oa(this.assets,this.worldBounds)).add(this.mouseDrag=new De(28E4,this.spaceComponent,this.worldContainer))},setupCamera:function(){},setupUI:function(){},onResize:function(){this.stageWidth=o._platform.getStage().get_width();this.stageHeight=o._platform.getStage().get_height()},firstUserInteraction:function(){},onGesture:function(){},onKey:function(a){switch(a.key[1]){case 83:o._platform.getStage().requestFullscreen(!1);break;case 5:case 62:o._platform.getStage().requestFullscreen();break;case 46:this.camera.controller.zoom.animateBy(0.2,
0.25,U.quadOut);break;case 51:this.camera.controller.zoom.animateBy(-0.2,0.25,U.quadOut);break;case 17:o._platform.getKeyboard().isDown(g.Control)&&window.document.location.reload();break;default:null}},__class__:nc};var sb=function(){this.worldBounds=new rd(-4096,-2048,8192,4096)};h["danglers.Main"]=sb;sb.__name__=!0;sb.getAnimation=function(a,b,c,d){a=(new Ee(a)).loop(b);b=(new x).add(a);a.movie._value.centerAnchor().setXY(c,d);return b};sb.main=function(){o.init();sb.logger=new Xf(o._platform.createLogHandler("Danglers"));
sb.instance=new sb;Yg.init("critters",(Fe=sb.instance,q(Fe,Fe.onSuccess)),5925240)};sb.__super__=nc;sb.prototype=w(nc.prototype,{onSuccess:function(a){this.fonts=new Wf(a);nc.prototype.onSuccess.call(this,a)},setupNapeWorld:function(){Oa.VelocityIterationsPerTimeStep=16;Oa.PositionIterationsPerTimeStep=20;nc.prototype.setupNapeWorld.call(this);this.spaceComponent.napeSpace.get_gravity().setxy(0,1800);this.worldNapeLayer.add(this.danglers=new Ge);this.danglers.oblongoCollision.connect(q(this,this.oblongoCollisionHandler))},
setupCamera:function(){this.spriteFollowBehaviour=new He(this.camera);this.boundsCheckBehaviour=new Ie(this.camera,this.worldBounds);this.mouseControlBehaviour=new Je(this.camera,this.worldBounds);this.zoomLimitBehaviour=new Ke(this.camera,0.25,2);this.camera.behaviours.push(this.spriteFollowBehaviour);this.camera.behaviours.push(this.mouseControlBehaviour);this.camera.behaviours.push(this.zoomLimitBehaviour);this.camera.behaviours.push(this.boundsCheckBehaviour);this.spriteFollowBehaviour.set_target(D.instance(this.danglers.oblongos.firstChild.next.next._compMap.DanglerComponent_0,
jb).headEntity);this.spriteFollowBehaviour.set_enabled(!1);this.mouseControlBehaviour.set_enabled(!0);this.boundsCheckBehaviour.set_enabled(!0);this.zoomLimitBehaviour.set_enabled(!0);this.camera.controller.panY.animateTo(-450,4,U.quartOut);this.camera.controller.zoom.animateTo(0.25,4,U.quartOut)},onKey:function(a){switch(a.key[1]){case 52:this.spriteFollowBehaviour.get_enabled()?this.spriteFollowBehaviour.set_enabled(!1):this.spriteFollowBehaviour.get_canFollowTarget()&&this.spriteFollowBehaviour.set_enabled(!0);
break;case 53:this.camera.set_rotation(0);this.spriteFollowBehaviour.set_enabled(!1);this.spriteFollowBehaviour.followTargetRotation=!1;this.camera.controller.panY.animateTo(-512,4,U.quartOut);this.camera.controller.zoom.animateTo(0.3,4,U.quartOut);break;default:nc.prototype.onKey.call(this,a)}},onGesture:function(a){nc.prototype.onGesture.call(this,a)},onResize:function(){this.titleText.x.set__(this.camera.stageCentreX);this.cameraControlsText.setXY(16,this.camera.stageHeight-164)},oblongoCollisionHandler:function(a,
b){var c=["sfx/blep","sfx/boop","sfx/blooweep","sfx/dangg","sfx/blesdfpk"];this.assets.getSound("audio/"+c[function(){null==a.zpp_inner_i.userData&&(a.zpp_inner_i.userData={});return a.zpp_inner_i.userData}(this).index]).play(0.2);this.assets.getSound("audio/"+c[function(){null==b.zpp_inner_i.userData&&(b.zpp_inner_i.userData={});return b.zpp_inner_i.userData}(this).index]).play(0.2)},setupUI:function(){var a=this.fonts.Amatic48,b=this.fonts.Amatic24;this.ui.add(new Le(this.assets,this.danglers.textureAtlas,
this.camera));a=(new Td(a,"DANGLING DANDIES")).setAlign(Sa.Center).setXY(this.camera.stageCentreX,24);this.ui.addChild((new x).add(a));this.titleText=a;a=(new Td(b,"CAMERA\nFullscreen [f]\nZoom [scrollwheel]\nPan [rmb or lmb+space]\nFollow target [F1]\nReset [F2]")).setAlign(Sa.Left);this.ui.addChild((new x).add(a));this.cameraControlsText=a;this.worldSceneryLayer.addChild((new x).add((new Ud(16448250,this.worldBounds.width,this.worldBounds.height)).centerAnchor().setXY(0,0)));this.setupAnimation()},
setupAnimation:function(){var a=new x,b=new Yf(this.assets,"animations"),b=sb.getAnimation(b,"GhostAnim",0,this.worldBounds.get_bottom()-216);a.addChild(b);this.worldSceneryLayer.addChild(a);var b=b._compMap.MoviePlayer_0.movie._value,c=new Vd;c.run(new re([new Bd(new Cd([new Zb(1),new nb(b.x,1440,12,U.quartInOut),new Zb(2.5),new nb(b.x,-1440,12,U.quartInOut),new Zb(3.5),new nb(b.x,-1440,8,U.quartInOut),new Zb(1),new nb(b.x,1440,12,U.quartInOut)])),new Bd(new Cd([new Zb(10),new nb(b.y,-350,2,U.backOut),
new Zb(5),new nb(b.y,350,3,U.quartInOut)]))]));a.addChild((new x).add(c))},__class__:sb});var Yg=function(){};h["danglers.PreloadMain"]=Yg;Yg.__name__=!0;Yg.init=function(a,b,c){null==c&&(c=0);var d=new Ud(c,1,o._platform.getStage().get_height());o.root.add(d);var e=o.loadAssetPack(Eb.fromAssets(a));e.progressChanged.connect(function(){d.width.animateTo(e._progress/e._total*o._platform.getStage().get_width(),0.25,U.quadOut);d.height.set__(o._platform.getStage().get_height())});e.success.connect(function(a){d.width.animateTo(o._platform.getStage().get_width(),
0.25,U.quadOut);oc.delay(function(){b(a);d.dispose()},250)}).once();e.error.connect(function(a){d.color=16711680;b(null);throw a;})};var eb=function(){};h["flambe.util.Disposable"]=eb;eb.__name__=!0;eb.prototype={__class__:eb};var G=function(){this._flags=0;this.owner=this.next=null};h["flambe.Component"]=G;G.__name__=!0;G.__interfaces__=[eb];G.prototype={onAdded:function(){},onRemoved:function(){},onStart:function(){},onStop:function(){},onUpdate:function(){},dispose:function(){null!=this.owner&&
this.owner.remove(this)},get_name:function(){return null},__class__:G};var $=function(a){G.call(this);this.danglers=a;this.spaceComponent=a.owner._compMap.SpaceComponent_9};h["danglers.components.DanglerComponent"]=$;$.__name__=!0;$.__super__=G;$.prototype=w(G.prototype,{get_name:function(){return"DanglerComponent_0"},onRemoved:function(){this.danglers=this.spaceComponent=null},__class__:$});var Dd=function(a,b,c){$.call(this,a);this.x=b;this.y=c};h["danglers.components.Cloud"]=Dd;Dd.__name__=!0;
Dd.__super__=$;Dd.prototype=w($.prototype,{onAdded:function(){var a=(new x).add(new F);this.owner.addChild(a);var b=this.danglers.textureAtlas.get("Cloud"),c=Zf.createBox(function(){null==f.BodyType_DYNAMIC&&(f.internal=!0,f.BodyType_DYNAMIC=new Ga,f.internal=!1);return f.BodyType_DYNAMIC}(this),0,0,b.get_width(),b.get_height());null==c.zpp_inner.wrap_pos&&c.zpp_inner.setupPosition();c.zpp_inner.wrap_pos.set_x(this.x);null==c.zpp_inner.wrap_pos&&c.zpp_inner.setupPosition();c.zpp_inner.wrap_pos.set_y(this.y);
for(var d=c.zpp_inner.wrap_shapes.iterator();d.hasNext();){var e;d.zpp_critical=!1;e=d.zpp_inner.at(d.zpp_i++);e.zpp_inner.immutable_midstep("Shape::fluidEnabled");e.zpp_inner.fluidEnabled=!0;null==e.zpp_inner.fluidProperties&&e.set_fluidProperties(new Fb);e.zpp_inner.wake();e.zpp_inner.fluidEnabled}c.setShapeFluidProperties(new Fb(0.5,1));d=Lc;e=this.spaceComponent.napeSpace.zpp_inner.__static;null==c.zpp_inner.wrap_pos&&c.zpp_inner.setupPosition();d=new d(e,c,c.zpp_inner.wrap_pos,B.weak(0,-b.get_height()/
2.5));d.set_space(this.spaceComponent.napeSpace);12!=d.zpp_inner.damping&&(d.zpp_inner.damping=12,d.zpp_inner.stiff||d.zpp_inner.wake());d.zpp_inner.damping;c=this.spaceComponent.createBodySpriteEntity(c,new aa(b));a.addChild(c);b=this.danglers.textureAtlas.get("CloudBack");b=(new x).add(new aa(b));d=c._compMap.Sprite_1;e=b._compMap.Sprite_1;e.setAnchor(d.anchorX._value+44,d.anchorY._value+32);e.x.set__(d.x._value);e.y.set__(d.y._value+8);d.alpha.set__(0.8);e.alpha.set__(0.55);a.addChild(b,!1);c._compMap.BodyComponent_10.setTargetSprite(a._compMap.Sprite_1)},
__class__:Dd});var Ge=function(){G.call(this);this.spritesheetBodies=new Na;this.oblongoCollision=new Ed;var a=Me,b;null==f.CbEvent_BEGIN&&(f.internal=!0,f.CbEvent_BEGIN=new Ta,f.internal=!1);b=f.CbEvent_BEGIN;null==f.InteractionType_COLLISION&&(f.internal=!0,f.InteractionType_COLLISION=new qa,f.internal=!1);this.bodyCollisionListener=new a(b,f.InteractionType_COLLISION,jb.getBodyCbType(),jb.getBodyCbType(),q(this,this.bodyCollisionBeginHandler))};h["danglers.components.Danglers"]=Ge;Ge.__name__=
!0;Ge.__super__=G;Ge.prototype=w(G.prototype,{get_name:function(){return"Danglers_1"},onAdded:function(){this.spaceComponent=this.owner._compMap.SpaceComponent_9;var a=this.spaceComponent.assetPack,b=E.parse(a.getFile("danglers/oblongo.xml").toString()),c=JSON.parse(a.getFile("danglers/oblongo_shapes.json").toString());this.oblongoSettings=JSON.parse(a.getFile("danglers/oblongo_settings.json").toString());for(var d=0,c=Z.__cast(c,Array);d<c.length;){var e=c[d];++d;var i=e.name,e=Zg.deserialiseToBody(e.data);
this.spritesheetBodies.set(i,e)}a=a.getTexture("danglers/oblongo");this.textureAtlas=$g.parse(b,a);this.spaceComponent.napeSpace.zpp_inner.wrap_listeners.add(this.bodyCollisionListener);this.addShapes();this.addLogoLetters();this.addOblongos();this.addWater(0,this.spaceComponent.bounds.get_bottom()-256,this.spaceComponent.bounds.width,512);this.addClouds()},addShapes:function(){for(var a=new x,b="Hexagon,HexStar,PentStar,PentaRounded,Pentagon,TriCurve1,TriCurve2,TriCurve3".split(","),c=0;16>c;){c++;
var d=b[D["int"](Math.random()*b.length)],e=this.textureAtlas.get(d),d=this.spritesheetBodies.get(d).copy(),e=this.spaceComponent.createBodySpriteEntity(d,new aa(e));d.scaleShapes(0.98,0.98);var i=0.5*Math.random()+1;e._compMap.BodyComponent_10.setScale(i,i);0.25>Math.random()?d.setShapeMaterials(Ba.ice()):d.setShapeMaterials(Ba.wood());null==d.zpp_inner.wrap_pos&&d.zpp_inner.setupPosition();d.zpp_inner.wrap_pos.set_x(3072*(Math.random()-0.5));null==d.zpp_inner.wrap_pos&&d.zpp_inner.setupPosition();
d.zpp_inner.wrap_pos.set_y(-512-1280*Math.random());a.addChild(e)}this.owner.addChild(a)},addWater:function(a,b,c,d){var e=new aa(this.textureAtlas.get("WaterStrip"));e.scaleX.set__(c/e.getNaturalWidth());e.scaleY.set__(d/e.getNaturalHeight());e.centerAnchor().setXY(a,b);a=Zf.createBox(function(){null==f.BodyType_STATIC&&(f.internal=!0,f.BodyType_STATIC=new Ga,f.internal=!1);return f.BodyType_STATIC}(this),a,b,c,d);a.align();a.zpp_inner.wrap_shapes.at(0).set_fluidEnabled(!0);a.setShapeFluidProperties(new Fb(1,
1));a.set_space(this.spaceComponent.napeSpace);null==a.zpp_inner_i.userData&&(a.zpp_inner_i.userData={});a.zpp_inner_i.userData.component=e;this.owner.addChild((new x).add(e))},addLogoLetters:function(){var a=new Fd,b=new x,c="BeadyiMP,BeadMyPi,MyPeaBid,MayBediP,yeBadiMP,BidMyaPe,yaMBiPed".split(","),c=0.98<Math.random()?c[D["int"](Math.random()*c.length)].split(""):"M,a,d,e,B,y,P,i".split(",");c.reverse();for(var d=this.spaceComponent.bounds,e=d.get_right()-d.width/4.5,d=d.y+132,i=0;i<c.length;){var k=
c[i];++i;var f="MadeByPiLogo_"+k,j=new aa(this.textureAtlas.get(f)),f=this.spritesheetBodies.get(f).copy();if((null==f.zpp_inner.compound?null:f.zpp_inner.compound.outer)!=a){if(null!=(null==f.zpp_inner.compound?null:f.zpp_inner.compound.outer))(null==f.zpp_inner.compound?null:f.zpp_inner.compound.outer).zpp_inner.wrap_bodies.remove(f);null!=a&&a.zpp_inner.wrap_bodies.add(f)}null==f.zpp_inner.compound?null:f.zpp_inner.compound.outer;f.setShapeMaterials(new Ba(-1,0.4,0.6,1.8,16));f.set_rotation("y"==
k?-1.2:-0.2);null==f.zpp_inner.wrap_pos&&f.zpp_inner.setupPosition();f.zpp_inner.wrap_pos.setxy(e,d+16*(Math.random()-0.5));e-=148+4*(Math.random()-0.5);k=this.spaceComponent.createBodySpriteEntity(f,j);b.addChild(k)}this.owner.addChild(b)},addOblongos:function(){this.oblongos=new x;this.sleepyZContainer=new x;this.sleepyParticles=new C(this.spaceComponent.assetPack,"particles/sleepZ");this.owner.addChild(this.oblongos);this.owner.addChild(this.sleepyZContainer);for(var a=-320,b=null,c=0;3>c;){var d=
c++,b=new x;this.oblongos.addChild(b,!1);d=this.createOblongo(a,128,d);d.setupSleepyParticles(this.sleepyZContainer,this.sleepyParticles);b.add(d);a+=320}a=new Mc(this,0,128);this.oblongos.addChild((new x).add(a));this.oblongos.add(this.oblongoControl=new Ne(this,0,128));a=new Vd;a.run(new re([new Bd(new Cd([new Zb(30),new nb(this.oblongoControl.y,720,3,U.quadIn),new Zb(1.5),new nb(this.oblongoControl.y,-720,3,U.quartInOut)]))]));this.oblongos.add(a);this.owner.addChild(this.sleepyZContainer)},addClouds:function(){var a=
new x,b=this.spaceComponent.bounds;a.addChild((new x).add(new Dd(this,-512,-b.height/4)));a.addChild((new x).add(new Dd(this,512,-720)));this.owner.addChild(a)},createOblongo:function(a,b,c){return new jb(this,this.textureAtlas,this.spritesheetBodies,this.oblongoSettings,a,b,c)},bodyCollisionBeginHandler:function(a){this.oblongoCollision.emit(a.zpp_inner.int1.outer_i.get_castBody(),a.zpp_inner.int2.outer_i.get_castBody())},__class__:Ge});var jb=function(a,b,c,d,e,i,k){$.call(this,a);this.x=e;this.y=
i;this.index=k;a=["OblongoBodyBlack","OblongoBodyStripes"][k%2];this.bodyTexture=b.get(a);this.armTexture=b.get("OblongoArm");this.fingersTexture=b.get("OblongoFingers");this.leftLegTexture=b.get("OblongoLegLeft");this.rightLegTexture=b.get("OblongoLegRight");this.mouthBackTexture=b.get("OblongoMouthBack");this.eyeWhiteTexture=b.get("OblongoEyeWhite");this.eyePupilTexture=b.get("OblongoEyePupil");this.eyeLidTexture=b.get("OblongoEyeLid");this.leftLegBody=c.get("OblongoLegLeft").copy();this.rightLegBody=
c.get("OblongoLegRight").copy();this.leftFingersBody=c.get("OblongoFingers").copy();this.rightFingersBody=c.get("OblongoFingers").copy();this.headBody=c.get(a).copy();if(Object.prototype.hasOwnProperty.call(d,a))this.config=ca.field(d,a);else throw"No Oblongo config found for body:"+a;};h["danglers.components.Oblongo"]=jb;jb.__name__=!0;jb.getBodyCbType=function(){null==jb.OBLONGO_BODY_TYPE&&(jb.OBLONGO_BODY_TYPE=new $b);return jb.OBLONGO_BODY_TYPE};jb.__super__=$;jb.prototype=w($.prototype,{onAdded:function(){var a=
this.y+164;this.leftFingersBody.set_type(this.rightFingersBody.set_type(function(){null==f.BodyType_KINEMATIC&&(f.internal=!0,f.BodyType_KINEMATIC=new Ga,f.internal=!1);return f.BodyType_KINEMATIC}(this)));this.leftLegBody.setShapeMaterials(Ba.steel());this.rightLegBody.setShapeMaterials(Ba.steel());this.headBody.setShapeMaterials(Ba.rubber());this.headBody.scaleShapes(0.98,0.98);this.headBody.get_cbTypes().add(jb.getBodyCbType());this.headBody.get_userData().index=this.index;this.headBody.applyImpulse(B.weak(3200*
(Math.random()-0.5),160*(Math.random()-0.5)));this.leftLegBody.setShapeFilters(new ob(2,-3));this.rightLegBody.setShapeFilters(new ob(2,-3));this.headBody.setShapeFilters(new ob(1,1,2));this.leftFingersBody.setShapeFilters(new ob(0));this.rightFingersBody.setShapeFilters(new ob(0));this.setHandsPosition(this.x,this.y);this.headBody.get_position().set(B.get(this.x,a,null));this.leftLegBody.set_position(B.get(this.x-this.bodyTexture.get_width()/8.4,a+this.bodyTexture.get_height()-this.bodyTexture.get_height()/
17,null));this.rightLegBody.set_position(B.get(this.x+this.bodyTexture.get_width()/8.4,a+this.bodyTexture.get_height()-this.bodyTexture.get_height()/17,null));var b=328+64*(Math.random()-0.5),a=new Wd(this.leftFingersBody,this.headBody,B.get(this.fingersTexture.get_width()/2+4,-10,null),B.get(-this.bodyTexture.get_width()/2.3,-20,null),25,b+20*(Math.random()-0.5)),c=new Wd(this.rightFingersBody,this.headBody,B.get(this.fingersTexture.get_width()/2+5,-10,null),B.get(this.bodyTexture.get_width()/2.3,
-25,null),25,b+20*(Math.random()-0.5));a.set_stiff(function(){!1!=c.zpp_inner.stiff&&(c.zpp_inner.stiff=!1,c.zpp_inner.wake());return c.zpp_inner.stiff}(this));a.set_damping(function(){0.0050!=c.zpp_inner.damping&&(c.zpp_inner.damping=0.0050,c.zpp_inner.stiff||c.zpp_inner.wake());return c.zpp_inner.damping}(this));a.set_frequency(c.set_frequency(3.141592653589793/(6+(Math.random()-0.5))));var b=new Lc(this.headBody,this.leftLegBody,B.get(-this.bodyTexture.get_width()/4,this.bodyTexture.get_height()/
2-24,null),B.get(2,-16-this.leftLegTexture.get_height()/2,null)),d=new Lc(this.headBody,this.rightLegBody,B.get(this.bodyTexture.get_width()/4,this.bodyTexture.get_height()/2-24,null),B.get(2,-16-this.rightLegTexture.get_height()/2,null));b.set_space(d.set_space(this.spaceComponent.napeSpace));this.mouthControl=new Oe(this.danglers);b=(new x).add((new aa(this.eyeLidTexture)).centerAnchor().setXY(this.config.mouth[0],this.config.mouth[1]));d=(new x).add((new aa(this.eyeWhiteTexture)).centerAnchor().setXY(this.config.mouth[0],
this.config.mouth[1]));b=(new x).addChild(d).addChild(b).add(this.mouthControl);this.eyeControl=new Pe(this.danglers);this.eyeControl.sleepChange.connect(q(this,this.onSleepStateChange));this.eyesEntity=new x;var e=new x,d=new x;this.eyesEntity.addChild(e).addChild(d);var i=(new x).add((new aa(this.eyeWhiteTexture)).centerAnchor().setXY(this.config.leftEye[0],this.config.leftEye[1])),k=(new x).add((new aa(this.eyePupilTexture)).centerAnchor().setXY(this.config.leftEye[0],this.config.leftEye[1])),
l=(new x).add((new aa(this.eyeLidTexture)).centerAnchor().setXY(this.config.leftEye[0],this.config.browYMin));l.add(new Xd(this.leftLegBody,this.config.browYMin,this.config.browYMax));e.addChild(i).addChild(k).addChild(l);e=(new x).add((new aa(this.eyeWhiteTexture)).centerAnchor().setXY(this.config.rightEye[0],this.config.rightEye[1]));i=(new x).add((new aa(this.eyePupilTexture)).centerAnchor().setXY(this.config.rightEye[0],this.config.rightEye[1]));k=(new x).add((new aa(this.eyeLidTexture)).centerAnchor().setXY(this.config.rightEye[0],
this.config.browYMin));k.add(new Xd(this.rightLegBody,this.config.browYMin,this.config.browYMax));d.addChild(e).addChild(i).addChild(k);this.leftFingersEntity=this.spaceComponent.createBodySpriteEntity(this.leftFingersBody,new aa(this.fingersTexture));this.rightFingersEntity=this.spaceComponent.createBodySpriteEntity(this.rightFingersBody,new aa(this.fingersTexture));this.bodyEntity=this.spaceComponent.createBodySpriteEntity(this.headBody,new aa(this.bodyTexture));this.leftLegEntity=this.spaceComponent.createBodySpriteEntity(this.leftLegBody,
new aa(this.leftLegTexture));this.rightLegEntity=this.spaceComponent.createBodySpriteEntity(this.rightLegBody,new aa(this.rightLegTexture));this.leftArmEntity=this.spaceComponent.createDistanceJointSpriteEntity(a,new aa(this.armTexture));this.rightArmEntity=this.spaceComponent.createDistanceJointSpriteEntity(c,new aa(this.armTexture));this.headEntity=(new x).add(new F);this.headEntity.addChild(this.eyesEntity).addChild(b).addChild(this.bodyEntity);this.bodyEntity._compMap.BodyComponent_10.setTargetSprite(this.headEntity._compMap.Sprite_1);
this.eyesEntity.add(this.eyeControl);this.owner.addChild(this.leftFingersEntity).addChild(this.rightFingersEntity).addChild(this.leftArmEntity).addChild(this.rightArmEntity).addChild(this.leftLegEntity).addChild(this.rightLegEntity).addChild(this.headEntity)},setHandsPosition:function(a,b){this.x=a;this.y=b;this.leftFingersBody.get_position().set(B.get(a-34,b+2,null));this.rightFingersBody.get_position().set(B.get(a+34,b+2,null))},onUpdate:function(){if(null!=this.eyeControl&&this.eyeControl.isSleeping){var a=
B.get(this.config.snoreOrigin[0],this.config.snoreOrigin[1],null),b=this.headBody.localPointToWorld(a);this.particleEmitter.setXY(function(){b.zpp_inner.validate();return b.zpp_inner.x}(this),function(){b.zpp_inner.validate();return b.zpp_inner.y}(this));a.dispose();b.dispose()}},setupSleepyParticles:function(a,b){this.particleEmitter=b.createEmitter();this.particleContainer=new x;a.addChild(this.particleContainer.add(this.particleEmitter));this.particleEmitter.enabled=!1},onSleepStateChange:function(a){this.particleEmitter.enabled=
a},__class__:jb});var Xd=function(a,b,c){G.call(this);this.body=a;this.min=b;this.max=c;this.velocity=0};h["danglers.components.oblongo.BrowControl"]=Xd;Xd.__name__=!0;Xd.__super__=G;Xd.prototype=w(G.prototype,{get_name:function(){return"BrowControl_13"},onAdded:function(){this.sprite=this.owner._compMap.Sprite_1},onUpdate:function(){var a=this.body.get_velocity().get_length();this.velocity+=(a-this.velocity)*(a>this.velocity?0.7:0.0050);this.sprite.y.set__(Math.max(this.min,this.max-0.2*this.velocity));
(this.isSleeping=this.sprite.y._value>this.max-5)&&this.sprite.y.set__(this.max)},onRemoved:function(){this.sprite=this.body=null},__class__:Xd});var Mc=function(a,b,c){this.positionInvalid=!1;this._x=b;this._y=c;$.call(this,a)};h["danglers.components.oblongo.DangleBar"]=Mc;Mc.__name__=!0;Mc.__super__=$;Mc.prototype=w($.prototype,{onAdded:function(){var a=this.danglers.textureAtlas.get("DangleBar"),b=this.danglers.spritesheetBodies.get("DangleBar");this.tWidth=a.get_width()-1;this.tWidth2=this.tWidth/
2;this.compound=new Fd;for(var c=this._x-2*this.tWidth+this.tWidth2,d=0;4>d;){var e=d++,i=b.copy();i.set_compound(this.compound);null==i.zpp_inner_i.userData&&(i.zpp_inner_i.userData={});i.zpp_inner_i.userData.i=e;i.set_type(function(){null==f.BodyType_KINEMATIC&&(f.internal=!0,f.BodyType_KINEMATIC=new Ga,f.internal=!1);return f.BodyType_KINEMATIC}(this));null==i.zpp_inner.wrap_pos&&i.zpp_inner.setupPosition();i.zpp_inner.wrap_pos.set_x(c+e*this.tWidth);null==i.zpp_inner.wrap_pos&&i.zpp_inner.setupPosition();
i.zpp_inner.wrap_pos.set_y(this._y-36);this.owner.addChild(this.spaceComponent.createBodySpriteEntity(i,new aa(a)))}this.compound.set_space(this.spaceComponent.napeSpace)},onUpdate:function(){this.positionInvalid&&this.updatePosition()},updatePosition:function(){for(var a=this._x-2*this.tWidth+this.tWidth2,b=this.compound.zpp_inner.wrap_bodies.iterator();b.hasNext();){var c;b.zpp_critical=!1;c=b.zpp_inner.at(b.zpp_i++);null==c.zpp_inner.wrap_pos&&c.zpp_inner.setupPosition();c.zpp_inner.wrap_pos.set_x(a+
D["int"](function(){null==c.zpp_inner_i.userData&&(c.zpp_inner_i.userData={});return c.zpp_inner_i.userData}(this).i)*this.tWidth);null==c.zpp_inner.wrap_pos&&c.zpp_inner.setupPosition();c.zpp_inner.wrap_pos.set_y(this._y-36)}this.positionInvalid=!1},onRemoved:function(){},get_x:function(){return this._x},get_y:function(){return this._y},set_x:function(a){this.positionInvalid=!0;return this._x=a},set_y:function(a){this.positionInvalid=!0;return this._y=a},__class__:Mc});var Pe=function(a){$.call(this,
a);this.sleepChange=new V;this.pt=new $c};h["danglers.components.oblongo.EyeControl"]=Pe;Pe.__name__=!0;Pe.__super__=$;Pe.prototype=w($.prototype,{onAdded:function(){this.isSleeping=!1;this.camera=o.root.firstChild._compMap.Camera_11;this.leftEye=new Gd(this.owner.firstChild);this.rightEye=new Gd(this.owner.firstChild.next)},onUpdate:function(){var a=this.leftEye.get_isSleeping()&&this.rightEye.get_isSleeping();a!=this.isSleeping&&this.sleepChange.emit(this.isSleeping=a);if(!this.isSleeping){var a=
o._platform.getPointer().get_x(),b=o._platform.getPointer().get_y();this.camera.screenPointToWorld(a,b,this.pt);this.leftEye.lookAt(this.pt);this.rightEye.lookAt(this.pt)}},onRemoved:function(){this.sleepChange=this.rightEye=this.leftEye=null;$.prototype.onRemoved.call(this)},__class__:Pe});var Gd=function(a){this.owner=a;this.eyeWhite=a.firstChild._compMap.Sprite_1;this.pupil=a.firstChild.next._compMap.Sprite_1;this.brow=a.firstChild.next.next._compMap.Sprite_1;this.browControl=this.brow.owner._compMap.BrowControl_13;
this.pX=this.pupil.x._value;this.pY=this.pupil.y._value;this.bodySprite=a.parent.parent._compMap.Sprite_1};h["danglers.components.oblongo.EyeController"]=Gd;Gd.__name__=!0;Gd.angleTo=function(a,b,c,d){a=Math.atan2(b-d,a-c)+1.5707963267948966;0>a&&(a+=6.283185307179586);6.283185307179586<a&&(a-=6.283185307179586);return a};Gd.prototype={get_isSleeping:function(){return this.browControl.isSleeping},lookAt:function(a){this.cX=this.bodySprite.x._value+this.pX;this.cY=this.bodySprite.y._value+this.pY;
var b=this.bodySprite.rotation._value,a=Gd.angleTo(a.x,a.y,this.cX,this.cY)+3.141592653589793*-b/180;this.pupil.x.set__(this.pX+4*Math.sin(a));this.pupil.y.set__(this.pY+4*Math.cos(a+3.141592653589793))},__class__:Gd};var Oe=function(a){$.call(this,a)};h["danglers.components.oblongo.MouthControl"]=Oe;Oe.__name__=!0;Oe.__super__=$;Oe.prototype=w($.prototype,{onAdded:function(){var a=this.owner.firstChild.next._compMap.Sprite_1.y;a.set__(a._value-16)},onUpdate:function(){},onRemoved:function(){$.prototype.onRemoved.call(this)},
__class__:Oe});var Ne=function(a,b,c){null==c&&(c=0);null==b&&(b=0);this.changed=!1;$.call(this,a);this.x=new y(b);this.y=new y(c);this.spacing=new y(256);this.oblongos=new Ae};h["danglers.components.oblongo.OblongoGroupControl"]=Ne;Ne.__name__=!0;Ne.__super__=$;Ne.prototype=w($.prototype,{onAdded:function(){for(var a=this.owner.firstChild;null!=a;){for(var b=a.firstComponent;null!=b;)Z.__instanceof(b,jb)?this.oblongos.add(b):Z.__instanceof(b,Mc)&&(this.bar=b),b=b.next;a=a.next}this.x.get_changed().connect(q(this,
this.propertyChange));this.y.get_changed().connect(q(this,this.propertyChange));this.spacing.get_changed().connect(q(this,this.propertyChange))},onUpdate:function(a){this.x.update(a);this.y.update(a);this.spacing.update(a);if(this.changed){this.changed=!1;this.bar.set_x(this.x._value);this.bar.set_y(this.y._value);for(var a=this.spacing._value,b=this.x._value-a*(this.oblongos.length/2)+a/2,c=this.y._value,d=this.oblongos.iterator();d.hasNext();){var e=d.next();e.setHandsPosition(b+a*e.index,c)}}},
propertyChange:function(){this.changed=!0},onRemoved:function(){},__class__:Ne});var Le=function(a,b,c){G.call(this);this.pack=a;this.textureAtlas=b;this.camera=c;this.musicOn=!0;this.bgMusic=a.getSound("audio/music/ingame_slow");this.bgMusicPlayback=this.bgMusic.loop(0.2)};h["danglers.ui.AudioControl"]=Le;Le.__name__=!0;Le.__super__=G;Le.prototype=w(G.prototype,{get_name:function(){return"AudioControl_5"},onAdded:function(){this.musicToggleButton=new aa(this.textureAtlas.get("Note"));this.owner.addChild((new x).add(this.musicToggleButton));
this.musicToggleButton.setXY(16,16);this.musicToggleButton.get_pointerIn().connect(q(this,this.onPointerIn));this.musicToggleButton.get_pointerOut().connect(q(this,this.onPointerOut));this.musicToggleButton.get_pointerDown().connect(q(this,this.onPointerDown))},onPointerIn:function(){this.musicToggleButton.alpha.set__(0.5)},onPointerOut:function(){this.musicOn?this.musicToggleButton.alpha.set__(1):this.musicToggleButton.alpha.set__(0.25)},onPointerDown:function(){this.musicOn=!this.musicOn;null!=
this.bgMusicPlayback&&this.bgMusicPlayback.dispose();this.musicOn?(this.bgMusicPlayback=this.bgMusic.loop(0.2),this.musicToggleButton.alpha.set__(0.8)):this.musicToggleButton.alpha.set__(0.25)},onRemoved:function(){this.pack=this.camera=this.textureAtlas=null},__class__:Le});var x=function(){this.parent=this.firstChild=this.next=this.firstComponent=null;this._compMap={}};h["flambe.Entity"]=x;x.__name__=!0;x.__interfaces__=[eb];x.prototype={add:function(a){null!=a.owner&&a.owner.remove(a);var b=a.get_name(),
c=this._compMap[b];null!=c&&this.remove(c);this._compMap[b]=a;b=null;for(c=this.firstComponent;null!=c;)b=c,c=c.next;null!=b?b.next=a:this.firstComponent=a;a.owner=this;a.next=null;a.onAdded();return this},remove:function(a){for(var b=null,c=this.firstComponent;null!=c;){var d=c.next;if(c==a)return null==b?this.firstComponent=d:(b.owner=this,b.next=d),delete this._compMap[c.get_name()],0!=(c._flags&1)&&(c.onStop(),c._flags&=-2),c.onRemoved(),c.owner=null,c.next=null,!0;b=c;c=d}return!1},addChild:function(a,
b){null==b&&(b=!0);null!=a.parent&&a.parent.removeChild(a);a.parent=this;if(b){for(var c=null,d=this.firstChild;null!=d;)c=d,d=d.next;null!=c?c.next=a:this.firstChild=a}else a.next=this.firstChild,this.firstChild=a;return this},removeChild:function(a){for(var b=null,c=this.firstChild;null!=c;){var d=c.next;if(c==a){null==b?this.firstChild=d:b.next=d;c.parent=null;c.next=null;break}b=c;c=d}},disposeChildren:function(){for(;null!=this.firstChild;)this.firstChild.dispose()},dispose:function(){for(null!=
this.parent&&this.parent.removeChild(this);null!=this.firstComponent;)this.firstComponent.dispose();this.disposeChildren()},toString:function(){return this.toStringImpl("")},toStringImpl:function(a){for(var b="",c=this.firstComponent;null!=c;)b+=c.get_name(),null!=c.next&&(b+=", "),c=c.next;for(var b=b+"\n",c=String.fromCharCode(9492),d=String.fromCharCode(9500),e=String.fromCharCode(9472),i=String.fromCharCode(9474),k=this.firstChild;null!=k;)var f=null==k.next,b=b+(a+(f?c:d)+e+e+" "),b=b+k.toStringImpl(a+
(f?" ":i)+"   "),k=k.next;return b},__class__:x};var ah=function(){};h["flambe.util.PackageLog"]=ah;ah.__name__=!0;var $f=function(){};h["flambe.platform.Platform"]=$f;$f.__name__=!0;$f.prototype={__class__:$f};var pc=function(){};h["flambe.platform.html.HtmlPlatform"]=pc;pc.__name__=!0;pc.__interfaces__=[$f];pc.prototype={init:function(){var a=this;I.fixAndroidMath();var b=null;try{b=window.flambe.canvas}catch(c){}b.setAttribute("tabindex","0");b.style.outlineStyle="none";b.style.webkitTapHighlightColor=
"transparent";b.setAttribute("moz-opaque","true");this._stage=new Hd(b);this._pointer=new O;this._mouse=new Qe(this._pointer,b);this._renderer=this.createRenderer(b);this.mainLoop=new ad;this.musicPlaying=!1;this._canvas=b;this._container=b.parentElement;this._container.style.overflow="hidden";this._container.style.position="relative";this._container.style.msTouchAction="none";var d=0,e=function(c){if(!(1E3>c.timeStamp-d)){var e=b.getBoundingClientRect(),i=a.getX(c,e),e=a.getY(c,e);switch(c.type){case "mousedown":c.target==
b&&(c.preventDefault(),a._mouse.submitDown(i,e,c.button),b.focus());break;case "mousemove":a._mouse.submitMove(i,e);break;case "mouseup":a._mouse.submitUp(i,e,c.button);break;case "mousewheel":case "DOMMouseScroll":a._mouse.submitScroll(i,e,"mousewheel"==c.type?c.wheelDelta/40:-c.detail)&&c.preventDefault()}}};window.addEventListener("mousedown",e,!1);window.addEventListener("mousemove",e,!1);window.addEventListener("mouseup",e,!1);b.addEventListener("mousewheel",e,!1);b.addEventListener("DOMMouseScroll",
e,!1);b.addEventListener("contextmenu",function(a){a.preventDefault()},!1);var i="undefined"!=typeof window.ontouchstart,e="msMaxTouchPoints"in window.navigator&&1<window.navigator.msMaxTouchPoints;if(i||e){var k=new Re(this._pointer,i?4:window.navigator.msMaxTouchPoints);this._touch=k;e=function(b){var c;c=i?b.changedTouches:[b];var e=b.target.getBoundingClientRect();d=b.timeStamp;switch(b.type){case "touchstart":case "MSPointerDown":case "pointerdown":b.preventDefault();I.SHOULD_HIDE_MOBILE_BROWSER&&
I.hideMobileBrowser();for(b=0;b<c.length;){var f=c[b];++b;var l=a.getX(f,e),j=a.getY(f,e);k.submitDown((i?f.identifier:f.pointerId)|0,l,j)}break;case "touchmove":case "MSPointerMove":case "pointermove":b.preventDefault();for(b=0;b<c.length;)f=c[b],++b,l=a.getX(f,e),j=a.getY(f,e),k.submitMove((i?f.identifier:f.pointerId)|0,l,j);break;case "touchend":case "touchcancel":case "MSPointerUp":case "pointerup":for(b=0;b<c.length;)f=c[b],++b,l=a.getX(f,e),j=a.getY(f,e),k.submitUp((i?f.identifier:f.pointerId)|
0,l,j)}};i?(b.addEventListener("touchstart",e,!1),b.addEventListener("touchmove",e,!1),b.addEventListener("touchend",e,!1),b.addEventListener("touchcancel",e,!1)):(b.addEventListener("MSPointerDown",e,!1),b.addEventListener("MSPointerMove",e,!1),b.addEventListener("MSPointerUp",e,!1))}else this._touch=new Se;var f=window.onerror;window.onerror=function(a,b,c){o.uncaughtError.emit(a);return null!=f?f(a,b,c):!1};var j=I.loadExtension("hidden",window.document);null!=j.value?(e=function(){o.hidden.set__(ca.field(window.document,
j.field))},e(null),window.document.addEventListener(j.prefix+"visibilitychange",e,!1)):(e=function(a){o.hidden.set__("pagehide"==a.type)},window.addEventListener("pageshow",e,!1),window.addEventListener("pagehide",e,!1));o.hidden.get_changed().connect(function(b){b||(a._skipFrame=!0)});this._skipFrame=!1;this._lastUpdate=Date.now();var g=I.loadExtension("requestAnimationFrame").value;if(null!=g){var h=window.performance,m=null!=h&&I.polyfill("now",h);m?this._lastUpdate=h.now():null;var r=null,r=function(c){a.update(m?
h.now():c);g(r,b)};g(r,b)}else window.setInterval(function(){a.update(Date.now())},16);sd.info("Initialized HTML platform",["renderer",this._renderer.get_type()])},loadAssetPack:function(a){return(new da(this,a)).promise},getStage:function(){return this._stage},createLogHandler:function(){return null},update:function(a){var b=(a-this._lastUpdate)/1E3;this._lastUpdate=a;o.hidden._value||(this._skipFrame?this._skipFrame=!1:(this.mainLoop.update(b),this.mainLoop.render(this._renderer)))},getPointer:function(){return this._pointer},
getMouse:function(){return this._mouse},getTouch:function(){return this._touch},getKeyboard:function(){var a=this;if(null==this._keyboard){this._keyboard=new Ja;var b=function(b){switch(b.type){case "keydown":a._keyboard.submitDown(b.keyCode)&&b.preventDefault();break;case "keyup":a._keyboard.submitUp(b.keyCode)}};this._canvas.addEventListener("keydown",b,!1);this._canvas.addEventListener("keyup",b,!1)}return this._keyboard},getRenderer:function(){return this._renderer},getX:function(a,b){return(a.clientX-
b.left)*this._stage.get_width()/b.width},getY:function(a,b){return(a.clientY-b.top)*this._stage.get_height()/b.height},createRenderer:function(a){try{var b=bh.getContextWebGL(a,{alpha:!1,depth:!1,failIfMajorPerformanceCaveat:!0});if(null!=b)if(I.detectSlowDriver(b))null;else return new Te(this._stage,b)}catch(c){}return new td(a)},__class__:pc};var ab=function(a,b){this._value=a;this._changed=null!=b?new Ed(b):null};h["flambe.util.Value"]=ab;ab.__name__=!0;ab.prototype={watch:function(a){a(this._value,
this._value);return this.get_changed().connect(a)},set__:function(a){var b=this._value;a!=b&&(this._value=a,null!=this._changed&&this._changed.emit(a,b));return a},get_changed:function(){null==this._changed&&(this._changed=new Ed);return this._changed},__class__:ab};var ac=function(a,b){this._next=null;this._signal=a;this._listener=b;this.stayInList=!0};h["flambe.util.SignalConnection"]=ac;ac.__name__=!0;ac.__interfaces__=[eb];ac.prototype={once:function(){this.stayInList=!1;return this},dispose:function(){null!=
this._signal&&(this._signal.disconnect(this),this._signal=null)},__class__:ac};var ja=function(a){this._head=null!=a?new ac(this,a):null;this._deferredTasks=null};h["flambe.util.SignalBase"]=ja;ja.__name__=!0;ja.prototype={connectImpl:function(a,b){var c=this,d=new ac(this,a);this._head==ja.DISPATCHING_SENTINEL?this.defer(function(){c.listAdd(d,b)}):this.listAdd(d,b);return d},disconnect:function(a){var b=this;this._head==ja.DISPATCHING_SENTINEL?this.defer(function(){b.listRemove(a)}):this.listRemove(a)},
defer:function(a){for(var b=null,c=this._deferredTasks;null!=c;)b=c,c=c.next;a=new ag(a);null!=b?b.next=a:this._deferredTasks=a},willEmit:function(){var a=this._head;this._head=ja.DISPATCHING_SENTINEL;return a},didEmit:function(a){this._head=a;a=this._deferredTasks;for(this._deferredTasks=null;null!=a;)a.fn(),a=a.next},listAdd:function(a,b){if(b)a._next=this._head,this._head=a;else{for(var c=null,d=this._head;null!=d;)c=d,d=d._next;null!=c?c._next=a:this._head=a}},listRemove:function(a){for(var b=
null,c=this._head;null!=c;){if(c==a){a=c._next;null==b?this._head=a:b._next=a;break}b=c;c=c._next}},__class__:ja};var Ed=function(a){ja.call(this,a)};h["flambe.util.Signal2"]=Ed;Ed.__name__=!0;Ed.__super__=ja;Ed.prototype=w(ja.prototype,{connect:function(a,b){null==b&&(b=!1);return this.connectImpl(a,b)},emit:function(a,b){var c=this;this._head==ja.DISPATCHING_SENTINEL?this.defer(function(){c.emitImpl(a,b)}):this.emitImpl(a,b)},emitImpl:function(a,b){for(var c=this.willEmit(),d=c;null!=d;)d._listener(a,
b),d.stayInList||d.dispose(),d=d._next;this.didEmit(c)},__class__:Ed});var V=function(a){ja.call(this,a)};h["flambe.util.Signal1"]=V;V.__name__=!0;V.__super__=ja;V.prototype=w(ja.prototype,{connect:function(a,b){null==b&&(b=!1);return this.connectImpl(a,b)},emit:function(a){var b=this;this._head==ja.DISPATCHING_SENTINEL?this.defer(function(){b.emitImpl(a)}):this.emitImpl(a)},emitImpl:function(a){for(var b=this.willEmit(),c=b;null!=c;)c._listener(a),c.stayInList||c.dispose(),c=c._next;this.didEmit(b)},
__class__:V});var y=function(a,b){this._behavior=null;ab.call(this,a,b)};h["flambe.animation.AnimatedFloat"]=y;y.__name__=!0;y.__super__=ab;y.prototype=w(ab.prototype,{set__:function(a){this._behavior=null;return ab.prototype.set__.call(this,a)},update:function(a){null!=this._behavior&&(ab.prototype.set__.call(this,this._behavior.update(a)),this._behavior.isComplete()&&(this._behavior=null))},animateTo:function(a,b,c){this.set_behavior(new bc(this._value,a,b,c))},animateBy:function(a,b,c){this.set_behavior(new bc(this._value,
this._value+a,b,c))},set_behavior:function(a){this._behavior=a;this.update(0);return a},__class__:y});var o=function(){};h["flambe.System"]=o;o.__name__=!0;o.init=function(){o._calledInit||(o._platform.init(),o._calledInit=!0)};o.loadAssetPack=function(a){return o._platform.loadAssetPack(a)};var Xf=function(a){this._handler=a};h["flambe.util.Logger"]=Xf;Xf.__name__=!0;Xf.prototype={__class__:Xf};var sd=function(){};h["flambe.Log"]=sd;sd.__name__=!0;sd.info=function(){null};sd.__super__=ah;sd.prototype=
w(ah.prototype,{__class__:sd});var bg=function(){this._realDt=0};h["flambe.SpeedAdjuster"]=bg;bg.__name__=!0;bg.__super__=G;bg.prototype=w(G.prototype,{get_name:function(){return"SpeedAdjuster_16"},onUpdate:function(a){0<this._realDt&&(a=this._realDt,this._realDt=0);this.scale.update(a)},__class__:bg});var cg=function(){};h["flambe.animation.Behavior"]=cg;cg.__name__=!0;cg.prototype={__class__:cg};var U=function(){};h["flambe.animation.Ease"]=U;U.__name__=!0;U.linear=function(a){return a};U.quadIn=
function(a){return a*a};U.quadOut=function(a){return a*(2-a)};U.quadInOut=function(a){return 0.5>=a?2*a*a:1-2*--a*a};U.quartOut=function(a){return 1- --a*a*a*a};U.quartInOut=function(a){return 0.5>=a?8*a*a*a*a:(1-(a=2*a-2)*a*a*a)/2+0.5};U.backOut=function(a){return 1- --a*a*(-2.70158*a-1.70158)};var bc=function(a,b,c,d){this._from=a;this._to=b;this._duration=c;this.elapsed=0;this._easing=null!=d?d:U.linear};h["flambe.animation.Tween"]=bc;bc.__name__=!0;bc.__interfaces__=[cg];bc.prototype={update:function(a){this.elapsed+=
a;return this.elapsed>=this._duration?this._to:this._from+(this._to-this._from)*this._easing(this.elapsed/this._duration)},isComplete:function(){return this.elapsed>=this._duration},__class__:bc};var Nc=function(){};h["flambe.asset.Asset"]=Nc;Nc.__name__=!0;Nc.__interfaces__=[eb];Nc.prototype={__class__:Nc};var v=h["flambe.asset.AssetFormat"]={__ename__:!0,__constructs__:"WEBP,JXR,PNG,JPG,GIF,DDS,PVR,PKM,MP3,M4A,OPUS,OGG,WAV,Data".split(",")};v.WEBP=["WEBP",0];v.WEBP.__enum__=v;v.JXR=["JXR",1];v.JXR.__enum__=
v;v.PNG=["PNG",2];v.PNG.__enum__=v;v.JPG=["JPG",3];v.JPG.__enum__=v;v.GIF=["GIF",4];v.GIF.__enum__=v;v.DDS=["DDS",5];v.DDS.__enum__=v;v.PVR=["PVR",6];v.PVR.__enum__=v;v.PKM=["PKM",7];v.PKM.__enum__=v;v.MP3=["MP3",8];v.MP3.__enum__=v;v.M4A=["M4A",9];v.M4A.__enum__=v;v.OPUS=["OPUS",10];v.OPUS.__enum__=v;v.OGG=["OGG",11];v.OGG.__enum__=v;v.WAV=["WAV",12];v.WAV.__enum__=v;v.Data=["Data",13];v.Data.__enum__=v;v.__empty_constructs__=[v.WEBP,v.JXR,v.PNG,v.JPG,v.GIF,v.DDS,v.PVR,v.PKM,v.MP3,v.M4A,v.OPUS,v.OGG,
v.WAV,v.Data];var dg=function(a,b,c,d){this.name=a;this.url=b;this.format=c;this.bytes=d};h["flambe.asset.AssetEntry"]=dg;dg.__name__=!0;dg.prototype={__class__:dg};var Ue=function(){};h["flambe.asset.AssetPack"]=Ue;Ue.__name__=!0;Ue.__interfaces__=[eb];Ue.prototype={__class__:Ue};var Ve=function(){};h["flambe.asset.File"]=Ve;Ve.__name__=!0;Ve.__interfaces__=[Nc];Ve.prototype={__class__:Ve};var Eb=function(){this._localBase=this._remoteBase=null;this._entries=[]};h["flambe.asset.Manifest"]=Eb;Eb.__name__=
!0;Eb.fromAssets=function(a,b){null==b&&(b=!0);var c=ca.field(ch.getType(Eb).assets[0],a);if(null==c){if(b)throw Ha.withFields("Missing asset pack",["name",a]);return null}var d=new Eb;d.set_localBase("assets");for(var e=0;e<c.length;){var i=c[e];++e;var k=i.name,f=a+"/"+k+"?v="+D.string(i.md5),j=Eb.inferFormat(k);j!=v.Data&&(k=Ha.removeFileExtension(k));d.add(k,f,i.bytes,j)}return d};Eb.inferFormat=function(a){a=Ha.getUrlExtension(a);if(null!=a)switch(a.toLowerCase()){case "gif":return v.GIF;case "jpg":case "jpeg":return v.JPG;
case "jxr":case "wdp":return v.JXR;case "png":return v.PNG;case "webp":return v.WEBP;case "dds":return v.DDS;case "pvr":return v.PVR;case "pkm":return v.PKM;case "m4a":return v.M4A;case "mp3":return v.MP3;case "ogg":return v.OGG;case "opus":return v.OPUS;case "wav":return v.WAV}else null;return v.Data};Eb.prototype={add:function(a,b,c,d){null==c&&(c=0);null==d&&(d=Eb.inferFormat(b));a=new dg(a,b,d,c);this._entries.push(a);return a},iterator:function(){return P.iter(this._entries)},getFullURL:function(a){var b;
b=null!=this.get_remoteBase()&&Eb._supportsCrossOrigin?this.get_remoteBase():this.get_localBase();return null!=b?Ha.joinPath(b,a.url):a.url},get_localBase:function(){return this._localBase},set_localBase:function(a){null!=a&&dh.that(!pd.startsWith(a,"http://")&&!pd.startsWith(a,"https://"),"localBase must be a path on the same domain, NOT starting with http(s)://",null);return this._localBase=a},get_remoteBase:function(){return this._remoteBase},__class__:Eb};var Ce=function(a){G.call(this);this.container=
a;this.behaviours=[];this.change=new Oc;this.visibleBounds=new rd;this._rotation=this._panY=this._panX=this._targetY=this._targetX=0;this._zoom=1;this.invalidated=!0};h["flambe.camera.Camera"]=Ce;Ce.__name__=!0;Ce.__super__=G;Ce.prototype=w(G.prototype,{get_name:function(){return"Camera_11"},onAdded:function(){this.container=this.owner;this.rootSprite=this.container._compMap.Sprite_1;if(null==this.rootSprite)throw"Uh-oh! No Sprite found in the container Entity "+D.string(this.container);this.owner.add(this.controller=
new We(this));this.stageResized=o._platform.getStage().resize.connect(q(this,this.onStageResized),!0);this.onStageResized()},onRemoved:function(){this.reset();for(var a=0,b=this.behaviours;a<b.length;){var c=b[a];++a;c.dispose()}this.behaviours=null;null!=this.controller&&(this.controller.dispose(),this.controller=null);null!=this.stageResized&&(this.stageResized.dispose(),this.stageResized=null);this.container=this.rootSprite=null},onUpdate:function(a){for(var b=this.stageCentreX,c=this.stageCentreY,
d=0,e=this.behaviours;d<e.length;){var i=e[d];++d;i.update(a)}if(this.invalidated){this.rootSprite.anchorX.set__(this._targetX-this._panX);this.rootSprite.anchorY.set__(this._targetY-this._panY);this.rootSprite.rotation.set__(this._rotation);this.rootSprite.setScale(this._zoom);this.rootSprite.x.set__(b);this.rootSprite.y.set__(c);this.visibleBounds.set(this.rootSprite.anchorX._value-b/this._zoom,this.rootSprite.anchorY._value-c/this._zoom,this.stageWidth/this._zoom,this.stageHeight/this._zoom);a=
0;for(b=this.behaviours;a<b.length;)c=b[a],++a,c.postUpdate();this.invalidated=!1;this.change.emit()}},onStageResized:function(){this.stageWidth=o._platform.getStage().get_width();this.stageHeight=o._platform.getStage().get_height();this.stageCentreX=this.stageWidth/2;this.stageCentreY=this.stageHeight/2;this.invalidated=!0},screenPointToWorld:function(a,b,c){c=null==c?new $c(a,b):c;if(null==this.rootSprite)return c;var d=this.rootSprite,e=d.scaleX._value;c.set((a-(d.x._value-d.anchorX._value*e))/
e,(b-(d.y._value-d.anchorY._value*e))/e);return c},reset:function(){this.invalidated=this.invalidated||1!=this._zoom;this._zoom=1;this.invalidated=this.invalidated||0!=this._targetX;this._targetX=0;this.invalidated=this.invalidated||0!=this._targetY;this._targetY=0;this.set_panX(this.set_panY(function(a){a.invalidated=a.invalidated||0!=a._rotation;return a._rotation=0}(this)));this.invalidated=!0;this.controller.setToCurrent();return this},set_zoom:function(a){this.invalidated=this.invalidated||a!=
this._zoom;return this._zoom=a},set_rotation:function(a){this.invalidated=this.invalidated||a!=this._rotation;return this._rotation=a},set_targetX:function(a){this.invalidated=this.invalidated||a!=this._targetX;return this._targetX=a},set_targetY:function(a){this.invalidated=this.invalidated||a!=this._targetY;return this._targetY=a},set_panX:function(a){this.invalidated=this.invalidated||a!=this._panX;return this._panX=a},set_panY:function(a){this.invalidated=this.invalidated||a!=this._panY;return this._panY=
a},__class__:Ce});var We=function(a){this.camera=null;G.call(this);this.camera=a};h["flambe.camera.CameraController"]=We;We.__name__=!0;We.__super__=G;We.prototype=w(G.prototype,{get_name:function(){return"CameraController_12"},onAdded:function(){this.panX=new y(this.camera._panX);this.panY=new y(this.camera._panY);this.targetX=new y(this.camera._targetX);this.targetY=new y(this.camera._targetY);this.zoom=new y(this.camera._zoom);this.rotation=new y(this.camera._rotation)},onUpdate:function(a){this.panX.update(a);
this.panY.update(a);this.targetX.update(a);this.targetY.update(a);this.zoom.update(a);this.rotation.update(a);this.camera.set_panX(this.panX._value);this.camera.set_panY(this.panY._value);this.camera.set_targetX(this.targetX._value);this.camera.set_targetY(this.targetY._value);this.camera.set_zoom(this.zoom._value);this.camera.set_rotation(this.rotation._value)},onRemoved:function(){this.rotation=this.zoom=this.targetY=this.targetX=this.panY=this.panX=this.camera=null},setToCurrent:function(){this.panX.set__(this.camera._panX);
this.panY.set__(this.camera._panY);this.targetX.set__(this.camera._targetX);this.targetY.set__(this.camera._targetY);this.zoom.set__(this.camera._zoom);this.rotation.set__(this.camera._rotation)},__class__:We});var ua=function(a){this._enabled=!1;this.camera=a;this.controller=a.controller};h["flambe.camera.behaviours.CameraControlBehaviour"]=ua;ua.__name__=!0;ua.prototype={update:function(){},postUpdate:function(){},dispose:function(){this.set_enabled(!1);this.camera=this.controller=null},get_enabled:function(){return this._enabled},
set_enabled:function(a){return this._enabled=a},__class__:ua};var Ie=function(a,b){ua.call(this,a);this.bounds=b};h["flambe.camera.behaviours.LimitBoundsBehaviour"]=Ie;Ie.__name__=!0;Ie.__super__=ua;Ie.prototype=w(ua.prototype,{postUpdate:function(){if(this._enabled){var a=this.camera,b=this.bounds,c=a.visibleBounds,d=a.rootSprite,e=a._zoom;c.width>=b.width?d.anchorX.set__(b.x+a.stageCentreX/e-(c.width-b.width)/2):c.x<b.x?d.anchorX.set__(b.x+a.stageCentreX/e):c.get_right()>b.get_right()&&d.anchorX.set__(b.get_right()-
a.stageCentreX/e);c.height>b.height?d.anchorY.set__(b.y+a.stageCentreY/e-(c.height-b.height)/2):c.y<b.y?d.anchorY.set__(b.y+a.stageCentreY/e):c.get_bottom()>b.get_bottom()&&d.anchorY.set__(b.get_bottom()-a.stageCentreY/e)}},dispose:function(){ua.prototype.dispose.call(this);this.bounds=null},__class__:Ie});var Je=function(a,b){this.scrollZoom=!0;this.mouseMoved=!1;this.lastX=this.lastY=this.x=this.y=0;this.bounds=b;ua.call(this,a)};h["flambe.camera.behaviours.MouseControlBehaviour"]=Je;Je.__name__=
!0;Je.__super__=ua;Je.prototype=w(ua.prototype,{validatePanX:function(a){if(this._enabled&&null!=this.bounds)if(0>a){if(0<this.camera.visibleBounds.get_right()-this.bounds.get_right())return 0}else if(0<a&&0>this.camera.visibleBounds.x-this.bounds.x)return 0;return a},validatePanY:function(a){if(this._enabled&&null!=this.bounds)if(0>a){if(0<this.camera.visibleBounds.get_bottom()-this.bounds.get_bottom())return 0}else if(0<a&&0>this.camera.visibleBounds.y-this.bounds.y)return 0;return a},update:function(){if(this.mouseMoved){this.mouseMoved=
!1;var a=this.controller,b=a.zoom._value,c=(this.x-this.lastX)/b,b=(this.y-this.lastY)/b;this.lastX=this.x;this.lastY=this.y;var d=a.panX;d.set__(d._value+this.validatePanX(c));a=a.panY;a.set__(a._value+this.validatePanY(b))}},onMouseDown:function(a){if(this._enabled){var b=o._platform.getMouse();if(a.button==fa.Right||a.button==fa.Left&&o._platform.getKeyboard().isDown(g.Space))this.lastX=a.viewX,this.lastY=a.viewY,this.mouseDownConnection.dispose(),this.mouseDownConnection=null,this.mouseMoveConnection=
b.move.connect(q(this,this.onMouseMove)),this.mouseUpConnection=b.up.connect(q(this,this.onMouseUp))}},onMouseUp:function(){this.mouseUpConnection.dispose();this.mouseUpConnection=null;this.mouseMoveConnection.dispose();this.mouseMoveConnection=null;this._enabled&&(this.mouseDownConnection=o._platform.getMouse().down.connect(q(this,this.onMouseDown)))},onMouseMove:function(a){this._enabled&&(this.mouseMoved=!0,this.x=a.viewX,this.y=a.viewY)},onMouseScroll:function(a){if(this._enabled&&this.scrollZoom){var b=
this.controller;o._platform.getKeyboard().isDown(g.Shift)?b.rotation.animateBy(0<a?-22.5:22.5,0.25,U.quadOut):(a=b.zoom._value*(0<a?1.2:0.8),a!=b.zoom._value&&b.zoom.animateTo(a,0.25,U.quadOut))}},setupControl:function(){var a=o._platform.getMouse();this.mouseDownConnection=a.down.connect(q(this,this.onMouseDown));this.mouseScrollConnection=a.scroll.connect(q(this,this.onMouseScroll))},removeControl:function(){null!=this.mouseMoveConnection&&(this.mouseMoveConnection.dispose(),this.mouseMoveConnection=
null);null!=this.mouseScrollConnection&&(this.mouseScrollConnection.dispose(),this.mouseScrollConnection=null);null!=this.mouseDownConnection&&(this.mouseDownConnection.dispose(),this.mouseDownConnection=null);null!=this.mouseUpConnection&&(this.mouseUpConnection.dispose(),this.mouseUpConnection=null)},set_enabled:function(a){!a&&this._enabled?(this.removeControl(),this._enabled=!1):o._platform.getMouse().get_supported()&&a&&!this._enabled&&(this.setupControl(),this._enabled=!0);return this._enabled},
__class__:Je});var He=function(a,b,c){null==c&&(c=0.25);null==b&&(b=0.25);this.followTargetRotation=!1;this.followTargetX=this.followTargetY=!0;this.rotationEaseTime=0;this.xEaseTime=this.yEaseTime=0.25;this._target=this._targetSprite=null;this.resetX=this.resetY=this.resetRotation=0;ua.call(this,a);this.xEaseTime=b;this.yEaseTime=c;this.followTargetX=0<=b;this.followTargetY=0<=c;this.easeRotation=this.easeY=this.easeX=U.quadInOut};h["flambe.camera.behaviours.SpriteFollowBehaviour"]=He;He.__name__=
!0;He.__super__=ua;He.prototype=w(ua.prototype,{update:function(){this.get_enabled()&&null!=this._target&&null!=this._targetSprite&&(this.followTargetX&&this.camera.controller.targetX.animateTo(this._targetSprite.x._value,this.xEaseTime,this.easeX),this.followTargetY&&this.camera.controller.targetY.animateTo(this._targetSprite.y._value,this.yEaseTime,this.easeY),this.followTargetRotation&&this.camera.controller.rotation.animateTo(-this._targetSprite.rotation._value,this.rotationEaseTime,this.easeRotation))},
dispose:function(){ua.prototype.dispose.call(this);this._target=this._targetSprite=null},set_enabled:function(a){this._enabled&&!a?(this.followTargetX&&this.camera.controller.targetX.animateTo(this.resetX,this.xEaseTime,this.easeX),this.followTargetY&&this.camera.controller.targetY.animateTo(this.resetY,this.yEaseTime,this.easeY),this.followTargetRotation&&this.camera.controller.rotation.animateTo(this.resetRotation,this.rotationEaseTime,this.easeRotation)):!this._enabled&&a&&(this.resetX=this.camera._targetX,
this.resetY=this.camera._targetY,this.resetRotation=this.camera._rotation);return this._enabled=a},set_target:function(a){if(null==a)this._targetSprite=null,this.set_enabled(!1);else{var b=a._compMap.Sprite_1;if(null==b)throw"Uh-oh! No Sprite found in that Entity "+D.string(a);if(b==this.camera.rootSprite)throw"Can't set the camera-target to be the main container!";this._targetSprite=b}return this._target=a},get_canFollowTarget:function(){return null!=this._target&&null!=this._targetSprite},__class__:He});
var Ke=function(a,b,c){this.min=b;this.max=c;ua.call(this,a)};h["flambe.camera.behaviours.ZoomLimitBehaviour"]=Ke;Ke.__name__=!0;Ke.__super__=ua;Ke.prototype=w(ua.prototype,{update:function(){if(this._enabled){var a=Math.min(Math.max(this.min,this.camera._zoom),this.max);this.camera._zoom!=a&&(this.camera._zoom=this.controller.zoom.set__(a))}},__class__:Ke});var $c=function(a,b){null==b&&(b=0);null==a&&(a=0);this.x=a;this.y=b};h["flambe.math.Point"]=$c;$c.__name__=!0;$c.prototype={set:function(a,
b){this.x=a;this.y=b},__class__:$c};var F=function(){this.blendMode=this.scissor=null;var a=this;G.call(this);this._flags|=54;this._localMatrix=new Pc;var b=function(){a._flags|=24};this.x=new y(0,b);this.y=new y(0,b);this.rotation=new y(0,b);this.scaleX=new y(1,b);this.scaleY=new y(1,b);this.anchorX=new y(0,b);this.anchorY=new y(0,b);this.alpha=new y(1)};h["flambe.display.Sprite"]=F;F.__name__=!0;F.hitTest=function(a,b,c){var d=a._compMap.Sprite_1;if(null!=d){if(6!=(d._flags&6))return null;d.getLocalMatrix().inverseTransform(b,
c,F._scratchPoint)&&(b=F._scratchPoint.x,c=F._scratchPoint.y);var e=d.scissor;if(null!=e&&!e.contains(b,c))return null}a=F.hitTestBackwards(a.firstChild,b,c);return null!=a?a:null!=d&&d.containsLocal(b,c)?d:null};F.render=function(a,b){var c=a._compMap.Sprite_1;if(null!=c){var d=c.alpha._value;if(0==(c._flags&2)||0>=d)return;b.save();1>d&&b.multiplyAlpha(d);null!=c.blendMode&&b.setBlendMode(c.blendMode);var d=c.getLocalMatrix(),e=d.m02,i=d.m12;0!=(c._flags&32)&&(e=Math.round(e),i=Math.round(i));b.transform(d.m00,
d.m10,d.m01,d.m11,e,i);d=c.scissor;null!=d&&b.applyScissor(d.x,d.y,d.width,d.height);c.draw(b)}d=a._compMap.Director_14;if(null!=d){d=d.occludedScenes;for(e=0;e<d.length;)i=d[e],++e,F.render(i,b)}for(d=a.firstChild;null!=d;)e=d.next,F.render(d,b),d=e;null!=c&&b.restore()};F.hitTestBackwards=function(a,b,c){if(null!=a){var d=F.hitTestBackwards(a.next,b,c);return null!=d?d:F.hitTest(a,b,c)}return null};F.__super__=G;F.prototype=w(G.prototype,{get_name:function(){return"Sprite_1"},getNaturalWidth:function(){return 0},
getNaturalHeight:function(){return 0},containsLocal:function(a,b){return 0<=a&&a<this.getNaturalWidth()&&0<=b&&b<this.getNaturalHeight()},getLocalMatrix:function(){0!=(this._flags&8)&&(this._flags&=-9,this._localMatrix.compose(this.x._value,this.y._value,this.scaleX._value,this.scaleY._value,3.141592653589793*this.rotation._value/180),this._localMatrix.translate(-this.anchorX._value,-this.anchorY._value));return this._localMatrix},setAnchor:function(a,b){this.anchorX.set__(a);this.anchorY.set__(b);
return this},centerAnchor:function(){this.anchorX.set__(this.getNaturalWidth()/2);this.anchorY.set__(this.getNaturalHeight()/2);return this},setXY:function(a,b){this.x.set__(a);this.y.set__(b);return this},setScale:function(a){this.scaleX.set__(a);this.scaleY.set__(a);return this},onAdded:function(){0!=(this._flags&64)&&this.connectHover()},onRemoved:function(){null!=this._hoverConnection&&(this._hoverConnection.dispose(),this._hoverConnection=null)},onUpdate:function(a){this.x.update(a);this.y.update(a);
this.rotation.update(a);this.scaleX.update(a);this.scaleY.update(a);this.alpha.update(a);this.anchorX.update(a);this.anchorY.update(a)},draw:function(){},getParentSprite:function(){if(null==this.owner)return null;for(var a=this.owner.parent;null!=a;){var b=a._compMap.Sprite_1;if(null!=b)return b;a=a.parent}return null},get_pointerDown:function(){null==this._pointerDown&&(this._pointerDown=new V);return this._pointerDown},get_pointerIn:function(){null==this._pointerIn&&(this._pointerIn=new V);return this._pointerIn},
get_pointerOut:function(){null==this._pointerOut&&(this._pointerOut=new V);return this._pointerOut},connectHover:function(){var a=this;null==this._hoverConnection&&(this._hoverConnection=o._platform.getPointer().move.connect(function(b){for(var c=b.hit;null!=c;){if(c==a)return;c=c.getParentSprite()}null!=a._pointerOut&&0!=(a._flags&64)&&a._pointerOut.emit(b);a._flags&=-65;a._hoverConnection.dispose();a._hoverConnection=null}))},set_visible:function(a){this._flags=eh.set(this._flags,2,a);return a},
onPointerDown:function(a){this.onHover(a);null!=this._pointerDown&&this._pointerDown.emit(a)},onPointerMove:function(a){this.onHover(a);null!=this._pointerMove&&this._pointerMove.emit(a)},onHover:function(a){if(0==(this._flags&64)&&(this._flags|=64,null!=this._pointerIn||null!=this._pointerOut))null!=this._pointerIn&&this._pointerIn.emit(a),this.connectHover()},onPointerUp:function(a){switch(a.source[1]){case 1:null!=this._pointerOut&&0!=(this._flags&64)&&this._pointerOut.emit(a),this._flags&=-65,
null!=this._hoverConnection&&(this._hoverConnection.dispose(),this._hoverConnection=null)}null!=this._pointerUp&&this._pointerUp.emit(a)},__class__:F});var Ud=function(a,b,c){F.call(this);this.color=a;this.width=new y(b);this.height=new y(c)};h["flambe.display.FillSprite"]=Ud;Ud.__name__=!0;Ud.__super__=F;Ud.prototype=w(F.prototype,{draw:function(a){a.fillRect(this.color,0,0,this.width._value,this.height._value)},getNaturalWidth:function(){return this.width._value},getNaturalHeight:function(){return this.height._value},
onUpdate:function(a){F.prototype.onUpdate.call(this,a);this.width.update(a);this.height.update(a)},__class__:Ud});var T=h["flambe.display.BlendMode"]={__ename__:!0,__constructs__:"Normal,Add,Multiply,Screen,Mask,Copy".split(",")};T.Normal=["Normal",0];T.Normal.__enum__=T;T.Add=["Add",1];T.Add.__enum__=T;T.Multiply=["Multiply",2];T.Multiply.__enum__=T;T.Screen=["Screen",3];T.Screen.__enum__=T;T.Mask=["Mask",4];T.Mask.__enum__=T;T.Copy=["Copy",5];T.Copy.__enum__=T;T.__empty_constructs__=[T.Normal,T.Add,
T.Multiply,T.Screen,T.Mask,T.Copy];var fb=h["flambe.display.EmitterType"]={__ename__:!0,__constructs__:["Gravity","Radial"]};fb.Gravity=["Gravity",0];fb.Gravity.__enum__=fb;fb.Radial=["Radial",1];fb.Radial.__enum__=fb;fb.__empty_constructs__=[fb.Gravity,fb.Radial];var C=function(a,b){this._file=a.getFile(b+".pex");for(var c=E.parse(this._file.toString()),d=0,e=0,i=b.lastIndexOf("/"),i=0<=i?P.substr(b,0,i+1):"",c=c.firstElement().elements();c.hasNext();){var k=c.next();switch(k.get_nodeName().toLowerCase()){case "texture":this.texture=
a.getTexture(i+Ha.removeFileExtension(k.get("name")));break;case "angle":this.angle=C.getFloat(k,"value");break;case "anglevariance":this.angleVariance=C.getFloat(k,"value");break;case "blendfuncdestination":e=D["int"](C.getFloat(k,"value"));break;case "blendfuncsource":d=D["int"](C.getFloat(k,"value"));break;case "duration":this.duration=C.getFloat(k,"value");break;case "emittertype":this.type=0==D["int"](C.getFloat(k,"value"))?fb.Gravity:fb.Radial;break;case "finishcolor":this.alphaEnd=C.getFloat(k,
"alpha");break;case "finishcolorvariance":this.alphaEndVariance=C.getFloat(k,"alpha");break;case "finishparticlesize":this.sizeEnd=C.getFloat(k,"value");break;case "finishparticlesizevariance":this.sizeEndVariance=C.getFloat(k,"value");break;case "gravity":this.gravityX=C.getFloat(k,"x");this.gravityY=C.getFloat(k,"y");break;case "maxparticles":this.maxParticles=D["int"](C.getFloat(k,"value"));break;case "maxradius":this.maxRadius=C.getFloat(k,"value");break;case "maxradiusvariance":this.maxRadiusVariance=
C.getFloat(k,"value");break;case "minradius":this.minRadius=C.getFloat(k,"value");break;case "particlelifespan":this.lifespan=C.getFloat(k,"value");break;case "particlelifespanvariance":this.lifespanVariance=C.getFloat(k,"value");break;case "radialaccelvariance":this.radialAccelVariance=C.getFloat(k,"value");break;case "radialacceleration":this.radialAccel=C.getFloat(k,"value");break;case "rotatepersecond":this.rotatePerSecond=C.getFloat(k,"value");break;case "rotatepersecondvariance":this.rotatePerSecondVariance=
C.getFloat(k,"value");break;case "rotationend":this.rotationEnd=C.getFloat(k,"value");break;case "rotationendvariance":this.rotationEndVariance=C.getFloat(k,"value");break;case "rotationstart":this.rotationStart=C.getFloat(k,"value");break;case "rotationstartvariance":this.rotationStartVariance=C.getFloat(k,"value");break;case "sourcepositionvariance":this.emitXVariance=C.getFloat(k,"x");this.emitYVariance=C.getFloat(k,"y");break;case "speed":this.speed=C.getFloat(k,"value");break;case "speedvariance":this.speedVariance=
C.getFloat(k,"value");break;case "startcolor":this.alphaStart=C.getFloat(k,"alpha");break;case "startcolorvariance":this.alphaStartVariance=C.getFloat(k,"alpha");break;case "startparticlesize":this.sizeStart=C.getFloat(k,"value");break;case "startparticlesizevariance":this.sizeStartVariance=C.getFloat(k,"value");break;case "tangentialaccelvariance":this.tangentialAccelVariance=C.getFloat(k,"value");break;case "tangentialacceleration":this.tangentialAccel=C.getFloat(k,"value")}}0>=this.lifespan&&(this.lifespan=
this.duration);1==d&&1==e?this.blendMode=T.Add:1==d&&771==e?this.blendMode=null:(0!=d||0!=e)&&null};h["flambe.display.EmitterMold"]=C;C.__name__=!0;C.getFloat=function(a,b){return D.parseFloat(a.get(b))};C.prototype={createEmitter:function(){return new va(this)},__class__:C};var va=function(a){this._emitElapsed=this._totalElapsed=0;this.enabled=!0;this.numParticles=0;F.call(this);this.texture=a.texture;this.blendMode=a.blendMode;this.type=a.type;this.alphaEnd=new y(a.alphaEnd);this.alphaEndVariance=
new y(a.alphaEndVariance);this.alphaStart=new y(a.alphaStart);this.alphaStartVariance=new y(a.alphaStartVariance);this.angle=new y(a.angle);this.angleVariance=new y(a.angleVariance);this.duration=a.duration;this.emitXVariance=new y(a.emitXVariance);this.emitYVariance=new y(a.emitYVariance);this.gravityX=new y(a.gravityX);this.gravityY=new y(a.gravityY);this.maxRadius=new y(a.maxRadius);this.maxRadiusVariance=new y(a.maxRadiusVariance);this.minRadius=new y(a.minRadius);this.lifespan=new y(a.lifespan);
this.lifespanVariance=new y(a.lifespanVariance);this.radialAccel=new y(a.radialAccel);this.radialAccelVariance=new y(a.radialAccelVariance);this.rotatePerSecond=new y(a.rotatePerSecond);this.rotatePerSecondVariance=new y(a.rotatePerSecondVariance);this.rotationEnd=new y(a.rotationEnd);this.rotationEndVariance=new y(a.rotationEndVariance);this.rotationStart=new y(a.rotationStart);this.rotationStartVariance=new y(a.rotationStartVariance);this.sizeEnd=new y(a.sizeEnd);this.sizeEndVariance=new y(a.sizeEndVariance);
this.sizeStart=new y(a.sizeStart);this.sizeStartVariance=new y(a.sizeStartVariance);this.speed=new y(a.speed);this.speedVariance=new y(a.speedVariance);this.tangentialAccel=new y(a.tangentialAccel);this.tangentialAccelVariance=new y(a.tangentialAccelVariance);this.emitX=new y(0);this.emitY=new y(0);this._particles=Array(a.maxParticles);for(var a=0,b=this._particles.length;a<b;)this._particles[a]=new eg,++a};h["flambe.display.EmitterSprite"]=va;va.__name__=!0;va.random=function(a,b){0!=b&&(a+=b*(2*
Math.random()-1));return a};va.__super__=F;va.prototype=w(F.prototype,{onUpdate:function(a){F.prototype.onUpdate.call(this,a);this.alphaEnd.update(a);this.alphaStart.update(a);this.angle.update(a);this.angleVariance.update(a);this.emitX.update(a);this.emitXVariance.update(a);this.emitY.update(a);this.emitYVariance.update(a);this.gravityX.update(a);this.gravityY.update(a);this.lifespan.update(a);this.lifespanVariance.update(a);this.maxRadius.update(a);this.maxRadiusVariance.update(a);this.minRadius.update(a);
this.radialAccel.update(a);this.radialAccelVariance.update(a);this.rotatePerSecond.update(a);this.rotatePerSecondVariance.update(a);this.rotationEnd.update(a);this.rotationEndVariance.update(a);this.rotationStart.update(a);this.rotationStartVariance.update(a);this.sizeEnd.update(a);this.sizeEndVariance.update(a);this.sizeStart.update(a);this.sizeStartVariance.update(a);this.speed.update(a);this.speedVariance.update(a);this.tangentialAccel.update(a);this.tangentialAccelVariance.update(a);for(var b=
this.type==fb.Gravity,c=0;c<this.numParticles;){var d=this._particles[c];if(d.life>a){if(b){d.x+=d.velX*a;d.y+=d.velY*a;var e=this.gravityX._value,i=-this.gravityY._value;if(0!=d.radialAccel||0!=d.tangentialAccel)var k=d.x-d.emitX,f=d.y-d.emitY,j=Math.sqrt(k*k+f*f),k=k/j,f=f/j,e=e+k*d.radialAccel,i=i+f*d.radialAccel,j=k,e=e+-f*d.tangentialAccel,i=i+j*d.tangentialAccel;d.velX+=e*a;d.velY+=i*a}else d.radialRotation+=d.velRadialRotation*a,d.radialRadius+=d.velRadialRadius*a,e=d.radialRadius,d.x=this.emitX._value-
Math.cos(d.radialRotation)*e,d.y=this.emitY._value-Math.sin(d.radialRotation)*e,e<this.minRadius._value&&(d.life=0);d.scale+=d.velScale*a;d.rotation+=d.velRotation*a;d.alpha+=d.velAlpha*a;d.life-=a;++c}else--this.numParticles,c!=this.numParticles&&(this._particles[c]=this._particles[this.numParticles],this._particles[this.numParticles]=d)}if(this.enabled){if(0<this.duration&&(this._totalElapsed+=a,this._totalElapsed>=this.duration)){this.enabled=!1;return}b=this.lifespan._value/this._particles.length;
for(this._emitElapsed+=a;this._emitElapsed>=b;)this.numParticles<this._particles.length&&this.initParticle(this._particles[this.numParticles])&&++this.numParticles,this._emitElapsed-=b}},draw:function(a){for(var b=-this.texture.get_width()/2,c=0,d=this.numParticles;c<d;){var e=this._particles[c];a.save();a.translate(e.x,e.y);1>e.alpha&&a.multiplyAlpha(e.alpha);0!=e.rotation&&a.rotate(e.rotation);1!=e.scale&&a.scale(e.scale,e.scale);a.drawTexture(this.texture,b,b);a.restore();++c}},initParticle:function(a){a.life=
va.random(this.lifespan._value,this.lifespanVariance._value);if(0>=a.life)return!1;a.emitX=this.emitX._value;a.emitY=this.emitY._value;var b=-ka.toRadians(va.random(this.angle._value,this.angleVariance._value)),c=va.random(this.speed._value,this.speedVariance._value);a.velX=c*Math.cos(b);a.velY=c*Math.sin(b);a.radialAccel=va.random(this.radialAccel._value,this.radialAccelVariance._value);a.tangentialAccel=va.random(this.tangentialAccel._value,this.tangentialAccelVariance._value);a.radialRadius=va.random(this.maxRadius._value,
this.maxRadiusVariance._value);a.velRadialRadius=-a.radialRadius/a.life;a.radialRotation=b;a.velRadialRotation=ka.toRadians(va.random(this.rotatePerSecond._value,this.rotatePerSecondVariance._value));this.type==fb.Gravity?(a.x=va.random(this.emitX._value,this.emitXVariance._value),a.y=va.random(this.emitY._value,this.emitYVariance._value)):(b=a.radialRadius,a.x=this.emitX._value-Math.cos(a.radialRotation)*b,a.y=this.emitY._value-Math.sin(a.radialRotation)*b);c=this.texture.get_width();b=va.random(this.sizeStart._value,
this.sizeStartVariance._value)/c;c=va.random(this.sizeEnd._value,this.sizeEndVariance._value)/c;a.scale=b;a.velScale=(c-b)/a.life;b=va.random(this.rotationStart._value,this.rotationStartVariance._value);c=va.random(this.rotationEnd._value,this.rotationEndVariance._value);a.rotation=b;a.velRotation=(c-b)/a.life;b=va.random(this.alphaStart._value,this.alphaStartVariance._value);c=va.random(this.alphaEnd._value,this.alphaEndVariance._value);a.alpha=b;a.velAlpha=(c-b)/a.life;return!0},__class__:va});
var eg=function(){this.emitX=this.emitY=this.x=this.velX=this.y=this.velY=this.radialRadius=this.velRadialRadius=this.radialRotation=this.velRadialRotation=this.radialAccel=this.tangentialAccel=this.scale=this.velScale=this.rotation=this.velRotation=this.alpha=this.velAlpha=this.life=0};h["flambe.display._EmitterSprite.Particle"]=eg;eg.__name__=!0;eg.prototype={__class__:eg};var Xe=function(a){this._kernings=null;this.xOffset=this.yOffset=this.xAdvance=0;this.page=null;this.x=this.y=this.width=this.height=
0;this.charCode=a};h["flambe.display.Glyph"]=Xe;Xe.__name__=!0;Xe.prototype={draw:function(a,b,c){0<this.width&&a.drawSubTexture(this.page,b+this.xOffset,c+this.yOffset,this.x,this.y,this.width,this.height)},getKerning:function(a){return null!=this._kernings?D["int"](this._kernings.get(a)):0},setKerning:function(a,b){null==this._kernings&&(this._kernings=new tb);this._kernings.set(a,b)},__class__:Xe};var qd=function(a,b){this.name=b;this._pack=a;this._file=a.getFile(b+".fnt");this.reload()};h["flambe.display.Font"]=
qd;qd.__name__=!0;qd.prototype={layoutText:function(a,b,c,d,e){null==e&&(e=0);null==d&&(d=0);null==c&&(c=0);null==b&&(b=Sa.Left);return new Qc(this,a,b,c,d,e)},reload:function(){this._glyphs=new tb;this._glyphs.set(qd.NEWLINE.charCode,qd.NEWLINE);for(var a=new qc(this._file.toString()),b=new tb,c=this.name.lastIndexOf("/"),c=0<=c?P.substr(this.name,0,c+1):"",d=a.keywords();d.hasNext();)switch(d.next()){case "info":for(var e=a.pairs();e.hasNext();){var i=e.next();switch(i.key){case "size":this.size=
i.getInt()}}break;case "common":for(e=a.pairs();e.hasNext();)switch(i=e.next(),i.key){case "lineHeight":this.lineHeight=i.getInt()}break;case "page":for(var e=0,i=null,k=a.pairs();k.hasNext();){var f=k.next();switch(f.key){case "id":e=f.getInt();break;case "file":i=f.getString()}}i=this._pack.getTexture(c+Ha.removeFileExtension(i));b.set(e,i);break;case "char":e=null;for(i=a.pairs();i.hasNext();)switch(k=i.next(),k.key){case "id":e=new Xe(k.getInt());break;case "x":e.x=k.getInt();break;case "y":e.y=
k.getInt();break;case "width":e.width=k.getInt();break;case "height":e.height=k.getInt();break;case "page":k=k.getInt();e.page=b.get(k);break;case "xoffset":e.xOffset=k.getInt();break;case "yoffset":e.yOffset=k.getInt();break;case "xadvance":e.xAdvance=k.getInt()}this._glyphs.set(e.charCode,e);break;case "kerning":e=null;k=i=0;for(f=a.pairs();f.hasNext();){var j=f.next();switch(j.key){case "first":e=this._glyphs.get(j.getInt());break;case "second":i=j.getInt();break;case "amount":k=j.getInt()}}null!=
e&&0!=k&&e.setKerning(i,k)}},__class__:qd};var Sa=h["flambe.display.TextAlign"]={__ename__:!0,__constructs__:["Left","Center","Right"]};Sa.Left=["Left",0];Sa.Left.__enum__=Sa;Sa.Center=["Center",1];Sa.Center.__enum__=Sa;Sa.Right=["Right",2];Sa.Right.__enum__=Sa;Sa.__empty_constructs__=[Sa.Left,Sa.Center,Sa.Right];var Qc=function(a,b,c,d,e,i){this.lines=0;var k=this;this._font=a;this._glyphs=[];this._offsets=[];this._lineOffset=Math.round(a.lineHeight+i);this.bounds=new rd;for(var f=[],i=b.length,
j=0;j<i;){var g=j++,g=b.charCodeAt(g),g=a._glyphs.get(g);null!=g?this._glyphs.push(g):null}for(var b=-1,h=0,m=0,a=a._glyphs.get(10),i=function(){k.bounds.width=ka.max(k.bounds.width,h);k.bounds.height+=m;f[k.lines]=h;m=h=0;++k.lines},j=0;j<this._glyphs.length;){g=this._glyphs[j];this._offsets[j]=Math.round(h);var r=0<d&&h+g.width>d;r||g==a?(r&&(0<=b?(this._glyphs[b]=a,h=this._offsets[b],j=b):this._glyphs.splice(j,0,a)),b=-1,m=this._lineOffset,i()):(32==g.charCode&&(b=j),h+=g.xAdvance+e,m=ka.max(m,
g.height+g.yOffset),j+1<this._glyphs.length&&(h+=g.getKerning(this._glyphs[j+1].charCode)));++j}i();e=0;a=Qc.getAlignOffset(c,f[0],d);b=1.79769313486231E308;i=-1.79769313486231E308;g=j=0;for(r=this._glyphs.length;g<r;){var Q=this._glyphs[g];10==Q.charCode&&(e+=this._lineOffset,++j,a=Qc.getAlignOffset(c,f[j],d));this._offsets[g]+=a;var o=e+Q.yOffset;b<o||(b=o);i=ka.max(i,o+Q.height);++g}this.bounds.x=Qc.getAlignOffset(c,this.bounds.width,d);this.bounds.y=b;this.bounds.height=i-b};h["flambe.display.TextLayout"]=
Qc;Qc.__name__=!0;Qc.getAlignOffset=function(a,b,c){switch(a[1]){case 0:return 0;case 2:return c-b;case 1:return Math.round((c-b)/2)}};Qc.prototype={draw:function(a){for(var b=0,c=0,d=this._glyphs.length;c<d;){var e=this._glyphs[c];10==e.charCode?b+=this._lineOffset:e.draw(a,this._offsets[c],b);++c}},__class__:Qc};var qc=function(a){this._configText=a;this._keywordPattern=new Kc("([A-Za-z]+)(.*)","");this._pairPattern=new Kc('([A-Za-z]+)=("[^"]*"|[^\\s]+)',"")};h["flambe.display._Font.ConfigParser"]=
qc;qc.__name__=!0;qc.advance=function(a,b){var c=b.matchedPos();return P.substr(a,c.pos+c.len,a.length)};qc.prototype={keywords:function(){var a=this,b=this._configText;return{next:function(){b=qc.advance(b,a._keywordPattern);a._pairText=a._keywordPattern.matched(2);return a._keywordPattern.matched(1)},hasNext:function(){return a._keywordPattern.match(b)}}},pairs:function(){var a=this,b=this._pairText;return{next:function(){b=qc.advance(b,a._pairPattern);return new fg(a._pairPattern.matched(1),a._pairPattern.matched(2))},
hasNext:function(){return a._pairPattern.match(b)}}},__class__:qc};var fg=function(a,b){this.key=a;this._value=b};h["flambe.display._Font.ConfigPair"]=fg;fg.__name__=!0;fg.prototype={getInt:function(){return D.parseInt(this._value)},getString:function(){return 34!=this._value.charCodeAt(0)?null:P.substr(this._value,1,this._value.length-2)},__class__:fg};var gg=function(){};h["flambe.display.Graphics"]=gg;gg.__name__=!0;gg.prototype={__class__:gg};var aa=function(a){F.call(this);this.texture=a};h["flambe.display.ImageSprite"]=
aa;aa.__name__=!0;aa.__super__=F;aa.prototype=w(F.prototype,{draw:function(a){null!=this.texture&&a.drawTexture(this.texture,0,0)},getNaturalWidth:function(){return null!=this.texture?this.texture.get_width():0},getNaturalHeight:function(){return null!=this.texture?this.texture.get_height():0},__class__:aa});var rc=h["flambe.display.Orientation"]={__ename__:!0,__constructs__:["Portrait","Landscape"]};rc.Portrait=["Portrait",0];rc.Portrait.__enum__=rc;rc.Landscape=["Landscape",1];rc.Landscape.__enum__=
rc;rc.__empty_constructs__=[rc.Portrait,rc.Landscape];var $g=function(){};h["flambe.display.StarlingSpriteSheet"]=$g;$g.__name__=!0;$g.parse=function(a,b){for(var c=new Na,d=a.elements();d.hasNext();){var e=d.next();if("TextureAtlas"==e.get_nodeName())for(e=e.elementsNamed("SubTexture");e.hasNext();){var i=e.next(),k=i.get("name"),i=b.subTexture(D.parseInt(i.get("x")),D.parseInt(i.get("y")),D.parseInt(i.get("width")),D.parseInt(i.get("height")));c.set(k,i)}}return c};var Ye=function(){};h["flambe.display.Texture"]=
Ye;Ye.__name__=!0;Ye.__interfaces__=[Nc];Ye.prototype={__class__:Ye};var fh=function(){};h["flambe.display.SubTexture"]=fh;fh.__name__=!0;fh.__interfaces__=[Ye];var Td=function(a,b){null==b&&(b="");this._layout=null;var c=this;F.call(this);this._font=a;this._text=b;this._align=Sa.Left;this._flags|=128;var d=function(){c._flags|=128};this.wrapWidth=new y(0,d);this.letterSpacing=new y(0,d);this.lineSpacing=new y(0,d)};h["flambe.display.TextSprite"]=Td;Td.__name__=!0;Td.__super__=F;Td.prototype=w(F.prototype,
{draw:function(a){this.updateLayout();this._layout.draw(a)},getNaturalWidth:function(){this.updateLayout();return 0<this.wrapWidth._value?this.wrapWidth._value:this._layout.bounds.width},getNaturalHeight:function(){this.updateLayout();var a=this._layout.lines*(this._font.lineHeight+this.lineSpacing._value),b=this._layout.bounds.height;return a>b?a:b},containsLocal:function(a,b){this.updateLayout();return this._layout.bounds.contains(a,b)},setAlign:function(a){this.set_align(a);return this},set_align:function(a){a!=
this._align&&(this._align=a,this._flags|=128);return a},updateLayout:function(){0!=(this._flags&128)&&(this._flags&=-129,this._layout=this._font.layoutText(this._text,this._align,this.wrapWidth._value,this.letterSpacing._value,this.lineSpacing._value))},onUpdate:function(a){F.prototype.onUpdate.call(this,a);this.wrapWidth.update(a);this.letterSpacing.update(a);this.lineSpacing.update(a)},__class__:Td});var A=h["flambe.input.GestureType"]={__ename__:!0,__constructs__:"GESTURE_TAP,GESTURE_LONG_PRESS,GESTURE_PAN,GESTURE_SWIPE,GESTURE_BEGIN,GESTURE_END,GESTURE_PINCH,GESTURE_ROTATION".split(",")};
A.GESTURE_TAP=["GESTURE_TAP",0];A.GESTURE_TAP.__enum__=A;A.GESTURE_LONG_PRESS=["GESTURE_LONG_PRESS",1];A.GESTURE_LONG_PRESS.__enum__=A;A.GESTURE_PAN=["GESTURE_PAN",2];A.GESTURE_PAN.__enum__=A;A.GESTURE_SWIPE=["GESTURE_SWIPE",3];A.GESTURE_SWIPE.__enum__=A;A.GESTURE_BEGIN=["GESTURE_BEGIN",4];A.GESTURE_BEGIN.__enum__=A;A.GESTURE_END=["GESTURE_END",5];A.GESTURE_END.__enum__=A;A.GESTURE_PINCH=["GESTURE_PINCH",6];A.GESTURE_PINCH.__enum__=A;A.GESTURE_ROTATION=["GESTURE_ROTATION",7];A.GESTURE_ROTATION.__enum__=
A;A.__empty_constructs__=[A.GESTURE_TAP,A.GESTURE_LONG_PRESS,A.GESTURE_PAN,A.GESTURE_SWIPE,A.GESTURE_BEGIN,A.GESTURE_END,A.GESTURE_PINCH,A.GESTURE_ROTATION];var hg=function(a,b,c,d){this.type=a;this.x=b;this.y=c;this.extra=d};h["flambe.input.Gesture"]=hg;hg.__name__=!0;hg.prototype={setTo:function(a,b,c){this.x=a;this.y=b;this.extra=c;return this},__class__:hg};var ba=h["flambe.input.TouchType"]={__ename__:!0,__constructs__:["TOUCH_BEGIN","TOUCH_MOVE","TOUCH_END"]};ba.TOUCH_BEGIN=["TOUCH_BEGIN",0];
ba.TOUCH_BEGIN.__enum__=ba;ba.TOUCH_MOVE=["TOUCH_MOVE",1];ba.TOUCH_MOVE.__enum__=ba;ba.TOUCH_END=["TOUCH_END",2];ba.TOUCH_END.__enum__=ba;ba.__empty_constructs__=[ba.TOUCH_BEGIN,ba.TOUCH_MOVE,ba.TOUCH_END];var ma=h["flambe.input.GestureState"]={__ename__:!0,__constructs__:["READY","BEGIN","TWO_FINGER_MOVE","MOVE"]};ma.READY=["READY",0];ma.READY.__enum__=ma;ma.BEGIN=["BEGIN",1];ma.BEGIN.__enum__=ma;ma.TWO_FINGER_MOVE=["TWO_FINGER_MOVE",2];ma.TWO_FINGER_MOVE.__enum__=ma;ma.MOVE=["MOVE",3];ma.MOVE.__enum__=
ma;ma.__empty_constructs__=[ma.READY,ma.BEGIN,ma.TWO_FINGER_MOVE,ma.MOVE];var Ia=function(){this.preferPointer=!0;this.swipeTimeout=0.25;this.longPressDelay=1;G.call(this);this.tempPoint=new $c;this.gesture=new V;this.touchList=new Ae;this.touchTimes=new tb;this.gestures=this.createGestures()};h["flambe.input.GestureControl"]=Ia;Ia.__name__=!0;Ia.polar=function(a,b,c){a.set(b*Math.cos(c),b*Math.sin(c))};Ia.lerp=function(a,b,c){return b+c*(a-b)};Ia.__super__=G;Ia.prototype=w(G.prototype,{get_name:function(){return"GestureControl_4"},
onAdded:function(){if(o._platform.getTouch().get_supported()&&1<o._platform.getTouch().get_maxPoints()&&o._platform.getMouse().get_supported()&&this.preferPointer||!(o._platform.getTouch().get_supported()&&1<o._platform.getTouch().get_maxPoints())&&o._platform.getPointer().get_supported())o._platform.getPointer().down.connect(q(this,this.onPointerDown)).once();else if(o._platform.getTouch().get_supported()&&1<o._platform.getTouch().get_maxPoints())this.upConn=o._platform.getTouch().up.connect(q(this,
this.onTouchUp)),this.downConn=o._platform.getTouch().down.connect(q(this,this.onTouchDown)),this.moveConn=o._platform.getTouch().move.connect(q(this,this.onTouchMove));else throw"No Pointer or (multi)Touch inputs available?";this.resizeConn=o._platform.getStage().resize.connect(q(this,this.stageResized));this.stageResized();this.setReady()},onPointerDown:function(a){null!=this.upConn&&this.upConn.dispose();this.upConn=o._platform.getPointer().up.connect(q(this,this.onPointerUp));null!=this.moveConn&&
this.moveConn.dispose();this.moveConn=o._platform.getPointer().move.connect(q(this,this.onPointerMove));this.onTouch(ba.TOUCH_BEGIN,-1,a.viewX,a.viewY)},onPointerMove:function(a){this.onTouch(ba.TOUCH_MOVE,-1,a.viewX,a.viewY)},onPointerUp:function(a){this.moveConn.dispose();this.moveConn=null;this.upConn.dispose();this.upConn=null;this.onTouch(ba.TOUCH_END,-1,a.viewX,a.viewY);o._platform.getPointer().down.connect(q(this,this.onPointerDown)).once()},onTouchDown:function(a){this.onTouch(ba.TOUCH_BEGIN,
a.id,a.viewX,a.viewY)},onTouchMove:function(a){this.onTouch(ba.TOUCH_MOVE,a.id,a.viewX,a.viewY)},onTouchUp:function(a){this.onTouch(ba.TOUCH_END,a.id,a.viewX,a.viewY)},stageResized:function(){var a=o._platform.getStage();Ia.moveToleSqr=0.0080*Math.sqrt(a.get_width()*a.get_width()+a.get_height()*a.get_height());Ia.moveToleSqr*=Ia.moveToleSqr},onRemoved:function(){null!=this.resizeConn&&this.resizeConn.dispose();null!=this.upConn&&this.upConn.dispose();null!=this.downConn&&this.downConn.dispose();null!=
this.moveConn&&this.moveConn.dispose();this.setReady()},setReady:function(){this.state=ma.READY;this.touch0=this.touch1=null;this.touchList.clear();null!=this.longPressTimer&&(this.longPressTimer.stop(),this.longPressTimer=null)},onTouch:function(a,b,c,d){var e=null==this.touch0||this.touch0.id==b;(e||null!=this.touch1&&this.touch1.id==b||null!=this.touch0&&null==this.touch1&&this.touch0.id!=b)&&this.handleTouch(a,{time:oc.stamp(),id:b,x:c,y:d},e)},handleTouch:function(a,b,c){var d=b.time,e=b.x,i=
b.y,k;k=c?this.touch0:this.touch1;if(a==ba.TOUCH_MOVE&&null!=k&&this.distSqr(b,k)<Ia.moveToleSqr)return!1;var f=!0;switch(this.state[1]){case 0:c&&a==ba.TOUCH_BEGIN?(this.state=ma.BEGIN,this.touch0=b,this.touchTimes.set(b.id,d),this.longPressTimer=oc.delay(function(a,b){return function(){return a(b)}}(q(this,this.sendLongPress),b),1E3*this.longPressDelay|0),this.gesture.emit(this.gestures.get(A.GESTURE_BEGIN).setTo(e,i,null))):f=!1;break;case 1:c&&a==ba.TOUCH_END?(this.gesture.emit(this.gestures.get(A.GESTURE_TAP).setTo(e,
i,null)),this.gesture.emit(this.gestures.get(A.GESTURE_END).setTo(e,i,null)),this.setReady()):c&&a==ba.TOUCH_MOVE?(this.tempPoint.set(e-this.touch0.x,i-this.touch0.y),this.gesture.emit(this.gestures.get(A.GESTURE_PAN).setTo(e,i,this.tempPoint)),this.state=ma.MOVE,null!=this.touch0&&this.touchList.push(this.touch0),this.touch0=b,null!=this.longPressTimer&&(this.longPressTimer.stop(),this.longPressTimer=null)):!c&&a==ba.TOUCH_BEGIN?(this.state=ma.TWO_FINGER_MOVE,this.touch1=b,null!=this.longPressTimer&&
(this.longPressTimer.stop(),this.longPressTimer=null)):f=!1;break;case 3:if(c&&a==ba.TOUCH_MOVE)this.tempPoint.set(e-this.touch0.x,i-this.touch0.y),this.gesture.emit(this.gestures.get(A.GESTURE_PAN).setTo(e,i,this.tempPoint)),this.state=ma.MOVE,null!=this.touch0&&this.touchList.push(this.touch0),this.touch0=b,null!=this.longPressTimer&&(this.longPressTimer.stop(),this.longPressTimer=null);else if(c&&a==ba.TOUCH_END){b=d-this.touchTimes.get(this.touch0.id);if(0>=this.swipeTimeout||b<this.swipeTimeout)a=
this.touchList.pop(),this.touchTimes.get(a.id),this.touchTimes.remove(a.id),c=a.x-k.x,a=a.y-k.y,k=Math.atan2(a,c),c=Math.sqrt(c*c+a*a),Ia.polar(this.tempPoint,c/-b,k),this.gesture.emit(this.gestures.get(A.GESTURE_SWIPE).setTo(e,i,this.tempPoint));this.gesture.emit(this.gestures.get(A.GESTURE_END).setTo(e,i,null));this.setReady()}else!c&&a==ba.TOUCH_BEGIN?(this.gesture.emit(this.gestures.get(A.GESTURE_BEGIN).setTo(e,i,null)),this.state=ma.TWO_FINGER_MOVE,this.touch1=b,null!=this.longPressTimer&&(this.longPressTimer.stop(),
this.longPressTimer=null)):f=!1;break;case 2:a==ba.TOUCH_END?(this.gesture.emit(this.gestures.get(A.GESTURE_END).setTo(e,i,null)),this.setReady()):a==ba.TOUCH_MOVE?(a=c?this.touch1:this.touch0,d=c?this.touch0:this.touch1,k=this.distSqr(b,a)/this.distSqr(d,a),e=Math.atan2(i-a.y,e-a.x)-Math.atan2(d.y-a.y,d.x-a.x),i=Ia.lerp(a.x,d.x,0.5),a=Ia.lerp(a.y,d.y,0.5),1!=k&&this.gesture.emit(this.gestures.get(A.GESTURE_PINCH).setTo(i,a,k)),0!=e&&this.gesture.emit(this.gestures.get(A.GESTURE_ROTATION).setTo(i,
a,e)),c?this.touch0=b:this.touch1=b):f=!1}return f},sendLongPress:function(a){this.gesture.emit(this.gestures.get(A.GESTURE_LONG_PRESS).setTo(a.x,a.y,null));this.gesture.emit(this.gestures.get(A.GESTURE_END).setTo(a.x,a.y,null));this.setReady()},distSqr:function(a,b){var c=b.x-a.x,d=b.y-a.y;return c*c+d*d},createGestures:function(a){null==a&&(a=lc.allEnums(A));for(var b=new bd,c=0;c<a.length;){var d=a[c];++c;var e=new hg(d,NaN,NaN);b.set(d,e)}return b},__class__:Ia});var g=h["flambe.input.Key"]={__ename__:!0,
__constructs__:"A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,Number0,Number1,Number2,Number3,Number4,Number5,Number6,Number7,Number8,Number9,Numpad0,Numpad1,Numpad2,Numpad3,Numpad4,Numpad5,Numpad6,Numpad7,Numpad8,Numpad9,NumpadAdd,NumpadDecimal,NumpadDivide,NumpadEnter,NumpadMultiply,NumpadSubtract,F1,F2,F3,F4,F5,F6,F7,F8,F9,F10,F11,F12,F13,F14,F15,Left,Up,Right,Down,Alt,Backquote,Backslash,Backspace,CapsLock,Comma,Command,Control,Delete,End,Enter,Equals,Escape,Home,Insert,LeftBracket,Minus,PageDown,PageUp,Period,Quote,RightBracket,Semicolon,Shift,Slash,Space,Tab,Menu,Search,Unknown".split(",")};
g.A=["A",0];g.A.__enum__=g;g.B=["B",1];g.B.__enum__=g;g.C=["C",2];g.C.__enum__=g;g.D=["D",3];g.D.__enum__=g;g.E=["E",4];g.E.__enum__=g;g.F=["F",5];g.F.__enum__=g;g.G=["G",6];g.G.__enum__=g;g.H=["H",7];g.H.__enum__=g;g.I=["I",8];g.I.__enum__=g;g.J=["J",9];g.J.__enum__=g;g.K=["K",10];g.K.__enum__=g;g.L=["L",11];g.L.__enum__=g;g.M=["M",12];g.M.__enum__=g;g.N=["N",13];g.N.__enum__=g;g.O=["O",14];g.O.__enum__=g;g.P=["P",15];g.P.__enum__=g;g.Q=["Q",16];g.Q.__enum__=g;g.R=["R",17];g.R.__enum__=g;g.S=["S",
18];g.S.__enum__=g;g.T=["T",19];g.T.__enum__=g;g.U=["U",20];g.U.__enum__=g;g.V=["V",21];g.V.__enum__=g;g.W=["W",22];g.W.__enum__=g;g.X=["X",23];g.X.__enum__=g;g.Y=["Y",24];g.Y.__enum__=g;g.Z=["Z",25];g.Z.__enum__=g;g.Number0=["Number0",26];g.Number0.__enum__=g;g.Number1=["Number1",27];g.Number1.__enum__=g;g.Number2=["Number2",28];g.Number2.__enum__=g;g.Number3=["Number3",29];g.Number3.__enum__=g;g.Number4=["Number4",30];g.Number4.__enum__=g;g.Number5=["Number5",31];g.Number5.__enum__=g;g.Number6=
["Number6",32];g.Number6.__enum__=g;g.Number7=["Number7",33];g.Number7.__enum__=g;g.Number8=["Number8",34];g.Number8.__enum__=g;g.Number9=["Number9",35];g.Number9.__enum__=g;g.Numpad0=["Numpad0",36];g.Numpad0.__enum__=g;g.Numpad1=["Numpad1",37];g.Numpad1.__enum__=g;g.Numpad2=["Numpad2",38];g.Numpad2.__enum__=g;g.Numpad3=["Numpad3",39];g.Numpad3.__enum__=g;g.Numpad4=["Numpad4",40];g.Numpad4.__enum__=g;g.Numpad5=["Numpad5",41];g.Numpad5.__enum__=g;g.Numpad6=["Numpad6",42];g.Numpad6.__enum__=g;g.Numpad7=
["Numpad7",43];g.Numpad7.__enum__=g;g.Numpad8=["Numpad8",44];g.Numpad8.__enum__=g;g.Numpad9=["Numpad9",45];g.Numpad9.__enum__=g;g.NumpadAdd=["NumpadAdd",46];g.NumpadAdd.__enum__=g;g.NumpadDecimal=["NumpadDecimal",47];g.NumpadDecimal.__enum__=g;g.NumpadDivide=["NumpadDivide",48];g.NumpadDivide.__enum__=g;g.NumpadEnter=["NumpadEnter",49];g.NumpadEnter.__enum__=g;g.NumpadMultiply=["NumpadMultiply",50];g.NumpadMultiply.__enum__=g;g.NumpadSubtract=["NumpadSubtract",51];g.NumpadSubtract.__enum__=g;g.F1=
["F1",52];g.F1.__enum__=g;g.F2=["F2",53];g.F2.__enum__=g;g.F3=["F3",54];g.F3.__enum__=g;g.F4=["F4",55];g.F4.__enum__=g;g.F5=["F5",56];g.F5.__enum__=g;g.F6=["F6",57];g.F6.__enum__=g;g.F7=["F7",58];g.F7.__enum__=g;g.F8=["F8",59];g.F8.__enum__=g;g.F9=["F9",60];g.F9.__enum__=g;g.F10=["F10",61];g.F10.__enum__=g;g.F11=["F11",62];g.F11.__enum__=g;g.F12=["F12",63];g.F12.__enum__=g;g.F13=["F13",64];g.F13.__enum__=g;g.F14=["F14",65];g.F14.__enum__=g;g.F15=["F15",66];g.F15.__enum__=g;g.Left=["Left",67];g.Left.__enum__=
g;g.Up=["Up",68];g.Up.__enum__=g;g.Right=["Right",69];g.Right.__enum__=g;g.Down=["Down",70];g.Down.__enum__=g;g.Alt=["Alt",71];g.Alt.__enum__=g;g.Backquote=["Backquote",72];g.Backquote.__enum__=g;g.Backslash=["Backslash",73];g.Backslash.__enum__=g;g.Backspace=["Backspace",74];g.Backspace.__enum__=g;g.CapsLock=["CapsLock",75];g.CapsLock.__enum__=g;g.Comma=["Comma",76];g.Comma.__enum__=g;g.Command=["Command",77];g.Command.__enum__=g;g.Control=["Control",78];g.Control.__enum__=g;g.Delete=["Delete",79];
g.Delete.__enum__=g;g.End=["End",80];g.End.__enum__=g;g.Enter=["Enter",81];g.Enter.__enum__=g;g.Equals=["Equals",82];g.Equals.__enum__=g;g.Escape=["Escape",83];g.Escape.__enum__=g;g.Home=["Home",84];g.Home.__enum__=g;g.Insert=["Insert",85];g.Insert.__enum__=g;g.LeftBracket=["LeftBracket",86];g.LeftBracket.__enum__=g;g.Minus=["Minus",87];g.Minus.__enum__=g;g.PageDown=["PageDown",88];g.PageDown.__enum__=g;g.PageUp=["PageUp",89];g.PageUp.__enum__=g;g.Period=["Period",90];g.Period.__enum__=g;g.Quote=
["Quote",91];g.Quote.__enum__=g;g.RightBracket=["RightBracket",92];g.RightBracket.__enum__=g;g.Semicolon=["Semicolon",93];g.Semicolon.__enum__=g;g.Shift=["Shift",94];g.Shift.__enum__=g;g.Slash=["Slash",95];g.Slash.__enum__=g;g.Space=["Space",96];g.Space.__enum__=g;g.Tab=["Tab",97];g.Tab.__enum__=g;g.Menu=["Menu",98];g.Menu.__enum__=g;g.Search=["Search",99];g.Search.__enum__=g;g.Unknown=function(a){a=["Unknown",100,a];a.__enum__=g;return a};g.__empty_constructs__=[g.A,g.B,g.C,g.D,g.E,g.F,g.G,g.H,g.I,
g.J,g.K,g.L,g.M,g.N,g.O,g.P,g.Q,g.R,g.S,g.T,g.U,g.V,g.W,g.X,g.Y,g.Z,g.Number0,g.Number1,g.Number2,g.Number3,g.Number4,g.Number5,g.Number6,g.Number7,g.Number8,g.Number9,g.Numpad0,g.Numpad1,g.Numpad2,g.Numpad3,g.Numpad4,g.Numpad5,g.Numpad6,g.Numpad7,g.Numpad8,g.Numpad9,g.NumpadAdd,g.NumpadDecimal,g.NumpadDivide,g.NumpadEnter,g.NumpadMultiply,g.NumpadSubtract,g.F1,g.F2,g.F3,g.F4,g.F5,g.F6,g.F7,g.F8,g.F9,g.F10,g.F11,g.F12,g.F13,g.F14,g.F15,g.Left,g.Up,g.Right,g.Down,g.Alt,g.Backquote,g.Backslash,g.Backspace,
g.CapsLock,g.Comma,g.Command,g.Control,g.Delete,g.End,g.Enter,g.Equals,g.Escape,g.Home,g.Insert,g.LeftBracket,g.Minus,g.PageDown,g.PageUp,g.Period,g.Quote,g.RightBracket,g.Semicolon,g.Shift,g.Slash,g.Space,g.Tab,g.Menu,g.Search];var ig=function(){this.init(0,null)};h["flambe.input.KeyboardEvent"]=ig;ig.__name__=!0;ig.prototype={init:function(a,b){this.id=a;this.key=b},__class__:ig};var fa=h["flambe.input.MouseButton"]={__ename__:!0,__constructs__:["Left","Middle","Right","Unknown"]};fa.Left=["Left",
0];fa.Left.__enum__=fa;fa.Middle=["Middle",1];fa.Middle.__enum__=fa;fa.Right=["Right",2];fa.Right.__enum__=fa;fa.Unknown=function(a){a=["Unknown",3,a];a.__enum__=fa;return a};fa.__empty_constructs__=[fa.Left,fa.Middle,fa.Right];var qb=h["flambe.input.MouseCursor"]={__ename__:!0,__constructs__:["Default","Button","None"]};qb.Default=["Default",0];qb.Default.__enum__=qb;qb.Button=["Button",1];qb.Button.__enum__=qb;qb.None=["None",2];qb.None.__enum__=qb;qb.__empty_constructs__=[qb.Default,qb.Button,
qb.None];var jg=function(){this.init(0,0,0,null)};h["flambe.input.MouseEvent"]=jg;jg.__name__=!0;jg.prototype={init:function(a,b,c,d){this.id=a;this.viewX=b;this.viewY=c;this.button=d},__class__:jg};var Yd=h["flambe.input.EventSource"]={__ename__:!0,__constructs__:["Mouse","Touch"]};Yd.Mouse=function(a){a=["Mouse",0,a];a.__enum__=Yd;return a};Yd.Touch=function(a){a=["Touch",1,a];a.__enum__=Yd;return a};Yd.__empty_constructs__=[];var kg=function(){this.init(0,0,0,null,null)};h["flambe.input.PointerEvent"]=
kg;kg.__name__=!0;kg.prototype={init:function(a,b,c,d,e){this.id=a;this.viewX=b;this.viewY=c;this.hit=d;this.source=e;this._stopped=!1},__class__:kg};var lg=function(a){this.id=a;this._source=Yd.Touch(this)};h["flambe.input.TouchPoint"]=lg;lg.__name__=!0;lg.prototype={init:function(a,b){this.viewX=a;this.viewY=b},__class__:lg};var ka=function(){};h["flambe.math.FMath"]=ka;ka.__name__=!0;ka.toRadians=function(a){return 3.141592653589793*a/180};ka.max=function(a,b){return a>b?a:b};ka.min=function(a,
b){return a<b?a:b};ka.clamp=function(a,b,c){return a<b?b:a>c?c:a};var Pc=function(){this.identity()};h["flambe.math.Matrix"]=Pc;Pc.__name__=!0;Pc.multiply=function(a,b,c){null==c&&(c=new Pc);var d=a.m00*b.m00+a.m01*b.m10,e=a.m00*b.m01+a.m01*b.m11,i=a.m00*b.m02+a.m01*b.m12+a.m02;c.m00=d;c.m01=e;c.m02=i;d=a.m10*b.m00+a.m11*b.m10;e=a.m10*b.m01+a.m11*b.m11;i=a.m10*b.m02+a.m11*b.m12+a.m12;c.m10=d;c.m11=e;c.m12=i;return c};Pc.prototype={set:function(a,b,c,d,e,i){this.m00=a;this.m01=c;this.m02=e;this.m10=
b;this.m11=d;this.m12=i},identity:function(){this.set(1,0,0,1,0,0)},compose:function(a,b,c,d,e){var i=Math.sin(e),e=Math.cos(e);this.set(e*c,i*c,-i*d,e*d,a,b)},translate:function(a,b){this.m02+=this.m00*a+this.m01*b;this.m12+=this.m11*b+this.m10*a},invert:function(){var a=this.determinant();if(0==a)return!1;this.set(this.m11/a,-this.m01/a,-this.m10/a,this.m00/a,(this.m01*this.m12-this.m11*this.m02)/a,(this.m10*this.m02-this.m00*this.m12)/a);return!0},transformArray:function(a,b,c){for(var d=0;d<b;){var e=
a[d],i=a[d+1];c[d++]=e*this.m00+i*this.m01+this.m02;c[d++]=e*this.m10+i*this.m11+this.m12}},determinant:function(){return this.m00*this.m11-this.m01*this.m10},inverseTransform:function(a,b,c){var d=this.determinant();if(0==d)return!1;a-=this.m02;b-=this.m12;c.x=(a*this.m11-b*this.m01)/d;c.y=(b*this.m00-a*this.m10)/d;return!0},clone:function(a){null==a&&(a=new Pc);a.set(this.m00,this.m10,this.m01,this.m11,this.m02,this.m12);return a},__class__:Pc};var rd=function(a,b,c,d){null==d&&(d=0);null==c&&(c=
0);null==b&&(b=0);null==a&&(a=0);this.set(a,b,c,d)};h["flambe.math.Rectangle"]=rd;rd.__name__=!0;rd.prototype={set:function(a,b,c,d){this.x=a;this.y=b;this.width=c;this.height=d},contains:function(a,b){a-=this.x;if(0<=this.width){if(0>a||a>this.width)return!1}else if(0<a||a<this.width)return!1;b-=this.y;if(0<=this.height){if(0>b||b>this.height)return!1}else if(0<b||b<this.height)return!1;return!0},clone:function(a){null==a&&(a=new rd);a.set(this.x,this.y,this.width,this.height);return a},equals:function(a){return this.x==
a.x&&this.y==a.y&&this.width==a.width&&this.height==a.height},get_right:function(){return this.x+this.width},get_bottom:function(){return this.y+this.height},__class__:rd};var Zd=function(a,b,c){this.scaleX=this.scaleY=1;G.call(this);this.world=a;this.body=b;this.bounds=c};h["flambe.nape.BodyComponent"]=Zd;Zd.__name__=!0;Zd.__super__=G;Zd.prototype=w(G.prototype,{get_name:function(){return"BodyComponent_10"},setTargetSprite:function(a){this.sprite=a},onAdded:function(){this.setup()},onStart:function(){(null==
this.sprite||null==this.space)&&this.setup()},setup:function(){this.sprite=this.owner._compMap.Sprite_1;this.space=null!=this.world._compMap.SpaceComponent_9?this.world._compMap.SpaceComponent_9.napeSpace:null;this.body.set_space(this.space)},setScale:function(a,b){this.body.scaleShapes(1/this.scaleX,1/this.scaleY);this.sprite.scaleX.set__(this.scaleX=a);this.sprite.scaleY.set__(this.scaleY=b);this.body.scaleShapes(a,b)},onUpdate:function(){var a=this.body.get_position(),b;if(b=null!=this.bounds)if(a.zpp_inner.validate(),
!(b=a.zpp_inner.x<this.bounds.zpp_inner.getmin().get_x()))if(a.zpp_inner.validate(),!(b=a.zpp_inner.y<this.bounds.zpp_inner.getmin().get_y()))if(a.zpp_inner.validate(),!(b=a.zpp_inner.x>this.bounds.zpp_inner.getmax().get_x()))a.zpp_inner.validate(),b=a.zpp_inner.y>this.bounds.zpp_inner.getmax().get_y();b?this.owner.dispose():(this.sprite.x.set__(function(){a.zpp_inner.validate();return a.zpp_inner.x}(this)),this.sprite.y.set__(function(){a.zpp_inner.validate();return a.zpp_inner.y}(this)),this.sprite.rotation.set__(180*
this.body.zpp_inner.rot/3.141592653589793))},onRemoved:function(){this.body.set_space(null)},__class__:Zd});var Ze=function(a){G.call(this);this.joint=a};h["flambe.nape.DistanceJointComponent"]=Ze;Ze.__name__=!0;Ze.__super__=G;Ze.prototype=w(G.prototype,{get_name:function(){return"DistanceJointComponent_17"},onAdded:function(){this.sprite=this.owner._compMap.Sprite_1},onUpdate:function(){if(this.joint.zpp_inner.active){var a=this.joint.get_body1().localPointToWorld(this.joint.get_anchor1()),b=this.joint.get_body2().localPointToWorld(this.joint.get_anchor2()),
c=B.distance(a,b),d=Math.atan2(function(){a.zpp_inner.validate();return a.zpp_inner.y}(this)-function(){b.zpp_inner.validate();return b.zpp_inner.y}(this),function(){a.zpp_inner.validate();return a.zpp_inner.x}(this)-function(){b.zpp_inner.validate();return b.zpp_inner.x}(this))+1.5707963267948966;null==this.sprite&&(this.sprite=this.owner._compMap.Sprite_1);this.sprite.x.set__(function(){a.zpp_inner.validate();return a.zpp_inner.x}(this));this.sprite.y.set__(function(){a.zpp_inner.validate();return a.zpp_inner.y}(this));
this.sprite.scaleY.set__(c/this.sprite.getNaturalHeight());this.sprite.rotation.set__(180*d/3.141592653589793)}},onRemoved:function(){this.joint.set_space(null)},__class__:Ze});var De=function(a,b,c){null==a&&(a=4E3);G.call(this);null!=this.handJoint&&this.handJoint.set_maxForce(a);this._maxForce=a;this.spaceComponent=b;this.rootSprite=c;this.mousePoint=new $c};h["flambe.nape.MouseDragComponent"]=De;De.__name__=!0;De.__super__=G;De.prototype=w(G.prototype,{get_name:function(){return"MouseDragComponent_3"},
onAdded:function(){null==this.spaceComponent&&(this.spaceComponent=this.owner._compMap.SpaceComponent_9);null==this.space&&(this.space=this.spaceComponent.napeSpace);null==this.rootSprite&&(this.rootSprite=this.owner._compMap.Sprite_1);this.camera=null==this.rootSprite?null:this.rootSprite.owner._compMap.Camera_11;o._platform.getPointer().get_supported()&&(this.setupJoint(),this.downConnection=o._platform.getPointer().down.connect(q(this,this.onPointerDown)),this.upConnection=o._platform.getPointer().up.connect(q(this,
this.onPointerUp)))},setupJoint:function(){this.handJoint=new Lc(this.space.zpp_inner.__static,null,B.get(0,0,!0),B.get(0,0,!0));this.handJoint.set_space(this.space);this.handJoint.set_active(!1);this.handJoint.set_stiff(!1);this.handJoint.set_maxForce(this._maxForce);this.handJoint.set_damping(10);this.handJoint.set_frequency(10)},onPointerDown:function(a){this.camera.screenPointToWorld(a.viewX,a.viewY,this.mousePoint);for(var a=B.get(this.mousePoint.x,this.mousePoint.y,null),b=this.space.bodiesUnderPoint(a).iterator();b.hasNext();){var c;
b.zpp_critical=!1;c=b.zpp_inner.at(b.zpp_i++);if(c.zpp_inner.type==f.id_BodyType_DYNAMIC){this.handJoint.set_body2(c);this.handJoint.get_anchor2().set(c.worldPointToLocal(a,!0));this.handJoint.set_active(!0);break}}a.dispose()},onPointerUp:function(){this.handJoint.set_active(!1)},onUpdate:function(){this.handJoint.zpp_inner.active&&(this.camera.screenPointToWorld(o._platform.getPointer().get_x(),o._platform.getPointer().get_y(),this.mousePoint),this.handJoint.get_anchor1().setxy(this.mousePoint.x,
this.mousePoint.y))},onRemoved:function(){this.upConnection.dispose();this.downConnection.dispose();this.handJoint.set_space(null);this.handJoint=null},__class__:De});var Oa=function(a,b,c){G.call(this);this.assetPack=a;this.napeSpace=null==c?new mg(B.get(0,0,null)):c;this.bounds=b;this.cumalativeDt=0};h["flambe.nape.SpaceComponent"]=Oa;Oa.__name__=!0;Oa.__super__=G;Oa.prototype=w(G.prototype,{get_name:function(){return"SpaceComponent_9"},onAdded:function(){this.createPhisicalBounds()},onUpdate:function(a){for(this.cumalativeDt+=
a;this.cumalativeDt>=Oa.FixedTimeStep;)this.napeSpace.step(Oa.FixedTimeStep,Oa.VelocityIterationsPerTimeStep,Oa.PositionIterationsPerTimeStep),this.cumalativeDt-=a},createPhisicalBounds:function(){if(null!=this.bounds){var a=new Fd,b=function(b,d,e,i,k){b=new Rc(b,B.get(d,e,!0));b.zpp_inner.wrap_shapes.add(new sc(sc.rect(0,0,i,k)));if((null==b.zpp_inner.compound?null:b.zpp_inner.compound.outer)!=a){if(null!=(null==b.zpp_inner.compound?null:b.zpp_inner.compound.outer))(null==b.zpp_inner.compound?null:
b.zpp_inner.compound.outer).zpp_inner.wrap_bodies.remove(b);null!=a&&a.zpp_inner.wrap_bodies.add(b)}null==b.zpp_inner.compound?null:b.zpp_inner.compound.outer;return b};null==f.BodyType_STATIC&&(f.internal=!0,f.BodyType_STATIC=new Ga,f.internal=!1);b(f.BodyType_STATIC,this.bounds.x-8,this.bounds.y,8,this.bounds.height);null==f.BodyType_STATIC&&(f.internal=!0,f.BodyType_STATIC=new Ga,f.internal=!1);b(f.BodyType_STATIC,this.bounds.get_right(),this.bounds.y,8,this.bounds.height);null==f.BodyType_STATIC&&
(f.internal=!0,f.BodyType_STATIC=new Ga,f.internal=!1);b(f.BodyType_STATIC,this.bounds.x,this.bounds.y-4,this.bounds.width,8);null==f.BodyType_STATIC&&(f.internal=!0,f.BodyType_STATIC=new Ga,f.internal=!1);b(f.BodyType_STATIC,this.bounds.x,this.bounds.get_bottom()+4,this.bounds.width,8);a.set_space(this.napeSpace)}},createBodySpriteEntity:function(a,b,c,d,e){e=null==e?new x:e;if(null!=b){null==a.zpp_inner_i.userData&&(a.zpp_inner_i.userData={});var i=a.zpp_inner_i.userData.graphicOffset;null!=i&&
b.setAnchor(-function(){i.zpp_inner.validate();return i.zpp_inner.x}(this),-function(){i.zpp_inner.validate();return i.zpp_inner.y}(this));e.add(b)}null==c?(c=Zd,d=[this.owner,a]):null!=d?(d.unshift(a),d.unshift(this.owner)):d=[this.owner,a];e.add(lc.createInstance(c,d));return e},createDistanceJointSpriteEntity:function(a,b){a.set_space(this.napeSpace);return(new x).add(new Ze(a)).add(b.setAnchor(b.getNaturalWidth()/2,0))},__class__:Oa});var Zf=function(){};h["flambe.nape.util.NapeHelpers"]=Zf;Zf.__name__=
!0;Zf.createBox=function(a,b,c,d,e){a=new Rc(a);a.zpp_inner.wrap_shapes.add(new sc(sc.rect(0,0,d,e)));null==a.zpp_inner.wrap_localCOM&&(a.zpp_inner.wrap_localCOM=B.get(a.zpp_inner.localCOMx,a.zpp_inner.localCOMy,null),a.zpp_inner.wrap_localCOM.zpp_inner._inuse=!0,a.zpp_inner.wrap_localCOM.zpp_inner._immutable=!0,a.zpp_inner.wrap_localCOM.zpp_inner._validate=(Fe=a.zpp_inner,q(Fe,Fe.getlocalCOM)));d=a.zpp_inner.wrap_localCOM.mul(-1);a.translateShapes(d);null==a.zpp_inner_i.userData&&(a.zpp_inner_i.userData=
{});a.zpp_inner_i.userData.graphicOffset=d;null==a.zpp_inner.wrap_pos&&a.zpp_inner.setupPosition();a.zpp_inner.wrap_pos.setxy(b,c);return a};var Zg=function(){};h["flambe.nape.util.SerialiseBodyUtil"]=Zg;Zg.__name__=!0;Zg.deserialiseToBody=function(a){for(var b=a.polys,c=new Rc,d=0;d<b.length;){var e=b[d];++d;for(var i=[],k=0;k<e.length;){var f=e[k];++k;i.push(B.get(f[0],f[1],null))}c.zpp_inner.wrap_shapes.add(new sc(i))}null==a.graphicOffset?(null==c.zpp_inner_i.userData&&(c.zpp_inner_i.userData=
{}),c.zpp_inner_i.userData.graphicOffset=B.get(null,null,null)):(null==c.zpp_inner_i.userData&&(c.zpp_inner_i.userData={}),c.zpp_inner_i.userData.graphicOffset=B.get(a.graphicOffset[0],a.graphicOffset[1],null));return c};var ia=function(){this._disposed=!1};h["flambe.platform.BasicAsset"]=ia;ia.__name__=!0;ia.__interfaces__=[Nc];ia.prototype={dispose:function(){this._disposed||(this._disposed=!0,this.onDisposed())},onDisposed:function(){null},__class__:ia};var Sc=function(a,b){var c=this;this.manifest=
b;this._platform=a;this.promise=new $e;this._bytesLoaded=new Na;this._pack=new af(b,this);var d=ze.array(b);if(0==d.length)this.handleSuccess();else{for(var e=new Na,i=0;i<d.length;){var k=d[i];++i;var f=e.get(k.name);null==f&&(f=[],e.set(k.name,f));f.push(k)}this._assetsRemaining=ze.count(e);for(d=e.iterator();d.hasNext();)e=[d.next()],this.pickBestEntry(e[0],function(a){return function(d){if(null!=d){var e=b.getFullURL(d);try{c.loadEntry(e,d)}catch(i){c.handleError(d,"Unexpected error: "+D.string(i))}e=
c.promise;e.set_total(e._total+d.bytes)}else d=a[0][0],Sc.isAudio(d.format)?c.handleLoad(d,Gb.getInstance()):c.handleError(d,"Could not find a supported format to load")}}(e))}};h["flambe.platform.BasicAssetPackLoader"]=Sc;Sc.__name__=!0;Sc.isAudio=function(a){switch(a[1]){case 8:case 9:case 10:case 11:case 12:return!0;default:return!1}};Sc.prototype={onDisposed:function(){},pickBestEntry:function(a,b){this.getAssetFormats(function(c){for(var d=0;d<c.length;){var e=c[d];++d;for(var i=0;i<a.length;){var k=
a[i];++i;if(k.format==e){b(k);return}}}b(null)})},loadEntry:function(){null},getAssetFormats:function(){null},handleLoad:function(a,b){if(!this._pack.disposed){this.handleProgress(a,a.bytes);var c;switch(a.format[1]){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:c=this._pack.textures;break;case 8:case 9:case 10:case 11:case 12:c=this._pack.sounds;break;case 13:c=this._pack.files}c.set(a.name,b);this._assetsRemaining-=1;0==this._assetsRemaining&&this.handleSuccess()}},handleProgress:function(a,
b){this._bytesLoaded.set(a.name,b);for(var c=0,d=this._bytesLoaded.iterator();d.hasNext();)var e=d.next(),c=c+e;this.promise.set_progress(c)},handleSuccess:function(){this.promise.set_result(this._pack)},handleError:function(a,b){this.promise.error.emit(Ha.withFields(b,["url",a.url]))},handleTextureError:function(a){this.handleError(a,"Failed to create texture. Is the GPU context unavailable?")},__class__:Sc};var af=function(a,b){this.disposed=!1;this._manifest=a;this.loader=b;this.textures=new Na;
this.sounds=new Na;this.files=new Na};h["flambe.platform._BasicAssetPackLoader.BasicAssetPack"]=af;af.__name__=!0;af.__interfaces__=[Ue];af.prototype={getTexture:function(a,b){null==b&&(b=!0);var c=this.textures.get(a);if(null==c&&b)throw Ha.withFields("Missing texture",["name",a]);return c},getSound:function(a,b){null==b&&(b=!0);var c=this.sounds.get(a);if(null==c&&b)throw Ha.withFields("Missing sound",["name",a]);return c},getFile:function(a,b){null==b&&(b=!0);var c=this.files.get(a);if(null==c&&
b)throw Ha.withFields("Missing file",["name",a]);return c},dispose:function(){if(!this.disposed){this.disposed=!0;for(var a=this.textures.iterator();a.hasNext();)a.next().dispose();this.textures=null;for(a=this.sounds.iterator();a.hasNext();)a.next().dispose();this.sounds=null;for(a=this.files.iterator();a.hasNext();)a.next().dispose();this.files=null;this.loader.onDisposed()}},__class__:af};var $d=function(a){this._disposed=!1;this._content=a};h["flambe.platform.BasicFile"]=$d;$d.__name__=!0;$d.__interfaces__=
[Ve];$d.__super__=ia;$d.prototype=w(ia.prototype,{toString:function(){return this._content},onDisposed:function(){this._content=null},__class__:$d});var ng=function(){};h["flambe.subsystem.KeyboardSystem"]=ng;ng.__name__=!0;ng.prototype={__class__:ng};var Ja=function(){this.down=new V;this.up=new V;this.backButton=new Oc;this._keyStates=new tb};h["flambe.platform.BasicKeyboard"]=Ja;Ja.__name__=!0;Ja.__interfaces__=[ng];Ja.prototype={get_supported:function(){return!0},isDown:function(a){return this.isCodeDown(ae.toKeyCode(a))},
isCodeDown:function(a){return this._keyStates.exists(a)},submitDown:function(a){if(16777238==a)return null!=this.backButton._head?(this.backButton.emit(),!0):!1;this._keyStates.exists(a)||(this._keyStates.set(a,!0),Ja._sharedEvent.init(Ja._sharedEvent.id+1,ae.toKey(a)),this.down.emit(Ja._sharedEvent));return!0},submitUp:function(a){this._keyStates.exists(a)&&(this._keyStates.remove(a),Ja._sharedEvent.init(Ja._sharedEvent.id+1,ae.toKey(a)),this.up.emit(Ja._sharedEvent))},__class__:Ja};var og=function(){};
h["flambe.subsystem.MouseSystem"]=og;og.__name__=!0;og.prototype={__class__:og};var Ca=function(a){this._pointer=a;this._source=Yd.Mouse(Ca._sharedEvent);this.down=new V;this.move=new V;this.up=new V;this.scroll=new V;this._y=this._x=0;this._cursor=qb.Default;this._buttonStates=new tb};h["flambe.platform.BasicMouse"]=Ca;Ca.__name__=!0;Ca.__interfaces__=[og];Ca.prototype={get_supported:function(){return!0},submitDown:function(a,b,c){this._buttonStates.exists(c)||(this._buttonStates.set(c,!0),this.prepare(a,
b,pg.toButton(c)),this._pointer.submitDown(a,b,this._source),this.down.emit(Ca._sharedEvent))},submitMove:function(a,b){this.prepare(a,b,null);this._pointer.submitMove(a,b,this._source);this.move.emit(Ca._sharedEvent)},submitUp:function(a,b,c){this._buttonStates.exists(c)&&(this._buttonStates.remove(c),this.prepare(a,b,pg.toButton(c)),this._pointer.submitUp(a,b,this._source),this.up.emit(Ca._sharedEvent))},submitScroll:function(a,b,c){this._x=a;this._y=b;if(null==this.scroll._head)return!1;this.scroll.emit(c);
return!0},prepare:function(a,b,c){this._x=a;this._y=b;Ca._sharedEvent.init(Ca._sharedEvent.id+1,a,b,c)},__class__:Ca};var qg=function(){};h["flambe.subsystem.PointerSystem"]=qg;qg.__name__=!0;qg.prototype={__class__:qg};var O=function(a,b,c){null==c&&(c=!1);null==b&&(b=0);null==a&&(a=0);this.down=new V;this.move=new V;this.up=new V;this._x=a;this._y=b;this._isDown=c};h["flambe.platform.BasicPointer"]=O;O.__name__=!0;O.__interfaces__=[qg];O.prototype={get_supported:function(){return!0},get_x:function(){return this._x},
get_y:function(){return this._y},submitDown:function(a,b,c){if(!this._isDown){this.submitMove(a,b,c);this._isDown=!0;var d=[],e=F.hitTest(o.root,a,b);if(null!=e){var i=e.owner;do{var k=i._compMap.Sprite_1;null!=k&&d.push(k);i=i.parent}while(null!=i)}this.prepare(a,b,e,c);for(a=0;a<d.length;)if(b=d[a],++a,b.onPointerDown(O._sharedEvent),O._sharedEvent._stopped)return;this.down.emit(O._sharedEvent)}},submitMove:function(a,b,c){if(!(a==this._x&&b==this._y)){var d=[],e=F.hitTest(o.root,a,b);if(null!=
e){var i=e.owner;do{var k=i._compMap.Sprite_1;null!=k&&d.push(k);i=i.parent}while(null!=i)}this.prepare(a,b,e,c);for(a=0;a<d.length;)if(b=d[a],++a,b.onPointerMove(O._sharedEvent),O._sharedEvent._stopped)return;this.move.emit(O._sharedEvent)}},submitUp:function(a,b,c){if(this._isDown){this.submitMove(a,b,c);this._isDown=!1;var d=[],e=F.hitTest(o.root,a,b);if(null!=e){var i=e.owner;do{var k=i._compMap.Sprite_1;null!=k&&d.push(k);i=i.parent}while(null!=i)}this.prepare(a,b,e,c);for(a=0;a<d.length;)if(b=
d[a],++a,b.onPointerUp(O._sharedEvent),O._sharedEvent._stopped)return;this.up.emit(O._sharedEvent)}},prepare:function(a,b,c,d){this._x=a;this._y=b;O._sharedEvent.init(O._sharedEvent.id+1,a,b,c,d)},__class__:O};var Da=function(a,b,c){this._x=this._y=0;this._parent=null;this.rootX=this.rootY=0;this._disposed=!1;this.root=a;this._width=b;this._height=c};h["flambe.platform.BasicTexture"]=Da;Da.__name__=!0;Da.__interfaces__=[fh];Da.__super__=ia;Da.prototype=w(ia.prototype,{subTexture:function(a,b,c,d){c=
this.root.createTexture(c,d);c._parent=this;c._x=a;c._y=b;c.rootX=this.rootX+a;c.rootY=this.rootY+b;return c},onDisposed:function(){null==this._parent&&this.root.dispose()},get_width:function(){return this._width},get_height:function(){return this._height},__class__:Da});var bf=function(){};h["flambe.subsystem.TouchSystem"]=bf;bf.__name__=!0;bf.prototype={__class__:bf};var Re=function(a,b){null==b&&(b=4);this._pointer=a;this._maxPoints=b;this._pointMap=new tb;this._points=[];this.down=new V;this.move=
new V;this.up=new V};h["flambe.platform.BasicTouch"]=Re;Re.__name__=!0;Re.__interfaces__=[bf];Re.prototype={get_supported:function(){return!0},get_maxPoints:function(){return this._maxPoints},submitDown:function(a,b,c){if(!this._pointMap.exists(a)){var d=new lg(a);d.init(b,c);this._pointMap.set(a,d);this._points.push(d);null==this._pointerTouch&&(this._pointerTouch=d,this._pointer.submitDown(b,c,d._source));this.down.emit(d)}},submitMove:function(a,b,c){a=this._pointMap.get(a);null!=a&&(a.init(b,
c),this._pointerTouch==a&&this._pointer.submitMove(b,c,a._source),this.move.emit(a))},submitUp:function(a,b,c){var d=this._pointMap.get(a);null!=d&&(d.init(b,c),this._pointMap.remove(a),P.remove(this._points,d),this._pointerTouch==d&&(this._pointerTouch=null,this._pointer.submitUp(b,c,d._source)),this.up.emit(d))},__class__:Re};var Tc=function(){};h["flambe.sound.Sound"]=Tc;Tc.__name__=!0;Tc.__interfaces__=[Nc];Tc.prototype={__class__:Tc};var Gb=function(){this._disposed=!1;this._playback=new cf(this)};
h["flambe.platform.DummySound"]=Gb;Gb.__name__=!0;Gb.__interfaces__=[Tc];Gb.getInstance=function(){null==Gb._instance&&(Gb._instance=new Gb);return Gb._instance};Gb.__super__=ia;Gb.prototype=w(ia.prototype,{play:function(){return this._playback},loop:function(){return this._playback},onDisposed:function(){},__class__:Gb});var df=function(){};h["flambe.sound.Playback"]=df;df.__name__=!0;df.__interfaces__=[eb];var cf=function(a){this._sound=a;this.volume=new y(0);this._complete=new ab(!0)};h["flambe.platform.DummyPlayback"]=
cf;cf.__name__=!0;cf.__interfaces__=[df];cf.prototype={dispose:function(){},__class__:cf};var Se=function(){this.down=new V;this.move=new V;this.up=new V};h["flambe.platform.DummyTouch"]=Se;Se.__name__=!0;Se.__interfaces__=[bf];Se.prototype={get_supported:function(){return!1},get_maxPoints:function(){return 0},__class__:Se};var ud=function(){this._entries=[]};h["flambe.platform.EventGroup"]=ud;ud.__name__=!0;ud.__interfaces__=[eb];ud.prototype={addListener:function(a,b,c){a.addEventListener(b,c,!1);
this._entries.push(new rg(a,b,c))},addDisposingListener:function(a,b,c){var d=this;this.addListener(a,b,function(a){d.dispose();c(a)})},dispose:function(){for(var a=0,b=this._entries;a<b.length;){var c=b[a];++a;c.dispatcher.removeEventListener(c.type,c.listener,!1)}this._entries=[]},__class__:ud};var rg=function(a,b,c){this.dispatcher=a;this.type=b;this.listener=c};h["flambe.platform._EventGroup.Entry"]=rg;rg.__name__=!0;rg.prototype={__class__:rg};var vd=function(){};h["flambe.platform.InternalGraphics"]=
vd;vd.__name__=!0;vd.__interfaces__=[gg];vd.prototype={__class__:vd};var sg=function(){};h["flambe.subsystem.RendererSystem"]=sg;sg.__name__=!0;sg.prototype={__class__:sg};var be=function(){};h["flambe.platform.InternalRenderer"]=be;be.__name__=!0;be.__interfaces__=[sg];be.prototype={__class__:be};var ae=function(){};h["flambe.platform.KeyCodes"]=ae;ae.__name__=!0;ae.toKey=function(a){switch(a){case 65:return g.A;case 66:return g.B;case 67:return g.C;case 68:return g.D;case 69:return g.E;case 70:return g.F;
case 71:return g.G;case 72:return g.H;case 73:return g.I;case 74:return g.J;case 75:return g.K;case 76:return g.L;case 77:return g.M;case 78:return g.N;case 79:return g.O;case 80:return g.P;case 81:return g.Q;case 82:return g.R;case 83:return g.S;case 84:return g.T;case 85:return g.U;case 86:return g.V;case 87:return g.W;case 88:return g.X;case 89:return g.Y;case 90:return g.Z;case 48:return g.Number0;case 49:return g.Number1;case 50:return g.Number2;case 51:return g.Number3;case 52:return g.Number4;
case 53:return g.Number5;case 54:return g.Number6;case 55:return g.Number7;case 56:return g.Number8;case 57:return g.Number9;case 96:return g.Numpad0;case 97:return g.Numpad1;case 98:return g.Numpad2;case 99:return g.Numpad3;case 100:return g.Numpad4;case 101:return g.Numpad5;case 102:return g.Numpad6;case 103:return g.Numpad7;case 104:return g.Numpad8;case 105:return g.Numpad9;case 107:return g.NumpadAdd;case 110:return g.NumpadDecimal;case 111:return g.NumpadDivide;case 108:return g.NumpadEnter;
case 106:return g.NumpadMultiply;case 109:return g.NumpadSubtract;case 112:return g.F1;case 113:return g.F2;case 114:return g.F3;case 115:return g.F4;case 116:return g.F5;case 117:return g.F6;case 118:return g.F7;case 119:return g.F8;case 120:return g.F9;case 121:return g.F10;case 122:return g.F11;case 123:return g.F12;case 37:return g.Left;case 38:return g.Up;case 39:return g.Right;case 40:return g.Down;case 18:return g.Alt;case 192:return g.Backquote;case 220:return g.Backslash;case 8:return g.Backspace;
case 20:return g.CapsLock;case 188:return g.Comma;case 15:return g.Command;case 17:return g.Control;case 46:return g.Delete;case 35:return g.End;case 13:return g.Enter;case 187:return g.Equals;case 27:return g.Escape;case 36:return g.Home;case 45:return g.Insert;case 219:return g.LeftBracket;case 189:return g.Minus;case 34:return g.PageDown;case 33:return g.PageUp;case 190:return g.Period;case 222:return g.Quote;case 221:return g.RightBracket;case 186:return g.Semicolon;case 16:return g.Shift;case 191:return g.Slash;
case 32:return g.Space;case 9:return g.Tab;case 16777234:return g.Menu;case 16777247:return g.Search}return g.Unknown(a)};ae.toKeyCode=function(a){switch(a[1]){case 0:return 65;case 1:return 66;case 2:return 67;case 3:return 68;case 4:return 69;case 5:return 70;case 6:return 71;case 7:return 72;case 8:return 73;case 9:return 74;case 10:return 75;case 11:return 76;case 12:return 77;case 13:return 78;case 14:return 79;case 15:return 80;case 16:return 81;case 17:return 82;case 18:return 83;case 19:return 84;
case 20:return 85;case 21:return 86;case 22:return 87;case 23:return 88;case 24:return 89;case 25:return 90;case 26:return 48;case 27:return 49;case 28:return 50;case 29:return 51;case 30:return 52;case 31:return 53;case 32:return 54;case 33:return 55;case 34:return 56;case 35:return 57;case 36:return 96;case 37:return 97;case 38:return 98;case 39:return 99;case 40:return 100;case 41:return 101;case 42:return 102;case 43:return 103;case 44:return 104;case 45:return 105;case 46:return 107;case 47:return 110;
case 48:return 111;case 49:return 108;case 50:return 106;case 51:return 109;case 52:return 112;case 53:return 113;case 54:return 114;case 55:return 115;case 56:return 116;case 57:return 117;case 58:return 118;case 59:return 119;case 60:return 120;case 61:return 121;case 62:return 122;case 63:return 123;case 64:return 124;case 65:return 125;case 66:return 126;case 67:return 37;case 68:return 38;case 69:return 39;case 70:return 40;case 71:return 18;case 72:return 192;case 73:return 220;case 74:return 8;
case 75:return 20;case 76:return 188;case 77:return 15;case 78:return 17;case 79:return 46;case 80:return 35;case 81:return 13;case 82:return 187;case 83:return 27;case 84:return 36;case 85:return 45;case 86:return 219;case 87:return 189;case 88:return 34;case 89:return 33;case 90:return 190;case 91:return 222;case 92:return 221;case 93:return 186;case 94:return 16;case 95:return 191;case 96:return 32;case 97:return 9;case 98:return 16777234;case 99:return 16777247;case 100:return a[2]}};var ad=function(){this._tickables=
[]};h["flambe.platform.MainLoop"]=ad;ad.__name__=!0;ad.updateEntity=function(a,b){var c=a._compMap.SpeedAdjuster_16;if(null!=c&&(c._realDt=b,b*=c.scale._value,0>=b)){c.onUpdate(b);return}for(c=a.firstComponent;null!=c;){var d=c.next;0==(c._flags&1)&&(c._flags|=1,c.onStart());c.onUpdate(b);c=d}for(c=a.firstChild;null!=c;)d=c.next,ad.updateEntity(c,b),c=d};ad.prototype={update:function(a){if(!(0>=a)){1<a&&(a=1);for(var b=0;b<this._tickables.length;){var c=this._tickables[b];null==c||c.update(a)?this._tickables.splice(b,
1):++b}o.volume.update(a);ad.updateEntity(o.root,a)}},render:function(a){var b=a.graphics;null!=b&&(a.willRender(),F.render(o.root,b),a.didRender())},addTickable:function(a){this._tickables.push(a)},removeTickable:function(a){a=this._tickables.indexOf(a);0<=a&&(this._tickables[a]=null)},__class__:ad};var tg=function(){};h["flambe.platform.MathUtil"]=tg;tg.__name__=!0;tg.nextPowerOfTwo=function(a){for(var b=1;b<a;)b<<=1;return b};var pg=function(){};h["flambe.platform.MouseCodes"]=pg;pg.__name__=!0;
pg.toButton=function(a){switch(a){case 0:return fa.Left;case 1:return fa.Middle;case 2:return fa.Right}return fa.Unknown(a)};var ef=function(){};h["flambe.platform.TextureRoot"]=ef;ef.__name__=!0;ef.prototype={__class__:ef};var ff=function(){};h["flambe.platform.Tickable"]=ff;ff.__name__=!0;ff.prototype={__class__:ff};var gf=function(a,b){this._firstDraw=!1;this._canvasCtx=a.getContext("2d",{alpha:b})};h["flambe.platform.html.CanvasGraphics"]=gf;gf.__name__=!0;gf.__interfaces__=[vd];gf.prototype=
{save:function(){this._canvasCtx.save()},translate:function(a,b){this._canvasCtx.translate(a|0,b|0)},scale:function(a,b){this._canvasCtx.scale(a,b)},rotate:function(a){this._canvasCtx.rotate(3.141592653589793*a/180)},transform:function(a,b,c,d,e,i){this._canvasCtx.transform(a,b,c,d,e,i)},restore:function(){this._canvasCtx.restore()},drawTexture:function(a,b,c){this.drawSubTexture(a,b,c,0,0,a.get_width(),a.get_height())},drawSubTexture:function(a,b,c,d,e,i,k){this._firstDraw?(this._firstDraw=!1,this._canvasCtx.globalCompositeOperation=
"copy",this.drawSubTexture(a,b,c,d,e,i,k),this._canvasCtx.globalCompositeOperation="source-over"):this._canvasCtx.drawImage(a.root.image,a.rootX+d|0,a.rootY+e|0,i|0,k|0,b|0,c|0,i|0,k|0)},fillRect:function(a,b,c,d,e){if(this._firstDraw)this._firstDraw=!1,this._canvasCtx.globalCompositeOperation="copy",this.fillRect(a,b,c,d,e),this._canvasCtx.globalCompositeOperation="source-over";else{for(a=(16777215&a).toString(16);6>a.length;)a="0"+D.string(a);this._canvasCtx.fillStyle="#"+D.string(a);this._canvasCtx.fillRect(b|
0,c|0,d|0,e|0)}},multiplyAlpha:function(a){this._canvasCtx.globalAlpha*=a},setBlendMode:function(a){var b;switch(a[1]){case 0:b="source-over";break;case 1:b="lighter";break;case 2:b="multiply";break;case 3:b="screen";break;case 4:b="destination-in";break;case 5:b="copy"}this._canvasCtx.globalCompositeOperation=b},applyScissor:function(a,b,c,d){this._canvasCtx.beginPath();this._canvasCtx.rect(a|0,b|0,c|0,d|0);this._canvasCtx.clip()},willRender:function(){this._firstDraw=!0},didRender:function(){},
onResize:function(){},__class__:gf};var td=function(a){this.graphics=new gf(a,!1);this._hasGPU=new ab(!0)};h["flambe.platform.html.CanvasRenderer"]=td;td.__name__=!0;td.__interfaces__=[be];td.prototype={get_type:function(){return ub.Canvas},createTextureFromImage:function(a){a=new Id(td.CANVAS_TEXTURES?I.createCanvas(a):a);return a.createTexture(a.width,a.height)},getCompressedTextureFormats:function(){return[]},createCompressedTexture:function(){return null},willRender:function(){this.graphics.willRender()},
didRender:function(){this.graphics.didRender()},__class__:td};var hf=function(a,b,c){Da.call(this,a,b,c)};h["flambe.platform.html.CanvasTexture"]=hf;hf.__name__=!0;hf.__super__=Da;hf.prototype=w(Da.prototype,{__class__:hf});var Id=function(a){this._graphics=null;this._disposed=!1;this.image=a;this.width=a.width;this.height=a.height};h["flambe.platform.html.CanvasTextureRoot"]=Id;Id.__name__=!0;Id.__interfaces__=[ef];Id.__super__=ia;Id.prototype=w(ia.prototype,{createTexture:function(a,b){return new hf(this,
a,b)},onDisposed:function(){this._graphics=this.image=null},__class__:Id});var da=function(a,b){Sc.call(this,a,b)};h["flambe.platform.html.HtmlAssetPackLoader"]=da;da.__name__=!0;da.detectImageFormats=function(a){var b=[v.PNG,v.JPG,v.GIF],c=2,d;d=window.document.createElement("img");d.onload=d.onerror=function(){1==d.width&&b.unshift(v.WEBP);--c;0==c&&a(b)};d.src="data:image/webp;base64,UklGRhoAAABXRUJQVlA4TA0AAAAvAAAAEAcQERGIiP4HAA==";var e;e=window.document.createElement("img");e.onload=e.onerror=
function(){1==e.width&&b.unshift(v.JXR);--c;0==c&&a(b)};e.src="data:image/vnd.ms-photo;base64,SUm8AQgAAAAFAAG8AQAQAAAASgAAAIC8BAABAAAAAQAAAIG8BAABAAAAAQAAAMC8BAABAAAAWgAAAMG8BAABAAAAHwAAAAAAAAAkw91vA07+S7GFPXd2jckNV01QSE9UTwAZAYBxAAAAABP/gAAEb/8AAQAAAQAAAA=="};da.detectAudioFormats=function(){var a;a=window.document.createElement("audio");if(null==a||null==q(a,a.canPlayType))return[];var b=new Kc("\\b(iPhone|iPod|iPad|Android|Windows Phone)\\b",""),c=window.navigator.userAgent;if(!J.get_supported()&&
b.match(c))return[];for(var b=[{format:v.M4A,mimeType:"audio/mp4; codecs=mp4a"},{format:v.MP3,mimeType:"audio/mpeg"},{format:v.OPUS,mimeType:"audio/ogg; codecs=opus"},{format:v.OGG,mimeType:"audio/ogg; codecs=vorbis"},{format:v.WAV,mimeType:"audio/wav"}],c=[],d=0;d<b.length;){var e=b[d];++d;var i="";try{i=a.canPlayType(e.mimeType)}catch(k){}""!=i&&c.push(e.format)}return c};da.supportsBlob=function(){if(da._detectBlobSupport){da._detectBlobSupport=!1;if((new Kc("\\bSilk\\b","")).match(window.navigator.userAgent)||
null==window.Blob)return!1;var a=new XMLHttpRequest;a.open("GET",".",!0);if(""!=a.responseType)return!1;a.responseType="blob";if("blob"!=a.responseType)return!1;da._URL=I.loadExtension("URL").value}return null!=da._URL&&null!=da._URL.createObjectURL};da.__super__=Sc;da.prototype=w(Sc.prototype,{loadEntry:function(a,b){var c=this;switch(b.format[1]){case 0:case 1:case 2:case 3:case 4:var d;d=window.document.createElement("img");var e=new ud;e.addDisposingListener(d,"load",function(){da.supportsBlob()&&
da._URL.revokeObjectURL(d.src);var a=c._platform.getRenderer().createTextureFromImage(d);null!=a?c.handleLoad(b,a):c.handleTextureError(b)});e.addDisposingListener(d,"error",function(){c.handleError(b,"Failed to load image")});da.supportsBlob()?this.download(a,b,"blob",function(a){d.src=da._URL.createObjectURL(a)}):d.src=a;break;case 5:case 6:case 7:this.download(a,b,"arraybuffer",function(){var a=c._platform.getRenderer().createCompressedTexture(b.format,null);null!=a?c.handleLoad(b,a):c.handleTextureError(b)});
break;case 8:case 9:case 10:case 11:case 12:if(J.get_supported())this.download(a,b,"arraybuffer",function(a){J.ctx.decodeAudioData(a,function(a){c.handleLoad(b,new J(a));return!0},function(){c.handleLoad(b,Gb.getInstance());return!1})});else{var i;i=window.document.createElement("audio");i.preload="auto";var k=++da._mediaRefCount;null==da._mediaElements&&(da._mediaElements=new tb);da._mediaElements.set(k,i);e=new ud;e.addDisposingListener(i,"canplaythrough",function(){da._mediaElements.remove(k);
c.handleLoad(b,new wd(i))});e.addDisposingListener(i,"error",function(){da._mediaElements.remove(k);var a=i.error.code;3==a||4==a?c.handleLoad(b,Gb.getInstance()):c.handleError(b,"Failed to load audio: "+i.error.code)});e.addListener(i,"progress",function(){if(0<i.buffered.length&&0<i.duration){var a=i.buffered.end(0)/i.duration;c.handleProgress(b,a*b.bytes|0)}});i.src=a;i.load()}break;case 13:this.download(a,b,"text",function(a){c.handleLoad(b,new $d(a))})}},getAssetFormats:function(a){var b=this;
null==da._supportedFormats&&(da._supportedFormats=new $e,da.detectImageFormats(function(a){da._supportedFormats.set_result(b._platform.getRenderer().getCompressedTextureFormats().concat(a).concat(da.detectAudioFormats()).concat([v.Data]))}));da._supportedFormats.get(a)},download:function(a,b,c,d){var e=this,i=null,k=null,f=0,j=!1,g=function(){j&&(j=!1,window.clearInterval(f))},h=3,m=function(){--h;return 0<=h?(k(),!0):!1},k=function(){g();null!=i&&i.abort();i=new XMLHttpRequest;i.open("GET",a,!0);
i.responseType=c;var k=0;i.onprogress=function(a){j||(j=!0,f=window.setInterval(function(){4!=i.readyState&&5E3<Date.now()-k&&!m()&&(g(),e.handleError(b,"Download stalled"))},1E3));k=Date.now();e.handleProgress(b,a.loaded)};i.onerror=function(){if(0!=i.status||!m())g(),e.handleError(b,"HTTP error "+i.status)};i.onload=function(){var a=i.response;null==a&&(a=i.responseText);g();d(a)};i.send()};k()},__class__:da});var Qe=function(a,b){Ca.call(this,a);this._canvas=b};h["flambe.platform.html.HtmlMouse"]=
Qe;Qe.__name__=!0;Qe.__super__=Ca;Qe.prototype=w(Ca.prototype,{__class__:Qe});var wd=function(a){this._disposed=!1;this.audioElement=a};h["flambe.platform.html.HtmlSound"]=wd;wd.__name__=!0;wd.__interfaces__=[Tc];wd.__super__=ia;wd.prototype=w(ia.prototype,{play:function(a,b,c){null==c&&(c=0);null==b&&(b=0);null==a&&(a=1);return new ce(this,a,!1,b,c)},loop:function(a,b,c){null==c&&(c=0);null==b&&(b=0);null==a&&(a=1);return new ce(this,a,!0,b,c)},get_duration:function(){return this.audioElement.duration},
onDisposed:function(){this.audioElement=null},__class__:wd});var ce=function(a,b,c,d,e){null==e&&(e=0);null==d&&(d=0);this._waitingToSeek=!1;this._playOffset=this._playDuration=0;this._loop=!1;var i=this;this._sound=a;this._loop=c;this._playOffset=ka.clamp(d,0,a.get_duration());this._playDuration=ka.max(0,ka.min(e,a.get_duration()));0==this._playDuration&&!this._loop&&(this._playDuration=a.get_duration()-this._playOffset);this._waitingToSeek=0<this._playOffset;this._tickableAdded=!1;this._clonedElement=
window.document.createElement("audio");this._clonedElement.loop=this._loop&&0==d&&0==e;this._clonedElement.src=a.audioElement.src;this.volume=new y(b,function(){i.updateVolume()});this.updateVolume();this._complete=new ab(!1);this.playAudio();o.hidden._value&&this.set_paused(!0)};h["flambe.platform.html._HtmlSound.HtmlPlayback"]=ce;ce.__name__=!0;ce.__interfaces__=[ff,df];ce.prototype={set_paused:function(a){this._clonedElement.paused!=a&&(a?this._clonedElement.pause():this.playAudio());return a},
update:function(a){this.volume.update(a);this._complete.set__(this._clonedElement.ended);if(this._waitingToSeek)if(this.canSeekToOffset())this._waitingToSeek=!1,this._clonedElement.currentTime=this._playOffset,this.set_paused(!1);else return!1;if(this._complete._value||this._clonedElement.paused)return this._tickableAdded=!1,this._volumeBinding.dispose(),this._hideBinding.dispose(),!0;var a=this._clonedElement.currentTime,b=this._playOffset+this._playDuration;this._loop&&!this._clonedElement.loop?
a>=b&&(this._clonedElement.currentTime=this._playOffset):!this._loop&&0<this._playDuration&&a>=b&&(this._complete.set__(!0),this.dispose());return!1},dispose:function(){pc.instance.mainLoop.removeTickable(this);this._tickableAdded=!1;this.set_paused(!0);this._waitingToSeek=!1;this._sound=this._clonedElement=this._complete=null;null!=this._volumeBinding&&(this._volumeBinding.dispose(),this._volumeBinding=null);null!=this._hideBinding&&(this._hideBinding.dispose(),this._hideBinding=null)},playAudio:function(){var a=
this;this._clonedElement.play();0<this._playOffset&&(this.canSeekToOffset()?(this._waitingToSeek=!1,this._clonedElement.currentTime=this._playOffset):(this._waitingToSeek=!0,this._clonedElement.paused||this.set_paused(!0)));this._tickableAdded||(pc.instance.mainLoop.addTickable(this),this._tickableAdded=!0,this._volumeBinding=o.volume.get_changed().connect(function(){a.updateVolume()}),this._hideBinding=o.hidden.get_changed().connect(function(b){b?(a._wasPaused=a._clonedElement.paused,a.set_paused(!0)):
a.set_paused(a._wasPaused)}))},canSeekToOffset:function(){if(1<=this._clonedElement.readyState)for(var a=this._clonedElement.seekable.length,b=this._clonedElement.seekable,c=0;c<a;){var d=c++,e=b.start(d),d=b.end(d);if(e<=this._playOffset&&this._playOffset<d)return!0}return!1},updateVolume:function(){this._clonedElement.volume=o.volume._value*this.volume._value},__class__:ce};var ug=function(){};h["flambe.subsystem.StageSystem"]=ug;ug.__name__=!0;ug.prototype={__class__:ug};var Hd=function(a){var b=
this;this._canvas=a;this.resize=new Oc;this.scaleFactor=Hd.computeScaleFactor();1!=this.scaleFactor&&(I.setVendorStyle(this._canvas,"transform-origin","top left"),I.setVendorStyle(this._canvas,"transform","scale("+1/this.scaleFactor+")"));I.SHOULD_HIDE_MOBILE_BROWSER&&(window.addEventListener("orientationchange",function(){I.callLater(q(b,b.hideMobileBrowser),200)},!1),this.hideMobileBrowser());window.addEventListener("resize",q(this,this.onWindowResize),!1);this.onWindowResize(null);this.orientation=
new ab(null);null!=window.orientation&&(window.addEventListener("orientationchange",q(this,this.onOrientationChange),!1),this.onOrientationChange(null));this.fullscreen=new ab(!1);I.addVendorListener(window.document,"fullscreenchange",function(){b.updateFullscreen()},!1);this.updateFullscreen()};h["flambe.platform.html.HtmlStage"]=Hd;Hd.__name__=!0;Hd.__interfaces__=[ug];Hd.computeScaleFactor=function(){var a=window.devicePixelRatio;null==a&&(a=1);var b=window.document.createElement("canvas").getContext("2d"),
b=I.loadExtension("backingStorePixelRatio",b).value;null==b&&(b=1);a/=b;b=window.screen.height;return 1136<a*window.screen.width||1136<a*b?1:a};Hd.prototype={get_width:function(){return this._canvas.width},get_height:function(){return this._canvas.height},requestFullscreen:function(a){null==a&&(a=!0);if(a){var a=window.document.documentElement,b=I.loadFirstExtension(["requestFullscreen","requestFullScreen"],a).value;null!=b&&b.apply(a,[])}else a=I.loadFirstExtension(["cancelFullscreen","cancelFullScreen"],
window.document).value,null!=a&&ca.callMethod(window.document,a,[])},onWindowResize:function(){var a=this._canvas.parentElement.getBoundingClientRect();this.resizeCanvas(a.width,a.height)},resizeCanvas:function(a,b){var c=this.scaleFactor*a,d=this.scaleFactor*b;if(this._canvas.width==c&&this._canvas.height==d)return!1;this._canvas.width=c|0;this._canvas.height=d|0;this.resize.emit();return!0},hideMobileBrowser:function(){var a=this,b=window.document.documentElement.style;b.height=window.innerHeight+
100+"px";b.width=window.innerWidth+"px";b.overflow="visible";I.callLater(function(){I.hideMobileBrowser();I.callLater(function(){b.height=window.innerHeight+"px";a.onWindowResize(null)},100)})},onOrientationChange:function(){this.orientation.set__(I.orientation(window.orientation))},updateFullscreen:function(){this.fullscreen.set__(!0==I.loadFirstExtension(["fullscreen","fullScreen","isFullScreen"],window.document).value)},__class__:Hd};var I=function(){};h["flambe.platform.html.HtmlUtil"]=I;I.__name__=
!0;I.callLater=function(a,b){null==b&&(b=0);window.setTimeout(a,b)};I.hideMobileBrowser=function(){window.scrollTo(1,0)};I.loadExtension=function(a,b){null==b&&(b=window);var c=ca.field(b,a);if(null!=c)return{prefix:"",field:a,value:c};for(var c=a.charAt(0).toUpperCase()+P.substr(a,1,null),d=0,e=I.VENDOR_PREFIXES;d<e.length;){var i=e[d];++d;var k=i+c,f=ca.field(b,k);if(null!=f)return{prefix:i,field:k,value:f}}return{prefix:null,field:null,value:null}};I.loadFirstExtension=function(a,b){for(var c=
0;c<a.length;){var d=a[c];++c;d=I.loadExtension(d,b);if(null!=d.field)return d}return{prefix:null,field:null,value:null}};I.polyfill=function(a,b){null==b&&(b=window);var c=I.loadExtension(a,b).value;if(null==c)return!1;b[a]=c;return!0};I.setVendorStyle=function(a,b,c){for(var a=a.style,d=0,e=I.VENDOR_PREFIXES;d<e.length;){var i=e[d];++d;a.setProperty("-"+i+"-"+b,c)}a.setProperty(b,c)};I.addVendorListener=function(a,b,c,d){for(var e=0,i=I.VENDOR_PREFIXES;e<i.length;){var k=i[e];++e;a.addEventListener(k+
b,c,d)}a.addEventListener(b,c,d)};I.orientation=function(a){switch(a){case -90:case 90:return rc.Landscape;default:return rc.Portrait}};I.createEmptyCanvas=function(a,b){var c;c=window.document.createElement("canvas");c.width=a;c.height=b;return c};I.createCanvas=function(a){var b=I.createEmptyCanvas(a.width,a.height),c=b.getContext("2d");c.save();c.globalCompositeOperation="copy";c.drawImage(a,0,0);c.restore();return b};I.detectSlowDriver=function(a){if(0<=window.navigator.platform.indexOf("Win")&&
null!=window.chrome){for(var b=0,a=a.getSupportedExtensions();b<a.length;){var c=a[b];++b;if(0<=c.indexOf("WEBGL_compressed_texture"))return!1}return!0}return!1};I.fixAndroidMath=function(){if(0<=window.navigator.userAgent.indexOf("Linux; U; Android 4")){var a=Math.sin,b=Math.cos;Math.sin=function(b){return 0==b?0:a(b)};Math.cos=function(a){return 0==a?1:b(a)}}};var J=function(a){this._disposed=!1;this.buffer=a};h["flambe.platform.html.WebAudioSound"]=J;J.__name__=!0;J.__interfaces__=[Tc];J.get_supported=
function(){if(J._detectSupport){J._detectSupport=!1;var a=I.loadExtension("AudioContext").value;null!=a&&(J.ctx=new a,J.gain=J.createGain(),J.gain.connect(J.ctx.destination),o.volume.watch(function(a){J.gain.gain.value=a}))}return null!=J.ctx};J.createGain=function(){var a;try{a=J.ctx.createGain()}catch(b){a="createGainNode".apply(J.ctx,[])}return a};J.start=function(a,b,c,d){null==d&&(d=0);null==c&&(c=0);null==a.start?a.noteOn(b,c,d):a.start(b,c,d)};J.__super__=ia;J.prototype=w(ia.prototype,{play:function(a,
b,c){null==c&&(c=0);null==b&&(b=0);null==a&&(a=1);return new xd(this,a,!1,b,c)},loop:function(a,b,c){null==c&&(c=0);null==b&&(b=0);null==a&&(a=1);return new xd(this,a,!0,b,c)},get_duration:function(){return this.buffer.duration},onDisposed:function(){this.buffer=null},__class__:J});var xd=function(a,b,c,d,e){null==e&&(e=0);null==d&&(d=0);var i=this;this._sound=a;this._head=J.gain;this._complete=new ab(!1);this._sourceNode=J.ctx.createBufferSource();this._sourceNode.buffer=a.buffer;0>=d&&(d=0);0>=
e&&(e=this._sourceNode.buffer.duration);if(this._sourceNode.loop=c)this._sourceNode.loopStart=d,this._sourceNode.loopEnd=Math.min(d+e,this._sourceNode.buffer.duration);this._sourceNode.onended=function(){i._complete.set__(!0);i.dispose()};J.start(this._sourceNode,0,d,e);this.playAudio();this.volume=new y(b,function(a){i.setVolume(a)});1!=b&&this.setVolume(b);o.hidden._value&&this.set_paused(!0)};h["flambe.platform.html._WebAudioSound.WebAudioPlayback"]=xd;xd.__name__=!0;xd.__interfaces__=[ff,df];
xd.prototype={set_paused:function(a){a!=0<=this._pausedAt&&(a?(this._sourceNode.disconnect(),this._pausedAt=this.get_position()):this.playAudio());return a},get_position:function(){return this._complete._value?this._sound.get_duration():0<=this._pausedAt?this._pausedAt:(J.ctx.currentTime-this._startedAt)%this._sound.get_duration()},update:function(a){this.volume.update(a);if(this._complete._value||0<=this._pausedAt)return this._tickableAdded=!1,this._hideBinding.dispose(),!0;3==this._sourceNode.playbackState&&
(this._complete.set__(!0),this.dispose());return!1},dispose:function(){this.set_paused(!0);this._tickableAdded&&(this._tickableAdded=!1,pc.instance.mainLoop.removeTickable(this));null!=this._hideBinding&&this._hideBinding.dispose();null!=this._gainNode&&this._gainNode.disconnect();this.volume=this._complete=this._gainNode=this._sourceNode=this._hideBinding=null},setVolume:function(a){null==this._gainNode&&(this._gainNode=J.createGain(),this.insertNode(this._gainNode));this._gainNode.gain.value=a},
insertNode:function(a){0<=this._pausedAt||(this._sourceNode.disconnect(),this._sourceNode.connect(a));a.connect(this._head);this._head=a},playAudio:function(){var a=this;this._sourceNode.connect(this._head);this._startedAt=J.ctx.currentTime;this._pausedAt=-1;this._tickableAdded||(pc.instance.mainLoop.addTickable(this),this._tickableAdded=!0,this._hideBinding=o.hidden.get_changed().connect(function(b){b?(a._wasPaused=0<=a._pausedAt,a.set_paused(!0)):a.set_paused(a._wasPaused)}))},__class__:xd};var vg=
function(a){this._quads=this._maxQuads=this._dataOffset=this._backbufferWidth=this._backbufferHeight=0;this._pendingSetScissor=!1;this._lastBlendMode=this._lastRenderTarget=this._lastShader=this._lastTexture=this._lastScissor=this._currentBlendMode=this._currentShader=this._currentTexture=this._currentRenderTarget=null;this._gl=a;a.clearColor(0,0,0,0);a.enable(3042);a.pixelStorei(37441,1);this._vertexBuffer=a.createBuffer();a.bindBuffer(34962,this._vertexBuffer);this._quadIndexBuffer=a.createBuffer();
a.bindBuffer(34963,this._quadIndexBuffer);this._drawTextureShader=new jf(a);this._drawPatternShader=new kf(a);this._fillRectShader=new lf(a);this.resize(16)};h["flambe.platform.html.WebGLBatcher"]=vg;vg.__name__=!0;vg.prototype={resizeBackbuffer:function(a,b){this._gl.viewport(0,0,a,b);this._backbufferWidth=a;this._backbufferHeight=b},willRender:function(){},didRender:function(){this.flush()},bindTexture:function(a){this.flush();this._currentTexture=this._lastTexture=null;this._gl.bindTexture(3553,
a)},deleteTexture:function(a){null!=this._lastTexture&&this._lastTexture.root==a&&(this.flush(),this._currentTexture=this._lastTexture=null);this._gl.deleteTexture(a.nativeTexture)},deleteFramebuffer:function(a){a==this._lastRenderTarget&&(this.flush(),this._currentRenderTarget=this._lastRenderTarget=null);this._gl.deleteFramebuffer(a.framebuffer)},prepareDrawTexture:function(a,b,c,d){d!=this._lastTexture&&(this.flush(),this._lastTexture=d);return this.prepareQuad(5,a,b,c,this._drawTextureShader)},
prepareFillRect:function(a,b,c){return this.prepareQuad(6,a,b,c,this._fillRectShader)},prepareQuad:function(a,b,c,d,e){b!=this._lastRenderTarget&&(this.flush(),this._lastRenderTarget=b);c!=this._lastBlendMode&&(this.flush(),this._lastBlendMode=c);e!=this._lastShader&&(this.flush(),this._lastShader=e);if(null!=d||null!=this._lastScissor)if(null==d||null==this._lastScissor||!this._lastScissor.equals(d))this.flush(),this._lastScissor=null!=d?d.clone(this._lastScissor):null,this._pendingSetScissor=!0;
this._quads>=this._maxQuads&&this.resize(this._maxQuads<<1);++this._quads;b=this._dataOffset;this._dataOffset+=a<<2;return b},flush:function(){if(!(1>this._quads)){this._lastRenderTarget!=this._currentRenderTarget&&this.bindRenderTarget(this._lastRenderTarget);if(this._lastBlendMode!=this._currentBlendMode){switch(this._lastBlendMode[1]){case 0:this._gl.blendFunc(1,771);break;case 1:this._gl.blendFunc(1,1);break;case 2:this._gl.blendFunc(774,771);break;case 3:this._gl.blendFunc(1,769);break;case 4:this._gl.blendFunc(0,
770);break;case 5:this._gl.blendFunc(1,0)}this._currentBlendMode=this._lastBlendMode}this._pendingSetScissor&&(null!=this._lastScissor?(this._gl.enable(3089),this._gl.scissor(this._lastScissor.x|0,this._lastScissor.y|0,this._lastScissor.width|0,this._lastScissor.height|0)):this._gl.disable(3089),this._pendingSetScissor=!1);this._lastTexture!=this._currentTexture&&(this._gl.bindTexture(3553,this._lastTexture.root.nativeTexture),this._currentTexture=this._lastTexture);this._lastShader!=this._currentShader&&
(this._lastShader.useProgram(),this._lastShader.prepare(),this._currentShader=this._lastShader);if(this._lastShader==this._drawPatternShader){var a=this._lastTexture,b=a.root;this._lastShader.setRegion(a.rootX/b.width,a.rootY/b.height,a._width/b.width,a._height/b.height)}this._gl.bufferData(34962,this.data.subarray(0,this._dataOffset),35040);this._gl.drawElements(4,6*this._quads,5123,0);this._dataOffset=this._quads=0}},resize:function(a){this.flush();if(!(1024<a)){this._maxQuads=a;this.data=new Float32Array(6*
(a<<2));this._gl.bufferData(34962,4*this.data.length,35040);for(var b=new Uint16Array(6*a),c=0;c<a;){var d=c++;b[6*d]=d<<2;b[6*d+1]=(d<<2)+1;b[6*d+2]=(d<<2)+2;b[6*d+3]=(d<<2)+2;b[6*d+4]=(d<<2)+3;b[6*d+5]=d<<2}this._gl.bufferData(34963,b,35044)}},bindRenderTarget:function(a){null!=a?(this._gl.bindFramebuffer(36160,a.framebuffer),this._gl.viewport(0,0,a.width,a.height)):(this._gl.bindFramebuffer(36160,null),this._gl.viewport(0,0,this._backbufferWidth,this._backbufferHeight));this._lastRenderTarget=
this._currentRenderTarget=a},__class__:vg};var Ua=function(a,b){this._inverseProjection=this._stateList=null;null==Ua._scratchQuadArray&&(Ua._scratchQuadArray=new Float32Array(8));this._batcher=a;this._renderTarget=b};h["flambe.platform.html.WebGLGraphics"]=Ua;Ua.__name__=!0;Ua.__interfaces__=[vd];Ua.prototype={save:function(){var a=this._stateList,b=this._stateList.next;null==b&&(b=new mf,b.prev=a,a.next=b);a.matrix.clone(b.matrix);b.alpha=a.alpha;b.blendMode=a.blendMode;b.scissor=null!=a.scissor?
a.scissor.clone(b.scissor):null;this._stateList=b},translate:function(a,b){var c=this._stateList.matrix;c.m02+=c.m00*a+c.m01*b;c.m12+=c.m10*a+c.m11*b},scale:function(a,b){var c=this._stateList.matrix;c.m00*=a;c.m10*=a;c.m01*=b;c.m11*=b},rotate:function(a){var b=this._stateList.matrix,a=3.141592653589793*a/180,c=Math.sin(a),a=Math.cos(a),d=b.m00,e=b.m10,i=b.m01,k=b.m11;b.m00=d*a+i*c;b.m10=e*a+k*c;b.m01=i*a-d*c;b.m11=k*a-e*c},transform:function(a,b,c,d,e,i){var k=this._stateList;Ua._scratchMatrix.set(a,
b,c,d,e,i);Pc.multiply(k.matrix,Ua._scratchMatrix,k.matrix)},restore:function(){this._stateList=this._stateList.prev},drawTexture:function(a,b,c){this.drawSubTexture(a,b,c,0,0,a.get_width(),a.get_height())},drawSubTexture:function(a,b,c,d,e,i,k){var f=this._stateList,j=a.root,b=this.transformQuad(b,c,i,k),c=j.width,j=j.height,d=(a.rootX+d)/c,e=(a.rootY+e)/j,i=d+i/c,k=e+k/j,c=f.alpha,a=this._batcher.prepareDrawTexture(this._renderTarget,f.blendMode,f.scissor,a),f=this._batcher.data;f[a]=b[0];f[++a]=
b[1];f[++a]=d;f[++a]=e;f[++a]=c;f[++a]=b[2];f[++a]=b[3];f[++a]=i;f[++a]=e;f[++a]=c;f[++a]=b[4];f[++a]=b[5];f[++a]=i;f[++a]=k;f[++a]=c;f[++a]=b[6];f[++a]=b[7];f[++a]=d;f[++a]=k;f[++a]=c},fillRect:function(a,b,c,d,e){var i=this._stateList,b=this.transformQuad(b,c,d,e),c=(a&16711680)/16711680,d=(a&65280)/65280,a=(a&255)/255,e=i.alpha,i=this._batcher.prepareFillRect(this._renderTarget,i.blendMode,i.scissor),f=this._batcher.data;f[i]=b[0];f[++i]=b[1];f[++i]=c;f[++i]=d;f[++i]=a;f[++i]=e;f[++i]=b[2];f[++i]=
b[3];f[++i]=c;f[++i]=d;f[++i]=a;f[++i]=e;f[++i]=b[4];f[++i]=b[5];f[++i]=c;f[++i]=d;f[++i]=a;f[++i]=e;f[++i]=b[6];f[++i]=b[7];f[++i]=c;f[++i]=d;f[++i]=a;f[++i]=e},multiplyAlpha:function(a){this._stateList.alpha*=a},setBlendMode:function(a){this._stateList.blendMode=a},applyScissor:function(a,b,c,d){var e=this._stateList,i=Ua._scratchQuadArray;i[0]=a;i[1]=b;i[2]=a+c;i[3]=b+d;e.matrix.transformArray(i,4,i);this._inverseProjection.transformArray(i,4,i);a=i[0];b=i[1];c=i[2]-a;d=i[3]-b;0>c&&(a+=c,c=-c);
0>d&&(b+=d,d=-d);e.applyScissor(a,b,c,d)},willRender:function(){this._batcher.willRender()},didRender:function(){this._batcher.didRender()},onResize:function(a,b){this._stateList=new mf;var c;c=null!=this._renderTarget?-1:1;this._stateList.matrix.set(2/a,0,0,-2*c/b,-1,c);this._inverseProjection=new Pc;this._inverseProjection.set(2/a,0,0,2/b,-1,-1);this._inverseProjection.invert()},transformQuad:function(a,b,c,d){var c=a+c,d=b+d,e=Ua._scratchQuadArray;e[0]=a;e[1]=b;e[2]=c;e[3]=b;e[4]=c;e[5]=d;e[6]=
a;e[7]=d;this._stateList.matrix.transformArray(e,8,e);return e},__class__:Ua};var mf=function(){this.scissor=this.prev=this.next=null;this.matrix=new Pc;this.alpha=1;this.blendMode=T.Normal};h["flambe.platform.html._WebGLGraphics.DrawingState"]=mf;mf.__name__=!0;mf.prototype={applyScissor:function(a,b,c,d){if(null!=this.scissor)var e=ka.max(this.scissor.x,a),i=ka.max(this.scissor.y,b),c=ka.min(this.scissor.x+this.scissor.width,a+c),d=ka.min(this.scissor.y+this.scissor.height,b+d),a=e,b=i,c=c-e,d=
d-i;else this.scissor=new rd;this.scissor.set(Math.round(a),Math.round(b),Math.round(c),Math.round(d))},__class__:mf};var Te=function(a,b){var c=this;this._hasGPU=new ab(!0);this.gl=b;b.canvas.addEventListener("webglcontextlost",function(a){a.preventDefault();c._hasGPU.set__(!1)},!1);b.canvas.addEventListener("webglcontextrestore",function(){c.init();c._hasGPU.set__(!0)},!1);a.resize.connect(q(this,this.onResize));this.init()};h["flambe.platform.html.WebGLRenderer"]=Te;Te.__name__=!0;Te.__interfaces__=
[be];Te.prototype={get_type:function(){return ub.WebGL},createTextureFromImage:function(a){if(this.gl.isContextLost())return null;var b=new cc(this,a.width,a.height);b.uploadImageData(a);return b.createTexture(a.width,a.height)},getCompressedTextureFormats:function(){return[]},createCompressedTexture:function(){this.gl.isContextLost();return null},willRender:function(){this.graphics.willRender()},didRender:function(){this.graphics.didRender()},onResize:function(){var a=this.gl.canvas.width,b=this.gl.canvas.height;
this.batcher.resizeBackbuffer(a,b);this.graphics.onResize(a,b)},init:function(){this.batcher=new vg(this.gl);this.graphics=new Ua(this.batcher,null);this.onResize()},__class__:Te};var nf=function(a,b,c){Da.call(this,a,b,c)};h["flambe.platform.html.WebGLTexture"]=nf;nf.__name__=!0;nf.__super__=Da;nf.prototype=w(Da.prototype,{__class__:nf});var cc=function(a,b,c){this.framebuffer=this._graphics=null;this._disposed=!1;this._renderer=a;this.width=ka.max(2,tg.nextPowerOfTwo(b));this.height=ka.max(2,tg.nextPowerOfTwo(c));
b=a.gl;this.nativeTexture=b.createTexture();a.batcher.bindTexture(this.nativeTexture);b.texParameteri(3553,10242,33071);b.texParameteri(3553,10243,33071);b.texParameteri(3553,10240,9729);b.texParameteri(3553,10241,9729)};h["flambe.platform.html.WebGLTextureRoot"]=cc;cc.__name__=!0;cc.__interfaces__=[ef];cc.drawBorder=function(a,b,c){var d=a.getContext("2d");d.drawImage(a,b-1,0,1,c,b,0,1,c);d.drawImage(a,0,c-1,b,1,0,c,b,1)};cc.__super__=ia;cc.prototype=w(ia.prototype,{createTexture:function(a,b){return new nf(this,
a,b)},uploadImageData:function(a){if(this.width!=a.width||this.height!=a.height){var b=I.createEmptyCanvas(this.width,this.height);b.getContext("2d").drawImage(a,0,0);cc.drawBorder(b,a.width,a.height);a=b}this._renderer.batcher.bindTexture(this.nativeTexture);this._renderer.gl.texImage2D(3553,0,6408,6408,5121,a)},onDisposed:function(){var a=this._renderer.batcher;a.deleteTexture(this);null!=this.framebuffer&&a.deleteFramebuffer(this);this._graphics=this.framebuffer=this.nativeTexture=null},__class__:cc});
var Ea=function(a,b,c){c="#ifdef GL_ES\nprecision mediump float;\n#endif\n"+c;this._gl=a;this._program=a.createProgram();a.attachShader(this._program,Ea.createShader(a,35633,b));a.attachShader(this._program,Ea.createShader(a,35632,c));a.linkProgram(this._program);a.useProgram(this._program)};h["flambe.platform.shader.ShaderGL"]=Ea;Ea.__name__=!0;Ea.createShader=function(a,b,c){b=a.createShader(b);a.shaderSource(b,c);a.compileShader(b);return b};Ea.prototype={useProgram:function(){this._gl.useProgram(this._program)},
prepare:function(){null},getAttribLocation:function(a){return this._gl.getAttribLocation(this._program,a)},getUniformLocation:function(a){return this._gl.getUniformLocation(this._program,a)},__class__:Ea};var kf=function(a){Ea.call(this,a,"attribute highp vec2 a_pos;\nattribute mediump vec2 a_uv;\nattribute lowp float a_alpha;\nvarying mediump vec2 v_uv;\nvarying lowp float v_alpha;\nvoid main (void) {\nv_uv = a_uv;\nv_alpha = a_alpha;\ngl_Position = vec4(a_pos, 0, 1);\n}","varying mediump vec2 v_uv;\nvarying lowp float v_alpha;\nuniform lowp sampler2D u_texture;\nuniform mediump vec4 u_region;\nvoid main (void) {\ngl_FragColor = texture2D(u_texture, u_region.xy + mod(v_uv, u_region.zw)) * v_alpha;\n}");
this.a_pos=this.getAttribLocation("a_pos");this.a_uv=this.getAttribLocation("a_uv");this.a_alpha=this.getAttribLocation("a_alpha");this.u_texture=this.getUniformLocation("u_texture");this.u_region=this.getUniformLocation("u_region");this.setTexture(0)};h["flambe.platform.shader.DrawPatternGL"]=kf;kf.__name__=!0;kf.__super__=Ea;kf.prototype=w(Ea.prototype,{setTexture:function(a){this._gl.uniform1i(this.u_texture,a)},prepare:function(){this._gl.enableVertexAttribArray(this.a_pos);this._gl.enableVertexAttribArray(this.a_uv);
this._gl.enableVertexAttribArray(this.a_alpha);this._gl.vertexAttribPointer(this.a_pos,2,5126,!1,20,0);this._gl.vertexAttribPointer(this.a_uv,2,5126,!1,20,8);this._gl.vertexAttribPointer(this.a_alpha,1,5126,!1,20,16)},__class__:kf});var jf=function(a){Ea.call(this,a,"attribute highp vec2 a_pos;\nattribute mediump vec2 a_uv;\nattribute lowp float a_alpha;\nvarying mediump vec2 v_uv;\nvarying lowp float v_alpha;\nvoid main (void) {\nv_uv = a_uv;\nv_alpha = a_alpha;\ngl_Position = vec4(a_pos, 0, 1);\n}",
"varying mediump vec2 v_uv;\nvarying lowp float v_alpha;\nuniform lowp sampler2D u_texture;\nvoid main (void) {\ngl_FragColor = texture2D(u_texture, v_uv) * v_alpha;\n}");this.a_pos=this.getAttribLocation("a_pos");this.a_uv=this.getAttribLocation("a_uv");this.a_alpha=this.getAttribLocation("a_alpha");this.u_texture=this.getUniformLocation("u_texture");this.setTexture(0)};h["flambe.platform.shader.DrawTextureGL"]=jf;jf.__name__=!0;jf.__super__=Ea;jf.prototype=w(Ea.prototype,{setTexture:function(a){this._gl.uniform1i(this.u_texture,
a)},prepare:function(){this._gl.enableVertexAttribArray(this.a_pos);this._gl.enableVertexAttribArray(this.a_uv);this._gl.enableVertexAttribArray(this.a_alpha);this._gl.vertexAttribPointer(this.a_pos,2,5126,!1,20,0);this._gl.vertexAttribPointer(this.a_uv,2,5126,!1,20,8);this._gl.vertexAttribPointer(this.a_alpha,1,5126,!1,20,16)},__class__:jf});var lf=function(a){Ea.call(this,a,"attribute highp vec2 a_pos;\nattribute lowp vec3 a_rgb;\nattribute lowp float a_alpha;\nvarying lowp vec4 v_color;\nvoid main (void) {\nv_color = vec4(a_rgb*a_alpha, a_alpha);\ngl_Position = vec4(a_pos, 0, 1);\n}",
"varying lowp vec4 v_color;\nvoid main (void) {\ngl_FragColor = v_color;\n}");this.a_pos=this.getAttribLocation("a_pos");this.a_rgb=this.getAttribLocation("a_rgb");this.a_alpha=this.getAttribLocation("a_alpha")};h["flambe.platform.shader.FillRectGL"]=lf;lf.__name__=!0;lf.__super__=Ea;lf.prototype=w(Ea.prototype,{prepare:function(){this._gl.enableVertexAttribArray(this.a_pos);this._gl.enableVertexAttribArray(this.a_rgb);this._gl.enableVertexAttribArray(this.a_alpha);this._gl.vertexAttribPointer(this.a_pos,
2,5126,!1,24,0);this._gl.vertexAttribPointer(this.a_rgb,3,5126,!1,24,8);this._gl.vertexAttribPointer(this.a_alpha,1,5126,!1,24,20)},__class__:lf});var wg=function(){this._transitor=null};h["flambe.scene.Director"]=wg;wg.__name__=!0;wg.__super__=G;wg.prototype=w(G.prototype,{get_name:function(){return"Director_14"},onAdded:function(){this.owner.addChild(this._root)},onRemoved:function(){this.completeTransition();for(var a=0,b=this.scenes;a<b.length;){var c=b[a];++a;c.dispose()}this.scenes=[];this.occludedScenes=
[];this._root.dispose()},onUpdate:function(a){null!=this._transitor&&this._transitor.update(a)&&this.completeTransition()},get_topScene:function(){var a=this.scenes.length;return 0<a?this.scenes[a-1]:null},show:function(a){a=a._compMap.Scene_15;null!=a&&a.shown.emit()},invalidateVisibility:function(){for(var a=this.scenes.length;0<a;){var b=this.scenes[--a]._compMap.Scene_15;if(null==b||b.opaque)break}this.occludedScenes=0<this.scenes.length?this.scenes.slice(a,this.scenes.length-1):[];a=this.get_topScene();
null!=a&&this.show(a)},completeTransition:function(){null!=this._transitor&&(this._transitor.complete(),this._transitor=null,this.invalidateVisibility())},__class__:wg});var gh=function(){};h["flambe.scene._Director.Transitor"]=gh;gh.__name__=!0;gh.prototype={update:function(a){return this._transition.update(a)},complete:function(){this._transition.complete();this._onComplete()},__class__:gh};var xg=function(){};h["flambe.scene.Scene"]=xg;xg.__name__=!0;xg.__super__=G;xg.prototype=w(G.prototype,{get_name:function(){return"Scene_15"},
__class__:xg});var hh=function(){};h["flambe.scene.Transition"]=hh;hh.__name__=!0;hh.prototype={update:function(){return!0},complete:function(){},__class__:hh};var tc=function(){};h["flambe.script.Action"]=tc;tc.__name__=!0;tc.prototype={__class__:tc};var nb=function(a,b,c,d){this._value=a;this._by=b;this._seconds=c;this._easing=d};h["flambe.script.AnimateBy"]=nb;nb.__name__=!0;nb.__interfaces__=[tc];nb.prototype={update:function(a){null==this._tween&&(this._tween=new bc(this._value._value,this._value._value+
this._by,this._seconds,this._easing),this._value.set_behavior(this._tween),this._value.update(a));if(this._value._behavior!=this._tween){var b=this._tween.elapsed-this._seconds;this._tween=null;return 0<b?Math.max(0,a-b):0}return-1},__class__:nb};var Zb=function(a){this._duration=a;this._elapsed=0};h["flambe.script.Delay"]=Zb;Zb.__name__=!0;Zb.__interfaces__=[tc];Zb.prototype={update:function(a){this._elapsed+=a;if(this._elapsed>=this._duration){var b=this._elapsed-this._duration;this._elapsed=0;
return a-b}return-1},__class__:Zb};var re=function(a){this._completedActions=[];this._runningActions=null!=a?a.slice():[]};h["flambe.script.Parallel"]=re;re.__name__=!0;re.__interfaces__=[tc];re.prototype={update:function(a,b){for(var c=!0,d=0,e=0,i=this._runningActions.length;e<i;){var f=e++,l=this._runningActions[f];if(null!=l){var j=l.update(a,b);0<=j?(this._runningActions[f]=null,this._completedActions.push(l),j>d&&(d=j)):c=!1}}return c?(this._runningActions=this._completedActions,this._completedActions=
[],d):-1},__class__:re};var Bd=function(a,b){null==b&&(b=-1);this._action=a;this._remaining=this._count=b};h["flambe.script.Repeat"]=Bd;Bd.__name__=!0;Bd.__interfaces__=[tc];Bd.prototype={update:function(a,b){if(0==this._count)return 0;var c=this._action.update(a,b);return 0<this._count&&0<=c&&0==--this._remaining?(this._remaining=this._count,c):-1},__class__:Bd};var Vd=function(){G.call(this);this.stopAll()};h["flambe.script.Script"]=Vd;Vd.__name__=!0;Vd.__super__=G;Vd.prototype=w(G.prototype,{get_name:function(){return"Script_8"},
run:function(a){a=new of(a);this._handles.push(a);return a},stopAll:function(){this._handles=[]},onUpdate:function(a){for(var b=0;b<this._handles.length;){var c=this._handles[b];c.removed||0<=c.action.update(a,this.owner)?this._handles.splice(b,1):++b}},__class__:Vd});var of=function(a){this.removed=!1;this.action=a};h["flambe.script._Script.Handle"]=of;of.__name__=!0;of.__interfaces__=[eb];of.prototype={dispose:function(){this.removed=!0;this.action=null},__class__:of};var Cd=function(a){this._idx=
0;this._runningActions=null!=a?a.slice():[]};h["flambe.script.Sequence"]=Cd;Cd.__name__=!0;Cd.__interfaces__=[tc];Cd.prototype={update:function(a,b){for(var c=0;;){var d=this._runningActions[this._idx];if(null!=d)if(d=d.update(a-c,b),0<=d)c+=d;else return-1;++this._idx;if(this._idx>=this._runningActions.length){this._idx=0;break}else if(c>a)return-1}return c},__class__:Cd};var ub=h["flambe.subsystem.RendererType"]={__ename__:!0,__constructs__:["Stage3D","WebGL","Canvas"]};ub.Stage3D=["Stage3D",0];
ub.Stage3D.__enum__=ub;ub.WebGL=["WebGL",1];ub.WebGL.__enum__=ub;ub.Canvas=["Canvas",2];ub.Canvas.__enum__=ub;ub.__empty_constructs__=[ub.Stage3D,ub.WebGL,ub.Canvas];var pf=function(){};h["flambe.swf.Symbol"]=pf;pf.__name__=!0;pf.prototype={__class__:pf};var qf=function(a,b){this._name=a.symbol;var c=a.rect;this.texture=b.subTexture(c[0],c[1],c[2],c[3]);c=a.origin;null!=c?(this.anchorX=c[0],this.anchorY=c[1]):this.anchorY=this.anchorX=0};h["flambe.swf.BitmapSymbol"]=qf;qf.__name__=!0;qf.__interfaces__=
[pf];qf.prototype={createSprite:function(){var a=new aa(this.texture);a.setAnchor(this.anchorX,this.anchorY);return a},__class__:qf};var Yf=function(a,b){this._file=a.getFile(b+"/library.json");var c=JSON.parse(this._file.toString());this._symbols=new Na;this.frameRate=c.frameRate;for(var d=[],e=0,i=c.movies;e<i.length;){var f=i[e];++e;f=new rf(this,f);d.push(f);this._symbols.set(f._name,f)}c=c.textureGroups;(1!=c[0].scaleFactor||1<c.length)&&null;c=c[0].atlases;for(e=0;e<c.length;){var l=c[e];++e;
i=a.getTexture(b+"/"+Ha.removeFileExtension(l.file));f=0;for(l=l.textures;f<l.length;){var j=l[f];++f;j=new qf(j,i);this._symbols.set(j._name,j)}}for(c=0;c<d.length;){i=d[c];++c;e=0;for(i=i.layers;e<i.length;){f=i[e];++e;f=f.keyframes;l=f.length;for(j=0;j<l;){var g=j++,h=f[g];if(null!=h.symbolName){var m=this._symbols.get(h.symbolName);h.symbol=m}if(h.tweened&&1==h.duration&&g+1<l&&(g=f[g+1],!g.visible||null==g.symbolName))h.visible=!1}}}};h["flambe.swf.Library"]=Yf;Yf.__name__=!0;Yf.prototype={createSprite:function(a,
b){null==b&&(b=!0);var c=this._symbols.get(a);if(null==c){if(b)throw Ha.withFields("Missing symbol",["name",a]);return null}return c.createSprite()},__class__:Yf};var Ee=function(a){this._oneshotSprite=this._loopingSprite=null;G.call(this);this._lib=a;this._root=new x;this.movie=new ab(null);this.setCache(!0)};h["flambe.swf.MoviePlayer"]=Ee;Ee.__name__=!0;Ee.__super__=G;Ee.prototype=w(G.prototype,{get_name:function(){return"MoviePlayer_0"},setCache:function(a){this._cache=a?new Na:null;return this},
loop:function(a,b){null==b&&(b=!0);if(b||null==this._loopingSprite||this._loopingSprite.symbol._name!=a)this._oneshotSprite=null,this._loopingSprite=this.playFromCache(a);return this},onAdded:function(){this.owner.addChild(this._root)},onRemoved:function(){this._root.dispose();this._oneshotSprite=this._loopingSprite=null;this.movie.set__(null)},onUpdate:function(a){null!=this._oneshotSprite&&this._oneshotSprite._position+a>this._oneshotSprite.symbol.duration&&(this._oneshotSprite=null,this.setCurrent(this._loopingSprite))},
playFromCache:function(a){var b;null!=this._cache?(b=this._cache.get(a),null!=b?b.set_position(0):(b=this.createMovie(a),this._cache.set(a,b))):b=this.createMovie(a);return this.setCurrent(b)},createMovie:function(a){a=this._lib.createSprite(a,!0);null!=this._decorator&&this._decorator(a);return a},setCurrent:function(a){this._root.add(a);return this.movie.set__(a)},__class__:Ee});var Jd=function(a){this._lastLabelFrame=-1;this._looped=null;F.call(this);this.symbol=a;this.speed=new y(1);this.labelPassed=
new V;this._animators=Array(a.layers.length);for(var b=0,c=this._animators.length;b<c;){var d=b++;this._animators[d]=new yg(a.layers[d])}this._frame=-1;this._position=0;this._lastLabelFrame=-1;this["goto"](0)};h["flambe.swf.MovieSprite"]=Jd;Jd.__name__=!0;Jd.__super__=F;Jd.prototype=w(F.prototype,{onAdded:function(){F.prototype.onAdded.call(this);for(var a=0,b=this._animators;a<b.length;){var c=b[a];++a;this.owner.addChild(c.content)}},onRemoved:function(){F.prototype.onRemoved.call(this);for(var a=
0,b=this._animators;a<b.length;){var c=b[a];++a;this.owner.removeChild(c.content)}},onUpdate:function(a){F.prototype.onUpdate.call(this,a);if(0!=this.speed._value){this.speed.update(a);switch(this._flags&384){case 0:this._position+=this.speed._value*a;this._position>this.symbol.duration&&(this._position%=this.symbol.duration,null!=this._looped&&this._looped.emit());break;case 256:this._flags&=-257}this["goto"](this._position*this.symbol.frameRate)}},"goto":function(a){if(this._frame!=a){for(var b=
a<this._frame,c=0,d=this._animators;c<d.length;){var e=d[c];++c;e.composeFrame(a,b);e.labelChanged&&this.labelPassed.emit(e.currentLabel)}this._frame=a}},set_position:function(a){return this._position=ka.clamp(a,0,this.symbol.duration)},rewind:function(){this._position=0;this._lastLabelFrame=-1;this._flags|=256},__class__:Jd});var yg=function(a){this.keyframeIdx=0;this.labelChanged=this.needsKeyframeUpdate=!1;this.currentLabel=null;this.layer=a;this.content=new x;if(a.empty)this._sprites=null;else{this._sprites=
Array(a.keyframes.length);for(var b=0,c=this._sprites.length;b<c;){var d=b++,e=a.keyframes[d];this._sprites[d]=0<d&&a.keyframes[d-1].symbol==e.symbol?this._sprites[d-1]:null==e.symbol?new F:e.symbol.createSprite()}this.content.add(this._sprites[0])}};h["flambe.swf._MovieSprite.LayerAnimator"]=yg;yg.__name__=!0;yg.prototype={composeFrame:function(a,b){this.labelChanged=!1;b&&(this.needsKeyframeUpdate=!0,this.keyframeIdx=0);if(null!=this._sprites){var c=this.layer.keyframes,d=c.length-1;if(a>this.layer.frames)this.content._compMap.Sprite_1.set_visible(!1),
this.keyframeIdx=d,this.needsKeyframeUpdate=!0;else{for(;this.keyframeIdx<d&&c[this.keyframeIdx+1].index<=a;)++this.keyframeIdx,this.needsKeyframeUpdate=!0;var e;this.needsKeyframeUpdate?(this.needsKeyframeUpdate=!1,this.currentLabel=null,e=this._sprites[this.keyframeIdx],e!=this.content._compMap.Sprite_1&&(lc.getClass(e)==Jd&&e.rewind(),this.content.add(e))):e=this.content._compMap.Sprite_1;var i=c[this.keyframeIdx],f=i.visible&&null!=i.symbol;e.set_visible(f);var l=i.label;l!=this.currentLabel&&
(this.currentLabel=l,this.labelChanged=!0);if(f){var f=i.x,l=i.y,j=i.scaleX,g=i.scaleY,h=i.skewX,m=i.skewY,r=i.alpha;if(i.tweened&&this.keyframeIdx<d){var d=(a-i.index)/i.duration,Q=i.ease;if(0!=Q){var o;0>Q?(o=1-d,o=1-o*o,Q=-Q):o=d*d;d=Q*o+(1-Q)*d}c=c[this.keyframeIdx+1];f+=(c.x-f)*d;l+=(c.y-l)*d;j+=(c.scaleX-j)*d;g+=(c.scaleY-g)*d;h+=(c.skewX-h)*d;m+=(c.skewY-m)*d;r+=(c.alpha-r)*d}c=e.getLocalMatrix();d=Math.sin(h);h=Math.cos(h);Q=Math.sin(m);m=Math.cos(m);c.set(m*j,Q*j,-d*g,h*g,f,l);c.translate(-i.pivotX,
-i.pivotY);e.alpha.set__(r)}}}},__class__:yg};var rf=function(a,b){this._name=b.id;this.frameRate=a.frameRate;this.frameLabels=new Na;this.frames=0;this.layers=Array(b.layers.length);for(var c=0,d=this.layers.length;c<d;){var e=c++,i=new zg(b.layers[e]);this.frames=Math.max(i.frames,this.frames);for(var f=0,l=i.keyframes;f<l.length;){var j=l[f];++f;null!=j.label&&this.frameLabels.set(j.label,j.index)}this.layers[e]=i}this.duration=this.frames/this.frameRate};h["flambe.swf.MovieSymbol"]=rf;rf.__name__=
!0;rf.__interfaces__=[pf];rf.prototype={createSprite:function(){return new Jd(this)},__class__:rf};var zg=function(a){this.empty=!0;this.name=a.name;var b=null;this.keyframes=Array(a.keyframes.length);for(var c=0,d=this.keyframes.length;c<d;){var e=c++,b=new Ag(a.keyframes[e],b);this.keyframes[e]=b;this.empty=this.empty&&null==b.symbolName&&null==b.label}this.frames=null!=b?b.index+b.duration:0};h["flambe.swf.MovieLayer"]=zg;zg.__name__=!0;zg.prototype={__class__:zg};var Ag=function(a,b){this.ease=
0;this.visible=this.tweened=!0;this.alpha=1;this.skewX=this.skewY=this.pivotX=this.pivotY=0;this.scaleX=this.scaleY=1;this.x=this.y=0;this.symbol=null;this.index=null!=b?b.index+b.duration:0;this.duration=a.duration;this.label=a.label;this.symbolName=a.ref;var c=a.loc;null!=c&&(this.x=c[0],this.y=c[1]);c=a.scale;null!=c&&(this.scaleX=c[0],this.scaleY=c[1]);c=a.skew;null!=c&&(this.skewX=c[0],this.skewY=c[1]);c=a.pivot;null!=c&&(this.pivotX=c[0],this.pivotY=c[1]);null!=a.alpha&&(this.alpha=a.alpha);
null!=a.visible&&(this.visible=a.visible);null!=a.tweened&&(this.tweened=a.tweened);null!=a.ease&&(this.ease=a.ease)};h["flambe.swf.MovieKeyframe"]=Ag;Ag.__name__=!0;Ag.prototype={__class__:Ag};var dh=function(){};h["flambe.util.Assert"]=dh;dh.__name__=!0;dh.that=function(){};var eh=function(){};h["flambe.util.BitSets"]=eh;eh.__name__=!0;eh.set=function(a,b,c){return c?a|b:a&~b};var Ph=function(){};h["flambe.util.LogHandler"]=Ph;Ph.__name__=!0;var $e=function(){this.success=new V;this.error=new V;
this.progressChanged=new Oc;this.hasResult=!1;this._total=this._progress=0};h["flambe.util.Promise"]=$e;$e.__name__=!0;$e.prototype={set_result:function(a){if(this.hasResult)throw"Promise result already assigned";this._result=a;this.hasResult=!0;this.success.emit(a);return a},get:function(a){return this.hasResult?(a(this._result),null):this.success.connect(a).once()},set_progress:function(a){this._progress!=a&&(this._progress=a,this.progressChanged.emit());return a},set_total:function(a){this._total!=
a&&(this._total=a,this.progressChanged.emit());return a},__class__:$e};var Oc=function(a){ja.call(this,a)};h["flambe.util.Signal0"]=Oc;Oc.__name__=!0;Oc.__super__=ja;Oc.prototype=w(ja.prototype,{connect:function(a,b){null==b&&(b=!1);return this.connectImpl(a,b)},emit:function(){var a=this;this._head==ja.DISPATCHING_SENTINEL?this.defer(function(){a.emitImpl()}):this.emitImpl()},emitImpl:function(){for(var a=this.willEmit(),b=a;null!=b;)b._listener(),b.stayInList||b.dispose(),b=b._next;this.didEmit(a)},
__class__:Oc});var ag=function(a){this.next=null;this.fn=a};h["flambe.util._SignalBase.Task"]=ag;ag.__name__=!0;ag.prototype={__class__:ag};var Ha=function(){};h["flambe.util.Strings"]=Ha;Ha.__name__=!0;Ha.getFileExtension=function(a){var b=a.lastIndexOf(".");return 0<b?P.substr(a,b+1,null):null};Ha.removeFileExtension=function(a){var b=a.lastIndexOf(".");return 0<b?P.substr(a,0,b):a};Ha.getUrlExtension=function(a){var b=a.lastIndexOf("?");0<=b&&(a=P.substr(a,0,b));b=a.lastIndexOf("/");0<=b&&(a=P.substr(a,
b+1,null));return Ha.getFileExtension(a)};Ha.joinPath=function(a,b){0<a.length&&47!=a.charCodeAt(a.length-1)&&(a+="/");return a+b};Ha.withFields=function(a,b){var c=b.length;if(0<c){for(var a=0<a.length?a+" [":a+"[",d=0;d<c;){0<d&&(a+=", ");var e=b[d],i=b[d+1];if(D.is(i,Error)){var f=i.stack;null!=f&&(i=f)}a+=e+"="+D.string(i);d+=2}a+="]"}return a};var oc=function(a){var b=this;this.id=setInterval(function(){b.run()},a)};h["haxe.Timer"]=oc;oc.__name__=!0;oc.delay=function(a,b){var c=new oc(b);c.run=
function(){c.stop();a()};return c};oc.stamp=function(){return(new Date).getTime()/1E3};oc.prototype={stop:function(){null!=this.id&&(clearInterval(this.id),this.id=null)},run:function(){},__class__:oc};var sf=function(){};h["haxe.ds.BalancedTree"]=sf;sf.__name__=!0;sf.prototype={set:function(a,b){this.root=this.setLoop(a,b,this.root)},get:function(a){for(var b=this.root;null!=b;){var c=this.compare(a,b.key);if(0==c)return b.value;b=0>c?b.left:b.right}return null},setLoop:function(a,b,c){if(null==
c)return new ra(null,a,b,null);var d=this.compare(a,c.key);if(0==d)return new ra(c.left,a,b,c.right,null==c?0:c._height);if(0>d)return this.balance(this.setLoop(a,b,c.left),c.key,c.value,c.right);a=this.setLoop(a,b,c.right);return this.balance(c.left,c.key,c.value,a)},balance:function(a,b,c,d){var e;e=null==a?0:a._height;var i;i=null==d?0:d._height;return e>i+2?function(){var b=a.left;return null==b?0:b._height}(this)>=function(){var b=a.right;return null==b?0:b._height}(this)?new ra(a.left,a.key,
a.value,new ra(a.right,b,c,d)):new ra(new ra(a.left,a.key,a.value,a.right.left),a.right.key,a.right.value,new ra(a.right.right,b,c,d)):i>e+2?function(){var a=d.right;return null==a?0:a._height}(this)>function(){var a=d.left;return null==a?0:a._height}(this)?new ra(new ra(a,b,c,d.left),d.key,d.value,d.right):new ra(new ra(a,b,c,d.left.left),d.left.key,d.left.value,new ra(d.left.right,d.key,d.value,d.right)):new ra(a,b,c,d,(e>i?e:i)+1)},compare:function(a,b){return ca.compare(a,b)},__class__:sf};var ra=
function(a,b,c,d,e){null==e&&(e=-1);this.left=a;this.key=b;this.value=c;this.right=d;this._height=-1==e?(function(a){a=a.left;return null==a?0:a._height}(this)>function(a){a=a.right;return null==a?0:a._height}(this)?function(a){a=a.left;return null==a?0:a._height}(this):function(a){a=a.right;return null==a?0:a._height}(this))+1:e};h["haxe.ds.TreeNode"]=ra;ra.__name__=!0;ra.prototype={__class__:ra};var bd=function(){};h["haxe.ds.EnumValueMap"]=bd;bd.__name__=!0;bd.__interfaces__=[Vf];bd.__super__=
sf;bd.prototype=w(sf.prototype,{compare:function(a,b){var c=a[1]-b[1];if(0!=c)return c;var c=a.slice(2),d=b.slice(2);return 0==c.length&&0==d.length?0:this.compareArgs(c,d)},compareArgs:function(a,b){var c=a.length-b.length;if(0!=c)return c;for(var c=0,d=a.length;c<d;){var e=c++,e=this.compareArg(a[e],b[e]);if(0!=e)return e}return 0},compareArg:function(a,b){return ca.isEnumValue(a)&&ca.isEnumValue(b)?this.compare(a,b):a instanceof Array&&null==a.__enum__&&b instanceof Array&&null==b.__enum__?this.compareArgs(a,
b):ca.compare(a,b)},__class__:bd});var tb=function(){this.h={}};h["haxe.ds.IntMap"]=tb;tb.__name__=!0;tb.__interfaces__=[Vf];tb.prototype={set:function(a,b){this.h[a]=b},get:function(a){return this.h[a]},exists:function(a){return this.h.hasOwnProperty(a)},remove:function(a){if(!this.h.hasOwnProperty(a))return!1;delete this.h[a];return!0},__class__:tb};var Na=function(){this.h={}};h["haxe.ds.StringMap"]=Na;Na.__name__=!0;Na.__interfaces__=[Vf];Na.prototype={set:function(a,b){this.h["$"+a]=b},get:function(a){return this.h["$"+
a]},exists:function(a){return this.h.hasOwnProperty("$"+a)},keys:function(){var a=[],b;for(b in this.h)this.h.hasOwnProperty(b)&&a.push(b.substr(1));return P.iter(a)},iterator:function(){return{ref:this.h,it:this.keys(),hasNext:function(){return this.it.hasNext()},next:function(){return this.ref["$"+this.it.next()]}}},__class__:Na};var Qh=function(){};h["haxe.io.Bytes"]=Qh;Qh.__name__=!0;var ih=function(){};h["haxe.io.Eof"]=ih;ih.__name__=!0;ih.prototype={toString:function(){return"Eof"},__class__:ih};
var ch=function(){};h["haxe.rtti.Meta"]=ch;ch.__name__=!0;ch.getType=function(a){a=a.__meta__;return null==a||null==a.obj?{}:a.obj};var mc=function(){};h["haxe.xml.Parser"]=mc;mc.__name__=!0;mc.parse=function(a){var b=E.createDocument();mc.doParse(a,0,b);return b};mc.doParse=function(a,b,c){null==b&&(b=0);for(var d=null,e=1,i=1,f=null,l=0,j=0,g=0,h=a.charCodeAt(b),m=new Be;h==h;){switch(e){case 0:switch(h){case 10:case 13:case 9:case 32:break;default:e=i;continue}break;case 1:switch(h){case 60:e=
0;i=2;break;default:l=b;e=13;continue}break;case 13:60==h?(i=E.createPCData(m.b+P.substr(a,l,b-l)),m=new Be,c.addChild(i),j++,e=0,i=2):38==h&&(m.addSub(a,l,b-l),e=18,i=13,l=b+1);break;case 17:93==h&&93==a.charCodeAt(b+1)&&62==a.charCodeAt(b+2)&&(e=E.createCData(P.substr(a,l,b-l)),c.addChild(e),j++,b+=2,e=1);break;case 2:switch(h){case 33:if(91==a.charCodeAt(b+1)){b+=2;if("CDATA["!=P.substr(a,b,6).toUpperCase())throw"Expected <![CDATA[";b+=5;e=17}else if(68==a.charCodeAt(b+1)||100==a.charCodeAt(b+
1)){if("OCTYPE"!=P.substr(a,b+2,6).toUpperCase())throw"Expected <!DOCTYPE";b+=8;e=16}else{if(45!=a.charCodeAt(b+1)||45!=a.charCodeAt(b+2))throw"Expected <\!--";b+=2;e=15}l=b+1;break;case 63:e=14;l=b;break;case 47:if(null==c)throw"Expected node name";l=b+1;e=0;i=10;break;default:e=3;l=b;continue}break;case 3:if(!(97<=h&&122>=h||65<=h&&90>=h||48<=h&&57>=h||58==h||46==h||95==h||45==h)){if(b==l)throw"Expected node name";d=E.createElement(P.substr(a,l,b-l));c.addChild(d);e=0;i=4;continue}break;case 4:switch(h){case 47:e=
11;j++;break;case 62:e=9;j++;break;default:e=5;l=b;continue}break;case 5:if(!(97<=h&&122>=h||65<=h&&90>=h||48<=h&&57>=h||58==h||46==h||95==h||45==h)){if(l==b)throw"Expected attribute name";f=P.substr(a,l,b-l);if(d.exists(f))throw"Duplicate attribute";e=0;i=6;continue}break;case 6:switch(h){case 61:e=0;i=7;break;default:throw"Expected =";}break;case 7:switch(h){case 34:case 39:e=8;l=b;break;default:throw'Expected "';}break;case 8:h==a.charCodeAt(l)&&(i=P.substr(a,l+1,b-l-1),d.set(f,i),e=0,i=4);break;
case 9:l=b=mc.doParse(a,b,d);e=1;break;case 11:switch(h){case 62:e=1;break;default:throw"Expected >";}break;case 12:switch(h){case 62:return 0==j&&c.addChild(E.createPCData("")),b;default:throw"Expected >";}case 10:if(!(97<=h&&122>=h||65<=h&&90>=h||48<=h&&57>=h||58==h||46==h||95==h||45==h)){if(l==b)throw"Expected node name";if(P.substr(a,l,b-l)!=c.get_nodeName())throw"Expected </"+c.get_nodeName()+">";e=0;i=12;continue}break;case 15:45==h&&45==a.charCodeAt(b+1)&&62==a.charCodeAt(b+2)&&(c.addChild(E.createComment(P.substr(a,
l,b-l))),b+=2,e=1);break;case 16:91==h?g++:93==h?g--:62==h&&0==g&&(c.addChild(E.createDocType(P.substr(a,l,b-l))),e=1);break;case 14:63==h&&62==a.charCodeAt(b+1)&&(b++,e=P.substr(a,l+1,b-l-2),c.addChild(E.createProcessingInstruction(e)),e=1);break;case 18:59==h&&(l=P.substr(a,l,b-l),35==l.charCodeAt(0)?(l=120==l.charCodeAt(1)?D.parseInt("0"+P.substr(l,1,l.length-1)):D.parseInt(P.substr(l,1,l.length-1)),m.add(String.fromCharCode(l))):mc.escapes.exists(l)?m.add(mc.escapes.get(l)):m.b+=D.string("&"+
l+";"),l=b+1,e=i)}h=pd.fastCodeAt(a,++b)}1==e&&(l=b,e=13);if(13==e)return(b!=l||0==j)&&c.addChild(E.createPCData(m.b+P.substr(a,l,b-l))),b;throw"Unexpected end";};var Z=function(){};h["js.Boot"]=Z;Z.__name__=!0;Z.getClass=function(a){return a instanceof Array&&null==a.__enum__?Array:a.__class__};Z.__string_rec=function(a,b){if(null==a)return"null";if(5<=b.length)return"<...>";var c=typeof a;if("function"==c&&(a.__name__||a.__ename__))c="object";switch(c){case "object":if(a instanceof Array){if(a.__enum__){if(2==
a.length)return a[0];for(var c=a[0]+"(",b=b+"\t",d=2,e=a.length;d<e;)var i=d++,c=2!=i?c+(","+Z.__string_rec(a[i],b)):c+Z.__string_rec(a[i],b);return c+")"}c=a.length;d="[";b+="\t";for(e=0;e<c;)i=e++,d+=(0<i?",":"")+Z.__string_rec(a[i],b);return d+"]"}try{d=a.toString}catch(f){return"???"}if(null!=d&&d!=Object.toString&&(c=a.toString(),"[object Object]"!=c))return c;c=null;d="{\n";b+="\t";e=null!=a.hasOwnProperty;for(c in a)if(!e||a.hasOwnProperty(c))"prototype"==c||"__class__"==c||"__super__"==c||
"__interfaces__"==c||"__properties__"==c||(2!=d.length&&(d+=", \n"),d+=b+c+" : "+Z.__string_rec(a[c],b));b=b.substring(1);return d+("\n"+b+"}");case "function":return"<function>";case "string":return a;default:return""+a}};Z.__interfLoop=function(a,b){if(null==a)return!1;if(a==b)return!0;var c=a.__interfaces__;if(null!=c)for(var d=0,e=c.length;d<e;){var i=d++,i=c[i];if(i==b||Z.__interfLoop(i,b))return!0}return Z.__interfLoop(a.__super__,b)};Z.__instanceof=function(a,b){if(null==b)return!1;switch(b){case Xh:return(a|
0)===a;case Rh:return"number"==typeof a;case Sh:return"boolean"==typeof a;case String:return"string"==typeof a;case Array:return a instanceof Array&&null==a.__enum__;case Yh:return!0;default:if(null!=a){if("function"==typeof b&&(a instanceof b||Z.__interfLoop(Z.getClass(a),b)))return!0}else return!1;return b==Zh&&null!=a.__name__||b==$h&&null!=a.__ename__?!0:a.__enum__==b}};Z.__cast=function(a,b){if(Z.__instanceof(a,b))return a;throw"Cannot cast "+D.string(a)+" to "+D.string(b);};var bh=function(){};
h["js.html._CanvasElement.CanvasUtil"]=bh;bh.__name__=!0;bh.getContextWebGL=function(a,b){for(var c=0,d=["webgl","experimental-webgl"];c<d.length;){var e=d[c];++c;e=a.getContext(e,b);if(null!=e)return e}return null};var m=function(){};h["nape.Config"]=m;m.__name__=!0;var Pa=function(){this.zpp_inner=null};h["nape.callbacks.Callback"]=Pa;Pa.__name__=!0;Pa.prototype={toString:function(){return""},__class__:Pa};var tf=function(){this.zpp_inner=null};h["nape.callbacks.BodyCallback"]=tf;tf.__name__=!0;
tf.__super__=Pa;tf.prototype=w(Pa.prototype,{toString:function(){var a;a="Cb:"+["WAKE","SLEEP"][this.zpp_inner.event-f.id_CbEvent_WAKE];a+=":"+this.zpp_inner.body.outer.toString();return a+=" : listener: "+D.string(this.zpp_inner.listener.outer)},__class__:tf});var ea=function(){this.zpp_inner=null};h["nape.callbacks.Listener"]=ea;ea.__name__=!0;ea.prototype={toString:function(){var a="BEGIN,END,WAKE,SLEEP,BREAK,PRE,ONGOING".split(",")[this.zpp_inner.event];if(this.zpp_inner.type==f.id_ListenerType_BODY)return"BodyListener{"+
a+"::"+D.string(this.zpp_inner.body.outer_zn.zpp_inner_zn.options.outer)+"}";if(this.zpp_inner.type==f.id_ListenerType_CONSTRAINT)return"ConstraintListener{"+a+"::"+D.string(this.zpp_inner.constraint.outer_zn.zpp_inner_zn.options.outer)+"}";var b=this.zpp_inner.interaction,c;switch(b.itype){case f.id_InteractionType_COLLISION:c="COLLISION";break;case f.id_InteractionType_SENSOR:c="SENSOR";break;case f.id_InteractionType_FLUID:c="FLUID";break;default:c="ALL"}return(this.zpp_inner.type==f.id_ListenerType_INTERACTION?
"InteractionListener{"+a+"#"+c+"::"+D.string(b.outer_zni.zpp_inner_zn.options1.outer)+":"+D.string(b.outer_zni.zpp_inner_zn.options2.outer)+"}":"PreListener{"+c+"::"+D.string(b.outer_znp.zpp_inner_zn.options1.outer)+":"+D.string(b.outer_znp.zpp_inner_zn.options2.outer)+"}")+" precedence="+this.zpp_inner.precedence},__class__:ea};var Bg=function(){this.zpp_inner_zn=null};h["nape.callbacks.BodyListener"]=Bg;Bg.__name__=!0;Bg.__super__=ea;Bg.prototype=w(ea.prototype,{__class__:Bg});var Ta=function(){};
h["nape.callbacks.CbEvent"]=Ta;Ta.__name__=!0;Ta.prototype={toString:function(){var a;null==f.CbEvent_PRE&&(f.internal=!0,f.CbEvent_PRE=new Ta,f.internal=!1);this==f.CbEvent_PRE?a="PRE":(null==f.CbEvent_BEGIN&&(f.internal=!0,f.CbEvent_BEGIN=new Ta,f.internal=!1),this==f.CbEvent_BEGIN?a="BEGIN":(null==f.CbEvent_ONGOING&&(f.internal=!0,f.CbEvent_ONGOING=new Ta,f.internal=!1),this==f.CbEvent_ONGOING?a="ONGOING":(null==f.CbEvent_END&&(f.internal=!0,f.CbEvent_END=new Ta,f.internal=!1),this==f.CbEvent_END?
a="END":(null==f.CbEvent_WAKE&&(f.internal=!0,f.CbEvent_WAKE=new Ta,f.internal=!1),this==f.CbEvent_WAKE?a="WAKE":(null==f.CbEvent_SLEEP&&(f.internal=!0,f.CbEvent_SLEEP=new Ta,f.internal=!1),this==f.CbEvent_SLEEP?a="SLEEP":(null==f.CbEvent_BREAK&&(f.internal=!0,f.CbEvent_BREAK=new Ta,f.internal=!1),a=this==f.CbEvent_BREAK?"BREAK":""))))));return a},__class__:Ta};var $b=function(){this.zpp_inner=null;this.zpp_inner=new wa;this.zpp_inner.outer=this};h["nape.callbacks.CbType"]=$b;$b.__name__=!0;$b.prototype=
{toString:function(){return this==wa.ANY_BODY?"ANY_BODY":this==wa.ANY_SHAPE?"ANY_SHAPE":this==wa.ANY_COMPOUND?"ANY_COMPOUND":this==wa.ANY_CONSTRAINT?"ANY_CONSTRAINT":"CbType#"+this.zpp_inner.id},__class__:$b};var Ka=function(){this.zpp_next=null;this.zpp_critical=!1;this.zpp_i=0;this.zpp_inner=null};h["nape.callbacks.CbTypeIterator"]=Ka;Ka.__name__=!0;Ka.get=function(a){var b;null==Ka.zpp_pool?(Hb.internal=!0,b=new Ka,Hb.internal=!1):(b=Ka.zpp_pool,Ka.zpp_pool=b.zpp_next);b.zpp_i=0;b.zpp_inner=a;
b.zpp_critical=!1;return b};Ka.prototype={hasNext:function(){this.zpp_inner.zpp_inner.valmod();var a=this.zpp_inner.get_length();this.zpp_critical=!0;if(this.zpp_i<a)return!0;this.zpp_next=Ka.zpp_pool;Ka.zpp_pool=this;this.zpp_inner=null;return!1},next:function(){this.zpp_critical=!1;return this.zpp_inner.at(this.zpp_i++)},__class__:Ka};var uf=function(){this.zpp_inner=null;this.zpp_inner=new Hb;this.zpp_inner.outer=this};h["nape.callbacks.CbTypeList"]=uf;uf.__name__=!0;uf.prototype={get_length:function(){this.zpp_inner.valmod();
this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length);return this.zpp_inner.user_length},at:function(a){this.zpp_inner.valmod();this.zpp_inner.reverse_flag&&(a=this.get_length()-1-a);if(a<this.zpp_inner.at_index||null==this.zpp_inner.at_ite)this.zpp_inner.at_index=a,this.zpp_inner.at_ite=this.zpp_inner.inner.iterator_at(a);else for(;this.zpp_inner.at_index!=a;)this.zpp_inner.at_index++,this.zpp_inner.at_ite=this.zpp_inner.at_ite.next;return this.zpp_inner.at_ite.elt.outer},
push:function(a){this.zpp_inner.modify_test();this.zpp_inner.valmod();var b;if(b=null!=this.zpp_inner.adder?this.zpp_inner.adder(a):!0)this.zpp_inner.reverse_flag?this.zpp_inner.inner.add(a.zpp_inner):(null==this.zpp_inner.push_ite&&(this.zpp_inner.push_ite=null==this.zpp_inner.inner.head?null:this.zpp_inner.inner.iterator_at(this.get_length()-1)),this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,a.zpp_inner)),this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&
this.zpp_inner.post_adder(a);return b},unshift:function(a){this.zpp_inner.modify_test();this.zpp_inner.valmod();var b;if(b=null!=this.zpp_inner.adder?this.zpp_inner.adder(a):!0)this.zpp_inner.reverse_flag?(null==this.zpp_inner.push_ite&&(this.zpp_inner.push_ite=null==this.zpp_inner.inner.head?null:this.zpp_inner.inner.iterator_at(this.get_length()-1)),this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,a.zpp_inner)):this.zpp_inner.inner.add(a.zpp_inner),this.zpp_inner.invalidate(),
null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(a);return b},add:function(a){return this.zpp_inner.reverse_flag?this.push(a):this.unshift(a)},iterator:function(){this.zpp_inner.valmod();return Ka.get(this)},toString:function(){var a="[",b=!0,c;this.zpp_inner.valmod();for(c=Ka.get(this);c.hasNext();){var d;c.zpp_critical=!1;d=c.zpp_inner.at(c.zpp_i++);b||(a+=",");a=null==d?a+"NULL":a+d.toString();b=!1}return a+"]"},__class__:uf};var vf=function(){this.zpp_inner=null};h["nape.callbacks.ConstraintCallback"]=
vf;vf.__name__=!0;vf.__super__=Pa;vf.prototype=w(Pa.prototype,{toString:function(){var a;a="Cb:"+["WAKE","SLEEP","BREAK"][this.zpp_inner.event-f.id_CbEvent_WAKE];a+=":"+this.zpp_inner.constraint.outer.toString();return a+=" : listener: "+D.string(this.zpp_inner.listener.outer)},__class__:vf});var Cg=function(){this.zpp_inner_zn=null};h["nape.callbacks.ConstraintListener"]=Cg;Cg.__name__=!0;Cg.__super__=ea;Cg.prototype=w(ea.prototype,{__class__:Cg});var wf=function(){this.zpp_inner=null};h["nape.callbacks.InteractionCallback"]=
wf;wf.__name__=!0;wf.__super__=Pa;wf.prototype=w(Pa.prototype,{toString:function(){var a;a="Cb:"+"BEGIN,END,,,,,ONGOING".split(",")[this.zpp_inner.event];a+=":"+this.zpp_inner.int1.outer_i.toString()+"/"+this.zpp_inner.int2.outer_i.toString();a+=" : "+this.zpp_inner.wrap_arbiters.toString();return a+=" : listener: "+D.string(this.zpp_inner.listener.outer)},__class__:wf});var Me=function(a,b,c,d,e,i){null==i&&(i=0);this.zpp_inner=this.zpp_inner_zn=null;var k=-1;null==f.CbEvent_BEGIN&&(f.internal=!0,
f.CbEvent_BEGIN=new Ta,f.internal=!1);a==f.CbEvent_BEGIN?k=f.id_CbEvent_BEGIN:(null==f.CbEvent_END&&(f.internal=!0,f.CbEvent_END=new Ta,f.internal=!1),a==f.CbEvent_END?k=f.id_CbEvent_END:(null==f.CbEvent_ONGOING&&(f.internal=!0,f.CbEvent_ONGOING=new Ta,f.internal=!1),a==f.CbEvent_ONGOING&&(k=f.id_CbEvent_ONGOING)));this.zpp_inner=this.zpp_inner_zn=new sa(uc.argument(c),uc.argument(d),k,f.id_ListenerType_INTERACTION);this.zpp_inner.outer=this;this.zpp_inner_zn.outer_zni=this;this.zpp_inner.precedence=
i;this.zpp_inner_zn.handleri=e;this.set_interactionType(b)};h["nape.callbacks.InteractionListener"]=Me;Me.__name__=!0;Me.__super__=ea;Me.prototype=w(ea.prototype,{get_interactionType:function(){var a=this.zpp_inner_zn.itype;if(a==f.id_InteractionType_COLLISION)return null==f.InteractionType_COLLISION&&(f.internal=!0,f.InteractionType_COLLISION=new qa,f.internal=!1),f.InteractionType_COLLISION;if(a==f.id_InteractionType_SENSOR)return null==f.InteractionType_SENSOR&&(f.internal=!0,f.InteractionType_SENSOR=
new qa,f.internal=!1),f.InteractionType_SENSOR;if(a==f.id_InteractionType_FLUID)return null==f.InteractionType_FLUID&&(f.internal=!0,f.InteractionType_FLUID=new qa,f.internal=!1),f.InteractionType_FLUID;return a==f.id_InteractionType_ANY?(null==f.InteractionType_ANY&&(f.internal=!0,f.InteractionType_ANY=new qa,f.internal=!1),f.InteractionType_ANY):null},set_interactionType:function(a){if(this.get_interactionType()!=a){var b=this.zpp_inner_zn;null==f.InteractionType_COLLISION&&(f.internal=!0,f.InteractionType_COLLISION=
new qa,f.internal=!1);a==f.InteractionType_COLLISION?a=f.id_InteractionType_COLLISION:(null==f.InteractionType_SENSOR&&(f.internal=!0,f.InteractionType_SENSOR=new qa,f.internal=!1),a==f.InteractionType_SENSOR?a=f.id_InteractionType_SENSOR:(null==f.InteractionType_FLUID&&(f.internal=!0,f.InteractionType_FLUID=new qa,f.internal=!1),a=a==f.InteractionType_FLUID?f.id_InteractionType_FLUID:f.id_InteractionType_ANY));b.itype=a}return this.get_interactionType()},__class__:Me});var qa=function(){};h["nape.callbacks.InteractionType"]=
qa;qa.__name__=!0;qa.prototype={toString:function(){var a;null==f.InteractionType_COLLISION&&(f.internal=!0,f.InteractionType_COLLISION=new qa,f.internal=!1);this==f.InteractionType_COLLISION?a="COLLISION":(null==f.InteractionType_SENSOR&&(f.internal=!0,f.InteractionType_SENSOR=new qa,f.internal=!1),this==f.InteractionType_SENSOR?a="SENSOR":(null==f.InteractionType_FLUID&&(f.internal=!0,f.InteractionType_FLUID=new qa,f.internal=!1),this==f.InteractionType_FLUID?a="FLUID":(null==f.InteractionType_ANY&&
(f.internal=!0,f.InteractionType_ANY=new qa,f.internal=!1),a=this==f.InteractionType_ANY?"ANY":"")));return a},__class__:qa};var Ib=function(){this.zpp_next=null;this.zpp_critical=!1;this.zpp_i=0;this.zpp_inner=null};h["nape.callbacks.ListenerIterator"]=Ib;Ib.__name__=!0;Ib.get=function(a){var b;null==Ib.zpp_pool?(Uc.internal=!0,b=new Ib,Uc.internal=!1):(b=Ib.zpp_pool,Ib.zpp_pool=b.zpp_next);b.zpp_i=0;b.zpp_inner=a;b.zpp_critical=!1;return b};Ib.prototype={hasNext:function(){this.zpp_inner.zpp_inner.valmod();
var a=this.zpp_inner.get_length();this.zpp_critical=!0;if(this.zpp_i<a)return!0;this.zpp_next=Ib.zpp_pool;Ib.zpp_pool=this;this.zpp_inner=null;return!1},next:function(){this.zpp_critical=!1;return this.zpp_inner.at(this.zpp_i++)},__class__:Ib};var Dg=function(){this.zpp_inner=null;this.zpp_inner=new Uc;this.zpp_inner.outer=this};h["nape.callbacks.ListenerList"]=Dg;Dg.__name__=!0;Dg.prototype={get_length:function(){this.zpp_inner.valmod();this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=
this.zpp_inner.inner.length);return this.zpp_inner.user_length},at:function(a){this.zpp_inner.valmod();this.zpp_inner.reverse_flag&&(a=this.get_length()-1-a);if(a<this.zpp_inner.at_index||null==this.zpp_inner.at_ite)this.zpp_inner.at_index=a,this.zpp_inner.at_ite=this.zpp_inner.inner.iterator_at(a);else for(;this.zpp_inner.at_index!=a;)this.zpp_inner.at_index++,this.zpp_inner.at_ite=this.zpp_inner.at_ite.next;return this.zpp_inner.at_ite.elt.outer},push:function(a){this.zpp_inner.modify_test();this.zpp_inner.valmod();
var b;if(b=null!=this.zpp_inner.adder?this.zpp_inner.adder(a):!0)this.zpp_inner.reverse_flag?this.zpp_inner.inner.add(a.zpp_inner):(null==this.zpp_inner.push_ite&&(this.zpp_inner.push_ite=null==this.zpp_inner.inner.head?null:this.zpp_inner.inner.iterator_at(this.get_length()-1)),this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,a.zpp_inner)),this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(a);return b},unshift:function(a){this.zpp_inner.modify_test();
this.zpp_inner.valmod();var b;if(b=null!=this.zpp_inner.adder?this.zpp_inner.adder(a):!0)this.zpp_inner.reverse_flag?(null==this.zpp_inner.push_ite&&(this.zpp_inner.push_ite=null==this.zpp_inner.inner.head?null:this.zpp_inner.inner.iterator_at(this.get_length()-1)),this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,a.zpp_inner)):this.zpp_inner.inner.add(a.zpp_inner),this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(a);return b},add:function(a){return this.zpp_inner.reverse_flag?
this.push(a):this.unshift(a)},remove:function(a){this.zpp_inner.modify_test();this.zpp_inner.valmod();var b;b=!1;for(var c=this.zpp_inner.inner.head;null!=c;){if(c.elt==a.zpp_inner){b=!0;break}c=c.next}b&&(null!=this.zpp_inner.subber&&this.zpp_inner.subber(a),this.zpp_inner.dontremove||this.zpp_inner.inner.remove(a.zpp_inner),this.zpp_inner.invalidate());return b},toString:function(){var a="[",b=!0,c;this.zpp_inner.valmod();for(c=Ib.get(this);c.hasNext();){var d;c.zpp_critical=!1;d=c.zpp_inner.at(c.zpp_i++);
b||(a+=",");a=null==d?a+"NULL":a+d.toString();b=!1}return a+"]"},__class__:Dg};var Kd=function(){};h["nape.callbacks.ListenerType"]=Kd;Kd.__name__=!0;Kd.prototype={toString:function(){var a;null==f.ListenerType_BODY&&(f.internal=!0,f.ListenerType_BODY=new Kd,f.internal=!1);this==f.ListenerType_BODY?a="BODY":(null==f.ListenerType_CONSTRAINT&&(f.internal=!0,f.ListenerType_CONSTRAINT=new Kd,f.internal=!1),this==f.ListenerType_CONSTRAINT?a="CONSTRAINT":(null==f.ListenerType_INTERACTION&&(f.internal=!0,
f.ListenerType_INTERACTION=new Kd,f.internal=!1),this==f.ListenerType_INTERACTION?a="INTERACTION":(null==f.ListenerType_PRE&&(f.internal=!0,f.ListenerType_PRE=new Kd,f.internal=!1),a=this==f.ListenerType_PRE?"PRE":"")));return a},__class__:Kd};var Ld=function(a,b){this.zpp_inner=null;this.zpp_inner=new uc;this.zpp_inner.outer=this;null!=a&&this.including(a);null!=b&&this.excluding(b)};h["nape.callbacks.OptionType"]=Ld;Ld.__name__=!0;Ld.prototype={including:function(a){this.zpp_inner.append(this.zpp_inner.includes,
a);return this},excluding:function(a){this.zpp_inner.append(this.zpp_inner.excludes,a);return this},toString:function(){null==this.zpp_inner.wrap_includes&&this.zpp_inner.setup_includes();var a=this.zpp_inner.wrap_includes.toString();null==this.zpp_inner.wrap_excludes&&this.zpp_inner.setup_excludes();return"@{"+a+" excluding "+this.zpp_inner.wrap_excludes.toString()+"}"},__class__:Ld};var xf=function(){this.zpp_inner=null};h["nape.callbacks.PreCallback"]=xf;xf.__name__=!0;xf.__super__=Pa;xf.prototype=
w(Pa.prototype,{toString:function(){var a;a="Cb:PRE:"+(":"+this.zpp_inner.int1.outer_i.toString()+"/"+this.zpp_inner.int2.outer_i.toString());a+=" : "+this.zpp_inner.pre_arbiter.wrapper().toString();return a+=" : listnener: "+D.string(this.zpp_inner.listener.outer)},__class__:xf});var xa=function(){};h["nape.callbacks.PreFlag"]=xa;xa.__name__=!0;xa.prototype={toString:function(){var a;null==f.PreFlag_ACCEPT&&(f.internal=!0,f.PreFlag_ACCEPT=new xa,f.internal=!1);this==f.PreFlag_ACCEPT?a="ACCEPT":(null==
f.PreFlag_IGNORE&&(f.internal=!0,f.PreFlag_IGNORE=new xa,f.internal=!1),this==f.PreFlag_IGNORE?a="IGNORE":(null==f.PreFlag_ACCEPT_ONCE&&(f.internal=!0,f.PreFlag_ACCEPT_ONCE=new xa,f.internal=!1),this==f.PreFlag_ACCEPT_ONCE?a="ACCEPT_ONCE":(null==f.PreFlag_IGNORE_ONCE&&(f.internal=!0,f.PreFlag_IGNORE_ONCE=new xa,f.internal=!1),a=this==f.PreFlag_IGNORE_ONCE?"IGNORE_ONCE":"")));return a},__class__:xa};var Eg=function(){this.zpp_inner_zn=null};h["nape.callbacks.PreListener"]=Eg;Eg.__name__=!0;Eg.__super__=
ea;Eg.prototype=w(ea.prototype,{__class__:Eg});var cd=function(){this.zpp_inner.insert_cbtype(wa.ANY_CONSTRAINT.zpp_inner)};h["nape.constraint.Constraint"]=cd;cd.__name__=!0;cd.prototype={set_space:function(a){if((null==this.zpp_inner.space?null:this.zpp_inner.space.outer)!=a)null!=this.zpp_inner.component&&(this.zpp_inner.component.woken=!1),this.zpp_inner.clearcache(),null!=this.zpp_inner.space&&this.zpp_inner.space.outer.zpp_inner.wrap_constraints.remove(this),null!=a?a.zpp_inner.wrap_constraints.add(this):
this.zpp_inner.space=null;return null==this.zpp_inner.space?null:this.zpp_inner.space.outer},set_active:function(a){this.zpp_inner.active!=a&&(null!=this.zpp_inner.component&&(this.zpp_inner.component.woken=!1),this.zpp_inner.clearcache(),a?(this.zpp_inner.active=a,this.zpp_inner.activate(),null!=this.zpp_inner.space&&(null!=this.zpp_inner.component&&(this.zpp_inner.component.sleeping=!0),this.zpp_inner.space.wake_constraint(this.zpp_inner,!0))):(null!=this.zpp_inner.space&&(this.zpp_inner.wake(),
this.zpp_inner.space.live_constraints.remove(this.zpp_inner)),this.zpp_inner.active=a,this.zpp_inner.deactivate()));return this.zpp_inner.active},set_stiff:function(a){this.zpp_inner.stiff!=a&&(this.zpp_inner.stiff=a,this.zpp_inner.wake());return this.zpp_inner.stiff},set_frequency:function(a){this.zpp_inner.frequency!=a&&(this.zpp_inner.frequency=a,this.zpp_inner.stiff||this.zpp_inner.wake());return this.zpp_inner.frequency},set_damping:function(a){this.zpp_inner.damping!=a&&(this.zpp_inner.damping=
a,this.zpp_inner.stiff||this.zpp_inner.wake());return this.zpp_inner.damping},set_maxForce:function(a){this.zpp_inner.maxForce!=a&&(this.zpp_inner.maxForce=a,this.zpp_inner.wake());return this.zpp_inner.maxForce},toString:function(){return"{Constraint}"},__class__:cd};var Jb=function(){this.zpp_next=null;this.zpp_critical=!1;this.zpp_i=0;this.zpp_inner=null};h["nape.constraint.ConstraintIterator"]=Jb;Jb.__name__=!0;Jb.get=function(a){var b;null==Jb.zpp_pool?(Kb.internal=!0,b=new Jb,Kb.internal=!1):
(b=Jb.zpp_pool,Jb.zpp_pool=b.zpp_next);b.zpp_i=0;b.zpp_inner=a;b.zpp_critical=!1;return b};Jb.prototype={hasNext:function(){this.zpp_inner.zpp_inner.valmod();var a=this.zpp_inner.get_length();this.zpp_critical=!0;if(this.zpp_i<a)return!0;this.zpp_next=Jb.zpp_pool;Jb.zpp_pool=this;this.zpp_inner=null;return!1},next:function(){this.zpp_critical=!1;return this.zpp_inner.at(this.zpp_i++)},__class__:Jb};var Fg=function(){this.zpp_inner=null;this.zpp_inner=new Kb;this.zpp_inner.outer=this};h["nape.constraint.ConstraintList"]=
Fg;Fg.__name__=!0;Fg.prototype={get_length:function(){this.zpp_inner.valmod();this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length);return this.zpp_inner.user_length},at:function(a){this.zpp_inner.valmod();this.zpp_inner.reverse_flag&&(a=this.get_length()-1-a);if(a<this.zpp_inner.at_index||null==this.zpp_inner.at_ite)this.zpp_inner.at_index=a,this.zpp_inner.at_ite=this.zpp_inner.inner.iterator_at(a);else for(;this.zpp_inner.at_index!=a;)this.zpp_inner.at_index++,
this.zpp_inner.at_ite=this.zpp_inner.at_ite.next;return this.zpp_inner.at_ite.elt.outer},push:function(a){this.zpp_inner.modify_test();this.zpp_inner.valmod();var b;if(b=null!=this.zpp_inner.adder?this.zpp_inner.adder(a):!0)this.zpp_inner.reverse_flag?this.zpp_inner.inner.add(a.zpp_inner):(null==this.zpp_inner.push_ite&&(this.zpp_inner.push_ite=null==this.zpp_inner.inner.head?null:this.zpp_inner.inner.iterator_at(this.get_length()-1)),this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,
a.zpp_inner)),this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(a);return b},unshift:function(a){this.zpp_inner.modify_test();this.zpp_inner.valmod();var b;if(b=null!=this.zpp_inner.adder?this.zpp_inner.adder(a):!0)this.zpp_inner.reverse_flag?(null==this.zpp_inner.push_ite&&(this.zpp_inner.push_ite=null==this.zpp_inner.inner.head?null:this.zpp_inner.inner.iterator_at(this.get_length()-1)),this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,
a.zpp_inner)):this.zpp_inner.inner.add(a.zpp_inner),this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(a);return b},add:function(a){return this.zpp_inner.reverse_flag?this.push(a):this.unshift(a)},remove:function(a){this.zpp_inner.modify_test();this.zpp_inner.valmod();var b;b=!1;for(var c=this.zpp_inner.inner.head;null!=c;){if(c.elt==a.zpp_inner){b=!0;break}c=c.next}b&&(null!=this.zpp_inner.subber&&this.zpp_inner.subber(a),this.zpp_inner.dontremove||this.zpp_inner.inner.remove(a.zpp_inner),
this.zpp_inner.invalidate());return b},toString:function(){var a="[",b=!0,c;this.zpp_inner.valmod();for(c=Jb.get(this);c.hasNext();){var d;c.zpp_critical=!1;d=c.zpp_inner.at(c.zpp_i++);b||(a+=",");a=null==d?a+"NULL":a+d.toString();b=!1}return a+"]"},__class__:Fg};var Wd=function(a,b,c,d,e,i){this.zpp_inner_zn=null;this.zpp_inner=this.zpp_inner_zn=new yf;this.zpp_inner.outer=this;this.zpp_inner_zn.outer_zn=this;cd.call(this);this.set_body1(a);this.set_body2(b);null==this.zpp_inner_zn.wrap_a1&&this.zpp_inner_zn.setup_a1();
this.zpp_inner_zn.wrap_a1.set(c);null==this.zpp_inner_zn.wrap_a1&&this.zpp_inner_zn.setup_a1();this.zpp_inner_zn.wrap_a1;null==this.zpp_inner_zn.wrap_a2&&this.zpp_inner_zn.setup_a2();this.zpp_inner_zn.wrap_a2.set(d);null==this.zpp_inner_zn.wrap_a2&&this.zpp_inner_zn.setup_a2();this.zpp_inner_zn.wrap_a2;this.zpp_inner.immutable_midstep("DistanceJoint::jointMin");this.zpp_inner_zn.jointMin!=e&&(this.zpp_inner_zn.jointMin=e,this.zpp_inner.wake());this.zpp_inner_zn.jointMin;this.zpp_inner.immutable_midstep("DistanceJoint::jointMax");
this.zpp_inner_zn.jointMax!=i&&(this.zpp_inner_zn.jointMax=i,this.zpp_inner.wake());this.zpp_inner_zn.jointMax};h["nape.constraint.DistanceJoint"]=Wd;Wd.__name__=!0;Wd.__super__=cd;Wd.prototype=w(cd.prototype,{get_body1:function(){return null==this.zpp_inner_zn.b1?null:this.zpp_inner_zn.b1.outer},set_body1:function(a){this.zpp_inner.immutable_midstep("Constraint::body1");a=null==a?null:a.zpp_inner;if(a!=this.zpp_inner_zn.b1&&(null!=this.zpp_inner_zn.b1&&(null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&
this.zpp_inner_zn.b2!=this.zpp_inner_zn.b1&&null!=this.zpp_inner_zn.b1&&this.zpp_inner_zn.b1.constraints.remove(this.zpp_inner),this.zpp_inner.active&&null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&this.zpp_inner_zn.b1.wake()),this.zpp_inner_zn.b1=a,null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&null!=a&&this.zpp_inner_zn.b2!=a&&null!=a&&a.constraints.add(this.zpp_inner),this.zpp_inner.active&&null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)))this.zpp_inner.wake(),
null!=a&&a.wake();return null==this.zpp_inner_zn.b1?null:this.zpp_inner_zn.b1.outer},get_body2:function(){return null==this.zpp_inner_zn.b2?null:this.zpp_inner_zn.b2.outer},set_body2:function(a){this.zpp_inner.immutable_midstep("Constraint::body2");a=null==a?null:a.zpp_inner;if(a!=this.zpp_inner_zn.b2&&(null!=this.zpp_inner_zn.b2&&(null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&this.zpp_inner_zn.b1!=this.zpp_inner_zn.b2&&null!=this.zpp_inner_zn.b2&&this.zpp_inner_zn.b2.constraints.remove(this.zpp_inner),
this.zpp_inner.active&&null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&this.zpp_inner_zn.b2.wake()),this.zpp_inner_zn.b2=a,null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&null!=a&&this.zpp_inner_zn.b1!=a&&null!=a&&a.constraints.add(this.zpp_inner),this.zpp_inner.active&&null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)))this.zpp_inner.wake(),null!=a&&a.wake();return null==this.zpp_inner_zn.b2?null:this.zpp_inner_zn.b2.outer},get_anchor1:function(){null==
this.zpp_inner_zn.wrap_a1&&this.zpp_inner_zn.setup_a1();return this.zpp_inner_zn.wrap_a1},get_anchor2:function(){null==this.zpp_inner_zn.wrap_a2&&this.zpp_inner_zn.setup_a2();return this.zpp_inner_zn.wrap_a2},__class__:Wd});var Lc=function(a,b,c,d){this.zpp_inner_zn=null;this.zpp_inner=this.zpp_inner_zn=new zf;this.zpp_inner.outer=this;this.zpp_inner_zn.outer_zn=this;cd.call(this);this.set_body1(a);this.set_body2(b);null==this.zpp_inner_zn.wrap_a1&&this.zpp_inner_zn.setup_a1();this.zpp_inner_zn.wrap_a1.set(c);
null==this.zpp_inner_zn.wrap_a1&&this.zpp_inner_zn.setup_a1();this.zpp_inner_zn.wrap_a1;null==this.zpp_inner_zn.wrap_a2&&this.zpp_inner_zn.setup_a2();this.zpp_inner_zn.wrap_a2.set(d);null==this.zpp_inner_zn.wrap_a2&&this.zpp_inner_zn.setup_a2();this.zpp_inner_zn.wrap_a2};h["nape.constraint.PivotJoint"]=Lc;Lc.__name__=!0;Lc.__super__=cd;Lc.prototype=w(cd.prototype,{set_body1:function(a){this.zpp_inner.immutable_midstep("Constraint::body1");a=null==a?null:a.zpp_inner;if(a!=this.zpp_inner_zn.b1&&(null!=
this.zpp_inner_zn.b1&&(null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&this.zpp_inner_zn.b2!=this.zpp_inner_zn.b1&&null!=this.zpp_inner_zn.b1&&this.zpp_inner_zn.b1.constraints.remove(this.zpp_inner),this.zpp_inner.active&&null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&this.zpp_inner_zn.b1.wake()),this.zpp_inner_zn.b1=a,null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&null!=a&&this.zpp_inner_zn.b2!=a&&null!=a&&a.constraints.add(this.zpp_inner),
this.zpp_inner.active&&null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)))this.zpp_inner.wake(),null!=a&&a.wake();return null==this.zpp_inner_zn.b1?null:this.zpp_inner_zn.b1.outer},set_body2:function(a){this.zpp_inner.immutable_midstep("Constraint::body2");a=null==a?null:a.zpp_inner;if(a!=this.zpp_inner_zn.b2&&(null!=this.zpp_inner_zn.b2&&(null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&this.zpp_inner_zn.b1!=this.zpp_inner_zn.b2&&null!=this.zpp_inner_zn.b2&&this.zpp_inner_zn.b2.constraints.remove(this.zpp_inner),
this.zpp_inner.active&&null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&this.zpp_inner_zn.b2.wake()),this.zpp_inner_zn.b2=a,null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&null!=a&&this.zpp_inner_zn.b1!=a&&null!=a&&a.constraints.add(this.zpp_inner),this.zpp_inner.active&&null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)))this.zpp_inner.wake(),null!=a&&a.wake();return null==this.zpp_inner_zn.b2?null:this.zpp_inner_zn.b2.outer},get_anchor1:function(){null==
this.zpp_inner_zn.wrap_a1&&this.zpp_inner_zn.setup_a1();return this.zpp_inner_zn.wrap_a1},get_anchor2:function(){null==this.zpp_inner_zn.wrap_a2&&this.zpp_inner_zn.setup_a2();return this.zpp_inner_zn.wrap_a2},__class__:Lc});var Lb=function(){this.zpp_inner=null};h["nape.dynamics.Arbiter"]=Lb;Lb.__name__=!0;Lb.prototype={get_state:function(){var a=this.zpp_inner.immState;if(a==(f.id_ImmState_ACCEPT|f.id_ImmState_ALWAYS))return null==f.PreFlag_ACCEPT&&(f.internal=!0,f.PreFlag_ACCEPT=new xa,f.internal=
!1),f.PreFlag_ACCEPT;switch(a){case f.id_ImmState_ACCEPT:return null==f.PreFlag_ACCEPT_ONCE&&(f.internal=!0,f.PreFlag_ACCEPT_ONCE=new xa,f.internal=!1),f.PreFlag_ACCEPT_ONCE;default:if(a==(f.id_ImmState_IGNORE|f.id_ImmState_ALWAYS))return null==f.PreFlag_IGNORE&&(f.internal=!0,f.PreFlag_IGNORE=new xa,f.internal=!1),f.PreFlag_IGNORE;null==f.PreFlag_IGNORE_ONCE&&(f.internal=!0,f.PreFlag_IGNORE_ONCE=new xa,f.internal=!1);return f.PreFlag_IGNORE_ONCE}},toString:function(){var a;a=this.zpp_inner.type==
H.COL?"CollisionArbiter":this.zpp_inner.type==H.FLUID?"FluidArbiter":"SensorArbiter";return this.zpp_inner.cleared?a+"(object-pooled)":a+"("+(this.zpp_inner.ws1.id>this.zpp_inner.ws2.id?this.zpp_inner.ws2.outer:this.zpp_inner.ws1.outer).toString()+"|"+(this.zpp_inner.ws1.id>this.zpp_inner.ws2.id?this.zpp_inner.ws1.outer:this.zpp_inner.ws2.outer).toString()+")"+(this.zpp_inner.type==H.COL?"["+["SD","DD"][this.zpp_inner.colarb.stat?0:1]+"]":"")+"<-"+this.get_state().toString()},__class__:Lb};var Mb=
function(){this.zpp_next=null;this.zpp_critical=!1;this.zpp_i=0;this.zpp_inner=null};h["nape.dynamics.ArbiterIterator"]=Mb;Mb.__name__=!0;Mb.get=function(a){var b;null==Mb.zpp_pool?(dd.internal=!0,b=new Mb,dd.internal=!1):(b=Mb.zpp_pool,Mb.zpp_pool=b.zpp_next);b.zpp_i=0;b.zpp_inner=a;b.zpp_critical=!1;return b};Mb.prototype={hasNext:function(){this.zpp_inner.zpp_inner.valmod();var a=this.zpp_inner.zpp_gl();this.zpp_critical=!0;if(this.zpp_i<a)return!0;this.zpp_next=Mb.zpp_pool;Mb.zpp_pool=this;this.zpp_inner=
null;return!1},next:function(){this.zpp_critical=!1;return this.zpp_inner.at(this.zpp_i++)},__class__:Mb};var Gg=function(){this.zpp_inner=null;this.zpp_inner=new dd;this.zpp_inner.outer=this};h["nape.dynamics.ArbiterList"]=Gg;Gg.__name__=!0;Gg.prototype={zpp_gl:function(){this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=!1;this.zpp_inner.user_length=0;for(var a=this.zpp_inner.inner.head;null!=a;)a.elt.active&&this.zpp_inner.user_length++,a=a.next}return this.zpp_inner.user_length},
zpp_vm:function(){this.zpp_inner.valmod()},at:function(a){this.zpp_vm();this.zpp_inner.reverse_flag&&(a=this.zpp_gl()-1-a);if(a<this.zpp_inner.at_index||null==this.zpp_inner.at_ite){this.zpp_inner.at_index=0;for(this.zpp_inner.at_ite=this.zpp_inner.inner.head;!this.zpp_inner.at_ite.elt.active;)this.zpp_inner.at_ite=this.zpp_inner.at_ite.next}for(;this.zpp_inner.at_index!=a;){this.zpp_inner.at_index++;for(this.zpp_inner.at_ite=this.zpp_inner.at_ite.next;!this.zpp_inner.at_ite.elt.active;)this.zpp_inner.at_ite=
this.zpp_inner.at_ite.next}return this.zpp_inner.at_ite.elt.wrapper()},iterator:function(){this.zpp_vm();return Mb.get(this)},toString:function(){for(var a="[",b=!0,c=this.iterator();c.hasNext();){var d;c.zpp_critical=!1;d=c.zpp_inner.at(c.zpp_i++);b||(a+=",");a=null==d?a+"NULL":a+d.toString();b=!1}return a+"]"},__class__:Gg};var de=function(){};h["nape.dynamics.ArbiterType"]=de;de.__name__=!0;de.prototype={toString:function(){var a;null==f.ArbiterType_COLLISION&&(f.internal=!0,f.ArbiterType_COLLISION=
new de,f.internal=!1);this==f.ArbiterType_COLLISION?a="COLLISION":(null==f.ArbiterType_SENSOR&&(f.internal=!0,f.ArbiterType_SENSOR=new de,f.internal=!1),this==f.ArbiterType_SENSOR?a="SENSOR":(null==f.ArbiterType_FLUID&&(f.internal=!0,f.ArbiterType_FLUID=new de,f.internal=!1),a=this==f.ArbiterType_FLUID?"FLUID":""));return a},__class__:de};var Af=function(){this.zpp_inner=null};h["nape.dynamics.CollisionArbiter"]=Af;Af.__name__=!0;Af.__super__=Lb;Af.prototype=w(Lb.prototype,{__class__:Af});var Hg=
function(){this.zpp_inner=null};h["nape.dynamics.Contact"]=Hg;Hg.__name__=!0;Hg.prototype={toString:function(){return null==this.zpp_inner.arbiter||this.zpp_inner.arbiter.cleared?"{object-pooled}":"{Contact}"},__class__:Hg};var vb=function(){this.zpp_next=null;this.zpp_critical=!1;this.zpp_i=0;this.zpp_inner=null};h["nape.dynamics.ContactIterator"]=vb;vb.__name__=!0;vb.get=function(a){var b;null==vb.zpp_pool?(Md.internal=!0,b=new vb,Md.internal=!1):(b=vb.zpp_pool,vb.zpp_pool=b.zpp_next);b.zpp_i=0;
b.zpp_inner=a;b.zpp_critical=!1;return b};vb.prototype={hasNext:function(){this.zpp_inner.zpp_inner.valmod();var a=this.zpp_inner.get_length();this.zpp_critical=!0;if(this.zpp_i<a)return!0;this.zpp_next=vb.zpp_pool;vb.zpp_pool=this;this.zpp_inner=null;return!1},next:function(){this.zpp_critical=!1;return this.zpp_inner.at(this.zpp_i++)},__class__:vb};var jh=function(){this.zpp_inner=null};h["nape.dynamics.ContactList"]=jh;jh.__name__=!0;jh.prototype={get_length:function(){this.zpp_inner.valmod();
if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=!1;this.zpp_inner.user_length=0;for(var a=this.zpp_inner.inner.next;null!=a;){var b=a;b.active&&b.arbiter.active&&this.zpp_inner.user_length++;a=a.next}}return this.zpp_inner.user_length},at:function(a){this.zpp_inner.valmod();this.zpp_inner.reverse_flag&&(a=this.get_length()-1-a);if(a<this.zpp_inner.at_index||null==this.zpp_inner.at_ite){this.zpp_inner.at_index=0;for(this.zpp_inner.at_ite=this.zpp_inner.inner.next;;){var b=this.zpp_inner.at_ite;
if(b.active&&b.arbiter.active)break;this.zpp_inner.at_ite=this.zpp_inner.at_ite.next}}for(;this.zpp_inner.at_index!=a;){this.zpp_inner.at_index++;for(this.zpp_inner.at_ite=this.zpp_inner.at_ite.next;;){b=this.zpp_inner.at_ite;if(b.active&&b.arbiter.active)break;this.zpp_inner.at_ite=this.zpp_inner.at_ite.next}}return this.zpp_inner.at_ite.wrapper()},toString:function(){var a="[",b=!0,c;this.zpp_inner.valmod();for(c=vb.get(this);c.hasNext();){var d;c.zpp_critical=!1;d=c.zpp_inner.at(c.zpp_i++);b||
(a+=",");a=null==d?a+"NULL":a+d.toString();b=!1}return a+"]"},__class__:jh};var Bf=function(){this.zpp_inner=null};h["nape.dynamics.FluidArbiter"]=Bf;Bf.__name__=!0;Bf.__super__=Lb;Bf.prototype=w(Lb.prototype,{__class__:Bf});var ob=function(a,b,c,d,e,i){null==i&&(i=-1);null==e&&(e=1);null==d&&(d=-1);null==c&&(c=1);null==b&&(b=-1);null==a&&(a=1);this.zpp_inner=null;null==ya.zpp_pool?this.zpp_inner=new ya:(this.zpp_inner=ya.zpp_pool,ya.zpp_pool=this.zpp_inner.next,this.zpp_inner.next=null);null;this.zpp_inner.outer=
this;this.zpp_inner.collisionGroup!=a&&(this.zpp_inner.collisionGroup=a,this.zpp_inner.invalidate());this.zpp_inner.collisionGroup;this.zpp_inner.collisionMask!=b&&(this.zpp_inner.collisionMask=b,this.zpp_inner.invalidate());this.zpp_inner.collisionMask;this.zpp_inner.sensorGroup!=c&&(this.zpp_inner.sensorGroup=c,this.zpp_inner.invalidate());this.zpp_inner.sensorGroup;this.zpp_inner.sensorMask!=d&&(this.zpp_inner.sensorMask=d,this.zpp_inner.invalidate());this.zpp_inner.sensorMask;this.zpp_inner.fluidGroup!=
e&&(this.zpp_inner.fluidGroup=e,this.zpp_inner.invalidate());this.zpp_inner.fluidGroup;this.zpp_inner.fluidMask!=i&&(this.zpp_inner.fluidMask=i,this.zpp_inner.invalidate());this.zpp_inner.fluidMask};h["nape.dynamics.InteractionFilter"]=ob;ob.__name__=!0;ob.prototype={__class__:ob};var kh=function(){this.zpp_inner=null};h["nape.dynamics.InteractionGroup"]=kh;kh.__name__=!0;kh.prototype={toString:function(){var a="InteractionGroup";this.zpp_inner.ignore&&(a+=":ignore");return a},__class__:kh};var Nb=
function(){this.zpp_next=null;this.zpp_critical=!1;this.zpp_i=0;this.zpp_inner=null};h["nape.dynamics.InteractionGroupIterator"]=Nb;Nb.__name__=!0;Nb.get=function(a){var b;null==Nb.zpp_pool?(ee.internal=!0,b=new Nb,ee.internal=!1):(b=Nb.zpp_pool,Nb.zpp_pool=b.zpp_next);b.zpp_i=0;b.zpp_inner=a;b.zpp_critical=!1;return b};Nb.prototype={hasNext:function(){this.zpp_inner.zpp_inner.valmod();var a=this.zpp_inner.get_length();this.zpp_critical=!0;if(this.zpp_i<a)return!0;this.zpp_next=Nb.zpp_pool;Nb.zpp_pool=
this;this.zpp_inner=null;return!1},next:function(){this.zpp_critical=!1;return this.zpp_inner.at(this.zpp_i++)},__class__:Nb};var lh=function(){this.zpp_inner=null};h["nape.dynamics.InteractionGroupList"]=lh;lh.__name__=!0;lh.prototype={get_length:function(){this.zpp_inner.valmod();this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length);return this.zpp_inner.user_length},at:function(a){this.zpp_inner.valmod();this.zpp_inner.reverse_flag&&(a=
this.get_length()-1-a);if(a<this.zpp_inner.at_index||null==this.zpp_inner.at_ite)this.zpp_inner.at_index=a,this.zpp_inner.at_ite=this.zpp_inner.inner.iterator_at(a);else for(;this.zpp_inner.at_index!=a;)this.zpp_inner.at_index++,this.zpp_inner.at_ite=this.zpp_inner.at_ite.next;return this.zpp_inner.at_ite.elt.outer},toString:function(){var a="[",b=!0,c;this.zpp_inner.valmod();for(c=Nb.get(this);c.hasNext();){var d;c.zpp_critical=!1;d=c.zpp_inner.at(c.zpp_i++);b||(a+=",");a=null==d?a+"NULL":a+d.toString();
b=!1}return a+"]"},__class__:lh};var mh=function(){this.zpp_inner=null};h["nape.geom.AABB"]=mh;mh.__name__=!0;mh.prototype={toString:function(){this.zpp_inner.validate();return this.zpp_inner.toString()},__class__:mh};var nh=function(){this.zpp_inner=null};h["nape.geom.ConvexResult"]=nh;nh.__name__=!0;nh.prototype={toString:function(){return"{ shape: "+D.string(this.zpp_inner.shape)+" toi: "+this.zpp_inner.toiDistance+" }"},__class__:nh};var vc=function(){this.zpp_next=null;this.zpp_critical=!1;this.zpp_i=
0;this.zpp_inner=null};h["nape.geom.ConvexResultIterator"]=vc;vc.__name__=!0;vc.get=function(a){var b;null==vc.zpp_pool?(yd.internal=!0,b=new vc,yd.internal=!1):(b=vc.zpp_pool,vc.zpp_pool=b.zpp_next);b.zpp_i=0;b.zpp_inner=a;b.zpp_critical=!1;return b};vc.prototype={hasNext:function(){this.zpp_inner.zpp_inner.valmod();var a=this.zpp_inner.get_length();this.zpp_critical=!0;if(this.zpp_i<a)return!0;this.zpp_next=vc.zpp_pool;vc.zpp_pool=this;this.zpp_inner=null;return!1},next:function(){this.zpp_critical=
!1;return this.zpp_inner.at(this.zpp_i++)},__class__:vc};var oh=function(){this.zpp_inner=null};h["nape.geom.ConvexResultList"]=oh;oh.__name__=!0;oh.prototype={get_length:function(){this.zpp_inner.valmod();this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length);return this.zpp_inner.user_length},at:function(a){this.zpp_inner.valmod();this.zpp_inner.reverse_flag&&(a=this.get_length()-1-a);if(a<this.zpp_inner.at_index||null==this.zpp_inner.at_ite)this.zpp_inner.at_index=
a,this.zpp_inner.at_ite=this.zpp_inner.inner.iterator_at(a);else for(;this.zpp_inner.at_index!=a;)this.zpp_inner.at_index++,this.zpp_inner.at_ite=this.zpp_inner.at_ite.next;return this.zpp_inner.at_ite.elt},toString:function(){var a="[",b=!0,c;this.zpp_inner.valmod();for(c=vc.get(this);c.hasNext();){var d;c.zpp_critical=!1;d=c.zpp_inner.at(c.zpp_i++);b||(a+=",");a=null==d?a+"NULL":a+d.toString();b=!1}return a+"]"},__class__:oh};var Ig=function(){this.zpp_inner=null};h["nape.geom.GeomPoly"]=Ig;Ig.__name__=
!0;Ig.prototype={toString:function(){var a="GeomPoly[",b=this.zpp_inner.vertices,c=this.zpp_inner.vertices;if(null!=b){do{var d=b;d!=this.zpp_inner.vertices&&(a+=",");a+="{"+d.x+","+d.y+"}";b=b.next}while(b!=c)}return a+"]"},__class__:Ig};var wc=function(){this.zpp_next=null;this.zpp_critical=!1;this.zpp_i=0;this.zpp_inner=null};h["nape.geom.GeomPolyIterator"]=wc;wc.__name__=!0;wc.get=function(a){var b;null==wc.zpp_pool?(ed.internal=!0,b=new wc,ed.internal=!1):(b=wc.zpp_pool,wc.zpp_pool=b.zpp_next);
b.zpp_i=0;b.zpp_inner=a;b.zpp_critical=!1;return b};wc.prototype={hasNext:function(){this.zpp_inner.zpp_inner.valmod();var a=this.zpp_inner.get_length();this.zpp_critical=!0;if(this.zpp_i<a)return!0;this.zpp_next=wc.zpp_pool;wc.zpp_pool=this;this.zpp_inner=null;return!1},next:function(){this.zpp_critical=!1;return this.zpp_inner.at(this.zpp_i++)},__class__:wc};var ph=function(){this.zpp_inner=null};h["nape.geom.GeomPolyList"]=ph;ph.__name__=!0;ph.prototype={get_length:function(){this.zpp_inner.valmod();
this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length);return this.zpp_inner.user_length},at:function(a){this.zpp_inner.valmod();this.zpp_inner.reverse_flag&&(a=this.get_length()-1-a);if(a<this.zpp_inner.at_index||null==this.zpp_inner.at_ite)this.zpp_inner.at_index=a,this.zpp_inner.at_ite=this.zpp_inner.inner.iterator_at(a);else for(;this.zpp_inner.at_index!=a;)this.zpp_inner.at_index++,this.zpp_inner.at_ite=this.zpp_inner.at_ite.next;return this.zpp_inner.at_ite.elt.outer},
toString:function(){var a="[",b=!0,c;this.zpp_inner.valmod();for(c=wc.get(this);c.hasNext();){var d;c.zpp_critical=!1;d=c.zpp_inner.at(c.zpp_i++);b||(a+=",");a=null==d?a+"NULL":a+d.toString();b=!1}return a+"]"},__class__:ph};var qh=function(){this.zpp_inner=null};h["nape.geom.Mat23"]=qh;qh.__name__=!0;qh.prototype={toString:function(){return"{ a: "+this.zpp_inner.a+" b: "+this.zpp_inner.b+" c: "+this.zpp_inner.c+" d: "+this.zpp_inner.d+" tx: "+this.zpp_inner.tx+" ty: "+this.zpp_inner.ty+" }"},__class__:qh};
var rh=function(){this.zpp_inner=null};h["nape.geom.MatMN"]=rh;rh.__name__=!0;rh.prototype={toString:function(){for(var a="{ ",b=!0,c=0,d=this.zpp_inner.m;c<d;){var e=c++;b||(a+="; ");for(var b=!1,i=0,f=this.zpp_inner.n;i<f;)var l=i++,a=a+(this.zpp_inner.x[e*this.zpp_inner.n+l]+" ")}return a+"}"},__class__:rh};var sh=function(){this.zpp_inner=null};h["nape.geom.RayResult"]=sh;sh.__name__=!0;sh.prototype={toString:function(){return"{ shape: "+D.string(this.zpp_inner.shape)+" distance: "+this.zpp_inner.toiDistance+
" ?inner: "+D.string(this.zpp_inner.inner)+" }"},__class__:sh};var dc=function(){this.zpp_next=null;this.zpp_critical=!1;this.zpp_i=0;this.zpp_inner=null};h["nape.geom.RayResultIterator"]=dc;dc.__name__=!0;dc.get=function(a){var b;null==dc.zpp_pool?(fe.internal=!0,b=new dc,fe.internal=!1):(b=dc.zpp_pool,dc.zpp_pool=b.zpp_next);b.zpp_i=0;b.zpp_inner=a;b.zpp_critical=!1;return b};dc.prototype={hasNext:function(){this.zpp_inner.zpp_inner.valmod();var a=this.zpp_inner.get_length();this.zpp_critical=!0;
if(this.zpp_i<a)return!0;this.zpp_next=dc.zpp_pool;dc.zpp_pool=this;this.zpp_inner=null;return!1},next:function(){this.zpp_critical=!1;return this.zpp_inner.at(this.zpp_i++)},__class__:dc};var th=function(){this.zpp_inner=null};h["nape.geom.RayResultList"]=th;th.__name__=!0;th.prototype={get_length:function(){this.zpp_inner.valmod();this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length);return this.zpp_inner.user_length},at:function(a){this.zpp_inner.valmod();
this.zpp_inner.reverse_flag&&(a=this.get_length()-1-a);if(a<this.zpp_inner.at_index||null==this.zpp_inner.at_ite)this.zpp_inner.at_index=a,this.zpp_inner.at_ite=this.zpp_inner.inner.iterator_at(a);else for(;this.zpp_inner.at_index!=a;)this.zpp_inner.at_index++,this.zpp_inner.at_ite=this.zpp_inner.at_ite.next;return this.zpp_inner.at_ite.elt},toString:function(){var a="[",b=!0,c;this.zpp_inner.valmod();for(c=dc.get(this);c.hasNext();){var d;c.zpp_critical=!1;d=c.zpp_inner.at(c.zpp_i++);b||(a+=",");
a=null==d?a+"NULL":a+d.toString();b=!1}return a+"]"},__class__:th};var B=function(a,b){null==b&&(b=0);null==a&&(a=0);this.zpp_inner=this.zpp_pool=null;this.zpp_inner=M.get(a,b,null);this.zpp_inner.outer=this};h["nape.geom.Vec2"]=B;B.__name__=!0;B.weak=function(a,b){null==b&&(b=0);null==a&&(a=0);return B.get(a,b,!0)};B.get=function(a,b,c){null==c&&(c=!1);null==b&&(b=0);null==a&&(a=0);var d;null==zd.poolVec2?d=new B:(d=zd.poolVec2,zd.poolVec2=d.zpp_pool,d.zpp_pool=null);if(null==d.zpp_inner)d.zpp_inner=
M.get(a,b,null),d.zpp_inner.outer=d;else{var e;d.zpp_inner.validate();if(e=d.zpp_inner.x==a)d.zpp_inner.validate(),e=d.zpp_inner.y==b;e||(d.zpp_inner.x=a,d.zpp_inner.y=b,d.zpp_inner.invalidate());d}d.zpp_inner.weak=c;return d};B.distance=function(a,b){var c=Math.sqrt(kb.vec_dsq(function(){a.zpp_inner.validate();return a.zpp_inner.x}(this),function(){a.zpp_inner.validate();return a.zpp_inner.y}(this),function(){b.zpp_inner.validate();return b.zpp_inner.x}(this),function(){b.zpp_inner.validate();return b.zpp_inner.y}(this)));
a.zpp_inner.weak?(a.dispose(),!0):!1;b.zpp_inner.weak?(b.dispose(),!0):!1;return c};B.prototype={dispose:function(){var a=this.zpp_inner;this.zpp_inner=this.zpp_inner.outer=null;this.zpp_pool=zd.poolVec2;zd.poolVec2=this;null!=a.outer&&(a.outer.zpp_inner=null,a.outer=null);a._isimmutable=null;a._validate=null;a._invalidate=null;a.next=M.zpp_pool;M.zpp_pool=a},get_x:function(){this.zpp_inner.validate();return this.zpp_inner.x},set_x:function(a){this.zpp_inner.validate();this.zpp_inner.x!=a&&(this.zpp_inner.x=
a,this.zpp_inner.invalidate());this.zpp_inner.validate();return this.zpp_inner.x},get_y:function(){this.zpp_inner.validate();return this.zpp_inner.y},set_y:function(a){this.zpp_inner.validate();this.zpp_inner.y!=a&&(this.zpp_inner.y=a,this.zpp_inner.invalidate());this.zpp_inner.validate();return this.zpp_inner.y},get_length:function(){return Math.sqrt(function(a){a.zpp_inner.validate();return a.zpp_inner.x}(this)*function(a){a.zpp_inner.validate();return a.zpp_inner.x}(this)+function(a){a.zpp_inner.validate();
return a.zpp_inner.y}(this)*function(a){a.zpp_inner.validate();return a.zpp_inner.y}(this))},lsq:function(){var a;this.zpp_inner.validate();a=this.zpp_inner.x;this.zpp_inner.validate();a*=this.zpp_inner.x;var b;this.zpp_inner.validate();b=this.zpp_inner.y;this.zpp_inner.validate();return a+b*this.zpp_inner.y},set:function(a){var b=this.setxy(function(){a.zpp_inner.validate();return a.zpp_inner.x}(this),function(){a.zpp_inner.validate();return a.zpp_inner.y}(this));a.zpp_inner.weak?(a.dispose(),!0):
!1;return b},setxy:function(a,b){var c;this.zpp_inner.validate();if(c=this.zpp_inner.x==a)this.zpp_inner.validate(),c=this.zpp_inner.y==b;c||(this.zpp_inner.x=a,this.zpp_inner.y=b,this.zpp_inner.invalidate());return this},mul:function(a,b){null==b&&(b=!1);return B.get(function(a){a.zpp_inner.validate();return a.zpp_inner.x}(this)*a,function(a){a.zpp_inner.validate();return a.zpp_inner.y}(this)*a,b)},subeq:function(a){this.setxy(function(a){a.zpp_inner.validate();return a.zpp_inner.x}(this)-function(){a.zpp_inner.validate();
return a.zpp_inner.x}(this),function(a){a.zpp_inner.validate();return a.zpp_inner.y}(this)-function(){a.zpp_inner.validate();return a.zpp_inner.y}(this));a.zpp_inner.weak?(a.dispose(),!0):!1;return this},toString:function(){this.zpp_inner.validate();return this.zpp_inner.toString()},__class__:B};var ec=function(){this.zpp_next=null;this.zpp_critical=!1;this.zpp_i=0;this.zpp_inner=null};h["nape.geom.Vec2Iterator"]=ec;ec.__name__=!0;ec.get=function(a){var b;null==ec.zpp_pool?(xc.internal=!0,b=new ec,
xc.internal=!1):(b=ec.zpp_pool,ec.zpp_pool=b.zpp_next);b.zpp_i=0;b.zpp_inner=a;b.zpp_critical=!1;return b};ec.prototype={hasNext:function(){this.zpp_inner.zpp_inner.valmod();var a=this.zpp_inner.zpp_gl();this.zpp_critical=!0;if(this.zpp_i<a)return!0;this.zpp_next=ec.zpp_pool;ec.zpp_pool=this;this.zpp_inner=null;return!1},next:function(){this.zpp_critical=!1;return this.zpp_inner.at(this.zpp_i++)},__class__:ec};var fd=function(){this.zpp_inner=null;this.zpp_inner=new xc;this.zpp_inner.outer=this};
h["nape.geom.Vec2List"]=fd;fd.__name__=!0;fd.prototype={zpp_gl:function(){this.zpp_inner.valmod();this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length);return this.zpp_inner.user_length},zpp_vm:function(){this.zpp_inner.valmod()},at:function(a){this.zpp_vm();this.zpp_inner.reverse_flag&&(a=this.zpp_gl()-1-a);if(a<this.zpp_inner.at_index||null==this.zpp_inner.at_ite)this.zpp_inner.at_index=a,this.zpp_inner.at_ite=this.zpp_inner.inner.iterator_at(a);
else for(;this.zpp_inner.at_index!=a;)this.zpp_inner.at_index++,this.zpp_inner.at_ite=this.zpp_inner.at_ite.next;return this.zpp_inner.at_ite.elt.wrapper()},push:function(a){this.zpp_inner.modify_test();this.zpp_vm();var b;if(b=null!=this.zpp_inner.adder?this.zpp_inner.adder(a):!0)this.zpp_inner.reverse_flag?this.zpp_inner.inner.add(a.zpp_inner):(null==this.zpp_inner.push_ite&&(this.zpp_inner.push_ite=this.empty()?null:this.zpp_inner.inner.iterator_at(this.zpp_gl()-1)),this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,
a.zpp_inner)),this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(a);return b},empty:function(){return 0==this.zpp_gl()},iterator:function(){this.zpp_vm();return ec.get(this)},toString:function(){for(var a="[",b=!0,c=this.iterator();c.hasNext();){var d;c.zpp_critical=!1;d=c.zpp_inner.at(c.zpp_i++);b||(a+=",");a=null==d?a+"NULL":a+d.toString();b=!1}return a+"]"},__class__:fd};var uh=function(){this.zpp_inner=null};h["nape.geom.Vec3"]=uh;uh.__name__=!0;uh.prototype=
{toString:function(){this.zpp_inner.validate();var a="{ x: "+this.zpp_inner.x+" y: ";this.zpp_inner.validate();a=a+this.zpp_inner.y+" z: ";this.zpp_inner.validate();return a+this.zpp_inner.z+" }"},__class__:uh};var gd=function(){};h["nape.geom.Winding"]=gd;gd.__name__=!0;gd.prototype={toString:function(){var a;null==f.Winding_UNDEFINED&&(f.internal=!0,f.Winding_UNDEFINED=new gd,f.internal=!1);this==f.Winding_UNDEFINED?a="UNDEFINED":(null==f.Winding_CLOCKWISE&&(f.internal=!0,f.Winding_CLOCKWISE=new gd,
f.internal=!1),this==f.Winding_CLOCKWISE?a="CLOCKWISE":(null==f.Winding_ANTICLOCKWISE&&(f.internal=!0,f.Winding_ANTICLOCKWISE=new gd,f.internal=!1),a=this==f.Winding_ANTICLOCKWISE?"ANTICLOCKWISE":""));return a},__class__:gd};var hd=function(){this.zpp_inner_i=null};h["nape.phys.Interactor"]=hd;hd.__name__=!0;hd.prototype={get_userData:function(){null==this.zpp_inner_i.userData&&(this.zpp_inner_i.userData={});return this.zpp_inner_i.userData},get_castBody:function(){return null!=this.zpp_inner_i.ibody?
this.zpp_inner_i.ibody.outer:null},get_cbTypes:function(){null==this.zpp_inner_i.wrap_cbTypes&&this.zpp_inner_i.setupcbTypes();return this.zpp_inner_i.wrap_cbTypes},toString:function(){return""},__class__:hd};var Rc=function(a,b){this.zpp_inner_i=this.zpp_inner=null;this.zpp_inner=new yc;this.zpp_inner.outer=this;this.zpp_inner.outer_i=this;this.zpp_inner_i=this.zpp_inner;null!=b?(b.zpp_inner.validate(),this.zpp_inner.posx=b.zpp_inner.x,b.zpp_inner.validate(),this.zpp_inner.posy=b.zpp_inner.y):(this.zpp_inner.posx=
0,this.zpp_inner.posy=0);this.set_type(null==a?function(){null==f.BodyType_DYNAMIC&&(f.internal=!0,f.BodyType_DYNAMIC=new Ga,f.internal=!1);return f.BodyType_DYNAMIC}(this):a);null!=b&&(b.zpp_inner.weak?(b.dispose(),!0):!1);this.zpp_inner_i.insert_cbtype(wa.ANY_BODY.zpp_inner)};h["nape.phys.Body"]=Rc;Rc.__name__=!0;Rc.__super__=hd;Rc.prototype=w(hd.prototype,{set_type:function(a){this.zpp_inner.immutable_midstep("Body::type");yc.types[this.zpp_inner.type]!=a&&(null==f.BodyType_DYNAMIC&&(f.internal=
!0,f.BodyType_DYNAMIC=new Ga,f.internal=!1),a==f.BodyType_DYNAMIC?a=f.id_BodyType_DYNAMIC:(null==f.BodyType_KINEMATIC&&(f.internal=!0,f.BodyType_KINEMATIC=new Ga,f.internal=!1),a=a==f.BodyType_KINEMATIC?f.id_BodyType_KINEMATIC:f.id_BodyType_STATIC),a==f.id_BodyType_STATIC&&null!=this.zpp_inner.space&&(this.zpp_inner.velx=0,this.zpp_inner.vely=0,this.zpp_inner.angvel=0),this.zpp_inner.invalidate_type(),null!=this.zpp_inner.space?this.zpp_inner.space.transmitType(this.zpp_inner,a):this.zpp_inner.type=
a);return yc.types[this.zpp_inner.type]},set_compound:function(a){if((null==this.zpp_inner.compound?null:this.zpp_inner.compound.outer)!=a){if(null!=(null==this.zpp_inner.compound?null:this.zpp_inner.compound.outer))(null==this.zpp_inner.compound?null:this.zpp_inner.compound.outer).zpp_inner.wrap_bodies.remove(this);null!=a&&a.zpp_inner.wrap_bodies.add(this)}return null==this.zpp_inner.compound?null:this.zpp_inner.compound.outer},set_space:function(a){this.zpp_inner.immutable_midstep("Body::space");
if((null==this.zpp_inner.space?null:this.zpp_inner.space.outer)!=a){if(null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer))this.zpp_inner.component.woken=!1;if(null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer))(null==this.zpp_inner.space?null:this.zpp_inner.space.outer).zpp_inner.wrap_bodies.remove(this);null!=a&&a.zpp_inner.wrap_bodies.add(this)}return null==this.zpp_inner.space?null:this.zpp_inner.space.outer},copy:function(){return this.zpp_inner.copy()},get_position:function(){null==
this.zpp_inner.wrap_pos&&this.zpp_inner.setupPosition();return this.zpp_inner.wrap_pos},set_position:function(a){null==this.zpp_inner.wrap_pos&&this.zpp_inner.setupPosition();this.zpp_inner.wrap_pos.set(a);null==this.zpp_inner.wrap_pos&&this.zpp_inner.setupPosition();return this.zpp_inner.wrap_pos},get_velocity:function(){null==this.zpp_inner.wrap_vel&&this.zpp_inner.setupVelocity();return this.zpp_inner.wrap_vel},set_rotation:function(a){this.zpp_inner.immutable_midstep("Body::rotation");this.zpp_inner.rot!=
a&&(this.zpp_inner.rot=a,this.zpp_inner.invalidate_rot(),this.zpp_inner.wake());return this.zpp_inner.rot},localPointToWorld:function(a,b){null==b&&(b=!1);this.zpp_inner.validate_axis();var c=0,d=0,c=this.zpp_inner.axisy;a.zpp_inner.validate();c*=a.zpp_inner.x;d=this.zpp_inner.axisx;a.zpp_inner.validate();c-=d*a.zpp_inner.y;a.zpp_inner.validate();d=a.zpp_inner.x*this.zpp_inner.axisx;a.zpp_inner.validate();d+=a.zpp_inner.y*this.zpp_inner.axisy;a.zpp_inner.weak?(a.dispose(),!0):!1;return B.get(c+this.zpp_inner.posx,
d+this.zpp_inner.posy,b)},worldPointToLocal:function(a,b){null==b&&(b=!1);this.zpp_inner.validate_axis();var c=0,d=0,e=d=0;a.zpp_inner.validate();d=a.zpp_inner.x-this.zpp_inner.posx;a.zpp_inner.validate();e=a.zpp_inner.y-this.zpp_inner.posy;c=d*this.zpp_inner.axisy+e*this.zpp_inner.axisx;d=e*this.zpp_inner.axisy-d*this.zpp_inner.axisx;a.zpp_inner.weak?(a.dispose(),!0):!1;return B.get(c,d,b)},localVectorToWorld:function(a,b){null==b&&(b=!1);this.zpp_inner.validate_axis();var c=0,d=0,c=this.zpp_inner.axisy;
a.zpp_inner.validate();c*=a.zpp_inner.x;d=this.zpp_inner.axisx;a.zpp_inner.validate();c-=d*a.zpp_inner.y;a.zpp_inner.validate();d=a.zpp_inner.x*this.zpp_inner.axisx;a.zpp_inner.validate();d+=a.zpp_inner.y*this.zpp_inner.axisy;a.zpp_inner.weak?(a.dispose(),!0):!1;return B.get(c,d,b)},applyImpulse:function(a,b,c){null==c&&(c=!1);if(c&&this.zpp_inner.component.sleeping)return a.zpp_inner.weak?(a.dispose(),!0):!1,null!=b&&(b.zpp_inner.weak?(b.dispose(),!0):!1),this;this.zpp_inner.validate_mass();var d=
this.zpp_inner.imass,e=this.zpp_inner,i=this.zpp_inner.velx;a.zpp_inner.validate();e.velx=i+a.zpp_inner.x*d;e=this.zpp_inner;i=this.zpp_inner.vely;a.zpp_inner.validate();e.vely=i+a.zpp_inner.y*d;if(null!=b){var k=0,d=0;b.zpp_inner.validate();k=b.zpp_inner.x-this.zpp_inner.posx;b.zpp_inner.validate();d=b.zpp_inner.y-this.zpp_inner.posy;this.zpp_inner.validate_inertia();e=this.zpp_inner;i=this.zpp_inner.angvel;a.zpp_inner.validate();k*=a.zpp_inner.y;a.zpp_inner.validate();e.angvel=i+(k-a.zpp_inner.x*
d)*this.zpp_inner.iinertia;b.zpp_inner.weak?(b.dispose(),!0):!1}c||this.zpp_inner.type==f.id_BodyType_DYNAMIC&&this.zpp_inner.wake();a.zpp_inner.weak?(a.dispose(),!0):!1;return this},translateShapes:function(a){this.zpp_inner.immutable_midstep("Body::translateShapes()");var b=a.zpp_inner.weak;a.zpp_inner.weak=!1;for(var c=this.zpp_inner.shapes.head;null!=c;)c.elt.outer.translate(a),c=c.next;a.zpp_inner.weak=b;a.zpp_inner.weak?(a.dispose(),!0):!1;return this},scaleShapes:function(a,b){this.zpp_inner.immutable_midstep("Body::scaleShapes()");
for(var c=this.zpp_inner.shapes.head;null!=c;)c.elt.outer.scale(a,b),c=c.next;return this},align:function(){this.zpp_inner.immutable_midstep("Body::align()");this.zpp_inner.validate_localCOM();var a=B.get(-this.zpp_inner.localCOMx,-this.zpp_inner.localCOMy,null);this.translateShapes(a);var b=this.localVectorToWorld(a);null==this.zpp_inner.wrap_pos&&this.zpp_inner.setupPosition();this.zpp_inner.wrap_pos.subeq(b);if(Infinity>this.zpp_inner.pre_posx){var c=this.zpp_inner,d=this.zpp_inner.pre_posx;b.zpp_inner.validate();
c.pre_posx=d-1*b.zpp_inner.x;c=this.zpp_inner;d=this.zpp_inner.pre_posy;b.zpp_inner.validate();c.pre_posy=d-1*b.zpp_inner.y}a.dispose();b.dispose();return this},setShapeMaterials:function(a){this.zpp_inner.immutable_midstep("Body::setShapeMaterials()");for(var b=this.zpp_inner.shapes.head;null!=b;)b.elt.outer.set_material(a),b=b.next;return this},setShapeFilters:function(a){this.zpp_inner.immutable_midstep("Body::setShapeFilters()");for(var b=this.zpp_inner.shapes.head;null!=b;)b.elt.outer.set_filter(a),
b=b.next;return this},setShapeFluidProperties:function(a){this.zpp_inner.immutable_midstep("Body::setShapeFluidProperties()");for(var b=this.zpp_inner.shapes.head;null!=b;)b.elt.outer.set_fluidProperties(a),b=b.next;return this},toString:function(){return(this.zpp_inner.world?"(space::world":"("+(this.zpp_inner.type==f.id_BodyType_DYNAMIC?"dynamic":this.zpp_inner.type==f.id_BodyType_STATIC?"static":"kinematic"))+")#"+this.zpp_inner_i.id},__class__:Rc});var fc=function(){this.zpp_next=null;this.zpp_critical=
!1;this.zpp_i=0;this.zpp_inner=null};h["nape.phys.BodyIterator"]=fc;fc.__name__=!0;fc.get=function(a){var b;null==fc.zpp_pool?(zc.internal=!0,b=new fc,zc.internal=!1):(b=fc.zpp_pool,fc.zpp_pool=b.zpp_next);b.zpp_i=0;b.zpp_inner=a;b.zpp_critical=!1;return b};fc.prototype={hasNext:function(){this.zpp_inner.zpp_inner.valmod();var a=this.zpp_inner.get_length();this.zpp_critical=!0;if(this.zpp_i<a)return!0;this.zpp_next=fc.zpp_pool;fc.zpp_pool=this;this.zpp_inner=null;return!1},next:function(){this.zpp_critical=
!1;return this.zpp_inner.at(this.zpp_i++)},__class__:fc};var ge=function(){this.zpp_inner=null;this.zpp_inner=new zc;this.zpp_inner.outer=this};h["nape.phys.BodyList"]=ge;ge.__name__=!0;ge.prototype={get_length:function(){this.zpp_inner.valmod();this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length);return this.zpp_inner.user_length},has:function(a){this.zpp_inner.valmod();return this.zpp_inner.inner.has(a.zpp_inner)},at:function(a){this.zpp_inner.valmod();
this.zpp_inner.reverse_flag&&(a=this.get_length()-1-a);if(a<this.zpp_inner.at_index||null==this.zpp_inner.at_ite)this.zpp_inner.at_index=a,this.zpp_inner.at_ite=this.zpp_inner.inner.iterator_at(a);else for(;this.zpp_inner.at_index!=a;)this.zpp_inner.at_index++,this.zpp_inner.at_ite=this.zpp_inner.at_ite.next;return this.zpp_inner.at_ite.elt.outer},push:function(a){this.zpp_inner.modify_test();this.zpp_inner.valmod();var b;if(b=null!=this.zpp_inner.adder?this.zpp_inner.adder(a):!0)this.zpp_inner.reverse_flag?
this.zpp_inner.inner.add(a.zpp_inner):(null==this.zpp_inner.push_ite&&(this.zpp_inner.push_ite=null==this.zpp_inner.inner.head?null:this.zpp_inner.inner.iterator_at(this.get_length()-1)),this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,a.zpp_inner)),this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(a);return b},unshift:function(a){this.zpp_inner.modify_test();this.zpp_inner.valmod();var b;if(b=null!=this.zpp_inner.adder?this.zpp_inner.adder(a):
!0)this.zpp_inner.reverse_flag?(null==this.zpp_inner.push_ite&&(this.zpp_inner.push_ite=null==this.zpp_inner.inner.head?null:this.zpp_inner.inner.iterator_at(this.get_length()-1)),this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,a.zpp_inner)):this.zpp_inner.inner.add(a.zpp_inner),this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(a);return b},add:function(a){return this.zpp_inner.reverse_flag?this.push(a):this.unshift(a)},remove:function(a){this.zpp_inner.modify_test();
this.zpp_inner.valmod();var b;b=!1;for(var c=this.zpp_inner.inner.head;null!=c;){if(c.elt==a.zpp_inner){b=!0;break}c=c.next}b&&(null!=this.zpp_inner.subber&&this.zpp_inner.subber(a),this.zpp_inner.dontremove||this.zpp_inner.inner.remove(a.zpp_inner),this.zpp_inner.invalidate());return b},iterator:function(){this.zpp_inner.valmod();return fc.get(this)},toString:function(){var a="[",b=!0,c;this.zpp_inner.valmod();for(c=fc.get(this);c.hasNext();){var d;c.zpp_critical=!1;d=c.zpp_inner.at(c.zpp_i++);b||
(a+=",");a=null==d?a+"NULL":a+d.toString();b=!1}return a+"]"},__class__:ge};var Ga=function(){};h["nape.phys.BodyType"]=Ga;Ga.__name__=!0;Ga.prototype={toString:function(){var a;null==f.BodyType_STATIC&&(f.internal=!0,f.BodyType_STATIC=new Ga,f.internal=!1);this==f.BodyType_STATIC?a="STATIC":(null==f.BodyType_DYNAMIC&&(f.internal=!0,f.BodyType_DYNAMIC=new Ga,f.internal=!1),this==f.BodyType_DYNAMIC?a="DYNAMIC":(null==f.BodyType_KINEMATIC&&(f.internal=!0,f.BodyType_KINEMATIC=new Ga,f.internal=!1),a=
this==f.BodyType_KINEMATIC?"KINEMATIC":""));return a},__class__:Ga};var Fd=function(){this.zpp_inner_i=this.zpp_inner=null;this.zpp_inner=new Cf;this.zpp_inner.outer=this;this.zpp_inner.outer_i=this;this.zpp_inner_i=this.zpp_inner;this.zpp_inner.insert_cbtype(wa.ANY_COMPOUND.zpp_inner)};h["nape.phys.Compound"]=Fd;Fd.__name__=!0;Fd.__super__=hd;Fd.prototype=w(hd.prototype,{set_space:function(a){this.zpp_inner.immutable_midstep("Compound::space");if((null==this.zpp_inner.space?null:this.zpp_inner.space.outer)!=
a){if(null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer))(null==this.zpp_inner.space?null:this.zpp_inner.space.outer).zpp_inner.wrap_compounds.remove(this);null!=a&&a.zpp_inner.wrap_compounds.add(this)}return null==this.zpp_inner.space?null:this.zpp_inner.space.outer},toString:function(){return"Compound"+this.zpp_inner_i.id},__class__:Fd});var Ob=function(){this.zpp_next=null;this.zpp_critical=!1;this.zpp_i=0;this.zpp_inner=null};h["nape.phys.CompoundIterator"]=Ob;Ob.__name__=!0;Ob.get=
function(a){var b;null==Ob.zpp_pool?(Vc.internal=!0,b=new Ob,Vc.internal=!1):(b=Ob.zpp_pool,Ob.zpp_pool=b.zpp_next);b.zpp_i=0;b.zpp_inner=a;b.zpp_critical=!1;return b};Ob.prototype={hasNext:function(){this.zpp_inner.zpp_inner.valmod();var a=this.zpp_inner.get_length();this.zpp_critical=!0;if(this.zpp_i<a)return!0;this.zpp_next=Ob.zpp_pool;Ob.zpp_pool=this;this.zpp_inner=null;return!1},next:function(){this.zpp_critical=!1;return this.zpp_inner.at(this.zpp_i++)},__class__:Ob};var Jg=function(){this.zpp_inner=
null;this.zpp_inner=new Vc;this.zpp_inner.outer=this};h["nape.phys.CompoundList"]=Jg;Jg.__name__=!0;Jg.prototype={get_length:function(){this.zpp_inner.valmod();this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length);return this.zpp_inner.user_length},at:function(a){this.zpp_inner.valmod();this.zpp_inner.reverse_flag&&(a=this.get_length()-1-a);if(a<this.zpp_inner.at_index||null==this.zpp_inner.at_ite)this.zpp_inner.at_index=a,this.zpp_inner.at_ite=
this.zpp_inner.inner.iterator_at(a);else for(;this.zpp_inner.at_index!=a;)this.zpp_inner.at_index++,this.zpp_inner.at_ite=this.zpp_inner.at_ite.next;return this.zpp_inner.at_ite.elt.outer},push:function(a){this.zpp_inner.modify_test();this.zpp_inner.valmod();var b;if(b=null!=this.zpp_inner.adder?this.zpp_inner.adder(a):!0)this.zpp_inner.reverse_flag?this.zpp_inner.inner.add(a.zpp_inner):(null==this.zpp_inner.push_ite&&(this.zpp_inner.push_ite=null==this.zpp_inner.inner.head?null:this.zpp_inner.inner.iterator_at(this.get_length()-
1)),this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,a.zpp_inner)),this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(a);return b},unshift:function(a){this.zpp_inner.modify_test();this.zpp_inner.valmod();var b;if(b=null!=this.zpp_inner.adder?this.zpp_inner.adder(a):!0)this.zpp_inner.reverse_flag?(null==this.zpp_inner.push_ite&&(this.zpp_inner.push_ite=null==this.zpp_inner.inner.head?null:this.zpp_inner.inner.iterator_at(this.get_length()-
1)),this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,a.zpp_inner)):this.zpp_inner.inner.add(a.zpp_inner),this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(a);return b},add:function(a){return this.zpp_inner.reverse_flag?this.push(a):this.unshift(a)},remove:function(a){this.zpp_inner.modify_test();this.zpp_inner.valmod();var b;b=!1;for(var c=this.zpp_inner.inner.head;null!=c;){if(c.elt==a.zpp_inner){b=!0;break}c=c.next}b&&(null!=this.zpp_inner.subber&&
this.zpp_inner.subber(a),this.zpp_inner.dontremove||this.zpp_inner.inner.remove(a.zpp_inner),this.zpp_inner.invalidate());return b},toString:function(){var a="[",b=!0,c;this.zpp_inner.valmod();for(c=Ob.get(this);c.hasNext();){var d;c.zpp_critical=!1;d=c.zpp_inner.at(c.zpp_i++);b||(a+=",");a=null==d?a+"NULL":a+d.toString();b=!1}return a+"]"},__class__:Jg};var Fb=function(a,b){null==b&&(b=1);null==a&&(a=1);this.zpp_inner=null;null==id.zpp_pool?this.zpp_inner=new id:(this.zpp_inner=id.zpp_pool,id.zpp_pool=
this.zpp_inner.next,this.zpp_inner.next=null);null;this.zpp_inner.outer=this;a!=1E3*this.zpp_inner.density&&(this.zpp_inner.density=a/1E3,this.zpp_inner.invalidate());1E3*this.zpp_inner.density;b!=this.zpp_inner.viscosity&&(this.zpp_inner.viscosity=b/1,this.zpp_inner.invalidate());this.zpp_inner.viscosity};h["nape.phys.FluidProperties"]=Fb;Fb.__name__=!0;Fb.prototype={toString:function(){return"{ density: "+1E3*this.zpp_inner.density+" viscosity: "+this.zpp_inner.viscosity+" gravity: "+D.string(this.zpp_inner.wrap_gravity)+
" }"},__class__:Fb};var he=function(){};h["nape.phys.GravMassMode"]=he;he.__name__=!0;he.prototype={toString:function(){var a;null==f.GravMassMode_DEFAULT&&(f.internal=!0,f.GravMassMode_DEFAULT=new he,f.internal=!1);this==f.GravMassMode_DEFAULT?a="DEFAULT":(null==f.GravMassMode_FIXED&&(f.internal=!0,f.GravMassMode_FIXED=new he,f.internal=!1),this==f.GravMassMode_FIXED?a="FIXED":(null==f.GravMassMode_SCALED&&(f.internal=!0,f.GravMassMode_SCALED=new he,f.internal=!1),a=this==f.GravMassMode_SCALED?"SCALED":
""));return a},__class__:he};var Df=function(){};h["nape.phys.InertiaMode"]=Df;Df.__name__=!0;Df.prototype={toString:function(){var a;null==f.InertiaMode_DEFAULT&&(f.internal=!0,f.InertiaMode_DEFAULT=new Df,f.internal=!1);this==f.InertiaMode_DEFAULT?a="DEFAULT":(null==f.InertiaMode_FIXED&&(f.internal=!0,f.InertiaMode_FIXED=new Df,f.internal=!1),a=this==f.InertiaMode_FIXED?"FIXED":"");return a},__class__:Df};var bb=function(){this.zpp_next=null;this.zpp_critical=!1;this.zpp_i=0;this.zpp_inner=null};
h["nape.phys.InteractorIterator"]=bb;bb.__name__=!0;bb.get=function(a){var b;null==bb.zpp_pool?(ie.internal=!0,b=new bb,ie.internal=!1):(b=bb.zpp_pool,bb.zpp_pool=b.zpp_next);b.zpp_i=0;b.zpp_inner=a;b.zpp_critical=!1;return b};bb.prototype={hasNext:function(){this.zpp_inner.zpp_inner.valmod();var a=this.zpp_inner.get_length();this.zpp_critical=!0;if(this.zpp_i<a)return!0;this.zpp_next=bb.zpp_pool;bb.zpp_pool=this;this.zpp_inner=null;return!1},next:function(){this.zpp_critical=!1;return this.zpp_inner.at(this.zpp_i++)},
__class__:bb};var vh=function(){this.zpp_inner=null};h["nape.phys.InteractorList"]=vh;vh.__name__=!0;vh.prototype={get_length:function(){this.zpp_inner.valmod();this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length);return this.zpp_inner.user_length},at:function(a){this.zpp_inner.valmod();this.zpp_inner.reverse_flag&&(a=this.get_length()-1-a);if(a<this.zpp_inner.at_index||null==this.zpp_inner.at_ite)this.zpp_inner.at_index=a,this.zpp_inner.at_ite=
this.zpp_inner.inner.iterator_at(a);else for(;this.zpp_inner.at_index!=a;)this.zpp_inner.at_index++,this.zpp_inner.at_ite=this.zpp_inner.at_ite.next;return this.zpp_inner.at_ite.elt.outer_i},toString:function(){var a="[",b=!0,c;this.zpp_inner.valmod();for(c=bb.get(this);c.hasNext();){var d;c.zpp_critical=!1;d=c.zpp_inner.at(c.zpp_i++);b||(a+=",");a=null==d?a+"NULL":a+d.toString();b=!1}return a+"]"},__class__:vh};var Ef=function(){};h["nape.phys.MassMode"]=Ef;Ef.__name__=!0;Ef.prototype={toString:function(){var a;
null==f.MassMode_DEFAULT&&(f.internal=!0,f.MassMode_DEFAULT=new Ef,f.internal=!1);this==f.MassMode_DEFAULT?a="DEFAULT":(null==f.MassMode_FIXED&&(f.internal=!0,f.MassMode_FIXED=new Ef,f.internal=!1),a=this==f.MassMode_FIXED?"FIXED":"");return a},__class__:Ef};var Ba=function(a,b,c,d,e){null==e&&(e=0.0010);null==d&&(d=1);null==c&&(c=2);null==b&&(b=1);null==a&&(a=0);this.zpp_inner=null;null==N.zpp_pool?this.zpp_inner=new N:(this.zpp_inner=N.zpp_pool,N.zpp_pool=this.zpp_inner.next,this.zpp_inner.next=
null);null;this.zpp_inner.outer=this;a!=this.zpp_inner.elasticity&&(this.zpp_inner.elasticity=a/1,this.zpp_inner.invalidate(N.WAKE|N.ARBITERS));this.zpp_inner.elasticity;b!=this.zpp_inner.dynamicFriction&&(this.zpp_inner.dynamicFriction=b/1,this.zpp_inner.invalidate(N.WAKE|N.ANGDRAG|N.ARBITERS));this.zpp_inner.dynamicFriction;c!=this.zpp_inner.staticFriction&&(this.zpp_inner.staticFriction=c/1,this.zpp_inner.invalidate(N.WAKE|N.ARBITERS));this.zpp_inner.staticFriction;d!=1E3*this.zpp_inner.density&&
(this.zpp_inner.density=d/1E3,this.zpp_inner.invalidate(N.WAKE|N.PROPS));1E3*this.zpp_inner.density;e!=this.zpp_inner.rollingFriction&&(this.zpp_inner.rollingFriction=e/1,this.zpp_inner.invalidate(N.WAKE|N.ARBITERS));this.zpp_inner.rollingFriction};h["nape.phys.Material"]=Ba;Ba.__name__=!0;Ba.wood=function(){return new Ba(0.4,0.2,0.38,0.7,0.0050)};Ba.steel=function(){return new Ba(0.2,0.57,0.74,7.8,0.0010)};Ba.ice=function(){return new Ba(0.3,0.03,0.1,0.9,1.0E-4)};Ba.rubber=function(){return new Ba(0.8,
1,1.4,1.5,0.01)};Ba.prototype={toString:function(){return"{ elasticity: "+this.zpp_inner.elasticity+" dynamicFriction: "+this.zpp_inner.dynamicFriction+" staticFriction: "+this.zpp_inner.staticFriction+" density: "+1E3*this.zpp_inner.density+" rollingFriction: "+this.zpp_inner.rollingFriction+" }"},__class__:Ba};var Wc=function(){this.zpp_inner_i=this.zpp_inner=null};h["nape.shape.Shape"]=Wc;Wc.__name__=!0;Wc.__super__=hd;Wc.prototype=w(hd.prototype,{set_material:function(a){this.zpp_inner.immutable_midstep("Shape::material");
this.zpp_inner.setMaterial(a.zpp_inner);return this.zpp_inner.material.wrapper()},set_filter:function(a){this.zpp_inner.immutable_midstep("Shape::filter");this.zpp_inner.setFilter(a.zpp_inner);return this.zpp_inner.filter.wrapper()},set_fluidProperties:function(a){this.zpp_inner.setFluid(a.zpp_inner);this.zpp_inner.immutable_midstep("Shape::fluidProperties");null==this.zpp_inner.fluidProperties&&this.zpp_inner.setFluid((new Fb).zpp_inner);return this.zpp_inner.fluidProperties.wrapper()},set_fluidEnabled:function(a){this.zpp_inner.immutable_midstep("Shape::fluidEnabled");
(this.zpp_inner.fluidEnabled=a)&&null==this.zpp_inner.fluidProperties&&this.set_fluidProperties(new Fb);this.zpp_inner.wake();return this.zpp_inner.fluidEnabled},translate:function(a){this.zpp_inner.immutable_midstep("Shape::translate()");0<a.lsq()&&(this.zpp_inner.type==f.id_ShapeType_CIRCLE?this.zpp_inner.circle.__translate(function(){a.zpp_inner.validate();return a.zpp_inner.x}(this),function(){a.zpp_inner.validate();return a.zpp_inner.y}(this)):this.zpp_inner.polygon.__translate(function(){a.zpp_inner.validate();
return a.zpp_inner.x}(this),function(){a.zpp_inner.validate();return a.zpp_inner.y}(this)));a.zpp_inner.weak?(a.dispose(),!0):!1;return this},scale:function(a,b){this.zpp_inner.immutable_midstep("Shape::scale()");if(this.zpp_inner.type==f.id_ShapeType_CIRCLE){var c=a*a-b*b;c*c<m.epsilon*m.epsilon&&this.zpp_inner.circle.__scale(a,b)}else this.zpp_inner.polygon.__scale(a,b);return this},copy:function(){return this.zpp_inner.copy()},toString:function(){return(this.zpp_inner.type==f.id_ShapeType_CIRCLE?
"Circle":"Polygon")+"#"+this.zpp_inner_i.id},__class__:Wc});var Gf=function(a,b,c,d){this.zpp_inner_zn=null;Wc.call(this);this.zpp_inner_zn=new Ff;this.zpp_inner_zn.outer=this;this.zpp_inner_zn.outer_zn=this;this.zpp_inner_i=this.zpp_inner=this.zpp_inner_zn;this.zpp_inner_i.outer_i=this;this.zpp_inner.immutable_midstep("Circle::radius");a!=this.zpp_inner_zn.radius&&(this.zpp_inner_zn.radius=a,this.zpp_inner_zn.invalidate_radius());this.zpp_inner_zn.radius;null==b?(this.zpp_inner.localCOMx=0,this.zpp_inner.localCOMy=
0):(b.zpp_inner.validate(),this.zpp_inner.localCOMx=b.zpp_inner.x,b.zpp_inner.validate(),this.zpp_inner.localCOMy=b.zpp_inner.y,b.zpp_inner.weak?(b.dispose(),!0):!1);null==c?(null==N.zpp_pool?this.zpp_inner.material=new N:(this.zpp_inner.material=N.zpp_pool,N.zpp_pool=this.zpp_inner.material.next,this.zpp_inner.material.next=null),null):(this.zpp_inner.immutable_midstep("Shape::material"),this.zpp_inner.setMaterial(c.zpp_inner),this.zpp_inner.material.wrapper());null==d?(null==ya.zpp_pool?this.zpp_inner.filter=
new ya:(this.zpp_inner.filter=ya.zpp_pool,ya.zpp_pool=this.zpp_inner.filter.next,this.zpp_inner.filter.next=null),null):(this.zpp_inner.immutable_midstep("Shape::filter"),this.zpp_inner.setFilter(d.zpp_inner),this.zpp_inner.filter.wrapper());this.zpp_inner_i.insert_cbtype(wa.ANY_SHAPE.zpp_inner)};h["nape.shape.Circle"]=Gf;Gf.__name__=!0;Gf.__super__=Wc;Gf.prototype=w(Wc.prototype,{__class__:Gf});var Kg=function(){this.zpp_inner=null};h["nape.shape.Edge"]=Kg;Kg.__name__=!0;Kg.prototype={toString:function(){if(null==
this.zpp_inner.polygon)return"Edge(object-pooled)";if(null==this.zpp_inner.polygon.body)return this.zpp_inner.polygon.validate_laxi(),"{ localNormal : "+("{ x: "+this.zpp_inner.lnormx+" y: "+this.zpp_inner.lnormy+" }")+" }";this.zpp_inner.polygon.validate_gaxi();return"{ localNormal : "+("{ x: "+this.zpp_inner.lnormx+" y: "+this.zpp_inner.lnormy+" }")+" worldNormal : "+("{ x: "+this.zpp_inner.gnormx+" y: "+this.zpp_inner.gnormy+" }")+" }"},__class__:Kg};var R=function(){this.zpp_next=null;this.zpp_critical=
!1;this.zpp_i=0;this.zpp_inner=null};h["nape.shape.EdgeIterator"]=R;R.__name__=!0;R.get=function(a){var b;null==R.zpp_pool?(ue.internal=!0,b=new R,ue.internal=!1):(b=R.zpp_pool,R.zpp_pool=b.zpp_next);b.zpp_i=0;b.zpp_inner=a;b.zpp_critical=!1;return b};R.prototype={hasNext:function(){this.zpp_inner.zpp_inner.valmod();var a=this.zpp_inner.get_length();this.zpp_critical=!0;if(this.zpp_i<a)return!0;this.zpp_next=R.zpp_pool;R.zpp_pool=this;this.zpp_inner=null;return!1},next:function(){this.zpp_critical=
!1;return this.zpp_inner.at(this.zpp_i++)},__class__:R};var wh=function(){this.zpp_inner=null};h["nape.shape.EdgeList"]=wh;wh.__name__=!0;wh.prototype={get_length:function(){this.zpp_inner.valmod();this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length);return this.zpp_inner.user_length},at:function(a){this.zpp_inner.valmod();this.zpp_inner.reverse_flag&&a!=this.get_length()-1&&(a=this.get_length()-2-a);if(a<this.zpp_inner.at_index||null==this.zpp_inner.at_ite)this.zpp_inner.at_index=
a,this.zpp_inner.at_ite=this.zpp_inner.inner.iterator_at(a);else for(;this.zpp_inner.at_index!=a;)this.zpp_inner.at_index++,this.zpp_inner.at_ite=this.zpp_inner.at_ite.next;return this.zpp_inner.at_ite.elt.wrapper()},toString:function(){var a="[",b=!0,c;this.zpp_inner.valmod();for(c=R.get(this);c.hasNext();){var d;c.zpp_critical=!1;d=c.zpp_inner.at(c.zpp_i++);b||(a+=",");a=null==d?a+"NULL":a+d.toString();b=!1}return a+"]"},__class__:wh};var sc=function(a,b,c){this.zpp_inner_zn=null;Wc.call(this);
this.zpp_inner_zn=new Hf;this.zpp_inner_zn.outer=this;this.zpp_inner_zn.outer_zn=this;this.zpp_inner_i=this.zpp_inner=this.zpp_inner_zn;this.zpp_inner_i.outer_i=this;if(a instanceof Array&&null==a.__enum__)for(var d=0;d<a.length;){var e=a[d];++d;var i=e;null==this.zpp_inner_zn.wrap_lverts&&this.zpp_inner_zn.getlverts();this.zpp_inner_zn.wrap_lverts.push(B.get(function(){i.zpp_inner.validate();return i.zpp_inner.x}(this),function(){i.zpp_inner.validate();return i.zpp_inner.y}(this),!1))}else if(Z.__instanceof(a,
fd))for(d=a.iterator();d.hasNext();){var f;d.zpp_critical=!1;f=d.zpp_inner.at(d.zpp_i++);null==this.zpp_inner_zn.wrap_lverts&&this.zpp_inner_zn.getlverts();this.zpp_inner_zn.wrap_lverts.push(B.get(function(){f.zpp_inner.validate();return f.zpp_inner.x}(this),function(){f.zpp_inner.validate();return f.zpp_inner.y}(this),!1))}else if(Z.__instanceof(a,Ig)&&(d=a.zpp_inner.vertices,null!=d)){e=d;do{var l=B.get(e.x,e.y,null),e=e.next;null==this.zpp_inner_zn.wrap_lverts&&this.zpp_inner_zn.getlverts();this.zpp_inner_zn.wrap_lverts.push(B.get(function(){l.zpp_inner.validate();
return l.zpp_inner.x}(this),function(){l.zpp_inner.validate();return l.zpp_inner.y}(this),!1));l.dispose()}while(e!=d)}if(a instanceof Array&&null==a.__enum__)for(d=0;d<a.length;){var e=a[d],j;if(j=e.zpp_inner.weak)e.dispose(),j=!0;j?a.splice(d,1):d++}else if(Z.__instanceof(a,fd)){null!=a.zpp_inner._validate&&a.zpp_inner._validate();a=a.zpp_inner.inner;d=null;for(e=a.head;null!=e;)j=e.elt,j.outer.zpp_inner.weak?(e=a.erase(d),j.outer.zpp_inner.weak?(j.outer.dispose(),!0):!1):(d=e,e=e.next)}null==b?
(null==N.zpp_pool?this.zpp_inner.material=new N:(this.zpp_inner.material=N.zpp_pool,N.zpp_pool=this.zpp_inner.material.next,this.zpp_inner.material.next=null),null):(this.zpp_inner.immutable_midstep("Shape::material"),this.zpp_inner.setMaterial(b.zpp_inner),this.zpp_inner.material.wrapper());null==c?(null==ya.zpp_pool?this.zpp_inner.filter=new ya:(this.zpp_inner.filter=ya.zpp_pool,ya.zpp_pool=this.zpp_inner.filter.next,this.zpp_inner.filter.next=null),null):(this.zpp_inner.immutable_midstep("Shape::filter"),
this.zpp_inner.setFilter(c.zpp_inner),this.zpp_inner.filter.wrapper());this.zpp_inner_i.insert_cbtype(wa.ANY_SHAPE.zpp_inner)};h["nape.shape.Polygon"]=sc;sc.__name__=!0;sc.rect=function(a,b,c,d,e){null==e&&(e=!1);return[B.get(a,b,e),B.get(a+c,b,e),B.get(a+c,b+d,e),B.get(a,b+d,e)]};sc.__super__=Wc;sc.prototype=w(Wc.prototype,{get_localVerts:function(){null==this.zpp_inner_zn.wrap_lverts&&this.zpp_inner_zn.getlverts();return this.zpp_inner_zn.wrap_lverts},__class__:sc});var rb=function(){this.zpp_next=
null;this.zpp_critical=!1;this.zpp_i=0;this.zpp_inner=null};h["nape.shape.ShapeIterator"]=rb;rb.__name__=!0;rb.get=function(a){var b;null==rb.zpp_pool?(jd.internal=!0,b=new rb,jd.internal=!1):(b=rb.zpp_pool,rb.zpp_pool=b.zpp_next);b.zpp_i=0;b.zpp_inner=a;b.zpp_critical=!1;return b};rb.prototype={hasNext:function(){this.zpp_inner.zpp_inner.valmod();var a=this.zpp_inner.get_length();this.zpp_critical=!0;if(this.zpp_i<a)return!0;this.zpp_next=rb.zpp_pool;rb.zpp_pool=this;this.zpp_inner=null;return!1},
next:function(){this.zpp_critical=!1;return this.zpp_inner.at(this.zpp_i++)},__class__:rb};var Lg=function(){this.zpp_inner=null;this.zpp_inner=new jd;this.zpp_inner.outer=this};h["nape.shape.ShapeList"]=Lg;Lg.__name__=!0;Lg.prototype={get_length:function(){this.zpp_inner.valmod();this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length);return this.zpp_inner.user_length},at:function(a){this.zpp_inner.valmod();this.zpp_inner.reverse_flag&&(a=
this.get_length()-1-a);if(a<this.zpp_inner.at_index||null==this.zpp_inner.at_ite)this.zpp_inner.at_index=a,this.zpp_inner.at_ite=this.zpp_inner.inner.iterator_at(a);else for(;this.zpp_inner.at_index!=a;)this.zpp_inner.at_index++,this.zpp_inner.at_ite=this.zpp_inner.at_ite.next;return this.zpp_inner.at_ite.elt.outer},push:function(a){this.zpp_inner.modify_test();this.zpp_inner.valmod();var b;if(b=null!=this.zpp_inner.adder?this.zpp_inner.adder(a):!0)this.zpp_inner.reverse_flag?this.zpp_inner.inner.add(a.zpp_inner):
(null==this.zpp_inner.push_ite&&(this.zpp_inner.push_ite=null==this.zpp_inner.inner.head?null:this.zpp_inner.inner.iterator_at(this.get_length()-1)),this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,a.zpp_inner)),this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(a);return b},unshift:function(a){this.zpp_inner.modify_test();this.zpp_inner.valmod();var b;if(b=null!=this.zpp_inner.adder?this.zpp_inner.adder(a):!0)this.zpp_inner.reverse_flag?
(null==this.zpp_inner.push_ite&&(this.zpp_inner.push_ite=null==this.zpp_inner.inner.head?null:this.zpp_inner.inner.iterator_at(this.get_length()-1)),this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,a.zpp_inner)):this.zpp_inner.inner.add(a.zpp_inner),this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(a);return b},add:function(a){return this.zpp_inner.reverse_flag?this.push(a):this.unshift(a)},remove:function(a){this.zpp_inner.modify_test();
this.zpp_inner.valmod();var b;b=!1;for(var c=this.zpp_inner.inner.head;null!=c;){if(c.elt==a.zpp_inner){b=!0;break}c=c.next}b&&(null!=this.zpp_inner.subber&&this.zpp_inner.subber(a),this.zpp_inner.dontremove||this.zpp_inner.inner.remove(a.zpp_inner),this.zpp_inner.invalidate());return b},iterator:function(){this.zpp_inner.valmod();return rb.get(this)},toString:function(){var a="[",b=!0,c;this.zpp_inner.valmod();for(c=rb.get(this);c.hasNext();){var d;c.zpp_critical=!1;d=c.zpp_inner.at(c.zpp_i++);b||
(a+=",");a=null==d?a+"NULL":a+d.toString();b=!1}return a+"]"},__class__:Lg};var If=function(){};h["nape.shape.ShapeType"]=If;If.__name__=!0;If.prototype={toString:function(){var a;null==f.ShapeType_CIRCLE&&(f.internal=!0,f.ShapeType_CIRCLE=new If,f.internal=!1);this==f.ShapeType_CIRCLE?a="CIRCLE":(null==f.ShapeType_POLYGON&&(f.internal=!0,f.ShapeType_POLYGON=new If,f.internal=!1),a=this==f.ShapeType_POLYGON?"POLYGON":"");return a},__class__:If};var Nd=function(){};h["nape.shape.ValidationResult"]=
Nd;Nd.__name__=!0;Nd.prototype={toString:function(){var a;null==f.ValidationResult_VALID&&(f.internal=!0,f.ValidationResult_VALID=new Nd,f.internal=!1);this==f.ValidationResult_VALID?a="VALID":(null==f.ValidationResult_DEGENERATE&&(f.internal=!0,f.ValidationResult_DEGENERATE=new Nd,f.internal=!1),this==f.ValidationResult_DEGENERATE?a="DEGENERATE":(null==f.ValidationResult_CONCAVE&&(f.internal=!0,f.ValidationResult_CONCAVE=new Nd,f.internal=!1),this==f.ValidationResult_CONCAVE?a="CONCAVE":(null==f.ValidationResult_SELF_INTERSECTING&&
(f.internal=!0,f.ValidationResult_SELF_INTERSECTING=new Nd,f.internal=!1),a=this==f.ValidationResult_SELF_INTERSECTING?"SELF_INTERSECTING":"")));return a},__class__:Nd};var Xc=function(){};h["nape.space.Broadphase"]=Xc;Xc.__name__=!0;Xc.prototype={toString:function(){var a;null==f.Broadphase_DYNAMIC_AABB_TREE&&(f.internal=!0,f.Broadphase_DYNAMIC_AABB_TREE=new Xc,f.internal=!1);this==f.Broadphase_DYNAMIC_AABB_TREE?a="DYNAMIC_AABB_TREE":(null==f.Broadphase_SWEEP_AND_PRUNE&&(f.internal=!0,f.Broadphase_SWEEP_AND_PRUNE=
new Xc,f.internal=!1),a=this==f.Broadphase_SWEEP_AND_PRUNE?"SWEEP_AND_PRUNE":"");return a},__class__:Xc};var mg=function(a,b){this.zpp_inner=null;this.zpp_inner=new Mg(null==a?null:a.zpp_inner,b);this.zpp_inner.outer=this;null!=a&&(a.zpp_inner.weak?(a.dispose(),!0):!1)};h["nape.space.Space"]=mg;mg.__name__=!0;mg.prototype={get_gravity:function(){null==this.zpp_inner.wrap_gravity&&this.zpp_inner.getgravity();return this.zpp_inner.wrap_gravity},step:function(a,b,c){null==c&&(c=10);null==b&&(b=10);this.zpp_inner.step(a,
b,c)},bodiesUnderPoint:function(a,b,c){b=this.zpp_inner.bodiesUnderPoint(function(){a.zpp_inner.validate();return a.zpp_inner.x}(this),function(){a.zpp_inner.validate();return a.zpp_inner.y}(this),null==b?null:b.zpp_inner,c);a.zpp_inner.weak?(a.dispose(),!0):!1;return b},__class__:mg};var W=function(){};h["zpp_nape.ZPP_ID"]=W;W.__name__=!0;W.Constraint=function(){return W._Constraint++};W.Interactor=function(){return W._Interactor++};W.CbType=function(){return W._CbType++};W.CbSet=function(){return W._CbSet++};
W.Listener=function(){return W._Listener++};var Pb=function(){this.body=this.constraint=null;this.pre_swapped=!1;this.int1=this.int2=this.set=this.wrap_arbiters=this.pre_arbiter=null;this.length=0;this.listener=this.next=this.prev=null;this.event=0;this.outer_body=this.outer_con=this.outer_int=null;this.length=0};h["zpp_nape.callbacks.ZPP_Callback"]=Pb;Pb.__name__=!0;Pb.prototype={wrapper_body:function(){null==this.outer_body&&(this.outer_body=new tf,this.outer_body.zpp_inner=this);return this.outer_body},
wrapper_con:function(){null==this.outer_con&&(this.outer_con=new vf,this.outer_con.zpp_inner=this);return this.outer_con},wrapper_int:function(){null==this.outer_int&&(this.outer_int=new wf,this.outer_int.zpp_inner=this);null==this.wrap_arbiters?this.wrap_arbiters=dd.get(this.set.arbiters,!0):this.wrap_arbiters.zpp_inner.inner=this.set.arbiters;this.wrap_arbiters.zpp_inner.zip_length=!0;this.wrap_arbiters.zpp_inner.at_ite=null;return this.outer_int},push:function(a){null!=this.prev?this.prev.next=
a:this.next=a;a.prev=this.prev;a.next=null;this.prev=a;this.length++},pop:function(){var a=this.next;this.next=a.next;null==this.next?this.prev=null:this.next.prev=null;this.length--;return a},empty:function(){return null==this.next},__class__:Pb};var K=function(){this.interactors=this.constraints=null;this.zip_conlisteners=!1;this.conlisteners=null;this.zip_bodylisteners=!1;this.bodylisteners=null;this.zip_listeners=!1;this.manager=this.cbpairs=this.listeners=null;this.id=0;this.next=null;this.count=
0;this.cbTypes=null;this.cbTypes=new Qb;this.listeners=new Od;this.zip_listeners=!0;this.bodylisteners=new Jf;this.zip_bodylisteners=!0;this.conlisteners=new Kf;this.zip_conlisteners=!0;this.constraints=new gc;this.interactors=new Ac;this.id=W.CbSet();this.cbpairs=new Ng};h["zpp_nape.callbacks.ZPP_CbSet"]=K;K.__name__=!0;K.setlt=function(a,b){for(var c=a.cbTypes.head,d=b.cbTypes.head;null!=c&&null!=d;){var e=c.elt,i=d.elt;if(e.id<i.id)return!0;if(i.id<e.id)return!1;c=c.next;d=d.next}return null!=
d&&null==c};K.get=function(a){var b;null==K.zpp_pool?b=new K:(b=K.zpp_pool,K.zpp_pool=b.next,b.next=null);null;for(var c=null,a=a.head;null!=a;){var d=a.elt,c=b.cbTypes.insert(c,d);d.cbsets.add(b);a=a.next}return b};K.single_intersection=function(a,b,c){return a.manager.pair(a,b).single_intersection(c)};K.find_all=function(a,b,c,d){a.manager.pair(a,b).forall(c,d)};K.prototype={invalidate_pairs:function(){for(var a=this.cbpairs.head;null!=a;)a.elt.zip_listeners=!0,a=a.next},realvalidate_listeners:function(){this.listeners.clear();
for(var a=this.cbTypes.head;null!=a;){for(var b=null,c=this.listeners.head,d=a.elt.listeners.head;null!=d;){var e=d.elt;null!=c&&c.elt==e?(d=d.next,b=c,c=c.next):null==c||Va.setlt(e,c.elt)?(e.space==this.manager.space&&(b=this.listeners.inlined_insert(b,e)),d=d.next):(b=c,c=c.next)}a=a.next}},realvalidate_bodylisteners:function(){this.bodylisteners.clear();for(var a=this.cbTypes.head;null!=a;){for(var b=null,c=this.bodylisteners.head,d=a.elt.bodylisteners.head;null!=d;){var e=d.elt;null!=c&&c.elt==
e?(d=d.next,b=c,c=c.next):null==c||Va.setlt(e,c.elt)?(!e.options.excluded(this.cbTypes)&&e.space==this.manager.space&&(b=this.bodylisteners.inlined_insert(b,e)),d=d.next):(b=c,c=c.next)}a=a.next}},realvalidate_conlisteners:function(){this.conlisteners.clear();for(var a=this.cbTypes.head;null!=a;){for(var b=null,c=this.conlisteners.head,d=a.elt.conlisteners.head;null!=d;){var e=d.elt;null!=c&&c.elt==e?(d=d.next,b=c,c=c.next):null==c||Va.setlt(e,c.elt)?(!e.options.excluded(this.cbTypes)&&e.space==this.manager.space&&
(b=this.conlisteners.inlined_insert(b,e)),d=d.next):(b=c,c=c.next)}a=a.next}},validate:function(){this.zip_listeners&&(this.zip_listeners=!1,this.realvalidate_listeners());this.zip_bodylisteners&&(this.zip_bodylisteners=!1,this.realvalidate_bodylisteners());this.zip_conlisteners&&(this.zip_conlisteners=!1,this.realvalidate_conlisteners())},free:function(){this.listeners.clear();this.zip_listeners=!0;this.bodylisteners.clear();this.zip_bodylisteners=!0;this.conlisteners.clear();for(this.zip_conlisteners=
!0;null!=this.cbTypes.head;)this.cbTypes.pop_unsafe().cbsets.remove(this)},__class__:K};var ta=function(){this.listeners=null;this.zip_listeners=!1;this.a=this.b=this.next=null;this.listeners=new Od};h["zpp_nape.callbacks.ZPP_CbSetPair"]=ta;ta.__name__=!0;ta.get=function(a,b){var c;null==ta.zpp_pool?c=new ta:(c=ta.zpp_pool,ta.zpp_pool=c.next,c.next=null);c.zip_listeners=!0;K.setlt(a,b)?(c.a=a,c.b=b):(c.a=b,c.b=a);return c};ta.setlt=function(a,b){return K.setlt(a.a,b.a)||a.a==b.a&&K.setlt(a.b,b.b)};
ta.prototype={__validate:function(){this.listeners.clear();for(var a=this.a.listeners.head,b=this.b.listeners.head;null!=a&&null!=b;){var c=a.elt,d=b.elt;c==d?((c.options1.compatible(this.a.cbTypes)&&c.options2.compatible(this.b.cbTypes)||c.options2.compatible(this.a.cbTypes)&&c.options1.compatible(this.b.cbTypes))&&this.listeners.add(c),a=a.next,b=b.next):c.precedence>d.precedence||c.precedence==d.precedence&&c.id>d.id?a=a.next:b=b.next}},empty_intersection:function(){return null==this.listeners.head},
single_intersection:function(a){var b=this.listeners.head;return null!=b&&b.elt==a&&null==b.next},forall:function(a,b){for(var c=this.listeners.head;null!=c;){var d=c.elt;d.event==a&&b(d);c=c.next}},__class__:ta};var Od=function(){this.length=0;this.modified=this.pushmod=!1;this.head=null};h["zpp_nape.util.ZNPList_ZPP_InteractionListener"]=Od;Od.__name__=!0;Od.prototype={add:function(a){return this.inlined_add(a)},inlined_add:function(a){var b;null==cb.zpp_pool?b=new cb:(b=cb.zpp_pool,cb.zpp_pool=
b.next,b.next=null);null;b.elt=a;b.next=this.head;this.head=b;this.modified=!0;this.length++;return a},inlined_insert:function(a,b){var c;null==cb.zpp_pool?c=new cb:(c=cb.zpp_pool,cb.zpp_pool=c.next,c.next=null);null;c.elt=b;null==a?(c.next=this.head,this.head=c):(c.next=a.next,a.next=c);this.pushmod=this.modified=!0;this.length++;return c},inlined_pop:function(){var a=this.head;this.head=a.next;a.elt=null;a.next=cb.zpp_pool;cb.zpp_pool=a;null==this.head&&(this.pushmod=!0);this.modified=!0;this.length--},
remove:function(a){this.inlined_try_remove(a)},inlined_try_remove:function(a){for(var b=null,c=this.head,d=!1;null!=c;){if(c.elt==a){this.inlined_erase(b);d=!0;break}b=c;c=c.next}return d},inlined_erase:function(a){var b,c;null==a?(b=this.head,this.head=c=b.next,null==this.head&&(this.pushmod=!0)):(b=a.next,c=b.next,a.next=c,null==c&&(this.pushmod=!0));a=b;a.elt=null;a.next=cb.zpp_pool;cb.zpp_pool=a;this.modified=!0;this.length--;this.pushmod=!0;return c},clear:function(){for(;null!=this.head;)this.inlined_pop();
this.pushmod=!0},inlined_clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},__class__:Od};var Jf=function(){this.length=0;this.modified=this.pushmod=!1;this.head=null};h["zpp_nape.util.ZNPList_ZPP_BodyListener"]=Jf;Jf.__name__=!0;Jf.prototype={inlined_insert:function(a,b){var c;null==Rb.zpp_pool?c=new Rb:(c=Rb.zpp_pool,Rb.zpp_pool=c.next,c.next=null);null;c.elt=b;null==a?(c.next=this.head,this.head=c):(c.next=a.next,a.next=c);this.pushmod=this.modified=!0;this.length++;return c},
inlined_pop:function(){var a=this.head;this.head=a.next;a.elt=null;a.next=Rb.zpp_pool;Rb.zpp_pool=a;null==this.head&&(this.pushmod=!0);this.modified=!0;this.length--},remove:function(a){this.inlined_try_remove(a)},inlined_try_remove:function(a){for(var b=null,c=this.head,d=!1;null!=c;){if(c.elt==a){this.inlined_erase(b);d=!0;break}b=c;c=c.next}return d},inlined_erase:function(a){var b,c;null==a?(b=this.head,this.head=c=b.next,null==this.head&&(this.pushmod=!0)):(b=a.next,c=b.next,a.next=c,null==c&&
(this.pushmod=!0));a=b;a.elt=null;a.next=Rb.zpp_pool;Rb.zpp_pool=a;this.modified=!0;this.length--;this.pushmod=!0;return c},clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},__class__:Jf};var Kf=function(){this.length=0;this.modified=this.pushmod=!1;this.head=null};h["zpp_nape.util.ZNPList_ZPP_ConstraintListener"]=Kf;Kf.__name__=!0;Kf.prototype={inlined_insert:function(a,b){var c;null==Sb.zpp_pool?c=new Sb:(c=Sb.zpp_pool,Sb.zpp_pool=c.next,c.next=null);null;c.elt=b;null==
a?(c.next=this.head,this.head=c):(c.next=a.next,a.next=c);this.pushmod=this.modified=!0;this.length++;return c},inlined_pop:function(){var a=this.head;this.head=a.next;a.elt=null;a.next=Sb.zpp_pool;Sb.zpp_pool=a;null==this.head&&(this.pushmod=!0);this.modified=!0;this.length--},remove:function(a){this.inlined_try_remove(a)},inlined_try_remove:function(a){for(var b=null,c=this.head,d=!1;null!=c;){if(c.elt==a){this.inlined_erase(b);d=!0;break}b=c;c=c.next}return d},inlined_erase:function(a){var b,c;
null==a?(b=this.head,this.head=c=b.next,null==this.head&&(this.pushmod=!0)):(b=a.next,c=b.next,a.next=c,null==c&&(this.pushmod=!0));a=b;a.elt=null;a.next=Sb.zpp_pool;Sb.zpp_pool=a;this.modified=!0;this.length--;this.pushmod=!0;return c},clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},__class__:Kf};var gc=function(){this.length=0;this.modified=this.pushmod=!1;this.head=null};h["zpp_nape.util.ZNPList_ZPP_Constraint"]=gc;gc.__name__=!0;gc.prototype={add:function(a){return this.inlined_add(a)},
inlined_add:function(a){var b;null==za.zpp_pool?b=new za:(b=za.zpp_pool,za.zpp_pool=b.next,b.next=null);null;b.elt=a;b.next=this.head;this.head=b;this.modified=!0;this.length++;return a},insert:function(a,b){return this.inlined_insert(a,b)},inlined_insert:function(a,b){var c;null==za.zpp_pool?c=new za:(c=za.zpp_pool,za.zpp_pool=c.next,c.next=null);null;c.elt=b;null==a?(c.next=this.head,this.head=c):(c.next=a.next,a.next=c);this.pushmod=this.modified=!0;this.length++;return c},pop:function(){this.inlined_pop()},
inlined_pop:function(){var a=this.head;this.head=a.next;a.elt=null;a.next=za.zpp_pool;za.zpp_pool=a;null==this.head&&(this.pushmod=!0);this.modified=!0;this.length--},inlined_pop_unsafe:function(){var a=this.head.elt;this.pop();return a},remove:function(a){this.inlined_try_remove(a)},inlined_try_remove:function(a){for(var b=null,c=this.head,d=!1;null!=c;){if(c.elt==a){this.inlined_erase(b);d=!0;break}b=c;c=c.next}return d},erase:function(a){return this.inlined_erase(a)},inlined_erase:function(a){var b,
c;null==a?(b=this.head,this.head=c=b.next,null==this.head&&(this.pushmod=!0)):(b=a.next,c=b.next,a.next=c,null==c&&(this.pushmod=!0));a=b;a.elt=null;a.next=za.zpp_pool;za.zpp_pool=a;this.modified=!0;this.length--;this.pushmod=!0;return c},iterator_at:function(a){for(var b=this.head;0<a--&&null!=b;)b=b.next;return b},__class__:gc};var Ac=function(){this.length=0;this.modified=this.pushmod=!1;this.head=null};h["zpp_nape.util.ZNPList_ZPP_Interactor"]=Ac;Ac.__name__=!0;Ac.prototype={add:function(a){return this.inlined_add(a)},
inlined_add:function(a){var b;null==Tb.zpp_pool?b=new Tb:(b=Tb.zpp_pool,Tb.zpp_pool=b.next,b.next=null);null;b.elt=a;b.next=this.head;this.head=b;this.modified=!0;this.length++;return a},pop:function(){this.inlined_pop()},inlined_pop:function(){var a=this.head;this.head=a.next;a.elt=null;a.next=Tb.zpp_pool;Tb.zpp_pool=a;null==this.head&&(this.pushmod=!0);this.modified=!0;this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var a=this.head.elt;this.pop();
return a},remove:function(a){this.inlined_try_remove(a)},inlined_try_remove:function(a){for(var b=null,c=this.head,d=!1;null!=c;){if(c.elt==a){this.inlined_erase(b);d=!0;break}b=c;c=c.next}return d},inlined_erase:function(a){var b,c;null==a?(b=this.head,this.head=c=b.next,null==this.head&&(this.pushmod=!0)):(b=a.next,c=b.next,a.next=c,null==c&&(this.pushmod=!0));a=b;a.elt=null;a.next=Tb.zpp_pool;Tb.zpp_pool=a;this.modified=!0;this.length--;this.pushmod=!0;return c},inlined_clear:function(){for(;null!=
this.head;)this.inlined_pop();this.pushmod=!0},iterator_at:function(a){for(var b=this.head;0<a--&&null!=b;)b=b.next;return b},__class__:Ac};var Pd=function(){this.length=0;this.modified=this.pushmod=!1;this.head=null};h["zpp_nape.util.ZNPList_ZPP_CbSet"]=Pd;Pd.__name__=!0;Pd.prototype={add:function(a){return this.inlined_add(a)},inlined_add:function(a){var b;null==Ub.zpp_pool?b=new Ub:(b=Ub.zpp_pool,Ub.zpp_pool=b.next,b.next=null);null;b.elt=a;b.next=this.head;this.head=b;this.modified=!0;this.length++;
return a},pop:function(){this.inlined_pop()},inlined_pop:function(){var a=this.head;this.head=a.next;a.elt=null;a.next=Ub.zpp_pool;Ub.zpp_pool=a;null==this.head&&(this.pushmod=!0);this.modified=!0;this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var a=this.head.elt;this.pop();return a},remove:function(a){this.inlined_try_remove(a)},inlined_try_remove:function(a){for(var b=null,c=this.head,d=!1;null!=c;){if(c.elt==a){this.inlined_erase(b);d=!0;break}b=
c;c=c.next}return d},inlined_erase:function(a){var b,c;null==a?(b=this.head,this.head=c=b.next,null==this.head&&(this.pushmod=!0)):(b=a.next,c=b.next,a.next=c,null==c&&(this.pushmod=!0));a=b;a.elt=null;a.next=Ub.zpp_pool;Ub.zpp_pool=a;this.modified=!0;this.length--;this.pushmod=!0;return c},__class__:Pd};var wa=function(){this.cbsets=this.listeners=this.bodylisteners=this.conlisteners=null;this.id=0;this.outer=null;this.id=W.CbType();this.listeners=new Od;this.bodylisteners=new Jf;this.conlisteners=
new Kf;this.constraints=new gc;this.interactors=new Ac;this.cbsets=new Pd};h["zpp_nape.callbacks.ZPP_CbType"]=wa;wa.__name__=!0;wa.prototype={addint:function(a){for(var b=null,c=this.listeners.head;null!=c;){var d=c.elt;if(a.precedence>d.precedence||a.precedence==d.precedence&&a.id>d.id)break;b=c;c=c.next}this.listeners.inlined_insert(b,a);this.invalidateint()},invalidateint:function(){for(var a=this.cbsets.head;null!=a;){var b=a.elt;b.zip_listeners=!0;b.invalidate_pairs();a=a.next}},addbody:function(a){for(var b=
null,c=this.bodylisteners.head;null!=c;){var d=c.elt;if(a.precedence>d.precedence||a.precedence==d.precedence&&a.id>d.id)break;b=c;c=c.next}this.bodylisteners.inlined_insert(b,a);this.invalidatebody()},invalidatebody:function(){for(var a=this.cbsets.head;null!=a;)a.elt.zip_bodylisteners=!0,a=a.next},addconstraint:function(a){for(var b=null,c=this.conlisteners.head;null!=c;){var d=c.elt;if(a.precedence>d.precedence||a.precedence==d.precedence&&a.id>d.id)break;b=c;c=c.next}this.conlisteners.inlined_insert(b,
a);this.invalidateconstraint()},invalidateconstraint:function(){for(var a=this.cbsets.head;null!=a;)a.elt.zip_conlisteners=!0,a=a.next},__class__:wa};var f=function(){};h["zpp_nape.util.ZPP_Flags"]=f;f.__name__=!0;var Va=function(){this.body=this.constraint=this.interaction=this.space=null;this.id=this.type=this.event=this.precedence=0;this.outer=null;this.id=W.Listener()};h["zpp_nape.callbacks.ZPP_Listener"]=Va;Va.__name__=!0;Va.setlt=function(a,b){return a.precedence>b.precedence||a.precedence==
b.precedence&&a.id>b.id};Va.prototype={addedToSpace:function(){},removedFromSpace:function(){},__class__:Va};var Og=function(){this.outer_zn=this.options=this.handler=null};h["zpp_nape.callbacks.ZPP_BodyListener"]=Og;Og.__name__=!0;Og.__super__=Va;Og.prototype=w(Va.prototype,{addedToSpace:function(){this.options.handler=q(this,this.cbtype_change);for(var a=this.options.includes.head;null!=a;)a.elt.addbody(this),a=a.next},removedFromSpace:function(){for(var a=this.options.includes.head;null!=a;){var b=
a.elt;b.bodylisteners.remove(this);b.invalidatebody();a=a.next}this.options.handler=null},cbtype_change:function(a,b,c){this.removedFromSpace();this.options.effect_change(a,b,c);this.addedToSpace()},__class__:Og});var Pg=function(){this.outer_zn=this.options=this.handler=null};h["zpp_nape.callbacks.ZPP_ConstraintListener"]=Pg;Pg.__name__=!0;Pg.__super__=Va;Pg.prototype=w(Va.prototype,{addedToSpace:function(){this.options.handler=q(this,this.cbtype_change);for(var a=this.options.includes.head;null!=
a;)a.elt.addconstraint(this),a=a.next},removedFromSpace:function(){for(var a=this.options.includes.head;null!=a;){var b=a.elt;b.conlisteners.remove(this);b.invalidateconstraint();a=a.next}this.options.handler=null},cbtype_change:function(a,b,c){this.removedFromSpace();this.options.effect_change(a,b,c);this.addedToSpace()},__class__:Pg});var Qb=function(){this.length=0;this.modified=this.pushmod=!1;this.head=null};h["zpp_nape.util.ZNPList_ZPP_CbType"]=Qb;Qb.__name__=!0;Qb.prototype={add:function(a){return this.inlined_add(a)},
inlined_add:function(a){var b;null==Fa.zpp_pool?b=new Fa:(b=Fa.zpp_pool,Fa.zpp_pool=b.next,b.next=null);null;b.elt=a;b.next=this.head;this.head=b;this.modified=!0;this.length++;return a},insert:function(a,b){return this.inlined_insert(a,b)},inlined_insert:function(a,b){var c;null==Fa.zpp_pool?c=new Fa:(c=Fa.zpp_pool,Fa.zpp_pool=c.next,c.next=null);null;c.elt=b;null==a?(c.next=this.head,this.head=c):(c.next=a.next,a.next=c);this.pushmod=this.modified=!0;this.length++;return c},pop:function(){this.inlined_pop()},
inlined_pop:function(){var a=this.head;this.head=a.next;a.elt=null;a.next=Fa.zpp_pool;Fa.zpp_pool=a;null==this.head&&(this.pushmod=!0);this.modified=!0;this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var a=this.head.elt;this.pop();return a},remove:function(a){this.inlined_try_remove(a)},inlined_try_remove:function(a){for(var b=null,c=this.head,d=!1;null!=c;){if(c.elt==a){this.inlined_erase(b);d=!0;break}b=c;c=c.next}return d},inlined_erase:function(a){var b,
c;null==a?(b=this.head,this.head=c=b.next,null==this.head&&(this.pushmod=!0)):(b=a.next,c=b.next,a.next=c,null==c&&(this.pushmod=!0));a=b;a.elt=null;a.next=Fa.zpp_pool;Fa.zpp_pool=a;this.modified=!0;this.length--;this.pushmod=!0;return c},clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},has:function(a){return this.inlined_has(a)},inlined_has:function(a){var b;b=!1;for(var c=this.head;null!=c;){if(c.elt==a){b=!0;break}c=c.next}return b},iterator_at:function(a){for(var b=this.head;0<
a--&&null!=b;)b=b.next;return b},__class__:Qb};var sa=function(a,b,c,d){this.handlerp=null;this.allowSleepingCallbacks=this.pure=!1;this.options1=this.options2=this.handleri=null;this.itype=0;this.outer_zni=this.outer_znp=null;Va.call(this);this.type=d;this.interaction=this;this.event=c;this.options1=a.zpp_inner;this.options2=b.zpp_inner;this.allowSleepingCallbacks=!1};h["zpp_nape.callbacks.ZPP_InteractionListener"]=sa;sa.__name__=!0;sa.__super__=Va;sa.prototype=w(Va.prototype,{CbSetset:function(a,
b,c){for(var d=sa.UCbSet,e=sa.VCbSet,i=sa.WCbSet,a=a.head,f=b.head;null!=a&&null!=f;){var l=a.elt,j=f.elt;l==j?(i.inlined_add(l),a=a.next,f=f.next):K.setlt(l,j)?(d.inlined_add(l),a=a.next):(e.inlined_add(j),f=f.next)}for(;null!=a;)d.inlined_add(a.elt),a=a.next;for(;null!=f;)e.inlined_add(f.elt),f=f.next;for(;null!=d.head;){a=d.pop_unsafe();for(f=b.head;null!=f;)c(a,f.elt),f=f.next}for(;null!=e.head;){b=e.pop_unsafe();for(d=i.head;null!=d;)c(b,d.elt),d=d.next}for(;null!=i.head;){e=i.pop_unsafe();c(e,
e);for(b=i.head;null!=b;)c(e,b.elt),b=b.next}},CbTypeset:function(a,b,c){for(var d=sa.UCbType,e=sa.VCbType,i=sa.WCbType,a=a.head,f=b.head;null!=a&&null!=f;){var l=a.elt,j=f.elt;l==j?(i.inlined_add(l),a=a.next,f=f.next):l.id<j.id?(d.inlined_add(l),a=a.next):(e.inlined_add(j),f=f.next)}for(;null!=a;)d.inlined_add(a.elt),a=a.next;for(;null!=f;)e.inlined_add(f.elt),f=f.next;for(;null!=d.head;){a=d.pop_unsafe();for(f=b.head;null!=f;)c(a,f.elt),f=f.next}for(;null!=e.head;){b=e.pop_unsafe();for(d=i.head;null!=
d;)c(b,d.elt),d=d.next}for(;null!=i.head;){e=i.pop_unsafe();c(e,e);for(b=i.head;null!=b;)c(e,b.elt),b=b.next}},with_uniquesets:function(a){var b=this,c;null==na.zpp_pool?c=new na:(c=na.zpp_pool,na.zpp_pool=c.next,c.next=null);null;c.lt=ta.setlt;this.CbTypeset(this.options1.includes,this.options2.includes,function(a,d){b.CbSetset(a.cbsets,d.cbsets,function(a,d){a.validate();d.validate();K.single_intersection(a,d,b)&&c.try_insert(ta.get(a,d))})});c.clear_with(function(c){a?b.space.freshListenerType(c.a,
c.b):b.space.nullListenerType(c.a,c.b);c.a=c.b=null;c.listeners.clear();c.next=ta.zpp_pool;ta.zpp_pool=c});var d=c;d.data=null;d.lt=null;d.swapped=null;d.next=na.zpp_pool;na.zpp_pool=d},with_union:function(a){for(var b=this.options1.includes.head,c=this.options2.includes.head;null!=b&&null!=c;){var d=b.elt,e=c.elt;d==e?(a(d),b=b.next,c=c.next):d.id<e.id?(a(d),b=b.next):(a(e),c=c.next)}for(;null!=b;)a(b.elt),b=b.next;for(;null!=c;)a(c.elt),c=c.next},addedToSpace:function(){var a=this,b=this.type==
f.id_ListenerType_PRE;this.with_union(function(c){c.addint(a);if(b)for(c=c.interactors.head;null!=c;)c.elt.wake(),c=c.next});this.options1.handler=q(this,this.cbtype_change1);this.options2.handler=q(this,this.cbtype_change2);this.with_uniquesets(!0)},removedFromSpace:function(){var a=this;this.with_uniquesets(!1);var b=this.type==f.id_ListenerType_PRE;this.with_union(function(c){c.listeners.remove(a);c.invalidateint();if(b)for(c=c.interactors.head;null!=c;)c.elt.wake(),c=c.next});this.options1.handler=
null;this.options2.handler=null},cbtype_change1:function(a,b,c){this.cbtype_change(this.options1,a,b,c)},cbtype_change2:function(a,b,c){this.cbtype_change(this.options2,a,b,c)},cbtype_change:function(a,b,c,d){this.removedFromSpace();a.effect_change(b,c,d);this.addedToSpace();null},__class__:sa});var uc=function(){this.outer=this.handler=this.includes=this.excludes=this.wrap_includes=this.wrap_excludes=null;this.includes=new Qb;this.excludes=new Qb};h["zpp_nape.callbacks.ZPP_OptionType"]=uc;uc.__name__=
!0;uc.argument=function(a){return null==a?new Ld:Z.__instanceof(a,Ld)?a:(new Ld).including(a)};uc.prototype={setup_includes:function(){this.wrap_includes=Hb.get(this.includes,!0)},setup_excludes:function(){this.wrap_excludes=Hb.get(this.excludes,!0)},excluded:function(a){return this.nonemptyintersection(a,this.excludes)},compatible:function(a){return this.nonemptyintersection(a,this.includes)&&!this.nonemptyintersection(a,this.excludes)},nonemptyintersection:function(a,b){for(var c=!1,d=a.head,e=
b.head;null!=e&&null!=d;){var i=e.elt,f=d.elt;if(i==f){c=!0;break}else i.id<f.id?e=e.next:d=d.next}return c},effect_change:function(a,b,c){if(b)if(c){b=null;for(c=this.includes.head;null!=c&&!(a.id<c.elt.id);){b=c;c=c.next}this.includes.inlined_insert(b,a)}else this.includes.remove(a);else if(c){b=null;for(c=this.excludes.head;null!=c&&!(a.id<c.elt.id);){b=c;c=c.next}this.excludes.inlined_insert(b,a)}else this.excludes.remove(a)},append_type:function(a,b){a==this.includes?this.includes.has(b)||(this.excludes.has(b)?
null!=this.handler?this.handler(b,!1,!1):this.effect_change(b,!1,!1):null!=this.handler?this.handler(b,!0,!0):this.effect_change(b,!0,!0)):this.excludes.has(b)||(this.includes.has(b)?null!=this.handler?this.handler(b,!0,!1):this.effect_change(b,!0,!1):null!=this.handler?this.handler(b,!1,!0):this.effect_change(b,!1,!0))},append:function(a,b){if(Z.__instanceof(b,$b))this.append_type(a,b.zpp_inner);else if(Z.__instanceof(b,uf)){var c;b.zpp_inner.valmod();for(c=Ka.get(b);c.hasNext();){var d;c.zpp_critical=
!1;d=c.zpp_inner.at(c.zpp_i++);this.append_type(a,d.zpp_inner)}}else if(b instanceof Array&&null==b.__enum__)for(c=0;c<b.length;)d=b[c],++c,this.append_type(a,d.zpp_inner)},__class__:uc};var Bc=function(){this.pre_dt=0;this.cbTypes=this.cbSet=null;this.ignore=this.__velocity=!1;this.component=null;this.breakUnderForce=this.breakUnderError=this.removeOnBreak=!1;this.frequency=this.damping=this.maxForce=this.maxError=0;this.active=this.stiff=!1;this.compound=this.space=null;this.id=0;this.outer=null;
this.__velocity=!1;this.id=W.Constraint();this.active=this.stiff=!0;this.ignore=!1;this.frequency=10;this.damping=1;this.maxError=this.maxForce=Infinity;this.breakUnderForce=!1;this.removeOnBreak=!0;this.pre_dt=-1;this.cbTypes=new Qb};h["zpp_nape.constraint.ZPP_Constraint"]=Bc;Bc.__name__=!0;Bc.prototype={immutable_midstep:function(){},insert_cbtype:function(a){if(!this.cbTypes.has(a)){null!=this.space&&(this.dealloc_cbSet(),a.constraints.add(this));for(var b=null,c=this.cbTypes.head;null!=c&&!(a.id<
c.elt.id);){b=c;c=c.next}this.cbTypes.inlined_insert(b,a);null!=this.space&&(this.alloc_cbSet(),this.wake())}},alloc_cbSet:function(){if(null!=(this.cbSet=this.space.cbsets.get(this.cbTypes)))this.cbSet.count++,this.cbSet.constraints.add(this)},dealloc_cbSet:function(){if(null!=this.cbSet){this.cbSet.constraints.remove(this);if(0==--this.cbSet.count){this.space.cbsets.remove(this.cbSet);var a=this.cbSet;a.free();a.next=K.zpp_pool;K.zpp_pool=a}this.cbSet=null}},activate:function(){null!=this.space&&
this.activeInSpace()},deactivate:function(){null!=this.space&&this.inactiveOrOutSpace()},addedToSpace:function(){this.active&&this.activeInSpace();this.activeBodies();for(var a=this.cbTypes.head;null!=a;)a.elt.constraints.add(this),a=a.next},removedFromSpace:function(){this.active&&this.inactiveOrOutSpace();this.inactiveBodies();for(var a=this.cbTypes.head;null!=a;)a.elt.constraints.remove(this),a=a.next},activeInSpace:function(){this.alloc_cbSet();null==Wa.zpp_pool?this.component=new Wa:(this.component=
Wa.zpp_pool,Wa.zpp_pool=this.component.next,this.component.next=null);null;this.component.isBody=!1;this.component.constraint=this},inactiveOrOutSpace:function(){this.dealloc_cbSet();var a=this.component;a.body=null;a.constraint=null;null;a.next=Wa.zpp_pool;Wa.zpp_pool=a;this.component=null},activeBodies:function(){},inactiveBodies:function(){},clearcache:function(){},wake_connected:function(){},forest:function(){},pair_exists:function(){return!1},broken:function(){},warmStart:function(){},preStep:function(){return!1},
applyImpulseVel:function(){return!1},applyImpulsePos:function(){return!1},wake:function(){null!=this.space&&this.space.wake_constraint(this)},__class__:Bc};var yf=function(){this.stepped=!1;this.kMass=this.jAcc=this.jMax=this.gamma=this.bias=0;this.wrap_a2=null;this.a2localx=this.a2localy=this.a2relx=this.a2rely=0;this.wrap_a1=this.b2=null;this.a1localx=this.a1localy=this.a1relx=this.a1rely=0;this.b1=null;this.nx=this.ny=this.cx1=this.cx2=0;this.slack=this.equal=!1;this.jointMin=this.jointMax=0;this.outer_zn=
null;Bc.call(this);this.jAcc=this.a2rely=this.a2relx=this.a2localy=this.a2localx=this.a1rely=this.a1relx=this.a1localy=this.a1localx=0;this.jMax=Infinity;this.stepped=!1;this.cx1=this.cx2=0};h["zpp_nape.constraint.ZPP_DistanceJoint"]=yf;yf.__name__=!0;yf.__super__=Bc;yf.prototype=w(Bc.prototype,{activeBodies:function(){null!=this.b1&&this.b1.constraints.add(this);this.b2!=this.b1&&null!=this.b2&&this.b2.constraints.add(this)},inactiveBodies:function(){null!=this.b1&&this.b1.constraints.remove(this);
this.b2!=this.b1&&null!=this.b2&&this.b2.constraints.remove(this)},validate_a1:function(){this.wrap_a1.zpp_inner.x=this.a1localx;this.wrap_a1.zpp_inner.y=this.a1localy},invalidate_a1:function(a){this.immutable_midstep("Constraint::a1");this.a1localx=a.x;this.a1localy=a.y;this.wake()},setup_a1:function(){this.wrap_a1=B.get(this.a1localx,this.a1localy,null);this.wrap_a1.zpp_inner._inuse=!0;this.wrap_a1.zpp_inner._validate=q(this,this.validate_a1);this.wrap_a1.zpp_inner._invalidate=q(this,this.invalidate_a1)},
validate_a2:function(){this.wrap_a2.zpp_inner.x=this.a2localx;this.wrap_a2.zpp_inner.y=this.a2localy},invalidate_a2:function(a){this.immutable_midstep("Constraint::a2");this.a2localx=a.x;this.a2localy=a.y;this.wake()},setup_a2:function(){this.wrap_a2=B.get(this.a2localx,this.a2localy,null);this.wrap_a2.zpp_inner._inuse=!0;this.wrap_a2.zpp_inner._validate=q(this,this.validate_a2);this.wrap_a2.zpp_inner._invalidate=q(this,this.invalidate_a2)},wake_connected:function(){null!=this.b1&&this.b1.type==f.id_BodyType_DYNAMIC&&
this.b1.wake();null!=this.b2&&this.b2.type==f.id_BodyType_DYNAMIC&&this.b2.wake()},forest:function(){if(this.b1.type==f.id_BodyType_DYNAMIC){var a;if(this.b1.component==this.b1.component.parent)a=this.b1.component;else{a=this.b1.component;for(var b=null;a!=a.parent;){var c=a.parent;a.parent=b;b=a;a=c}for(;null!=b;)c=b.parent,b.parent=a,b=c}if(this.component==this.component.parent)b=this.component;else{b=this.component;for(c=null;b!=b.parent;){var d=b.parent;b.parent=c;c=b;b=d}for(;null!=c;)d=c.parent,
c.parent=b,c=d}a!=b&&(a.rank<b.rank?a.parent=b:a.rank>b.rank?b.parent=a:(b.parent=a,a.rank++))}if(this.b2.type==f.id_BodyType_DYNAMIC){if(this.b2.component==this.b2.component.parent)a=this.b2.component;else{a=this.b2.component;for(b=null;a!=a.parent;)c=a.parent,a.parent=b,b=a,a=c;for(;null!=b;)c=b.parent,b.parent=a,b=c}if(this.component==this.component.parent)b=this.component;else{b=this.component;for(c=null;b!=b.parent;)d=b.parent,b.parent=c,c=b,b=d;for(;null!=c;)d=c.parent,c.parent=b,c=d}a!=b&&
(a.rank<b.rank?a.parent=b:a.rank>b.rank?b.parent=a:(b.parent=a,a.rank++))}},pair_exists:function(a,b){return this.b1.id==a&&this.b2.id==b||this.b1.id==b&&this.b2.id==a},clearcache:function(){this.jAcc=0;this.pre_dt=-1},preStep:function(a){-1==this.pre_dt&&(this.pre_dt=a);var b=a/this.pre_dt;this.pre_dt=a;this.stepped=!0;this.equal=this.jointMin==this.jointMax;this.a1relx=this.b1.axisy*this.a1localx-this.b1.axisx*this.a1localy;this.a1rely=this.a1localx*this.b1.axisx+this.a1localy*this.b1.axisy;this.a2relx=
this.b2.axisy*this.a2localx-this.b2.axisx*this.a2localy;this.a2rely=this.a2localx*this.b2.axisx+this.a2localy*this.b2.axisy;var c;this.nx=this.b2.posx+this.a2relx-(this.b1.posx+this.a1relx);this.ny=this.b2.posy+this.a2rely-(this.b1.posy+this.a1rely);c=this.nx*this.nx+this.ny*this.ny;if(c<m.epsilon)c=this.ny=this.nx=0,this.slack=!0;else{c=Math.sqrt(c);var d=1/c;this.nx*=d;this.ny*=d;this.equal?(c-=this.jointMax,this.slack=!1):c<this.jointMin?(c=this.jointMin-c,this.nx=-this.nx,this.ny=-this.ny,this.slack=
!1):c>this.jointMax?(c-=this.jointMax,this.slack=!1):(c=this.ny=this.nx=0,this.slack=!0)}if(!this.slack){this.cx1=this.ny*this.a1relx-this.nx*this.a1rely;this.cx2=this.ny*this.a2relx-this.nx*this.a2rely;this.kMass=this.b1.smass+this.b2.smass+this.cx1*this.cx1*this.b1.sinertia+this.cx2*this.cx2*this.b2.sinertia;0!=this.kMass?this.kMass=1/this.kMass:this.jAcc=0;if(this.stiff)this.gamma=this.bias=0;else{if(this.breakUnderError&&c*c>this.maxError*this.maxError)return!0;var e;e=2*Math.PI*this.frequency;
this.gamma=1/(a*e*(2*this.damping+e*a));d=1/(1+this.gamma);e=a*e*e*this.gamma;this.gamma*=d;this.kMass*=d;this.bias=-c*e;this.bias<-this.maxError?this.bias=-this.maxError:this.bias>this.maxError&&(this.bias=this.maxError)}this.jAcc*=b;this.jMax=this.maxForce*a}return!1},warmStart:function(){if(!this.slack){var a=this.b1.imass*this.jAcc;this.b1.velx-=this.nx*a;this.b1.vely-=this.ny*a;a=this.b2.imass*this.jAcc;this.b2.velx+=this.nx*a;this.b2.vely+=this.ny*a;this.b1.angvel-=this.cx1*this.b1.iinertia*
this.jAcc;this.b2.angvel+=this.cx2*this.b2.iinertia*this.jAcc}},applyImpulseVel:function(){if(this.slack)return!1;var a=this.kMass*(this.bias-(this.nx*(this.b2.velx+this.b2.kinvelx-this.b1.velx-this.b1.kinvelx)+this.ny*(this.b2.vely+this.b2.kinvely-this.b1.vely-this.b1.kinvely)+(this.b2.angvel+this.b2.kinangvel)*this.cx2-(this.b1.angvel+this.b1.kinangvel)*this.cx1))-this.jAcc*this.gamma,b=this.jAcc;this.jAcc+=a;!this.equal&&0<this.jAcc&&(this.jAcc=0);if(this.breakUnderForce&&this.jAcc<-this.jMax)return!0;
!this.stiff&&this.jAcc<-this.jMax&&(this.jAcc=-this.jMax);a=this.jAcc-b;b=this.b1.imass*a;this.b1.velx-=this.nx*b;this.b1.vely-=this.ny*b;b=this.b2.imass*a;this.b2.velx+=this.nx*b;this.b2.vely+=this.ny*b;this.b1.angvel-=this.cx1*this.b1.iinertia*a;this.b2.angvel+=this.cx2*this.b2.iinertia*a;return!1},applyImpulsePos:function(){var a,b,c=0,d=0,c=this.b1.axisy*this.a1localx-this.b1.axisx*this.a1localy,d=this.a1localx*this.b1.axisx+this.a1localy*this.b1.axisy,e=0,i=0,e=this.b2.axisy*this.a2localx-this.b2.axisx*
this.a2localy,i=this.a2localx*this.b2.axisx+this.a2localy*this.b2.axisy,f=0,l=0,f=this.b2.posx+e-(this.b1.posx+c),l=this.b2.posy+i-(this.b1.posy+d);a=f*f+l*l;a<m.epsilon?(a=l=f=0,b=!0):(a=Math.sqrt(a),b=1/a,f*=b,l*=b,this.equal?(a-=this.jointMax,b=!1):a<this.jointMin?(a=this.jointMin-a,f=-f,l=-l,b=!1):a>this.jointMax?(a-=this.jointMax,b=!1):(a=l=f=0,b=!0));if(!b){if(this.breakUnderError&&a*a>this.maxError*this.maxError)return!0;if(a*a<m.constraintLinearSlop*m.constraintLinearSlop)return!1;a*=0.5;
if(6<a*a&&(b=this.b1.smass+this.b2.smass,b>m.epsilon&&(b=-a*(0.75/b),this.equal||0>b)))a=b*this.b1.imass,this.b1.posx-=f*a,this.b1.posy-=l*a,a=b*this.b2.imass,this.b2.posx+=f*a,this.b2.posy+=l*a,f=this.b2.posx+e-(this.b1.posx+c),l=this.b2.posy+i-(this.b1.posy+d),a=f*f+l*l,a<m.epsilon?a=l=f=0:(a=Math.sqrt(a),b=1/a,f*=b,l*=b,this.equal?a-=this.jointMax:a<this.jointMin?(a=this.jointMin-a,f=-f,l=-l):a>this.jointMax?a-=this.jointMax:a=l=f=0),a*=0.5;c=l*c-f*d;e=l*e-f*i;i=this.b1.smass+this.b2.smass+c*c*
this.b1.sinertia+e*e*this.b2.sinertia;0!=i&&(i=1/i);b=-a*i;if(this.equal||0>b)i=this.b1.imass*b,this.b1.posx-=f*i,this.b1.posy-=l*i,i=this.b2.imass*b,this.b2.posx+=f*i,this.b2.posy+=l*i,this.b1.delta_rot(-c*this.b1.iinertia*b),this.b2.delta_rot(e*this.b2.iinertia*b)}return!1},__class__:yf});var zf=function(){this.stepped=!1;this.kMassa=this.kMassb=this.kMassc=this.jAccx=this.jAccy=this.jMax=this.gamma=this.biasx=this.biasy=0;this.wrap_a2=null;this.a2localx=this.a2localy=this.a2relx=this.a2rely=0;
this.wrap_a1=this.b2=null;this.a1localx=this.a1localy=this.a1relx=this.a1rely=0;this.outer_zn=this.b1=null;Bc.call(this);this.stepped=!1;this.jAccy=this.jAccx=0;this.jMax=Infinity;this.a2rely=this.a2relx=this.a2localy=this.a2localx=this.a1rely=this.a1relx=this.a1localy=this.a1localx=0};h["zpp_nape.constraint.ZPP_PivotJoint"]=zf;zf.__name__=!0;zf.__super__=Bc;zf.prototype=w(Bc.prototype,{activeBodies:function(){null!=this.b1&&this.b1.constraints.add(this);this.b2!=this.b1&&null!=this.b2&&this.b2.constraints.add(this)},
inactiveBodies:function(){null!=this.b1&&this.b1.constraints.remove(this);this.b2!=this.b1&&null!=this.b2&&this.b2.constraints.remove(this)},validate_a1:function(){this.wrap_a1.zpp_inner.x=this.a1localx;this.wrap_a1.zpp_inner.y=this.a1localy},invalidate_a1:function(a){this.immutable_midstep("Constraint::a1");this.a1localx=a.x;this.a1localy=a.y;this.wake()},setup_a1:function(){this.wrap_a1=B.get(this.a1localx,this.a1localy,null);this.wrap_a1.zpp_inner._inuse=!0;this.wrap_a1.zpp_inner._validate=q(this,
this.validate_a1);this.wrap_a1.zpp_inner._invalidate=q(this,this.invalidate_a1)},validate_a2:function(){this.wrap_a2.zpp_inner.x=this.a2localx;this.wrap_a2.zpp_inner.y=this.a2localy},invalidate_a2:function(a){this.immutable_midstep("Constraint::a2");this.a2localx=a.x;this.a2localy=a.y;this.wake()},setup_a2:function(){this.wrap_a2=B.get(this.a2localx,this.a2localy,null);this.wrap_a2.zpp_inner._inuse=!0;this.wrap_a2.zpp_inner._validate=q(this,this.validate_a2);this.wrap_a2.zpp_inner._invalidate=q(this,
this.invalidate_a2)},wake_connected:function(){null!=this.b1&&this.b1.type==f.id_BodyType_DYNAMIC&&this.b1.wake();null!=this.b2&&this.b2.type==f.id_BodyType_DYNAMIC&&this.b2.wake()},forest:function(){if(this.b1.type==f.id_BodyType_DYNAMIC){var a;if(this.b1.component==this.b1.component.parent)a=this.b1.component;else{a=this.b1.component;for(var b=null;a!=a.parent;){var c=a.parent;a.parent=b;b=a;a=c}for(;null!=b;)c=b.parent,b.parent=a,b=c}if(this.component==this.component.parent)b=this.component;else{b=
this.component;for(c=null;b!=b.parent;){var d=b.parent;b.parent=c;c=b;b=d}for(;null!=c;)d=c.parent,c.parent=b,c=d}a!=b&&(a.rank<b.rank?a.parent=b:a.rank>b.rank?b.parent=a:(b.parent=a,a.rank++))}if(this.b2.type==f.id_BodyType_DYNAMIC){if(this.b2.component==this.b2.component.parent)a=this.b2.component;else{a=this.b2.component;for(b=null;a!=a.parent;)c=a.parent,a.parent=b,b=a,a=c;for(;null!=b;)c=b.parent,b.parent=a,b=c}if(this.component==this.component.parent)b=this.component;else{b=this.component;for(c=
null;b!=b.parent;)d=b.parent,b.parent=c,c=b,b=d;for(;null!=c;)d=c.parent,c.parent=b,c=d}a!=b&&(a.rank<b.rank?a.parent=b:a.rank>b.rank?b.parent=a:(b.parent=a,a.rank++))}},pair_exists:function(a,b){return this.b1.id==a&&this.b2.id==b||this.b1.id==b&&this.b2.id==a},clearcache:function(){this.jAccy=this.jAccx=0;this.pre_dt=-1},preStep:function(a){-1==this.pre_dt&&(this.pre_dt=a);var b=a/this.pre_dt;this.pre_dt=a;this.stepped=!0;this.a1relx=this.b1.axisy*this.a1localx-this.b1.axisx*this.a1localy;this.a1rely=
this.a1localx*this.b1.axisx+this.a1localy*this.b1.axisy;this.a2relx=this.b2.axisy*this.a2localx-this.b2.axisx*this.a2localy;this.a2rely=this.a2localx*this.b2.axisx+this.a2localy*this.b2.axisy;var c=this.b1.smass+this.b2.smass;this.kMassa=c;this.kMassb=0;this.kMassc=c;if(0!=this.b1.sinertia){var c=this.a1relx*this.b1.sinertia,d=this.a1rely*this.b1.sinertia;this.kMassa+=d*this.a1rely;this.kMassb+=-d*this.a1relx;this.kMassc+=c*this.a1relx}0!=this.b2.sinertia&&(c=this.a2relx*this.b2.sinertia,d=this.a2rely*
this.b2.sinertia,this.kMassa+=d*this.a2rely,this.kMassb+=-d*this.a2relx,this.kMassc+=c*this.a2relx);c=this.kMassa*this.kMassc-this.kMassb*this.kMassb;c!=c?(this.kMassa=this.kMassb=this.kMassc=0,c=3):0==c?(c=0,0!=this.kMassa?this.kMassa=1/this.kMassa:(this.kMassa=0,c|=1),0!=this.kMassc?this.kMassc=1/this.kMassc:(this.kMassc=0,c|=2),this.kMassb=0):(c=1/c,d=this.kMassc*c,this.kMassc=this.kMassa*c,this.kMassa=d,this.kMassb*=-c,c=0);0!=(c&1)&&(this.jAccx=0);0!=(c&2)&&(this.jAccy=0);if(this.stiff)this.gamma=
this.biasy=this.biasx=0;else{d=2*Math.PI*this.frequency;this.gamma=1/(a*d*(2*this.damping+d*a));c=1/(1+this.gamma);d=a*d*d*this.gamma;this.gamma*=c;this.kMassa*=c;this.kMassb*=c;this.kMassc*=c;this.biasx=this.b2.posx+this.a2relx-(this.b1.posx+this.a1relx);this.biasy=this.b2.posy+this.a2rely-(this.b1.posy+this.a1rely);if(this.breakUnderError&&this.biasx*this.biasx+this.biasy*this.biasy>this.maxError*this.maxError)return!0;c=-d;this.biasx*=c;this.biasy*=c;c=this.maxError;d=this.biasx*this.biasx+this.biasy*
this.biasy;d>c*c&&(c*=1/Math.sqrt(d),this.biasx*=c,this.biasy*=c)}this.jAccx*=b;this.jAccy*=b;this.jMax=this.maxForce*a;return!1},warmStart:function(){var a=this.b1.imass;this.b1.velx-=this.jAccx*a;this.b1.vely-=this.jAccy*a;a=this.b2.imass;this.b2.velx+=this.jAccx*a;this.b2.vely+=this.jAccy*a;this.b1.angvel-=(this.jAccy*this.a1relx-this.jAccx*this.a1rely)*this.b1.iinertia;this.b2.angvel+=(this.jAccy*this.a2relx-this.jAccx*this.a2rely)*this.b2.iinertia},applyImpulseVel:function(){var a=0,b=0,a=this.b2.velx+
this.b2.kinvelx-this.a2rely*(this.b2.angvel+this.b2.kinangvel)-(this.b1.velx+this.b1.kinvelx-this.a1rely*(this.b1.angvel+this.b1.kinangvel)),b=this.b2.vely+this.b2.kinvely+this.a2relx*(this.b2.angvel+this.b2.kinangvel)-(this.b1.vely+this.b1.kinvely+this.a1relx*(this.b1.angvel+this.b1.kinangvel)),c=0,d=0,c=this.biasx-a,d=this.biasy-b,a=this.kMassa*c+this.kMassb*d,d=this.kMassb*c+this.kMassc*d,b=this.gamma,c=a-this.jAccx*b,d=d-this.jAccy*b,b=a=0,a=this.jAccx,b=this.jAccy;this.jAccx+=1*c;this.jAccy+=
1*d;if(this.breakUnderForce){if(this.jAccx*this.jAccx+this.jAccy*this.jAccy>this.jMax*this.jMax)return!0}else this.stiff||(c=this.jMax,d=this.jAccx*this.jAccx+this.jAccy*this.jAccy,d>c*c&&(c*=1/Math.sqrt(d),this.jAccx*=c,this.jAccy*=c));c=this.jAccx-a;d=this.jAccy-b;a=this.b1.imass;this.b1.velx-=c*a;this.b1.vely-=d*a;a=this.b2.imass;this.b2.velx+=c*a;this.b2.vely+=d*a;this.b1.angvel-=(d*this.a1relx-c*this.a1rely)*this.b1.iinertia;this.b2.angvel+=(d*this.a2relx-c*this.a2rely)*this.b2.iinertia;return!1},
applyImpulsePos:function(){var a=0,b=0,a=this.b1.axisy*this.a1localx-this.b1.axisx*this.a1localy,b=this.a1localx*this.b1.axisx+this.a1localy*this.b1.axisy,c=0,d=0,c=this.b2.axisy*this.a2localx-this.b2.axisx*this.a2localy,d=this.a2localx*this.b2.axisx+this.a2localy*this.b2.axisy,e=0,f=0,e=this.b2.posx+c-(this.b1.posx+a),f=this.b2.posy+d-(this.b1.posy+b);if(this.breakUnderError&&e*e+f*f>this.maxError*this.maxError)return!0;if(e*e+f*f<m.constraintLinearSlop*m.constraintLinearSlop)return!1;var e=0.5*
e,f=0.5*f,k=0,l=0;if(6<e*e+f*f&&(l=this.b1.smass+this.b2.smass,l>m.epsilon)){var l=0.75/l,k=-e*l,l=-f*l,j=k*k+l*l;400<j&&(j=20*(1/Math.sqrt(j)),k*=j,l*=j);j=this.b1.imass;this.b1.posx-=k*j;this.b1.posy-=l*j;j=this.b2.imass;this.b2.posx+=k*j;this.b2.posy+=l*j;e=this.b2.posx+c-(this.b1.posx+a);f=this.b2.posy+d-(this.b1.posy+b);e*=0.5;f*=0.5}var g=j=0,h=0,j=k=this.b1.smass+this.b2.smass,g=0,h=k;0!=this.b1.sinertia&&(k=a*this.b1.sinertia,l=b*this.b1.sinertia,j+=l*b,g+=-l*a,h+=k*a);0!=this.b2.sinertia&&
(k=c*this.b2.sinertia,l=d*this.b2.sinertia,j+=l*d,g+=-l*c,h+=k*c);k=-e;l=-f;e=k*k+l*l;36<e&&(e=6*(1/Math.sqrt(e)),k*=e,l*=e);e=j*h-g*g;e!=e?k=l=0:0==e?(k=0!=j?k/j:0,l=0!=h?l/h:0):(e=1/e,h=e*(h*k-g*l),l=e*(j*l-g*k),k=h);j=this.b1.imass;this.b1.posx-=k*j;this.b1.posy-=l*j;j=this.b2.imass;this.b2.posx+=k*j;this.b2.posy+=l*j;this.b1.delta_rot(-(l*a-k*b)*this.b1.iinertia);this.b2.delta_rot((l*c-k*d)*this.b2.iinertia);return!1},__class__:zf});var H=function(){this.colarb=this.fluidarb=this.sensorarb=null;
this.type=0;this.b1=this.b2=this.ws1=this.ws2=this.pair=null;this.invalidated=!1;this.immState=0;this.intchange=this.presentable=this.continuous=this.fresh=!1;this.present=0;this.active=this.cleared=this.sleeping=!1;this.id=this.di=this.stamp=this.up_stamp=this.sleep_stamp=this.endGenerated=0;this.outer=null};h["zpp_nape.dynamics.ZPP_Arbiter"]=H;H.__name__=!0;H.prototype={wrapper:function(){null==this.outer&&(H.internal=!0,this.type==H.COL?(this.colarb.outer_zn=new Af,this.outer=this.colarb.outer_zn):
this.type==H.FLUID?(this.fluidarb.outer_zn=new Bf,this.outer=this.fluidarb.outer_zn):this.outer=new Lb,this.outer.zpp_inner=this,H.internal=!1);return this.outer},__class__:H};var gb=function(){this.next=null;H.call(this);this.type=H.SENSOR;this.sensorarb=this};h["zpp_nape.dynamics.ZPP_SensorArbiter"]=gb;gb.__name__=!0;gb.__super__=H;gb.prototype=w(H.prototype,{retire:function(){this.cleared||(this.b1.arbiters.inlined_try_remove(this),this.b2.arbiters.inlined_try_remove(this),null!=this.pair&&(this.pair=
this.pair.arb=null));this.b1=this.b2=null;this.intchange=this.active=!1;this.next=gb.zpp_pool;gb.zpp_pool=this},__class__:gb});var hb=function(){this.wMass=this.adamp=this.agamma=this.vMassa=this.vMassb=this.vMassc=this.dampx=this.dampy=this.lgamma=this.nx=this.ny=this.buoyx=this.buoyy=this.pre_dt=0;this.nodrag=!1;this.centroidx=this.centroidy=this.overlap=this.r1x=this.r1y=this.r2x=this.r2y=0;this.outer_zn=this.next=null;H.call(this);this.type=H.FLUID;this.fluidarb=this;this.buoyy=this.buoyx=0;this.pre_dt=
-1};h["zpp_nape.dynamics.ZPP_FluidArbiter"]=hb;hb.__name__=!0;hb.__super__=H;hb.prototype=w(H.prototype,{retire:function(){this.cleared||(this.b1.arbiters.inlined_try_remove(this),this.b2.arbiters.inlined_try_remove(this),null!=this.pair&&(this.pair=this.pair.arb=null));this.b1=this.b2=null;this.intchange=this.active=!1;this.next=hb.zpp_pool;hb.zpp_pool=this;this.pre_dt=-1},preStep:function(a,b){-1==this.pre_dt&&(this.pre_dt=b);var c=b/this.pre_dt;this.pre_dt=b;this.r1x=this.centroidx-this.b1.posx;
this.r1y=this.centroidy-this.b1.posy;this.r2x=this.centroidx-this.b2.posx;this.r2y=this.centroidy-this.b2.posy;var d=0,e=0;this.ws1.fluidEnabled&&null!=this.ws1.fluidProperties.wrap_gravity?(d=this.ws1.fluidProperties.gravityx,e=this.ws1.fluidProperties.gravityy):(d=a.gravityx,e=a.gravityy);var i=0,k=0;this.ws2.fluidEnabled&&null!=this.ws2.fluidProperties.wrap_gravity?(i=this.ws2.fluidProperties.gravityx,k=this.ws2.fluidProperties.gravityy):(i=a.gravityx,k=a.gravityy);var l=0,j=0;if(this.ws1.fluidEnabled&&
this.ws2.fluidEnabled){var g=this.overlap*this.ws1.fluidProperties.density,h=this.overlap*this.ws2.fluidProperties.density;if(g>h)i=g+h,l-=d*i,j-=e*i;else if(g<h)d=g+h,l+=i*d,j+=k*d;else{var p=0,r=0,p=0.5*(d+i),r=0.5*(e+k);this.ws1.worldCOMx*p+this.ws1.worldCOMy*r>this.ws2.worldCOMx*p+this.ws2.worldCOMy*r?(d=g+h,l-=p*d,j-=r*d):(d=g+h,l+=p*d,j+=r*d)}}else this.ws1.fluidEnabled?(i=this.overlap*this.ws1.fluidProperties.density,l-=d*i,j-=e*i):this.ws2.fluidEnabled&&(d=this.overlap*this.ws2.fluidProperties.density,
l+=i*d,j+=k*d);l*=b;j*=b;this.buoyx=l;this.buoyy=j;this.b1.type==f.id_BodyType_DYNAMIC&&(d=this.b1.imass,this.b1.velx-=l*d,this.b1.vely-=j*d,this.b1.angvel-=(j*this.r1x-l*this.r1y)*this.b1.iinertia);this.b2.type==f.id_BodyType_DYNAMIC&&(d=this.b2.imass,this.b2.velx+=l*d,this.b2.vely+=j*d,this.b2.angvel+=(j*this.r2x-l*this.r2y)*this.b2.iinertia);if((!this.ws1.fluidEnabled||0==this.ws1.fluidProperties.viscosity)&&(!this.ws2.fluidEnabled||0==this.ws2.fluidProperties.viscosity))this.nodrag=!0,this.adamp=
this.dampy=this.dampx=0;else{this.nodrag=!1;l=0;this.ws1.fluidEnabled&&(this.ws2.validate_angDrag(),l+=this.ws1.fluidProperties.viscosity*this.ws2.angDrag*this.overlap/this.ws2.area);this.ws2.fluidEnabled&&(this.ws1.validate_angDrag(),l+=this.ws2.fluidProperties.viscosity*this.ws1.angDrag*this.overlap/this.ws1.area);0!=l?(j=this.b1.sinertia+this.b2.sinertia,this.wMass=0!=j?1/j:0,l=2*Math.PI*4.0E-4*l,this.agamma=1/(b*l*(2+l*b)),l=1/(1+this.agamma),this.agamma*=l,this.wMass*=l):this.agamma=this.wMass=
0;l=this.b2.velx+this.b2.kinvelx-this.r2y*(this.b2.angvel+this.b2.kinangvel)-(this.b1.velx+this.b1.kinvelx-this.r1y*(this.b2.angvel+this.b2.kinangvel));j=this.b2.vely+this.b2.kinvely+this.r2x*(this.b2.angvel+this.b2.kinangvel)-(this.b1.vely+this.b1.kinvely+this.r1x*(this.b1.angvel+this.b1.kinangvel));l*l+j*j<m.epsilon*m.epsilon||(d=1/Math.sqrt(l*l+j*j),this.nx=l*d,this.ny=j*d);l=0;if(this.ws1.fluidEnabled)if(j=-this.ws1.fluidProperties.viscosity*this.overlap/this.ws2.area,this.ws2.type==f.id_ShapeType_CIRCLE)l-=
j*this.ws2.circle.radius*m.fluidLinearDrag/(2*this.ws2.circle.radius*Math.PI);else{e=d=0;for(i=this.ws2.polygon.edges.head;null!=i;)k=i.elt,d+=k.length,k=j*k.length*(k.gnormx*this.nx+k.gnormy*this.ny),0<k&&(k=k*=-m.fluidVacuumDrag),e-=0.5*k*m.fluidLinearDrag,i=i.next;l+=e/d}if(this.ws2.fluidEnabled)if(j=-this.ws2.fluidProperties.viscosity*this.overlap/this.ws1.area,this.ws1.type==f.id_ShapeType_CIRCLE)l-=j*this.ws1.circle.radius*m.fluidLinearDrag/(2*this.ws1.circle.radius*Math.PI);else{e=d=0;for(i=
this.ws1.polygon.edges.head;null!=i;)k=i.elt,d+=k.length,k=j*k.length*(k.gnormx*this.nx+k.gnormy*this.ny),0<k&&(k=k*=-m.fluidVacuumDrag),e-=0.5*k*m.fluidLinearDrag,i=i.next;l+=e/d}0!=l?(i=this.b1.smass+this.b2.smass,e=d=j=0,j=i,d=0,e=i,0!=this.b1.sinertia&&(i=this.r1x*this.b1.sinertia,k=this.r1y*this.b1.sinertia,j+=k*this.r1y,d+=-k*this.r1x,e+=i*this.r1x),0!=this.b2.sinertia&&(i=this.r2x*this.b2.sinertia,k=this.r2y*this.b2.sinertia,j+=k*this.r2y,d+=-k*this.r2x,e+=i*this.r2x),i=j*e-d*d,i!=i?(j=d=e=
0,3):0==i?(i=0,0!=j?j=1/j:(j=0,i|=1),0!=e?e=1/e:(e=0,i|=2),d=0,i):(i=1/i,k=e*i,e=j*i,j=k,d*=-i,0),this.vMassa=j,this.vMassb=d,this.vMassc=e,l*=2*Math.PI,this.lgamma=1/(b*l*(2+l*b)),l=1/(1+this.lgamma),this.lgamma*=l,this.vMassa*=l,this.vMassb*=l,this.vMassc*=l):this.lgamma=this.vMassc=this.vMassb=this.vMassa=0}this.dampx*=c;this.dampy*=c;this.adamp*=c},warmStart:function(){var a=this.b1.imass;this.b1.velx-=this.dampx*a;this.b1.vely-=this.dampy*a;a=this.b2.imass;this.b2.velx+=this.dampx*a;this.b2.vely+=
this.dampy*a;this.b1.angvel-=this.b1.iinertia*(this.dampy*this.r1x-this.dampx*this.r1y);this.b2.angvel+=this.b2.iinertia*(this.dampy*this.r2x-this.dampx*this.r2y);this.b1.angvel-=this.adamp*this.b1.iinertia;this.b2.angvel+=this.adamp*this.b2.iinertia},applyImpulseVel:function(){if(!this.nodrag){var a=this.b1.angvel+this.b1.kinangvel,b=this.b2.angvel+this.b2.kinangvel,c=this.b1.velx+this.b1.kinvelx-this.r1y*a-(this.b2.velx+this.b2.kinvelx-this.r2y*b),d=this.b1.vely+this.b1.kinvely+this.r1x*a-(this.b2.vely+
this.b2.kinvely+this.r2x*b),e=this.vMassa*c+this.vMassb*d,d=this.vMassb*c+this.vMassc*d,f=this.lgamma,c=e-this.dampx*f,d=d-this.dampy*f;this.dampx+=1*c;this.dampy+=1*d;e=this.b1.imass;this.b1.velx-=c*e;this.b1.vely-=d*e;e=this.b2.imass;this.b2.velx+=c*e;this.b2.vely+=d*e;this.b1.angvel-=this.b1.iinertia*(d*this.r1x-c*this.r1y);this.b2.angvel+=this.b2.iinertia*(d*this.r2x-c*this.r2y);a=(a-b)*this.wMass-this.adamp*this.agamma;this.adamp+=a;this.b1.angvel-=a*this.b1.iinertia;this.b2.angvel+=a*this.b2.iinertia}},
__class__:hb});var Ya=function(){this.pre_dt=0;this.stat=!1;this.next=null;this.hc2=this.hpc2=!1;this.c1=this.oc1=this.c2=this.oc2=null;this.__ref_vertex=0;this.__ref_edge1=this.__ref_edge2=null;this.biasCoef=0;this.rev=!1;this.nx=this.ny=this.kMassa=this.kMassb=this.kMassc=this.Ka=this.Kb=this.Kc=this.rMass=this.jrAcc=this.rn1a=this.rt1a=this.rn1b=this.rt1b=this.rn2a=this.rt2a=this.rn2b=this.rt2b=this.k1x=this.k1y=this.k2x=this.k2y=this.surfacex=this.surfacey=this.lnormx=this.lnormy=this.lproj=this.radius=
0;this.s1=this.s2=this.contacts=this.innards=null;this.userdef_dyn_fric=this.userdef_stat_fric=this.userdef_restitution=this.userdef_rfric=!1;this.dyn_fric=this.stat_fric=this.restitution=this.rfric=0;this.outer_zn=null;H.call(this);this.pre_dt=-1;this.contacts=new Xa;this.innards=new Lf;this.type=H.COL;this.colarb=this};h["zpp_nape.dynamics.ZPP_ColArbiter"]=Ya;Ya.__name__=!0;Ya.__super__=H;Ya.prototype=w(H.prototype,{injectContact:function(a,b,c,d,e,f,k){null==k&&(k=!1);for(var l=null,g=this.contacts.next;null!=
g;){var h=g;if(f==h.hash){l=h;break}g=g.next}null==l?(null==Xa.zpp_pool?l=new Xa:(l=Xa.zpp_pool,Xa.zpp_pool=l.next,l.next=null),null,g=l.inner,g.jnAcc=g.jtAcc=0,l.hash=f,l.fresh=!0,l.arbiter=this,this.jrAcc=0,this.contacts.inlined_add(l),this.innards.add(g)):l.fresh=!1;l.px=a;l.py=b;this.nx=c;this.ny=d;l.dist=e;l.stamp=this.stamp;l.posOnly=k;return l},retire:function(){this.cleared||(this.b1.arbiters.inlined_try_remove(this),this.b2.arbiters.inlined_try_remove(this),null!=this.pair&&(this.pair=this.pair.arb=
null));this.b1=this.b2=null;for(this.intchange=this.active=!1;null!=this.contacts.next;){var a=this.contacts.inlined_pop_unsafe();a.arbiter=null;a.next=Xa.zpp_pool;Xa.zpp_pool=a;this.innards.inlined_pop()}this.userdef_rfric=this.userdef_restitution=this.userdef_stat_fric=this.userdef_dyn_fric=!1;this.__ref_edge1=this.__ref_edge2=null;this.next=Ya.zpp_pool;Ya.zpp_pool=this;this.pre_dt=-1},cleanupContacts:function(){var a=!0,b=null,c=null,d=this.innards.next;this.hc2=!1;for(var e=this.contacts.next;null!=
e;){var f=e;f.stamp+m.arbiterExpirationDelay<this.stamp?(e=this.contacts.inlined_erase(b),d=this.innards.inlined_erase(c),f.arbiter=null,f.next=Xa.zpp_pool,Xa.zpp_pool=f):(b=f.inner,c=f.active,f.active=f.stamp==this.stamp,f.active&&(a?(a=!1,this.c1=b,this.oc1=f):(this.hc2=!0,this.c2=b,this.oc2=f)),c!=f.active&&(this.contacts.modified=!0),b=e,c=d,d=d.next,e=e.next)}this.hc2?(this.hpc2=!0,this.oc1.posOnly?(d=this.c1,this.c1=this.c2,this.c2=d,d=this.oc1,this.oc1=this.oc2,this.oc2=d,this.hc2=!1):this.oc2.posOnly&&
(this.hc2=!1),this.oc1.posOnly&&(a=!0)):this.hpc2=!1;return a},preStep:function(a){this.invalidated&&(this.invalidated=!1,this.userdef_restitution||(this.restitution=-Infinity>=this.s1.material.elasticity||-Infinity>=this.s2.material.elasticity?0:Infinity<=this.s1.material.elasticity||Infinity<=this.s2.material.elasticity?1:(this.s1.material.elasticity+this.s2.material.elasticity)/2,0>this.restitution&&(this.restitution=0),1<this.restitution&&(this.restitution=1)),this.userdef_dyn_fric||(this.dyn_fric=
Math.sqrt(this.s1.material.dynamicFriction*this.s2.material.dynamicFriction)),this.userdef_stat_fric||(this.stat_fric=Math.sqrt(this.s1.material.staticFriction*this.s2.material.staticFriction)),this.userdef_rfric||(this.rfric=Math.sqrt(this.s1.material.rollingFriction*this.s2.material.rollingFriction)));-1==this.pre_dt&&(this.pre_dt=a);var b=a/this.pre_dt;this.pre_dt=a;var c=this.b1.smass+this.b2.smass;this.hc2=!1;a=!0;this.biasCoef=this.b1.type!=f.id_BodyType_DYNAMIC||this.b2.type!=f.id_BodyType_DYNAMIC?
this.continuous?m.contactContinuousStaticBiasCoef:m.contactStaticBiasCoef:this.continuous?m.contactContinuousBiasCoef:m.contactBiasCoef;this.continuous=!1;for(var d=null,e=null,i=this.innards.next,k=this.contacts.next;null!=k;){var g=k;if(g.stamp+m.arbiterExpirationDelay<this.stamp)k=this.contacts.inlined_erase(d),i=this.innards.inlined_erase(e),g.arbiter=null,g.next=Xa.zpp_pool,Xa.zpp_pool=g;else{d=g.inner;e=g.active;g.active=g.stamp==this.stamp;if(g.active){a?(a=!1,this.c1=d,this.oc1=g):(this.hc2=
!0,this.c2=d,this.oc2=g);d.r2x=g.px-this.b2.posx;d.r2y=g.py-this.b2.posy;d.r1x=g.px-this.b1.posx;d.r1y=g.py-this.b1.posy;var j=c+this.b2.sinertia*ve.sqr(d.r2x*this.nx+d.r2y*this.ny),j=j+this.b1.sinertia*ve.sqr(d.r1x*this.nx+d.r1y*this.ny);d.tMass=j<m.epsilon*m.epsilon?0:1/j;j=c+this.b2.sinertia*ve.sqr(this.ny*d.r2x-this.nx*d.r2y);j+=this.b1.sinertia*ve.sqr(this.ny*d.r1x-this.nx*d.r1y);d.nMass=j<m.epsilon*m.epsilon?0:1/j;var h=j=0,n=this.b2.angvel+this.b2.kinangvel,j=this.b2.velx+this.b2.kinvelx-d.r2y*
n,h=this.b2.vely+this.b2.kinvely+d.r2x*n,n=this.b1.angvel+this.b1.kinangvel,j=j-(this.b1.velx+this.b1.kinvelx-d.r1y*n),h=h-(this.b1.vely+this.b1.kinvely+d.r1x*n),n=this.nx*j+this.ny*h;g.elasticity=this.restitution;d.bounce=n*g.elasticity;d.bounce>-m.elasticThreshold&&(d.bounce=0);n=h*this.nx-j*this.ny;j=m.staticFrictionThreshold;d.friction=n*n>j*j?this.dyn_fric:this.stat_fric;d.jnAcc*=b;d.jtAcc*=b}e!=g.active&&(this.contacts.modified=!0);d=k;e=i;i=i.next;k=k.next}}this.hc2?(this.hpc2=!0,this.oc1.posOnly?
(i=this.c1,this.c1=this.c2,this.c2=i,i=this.oc1,this.oc1=this.oc2,this.oc2=i,this.hc2=!1):this.oc2.posOnly&&(this.hc2=!1),this.oc1.posOnly&&(a=!0)):this.hpc2=!1;this.jrAcc*=b;a||(this.rn1a=this.ny*this.c1.r1x-this.nx*this.c1.r1y,this.rt1a=this.c1.r1x*this.nx+this.c1.r1y*this.ny,this.rn1b=this.ny*this.c1.r2x-this.nx*this.c1.r2y,this.rt1b=this.c1.r2x*this.nx+this.c1.r2y*this.ny,this.k1x=this.b2.kinvelx-this.c1.r2y*this.b2.kinangvel-(this.b1.kinvelx-this.c1.r1y*this.b1.kinangvel),this.k1y=this.b2.kinvely+
this.c1.r2x*this.b2.kinangvel-(this.b1.kinvely+this.c1.r1x*this.b1.kinangvel));this.hc2&&(this.rn2a=this.ny*this.c2.r1x-this.nx*this.c2.r1y,this.rt2a=this.c2.r1x*this.nx+this.c2.r1y*this.ny,this.rn2b=this.ny*this.c2.r2x-this.nx*this.c2.r2y,this.rt2b=this.c2.r2x*this.nx+this.c2.r2y*this.ny,this.k2x=this.b2.kinvelx-this.c2.r2y*this.b2.kinangvel-(this.b1.kinvelx-this.c2.r1y*this.b1.kinangvel),this.k2y=this.b2.kinvely+this.c2.r2x*this.b2.kinangvel-(this.b1.kinvely+this.c2.r1x*this.b1.kinangvel),this.kMassa=
c+this.b1.sinertia*this.rn1a*this.rn1a+this.b2.sinertia*this.rn1b*this.rn1b,this.kMassb=c+this.b1.sinertia*this.rn1a*this.rn2a+this.b2.sinertia*this.rn1b*this.rn2b,this.kMassc=c+this.b1.sinertia*this.rn2a*this.rn2a+this.b2.sinertia*this.rn2b*this.rn2b,this.kMassa*this.kMassa+2*this.kMassb*this.kMassb+this.kMassc*this.kMassc<m.illConditionedThreshold*(this.kMassa*this.kMassc-this.kMassb*this.kMassb)?(this.Ka=this.kMassa,this.Kb=this.kMassb,this.Kc=this.kMassc,b=this.kMassa*this.kMassc-this.kMassb*
this.kMassb,b!=b?(this.kMassa=this.kMassb=this.kMassc=0,3):0==b?(b=0,0!=this.kMassa?this.kMassa=1/this.kMassa:(this.kMassa=0,b|=1),0!=this.kMassc?this.kMassc=1/this.kMassc:(this.kMassc=0,b|=2),this.kMassb=0,b):(b=1/b,c=this.kMassc*b,this.kMassc=this.kMassa*b,this.kMassa=c,this.kMassb*=-b,0)):(this.hc2=!1,this.oc2.dist<this.oc1.dist&&(b=this.c1,this.c1=this.c2,this.c2=b),this.oc2.active=!1,this.contacts.modified=!0));this.surfacex=this.b2.svelx;this.surfacey=this.b2.svely;this.surfacex+=1*this.b1.svelx;
this.surfacey+=1*this.b1.svely;this.surfacex=-this.surfacex;this.surfacey=-this.surfacey;this.rMass=this.b1.sinertia+this.b2.sinertia;0!=this.rMass&&(this.rMass=1/this.rMass);return a},warmStart:function(){var a=this.nx*this.c1.jnAcc-this.ny*this.c1.jtAcc,b=this.ny*this.c1.jnAcc+this.nx*this.c1.jtAcc,c=this.b1.imass;this.b1.velx-=a*c;this.b1.vely-=b*c;this.b1.angvel-=this.b1.iinertia*(b*this.c1.r1x-a*this.c1.r1y);c=this.b2.imass;this.b2.velx+=a*c;this.b2.vely+=b*c;this.b2.angvel+=this.b2.iinertia*
(b*this.c1.r2x-a*this.c1.r2y);this.hc2&&(a=this.nx*this.c2.jnAcc-this.ny*this.c2.jtAcc,b=this.ny*this.c2.jnAcc+this.nx*this.c2.jtAcc,c=this.b1.imass,this.b1.velx-=a*c,this.b1.vely-=b*c,this.b1.angvel-=this.b1.iinertia*(b*this.c2.r1x-a*this.c2.r1y),c=this.b2.imass,this.b2.velx+=a*c,this.b2.vely+=b*c,this.b2.angvel+=this.b2.iinertia*(b*this.c2.r2x-a*this.c2.r2y));this.b2.angvel+=this.jrAcc*this.b2.iinertia;this.b1.angvel-=this.jrAcc*this.b1.iinertia},applyImpulseVel:function(){var a,b,c,d,e;d=this.k1x+
this.b2.velx-this.c1.r2y*this.b2.angvel-(this.b1.velx-this.c1.r1y*this.b1.angvel);var f=this.k1y+this.b2.vely+this.c1.r2x*this.b2.angvel-(this.b1.vely+this.c1.r1x*this.b1.angvel);c=(f*this.nx-d*this.ny+this.surfacex)*this.c1.tMass;d=this.c1.friction*this.c1.jnAcc;a=this.c1.jtAcc;e=a-c;e>d?e=d:e<-d&&(e=-d);c=e-a;this.c1.jtAcc=e;a=-this.ny*c;b=this.nx*c;this.b2.velx+=a*this.b2.imass;this.b2.vely+=b*this.b2.imass;this.b1.velx-=a*this.b1.imass;this.b1.vely-=b*this.b1.imass;this.b2.angvel+=this.rt1b*c*
this.b2.iinertia;this.b1.angvel-=this.rt1a*c*this.b1.iinertia;this.hc2?(e=this.k2x+this.b2.velx-this.c2.r2y*this.b2.angvel-(this.b1.velx-this.c2.r1y*this.b1.angvel),b=this.k2y+this.b2.vely+this.c2.r2x*this.b2.angvel-(this.b1.vely+this.c2.r1x*this.b1.angvel),c=(b*this.nx-e*this.ny+this.surfacex)*this.c2.tMass,d=this.c2.friction*this.c2.jnAcc,a=this.c2.jtAcc,e=a-c,e>d?e=d:e<-d&&(e=-d),c=e-a,this.c2.jtAcc=e,a=-this.ny*c,b=this.nx*c,this.b2.velx+=a*this.b2.imass,this.b2.vely+=b*this.b2.imass,this.b1.velx-=
a*this.b1.imass,this.b1.vely-=b*this.b1.imass,this.b2.angvel+=this.rt2b*c*this.b2.iinertia,this.b1.angvel-=this.rt2a*c*this.b1.iinertia,d=this.k1x+this.b2.velx-this.c1.r2y*this.b2.angvel-(this.b1.velx-this.c1.r1y*this.b1.angvel),f=this.k1y+this.b2.vely+this.c1.r2x*this.b2.angvel-(this.b1.vely+this.c1.r1x*this.b1.angvel),e=this.k2x+this.b2.velx-this.c2.r2y*this.b2.angvel-(this.b1.velx-this.c2.r1y*this.b1.angvel),b=this.k2y+this.b2.vely+this.c2.r2x*this.b2.angvel-(this.b1.vely+this.c2.r1x*this.b1.angvel),
c=this.c1.jnAcc,a=this.c2.jnAcc,d=d*this.nx+f*this.ny+this.surfacey+this.c1.bounce-(this.Ka*c+this.Kb*a),e=e*this.nx+b*this.ny+this.surfacey+this.c2.bounce-(this.Kb*c+this.Kc*a),b=-(this.kMassa*d+this.kMassb*e),f=-(this.kMassb*d+this.kMassc*e),0<=b&&0<=f?(d=b-c,e=f-a,this.c1.jnAcc=b,this.c2.jnAcc=f):(b=-this.c1.nMass*d,0<=b&&0<=this.Kb*b+e?(d=b-c,e=-a,this.c1.jnAcc=b,this.c2.jnAcc=0):(f=-this.c2.nMass*e,0<=f&&0<=this.Kb*f+d?(d=-c,e=f-a,this.c1.jnAcc=0,this.c2.jnAcc=f):0<=d&&0<=e?(d=-c,e=-a,this.c1.jnAcc=
this.c2.jnAcc=0):e=d=0)),c=d+e,a=this.nx*c,b=this.ny*c,this.b2.velx+=a*this.b2.imass,this.b2.vely+=b*this.b2.imass,this.b1.velx-=a*this.b1.imass,this.b1.vely-=b*this.b1.imass,this.b2.angvel+=(this.rn1b*d+this.rn2b*e)*this.b2.iinertia,this.b1.angvel-=(this.rn1a*d+this.rn2a*e)*this.b1.iinertia):(0!=this.radius&&(c=(this.b2.angvel-this.b1.angvel)*this.rMass,d=this.rfric*this.c1.jnAcc,a=this.jrAcc,this.jrAcc-=c,this.jrAcc>d?this.jrAcc=d:this.jrAcc<-d&&(this.jrAcc=-d),c=this.jrAcc-a,this.b2.angvel+=c*
this.b2.iinertia,this.b1.angvel-=c*this.b1.iinertia),d=this.k1x+this.b2.velx-this.c1.r2y*this.b2.angvel-(this.b1.velx-this.c1.r1y*this.b1.angvel),f=this.k1y+this.b2.vely+this.c1.r2x*this.b2.angvel-(this.b1.vely+this.c1.r1x*this.b1.angvel),c=(this.c1.bounce+(this.nx*d+this.ny*f)+this.surfacey)*this.c1.nMass,a=this.c1.jnAcc,e=a-c,0>e&&(e=0),c=e-a,this.c1.jnAcc=e,a=this.nx*c,b=this.ny*c,this.b2.velx+=a*this.b2.imass,this.b2.vely+=b*this.b2.imass,this.b1.velx-=a*this.b1.imass,this.b1.vely-=b*this.b1.imass,
this.b2.angvel+=this.rn1b*c*this.b2.iinertia,this.b1.angvel-=this.rn1a*c*this.b1.iinertia)},applyImpulsePos:function(){if(2==this.ptype){var a=this.c1,b=0,c=0,b=this.b2.axisy*a.lr2x-this.b2.axisx*a.lr2y,c=a.lr2x*this.b2.axisx+a.lr2y*this.b2.axisy,b=b+1*this.b2.posx,c=c+1*this.b2.posy,d=0,e=0,d=this.b1.axisy*a.lr1x-this.b1.axisx*a.lr1y,e=a.lr1x*this.b1.axisx+a.lr1y*this.b1.axisy,d=d+1*this.b1.posx,e=e+1*this.b1.posy,f=a=0,a=b-d,f=c-e,k=Math.sqrt(a*a+f*f),g=this.radius-m.collisionSlop,j=k-g;0>a*this.nx+
f*this.ny&&(a=-a,f=-f,j-=this.radius);0>j&&(k<m.epsilon?0!=this.b1.smass?this.b1.posx+=10*m.epsilon:this.b2.posx+=10*m.epsilon:(j=1/k,a*=j,f*=j,b=0.5*(d+b),c=0.5*(e+c),d=b-this.b1.posx,e=c-this.b1.posy,b-=this.b2.posx,c-=this.b2.posy,d=f*d-a*e,b=f*b-a*c,c=this.b2.smass+b*b*this.b2.sinertia+this.b1.smass+d*d*this.b1.sinertia,0!=c&&(k=-this.biasCoef*(k-g)/c,c=g=0,g=a*k,c=f*k,a=this.b1.imass,this.b1.posx-=g*a,this.b1.posy-=c*a,this.b1.delta_rot(-d*this.b1.iinertia*k),a=this.b2.imass,this.b2.posx+=g*
a,this.b2.posy+=c*a,this.b2.delta_rot(b*this.b2.iinertia*k))))}else{var h=j=f=a=0,e=b=0;0==this.ptype?(a=this.b1.axisy*this.lnormx-this.b1.axisx*this.lnormy,f=this.lnormx*this.b1.axisx+this.lnormy*this.b1.axisy,g=this.lproj+(a*this.b1.posx+f*this.b1.posy),j=this.b2.axisy*this.c1.lr1x-this.b2.axisx*this.c1.lr1y,h=this.c1.lr1x*this.b2.axisx+this.c1.lr1y*this.b2.axisy,j+=1*this.b2.posx,h+=1*this.b2.posy,this.hpc2&&(b=this.b2.axisy*this.c2.lr1x-this.b2.axisx*this.c2.lr1y,e=this.c2.lr1x*this.b2.axisx+
this.c2.lr1y*this.b2.axisy,b+=1*this.b2.posx,e+=1*this.b2.posy)):(a=this.b2.axisy*this.lnormx-this.b2.axisx*this.lnormy,f=this.lnormx*this.b2.axisx+this.lnormy*this.b2.axisy,g=this.lproj+(a*this.b2.posx+f*this.b2.posy),j=this.b1.axisy*this.c1.lr1x-this.b1.axisx*this.c1.lr1y,h=this.c1.lr1x*this.b1.axisx+this.c1.lr1y*this.b1.axisy,j+=1*this.b1.posx,h+=1*this.b1.posy,this.hpc2&&(b=this.b1.axisy*this.c2.lr1x-this.b1.axisx*this.c2.lr1y,e=this.c2.lr1x*this.b1.axisx+this.c2.lr1y*this.b1.axisy,b+=1*this.b1.posx,
e+=1*this.b1.posy));k=j*a+h*f-g-this.radius;k+=m.collisionSlop;c=0;this.hpc2&&(c=b*a+e*f-g-this.radius,c+=m.collisionSlop);if(0>k||0>c){this.rev&&(a=-a,f=-f);var n=0,p=0,n=j-this.b1.posx,p=h-this.b1.posy,d=g=0,g=j-this.b2.posx,d=h-this.b2.posy,r=0,Q=0,h=j=0;if(this.hpc2){r=b-this.b1.posx;Q=e-this.b1.posy;j=b-this.b2.posx;h=e-this.b2.posy;b=f*n-a*p;g=f*g-a*d;e=f*r-a*Q;d=f*j-a*h;j=this.b1.smass+this.b2.smass;this.kMassa=j+this.b1.sinertia*b*b+this.b2.sinertia*g*g;this.kMassb=j+this.b1.sinertia*b*e+
this.b2.sinertia*g*d;this.kMassc=j+this.b1.sinertia*e*e+this.b2.sinertia*d*d;n=h=j=0;j=this.kMassa;h=this.kMassb;n=this.kMassc;p=k*this.biasCoef;r=c*this.biasCoef;c=k=0;k=-p;c=-r;Q=this.kMassa*this.kMassc-this.kMassb*this.kMassb;if(Q!=Q)k=c=0;else if(0==Q)k=0!=this.kMassa?k/this.kMassa:0,c=0!=this.kMassc?c/this.kMassc:0;else var Q=1/Q,o=Q*(this.kMassc*k-this.kMassb*c),c=Q*(this.kMassa*c-this.kMassb*k),k=o;0<=k&&0<=c?(j=(k+c)*this.b1.imass,this.b1.posx-=a*j,this.b1.posy-=f*j,this.b1.delta_rot(-this.b1.iinertia*
(b*k+e*c)),b=(k+c)*this.b2.imass,this.b2.posx+=a*b,this.b2.posy+=f*b,this.b2.delta_rot(this.b2.iinertia*(g*k+d*c))):(k=-p/j,c=0,0<=k&&0<=h*k+r?(j=(k+c)*this.b1.imass,this.b1.posx-=a*j,this.b1.posy-=f*j,this.b1.delta_rot(-this.b1.iinertia*(b*k+e*c)),b=(k+c)*this.b2.imass,this.b2.posx+=a*b,this.b2.posy+=f*b,this.b2.delta_rot(this.b2.iinertia*(g*k+d*c))):(k=0,c=-r/n,0<=c&&0<=h*c+p&&(j=(k+c)*this.b1.imass,this.b1.posx-=a*j,this.b1.posy-=f*j,this.b1.delta_rot(-this.b1.iinertia*(b*k+e*c)),b=(k+c)*this.b2.imass,
this.b2.posx+=a*b,this.b2.posy+=f*b,this.b2.delta_rot(this.b2.iinertia*(g*k+d*c)))))}else b=f*n-a*p,g=f*g-a*d,c=this.b2.smass+g*g*this.b2.sinertia+this.b1.smass+b*b*this.b1.sinertia,0!=c&&(k=-this.biasCoef*k/c,d=c=0,c=a*k,d=f*k,a=this.b1.imass,this.b1.posx-=c*a,this.b1.posy-=d*a,this.b1.delta_rot(-b*this.b1.iinertia*k),a=this.b2.imass,this.b2.posx+=c*a,this.b2.posy+=d*a,this.b2.delta_rot(g*this.b2.iinertia*k))}}},__class__:Ya});var Xa=function(){this.length=0;this._inuse=this.modified=this.pushmod=
!1;this.next=null;this.dist=this.elasticity=0;this.fresh=!1;this.stamp=this.hash=0;this.active=this.posOnly=!1;this.arbiter=this.inner=null;this.px=this.py=0;this.outer=null;this.inner=new Lf};h["zpp_nape.dynamics.ZPP_Contact"]=Xa;Xa.__name__=!0;Xa.prototype={wrapper:function(){null==this.outer&&(Xa.internal=!0,this.outer=new Hg,Xa.internal=!1,this.outer.zpp_inner=this);return this.outer},inlined_add:function(a){a._inuse=!0;a.next=this.next;this.next=a;this.modified=!0;this.length++;return a},pop:function(){this.inlined_pop()},
inlined_pop:function(){var a=this.next;this.next=a.next;a._inuse=!1;null==this.next&&(this.pushmod=!0);this.modified=!0;this.length--},inlined_pop_unsafe:function(){var a=this.next;this.pop();return a},inlined_erase:function(a){var b,c;null==a?(b=this.next,this.next=c=b.next,null==this.next&&(this.pushmod=!0)):(b=a.next,c=b.next,a.next=c,null==c&&(this.pushmod=!0));b._inuse=!1;this.modified=!0;this.length--;this.pushmod=!0;return c},__class__:Xa};var Lf=function(){this.length=0;this._inuse=this.modified=
this.pushmod=!1;this.next=null;this.r1x=this.r1y=this.r2x=this.r2y=this.nMass=this.tMass=this.bounce=this.friction=this.jnAcc=this.jtAcc=this.lr1x=this.lr1y=this.lr2x=this.lr2y=0};h["zpp_nape.dynamics.ZPP_IContact"]=Lf;Lf.__name__=!0;Lf.prototype={add:function(a){return this.inlined_add(a)},inlined_add:function(a){a._inuse=!0;a.next=this.next;this.next=a;this.modified=!0;this.length++;return a},inlined_pop:function(){var a=this.next;this.next=a.next;a._inuse=!1;null==this.next&&(this.pushmod=!0);
this.modified=!0;this.length--},inlined_erase:function(a){var b,c;null==a?(b=this.next,this.next=c=b.next,null==this.next&&(this.pushmod=!0)):(b=a.next,c=b.next,a.next=c,null==c&&(this.pushmod=!0));b._inuse=!1;this.modified=!0;this.length--;this.pushmod=!0;return c},__class__:Lf};var ya=function(){this.collisionGroup=this.collisionMask=this.sensorGroup=this.sensorMask=this.fluidGroup=this.fluidMask=0;this.next=this.outer=this.shapes=null;this.shapes=new kd;this.collisionGroup=this.sensorGroup=this.fluidGroup=
1;this.collisionMask=this.sensorMask=this.fluidMask=-1};h["zpp_nape.dynamics.ZPP_InteractionFilter"]=ya;ya.__name__=!0;ya.prototype={wrapper:function(){if(null==this.outer){this.outer=new ob;var a=this.outer.zpp_inner;a.outer=null;a.next=ya.zpp_pool;ya.zpp_pool=a;this.outer.zpp_inner=this}return this.outer},shouldCollide:function(a){return 0!=(this.collisionMask&a.collisionGroup)&&0!=(a.collisionMask&this.collisionGroup)},shouldSense:function(a){return 0!=(this.sensorMask&a.sensorGroup)&&0!=(a.sensorMask&
this.sensorGroup)},shouldFlow:function(a){return 0!=(this.fluidMask&a.fluidGroup)&&0!=(a.fluidMask&this.fluidGroup)},invalidate:function(){for(var a=this.shapes.head;null!=a;)a.elt.invalidate_filter(),a=a.next},__class__:ya};var xh=function(){this.depth=0;this.group=this.interactors=null;this.ignore=!1;this.outer=null};h["zpp_nape.dynamics.ZPP_InteractionGroup"]=xh;xh.__name__=!0;xh.prototype={__class__:xh};var ga=function(){this.wrap_max=null;this.maxx=this.maxy=0;this.wrap_min=null;this.minx=this.miny=
0;this.outer=this.next=null;this._immutable=!1;this._invalidate=this._validate=null};h["zpp_nape.geom.ZPP_AABB"]=ga;ga.__name__=!0;ga.get=function(a,b,c,d){var e;null==ga.zpp_pool?e=new ga:(e=ga.zpp_pool,ga.zpp_pool=e.next,e.next=null);null;e.minx=a;e.miny=b;e.maxx=c;e.maxy=d;return e};ga.prototype={validate:function(){null!=this._validate&&this._validate()},perimeter:function(){return 2*(this.maxx-this.minx+(this.maxy-this.miny))},getmin:function(){null==this.wrap_min&&(this.wrap_min=B.get(this.minx,
this.miny,null),this.wrap_min.zpp_inner._inuse=!0,this._immutable?this.wrap_min.zpp_inner._immutable=!0:this.wrap_min.zpp_inner._invalidate=q(this,this.mod_min),this.wrap_min.zpp_inner._validate=q(this,this.dom_min));return this.wrap_min},dom_min:function(){null!=this._validate&&this._validate();this.wrap_min.zpp_inner.x=this.minx;this.wrap_min.zpp_inner.y=this.miny},mod_min:function(a){if(a.x!=this.minx||a.y!=this.miny)this.minx=a.x,this.miny=a.y,null!=this._invalidate&&this._invalidate(this)},getmax:function(){null==
this.wrap_max&&(this.wrap_max=B.get(this.maxx,this.maxy,null),this.wrap_max.zpp_inner._inuse=!0,this._immutable?this.wrap_max.zpp_inner._immutable=!0:this.wrap_max.zpp_inner._invalidate=q(this,this.mod_max),this.wrap_max.zpp_inner._validate=q(this,this.dom_max));return this.wrap_max},dom_max:function(){null!=this._validate&&this._validate();this.wrap_max.zpp_inner.x=this.maxx;this.wrap_max.zpp_inner.y=this.maxy},mod_max:function(a){if(a.x!=this.maxx||a.y!=this.maxy)this.maxx=a.x,this.maxy=a.y,null!=
this._invalidate&&this._invalidate(this)},intersectY:function(a){return!(a.miny>this.maxy||this.miny>a.maxy)},intersect:function(a){return a.miny<=this.maxy&&this.miny<=a.maxy&&a.minx<=this.maxx&&this.minx<=a.maxx},combine:function(a){a.minx<this.minx&&(this.minx=a.minx);a.maxx>this.maxx&&(this.maxx=a.maxx);a.miny<this.miny&&(this.miny=a.miny);a.maxy>this.maxy&&(this.maxy=a.maxy)},contains:function(a){return a.minx>=this.minx&&a.miny>=this.miny&&a.maxx<=this.maxx&&a.maxy<=this.maxy},containsPoint:function(a){return a.x>=
this.minx&&a.x<=this.maxx&&a.y>=this.miny&&a.y<=this.maxy},setCombine:function(a,b){this.minx=a.minx<b.minx?a.minx:b.minx;this.miny=a.miny<b.miny?a.miny:b.miny;this.maxx=a.maxx>b.maxx?a.maxx:b.maxx;this.maxy=a.maxy>b.maxy?a.maxy:b.maxy},setExpand:function(a,b){this.minx=a.minx-b;this.miny=a.miny-b;this.maxx=a.maxx+b;this.maxy=a.maxy+b},toString:function(){return"{ x: "+this.minx+" y: "+this.miny+" w: "+(this.maxx-this.minx)+" h: "+(this.maxy-this.miny)+" }"},__class__:ga};var we=function(){this.length=
0;this.modified=this.pushmod=!1;this.head=null};h["zpp_nape.util.ZNPList_ZPP_Vec2"]=we;we.__name__=!0;we.prototype={add:function(a){return this.inlined_add(a)},inlined_add:function(a){var b;null==Qa.zpp_pool?b=new Qa:(b=Qa.zpp_pool,Qa.zpp_pool=b.next,b.next=null);null;b.elt=a;b.next=this.head;this.head=b;this.modified=!0;this.length++;return a},insert:function(a,b){return this.inlined_insert(a,b)},inlined_insert:function(a,b){var c;null==Qa.zpp_pool?c=new Qa:(c=Qa.zpp_pool,Qa.zpp_pool=c.next,c.next=
null);null;c.elt=b;null==a?(c.next=this.head,this.head=c):(c.next=a.next,a.next=c);this.pushmod=this.modified=!0;this.length++;return c},pop:function(){this.inlined_pop()},inlined_pop:function(){var a=this.head;this.head=a.next;a.elt=null;a.next=Qa.zpp_pool;Qa.zpp_pool=a;null==this.head&&(this.pushmod=!0);this.modified=!0;this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var a=this.head.elt;this.pop();return a},erase:function(a){return this.inlined_erase(a)},
inlined_erase:function(a){var b,c;null==a?(b=this.head,this.head=c=b.next,null==this.head&&(this.pushmod=!0)):(b=a.next,c=b.next,a.next=c,null==c&&(this.pushmod=!0));a=b;a.elt=null;a.next=Qa.zpp_pool;Qa.zpp_pool=a;this.modified=!0;this.length--;this.pushmod=!0;return c},clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},iterator_at:function(a){for(var b=this.head;0<a--&&null!=b;)b=b.next;return b},__class__:we};var t=function(){};h["zpp_nape.geom.ZPP_Collide"]=t;t.__name__=
!0;t.circleContains=function(a,b){var c=0,d=0,c=b.x-a.worldCOMx,d=b.y-a.worldCOMy;return c*c+d*d<a.radius*a.radius};t.polyContains=function(a,b){var c;c=!0;for(var d=a.edges.head;null!=d;){var e=d.elt;if(e.gnormx*b.x+e.gnormy*b.y<=e.gprojection)d=d.next;else{c=!1;break}}return c};t.contactCollide=function(a,b,c,d){if(b.type==f.id_ShapeType_POLYGON)if(a.type==f.id_ShapeType_POLYGON){for(var e=!0,i=-1.0E100,k=-1,g=null,j=null,h=a.polygon.edges.head;null!=h;){for(var n=h.elt,p=1.0E100,r=b.polygon.gverts.next;null!=
r;){var Q=r,Q=n.gnormx*Q.x+n.gnormy*Q.y;Q<p&&(p=Q);if(p-n.gprojection<=i)break;r=r.next}p-=n.gprojection;if(0<=p){e=!1;break}p>i&&(i=p,g=n,k=1);h=h.next}if(e){for(h=b.polygon.edges.head;null!=h;){n=h.elt;p=1.0E100;for(r=a.polygon.gverts.next;null!=r;){Q=r;Q=n.gnormx*Q.x+n.gnormy*Q.y;Q<p&&(p=Q);if(p-n.gprojection<=i)break;r=r.next}p-=n.gprojection;if(0<=p){e=!1;break}p>i&&(i=p,j=n,k=2);h=h.next}if(e){1==k?(a=b.polygon,b=g,j=1):(a=a.polygon,b=j,j=-1);g=null;e=1.0E100;for(i=a.edges.head;null!=i;)h=i.elt,
n=b.gnormx*h.gnormx+b.gnormy*h.gnormy,n<e&&(e=n,g=h),i=i.next;var i=e=0,e=g.gp0.x,i=g.gp0.y,n=h=0,h=g.gp1.x,n=g.gp1.y,r=p=0,p=h-e,r=n-i,o=b.gnormy*e-b.gnormx*i,Q=b.gnormy*h-b.gnormx*n,q=1/(Q-o),o=(-b.tp1-o)*q;o>m.epsilon&&(e+=p*o,i+=r*o);Q=(-b.tp0-Q)*q;Q<-m.epsilon&&(h+=p*Q,n+=r*Q);r=p=0;r=j;p=b.gnormx*r;r*=b.gnormy;c.lnormx=b.lnormx;c.lnormy=b.lnormy;c.lproj=b.lprojection;c.radius=0;c.rev=d!=(-1==j);c.ptype=c.rev?1:0;Q=e*b.gnormx+i*b.gnormy-b.gprojection;j=h*b.gnormx+n*b.gnormy-b.gprojection;if(0<
Q&&0<j)return!1;d&&(p=-p,r=-r);d=c.injectContact(e-0.5*b.gnormx*Q,i-0.5*b.gnormy*Q,p,r,Q,c.rev?1:0,0<Q);e-=1*a.body.posx;i-=1*a.body.posy;d.inner.lr1x=e*a.body.axisy+i*a.body.axisx;d.inner.lr1y=i*a.body.axisy-e*a.body.axisx;d=c.injectContact(h-0.5*b.gnormx*j,n-0.5*b.gnormy*j,p,r,j,c.rev?0:1,0<j);h-=1*a.body.posx;n-=1*a.body.posy;d.inner.lr1x=h*a.body.axisy+n*a.body.axisx;d.inner.lr1y=n*a.body.axisy-h*a.body.axisx;1==k?(c.__ref_edge1=b,c.__ref_edge2=g):(c.__ref_edge2=b,c.__ref_edge1=g);return!0}}}else{j=
-1.0E100;g=!0;e=k=null;i=b.polygon.gverts.next;for(h=b.polygon.edges.head;null!=h;){n=h.elt;p=n.gnormx*a.circle.worldCOMx+n.gnormy*a.circle.worldCOMy-n.gprojection-a.circle.radius;if(0<p){g=!1;break}p>j&&(j=p,k=n,e=i);i=i.next;h=h.next}if(g){g=e;e=null==e.next?b.polygon.gverts.next:e.next;i=a.circle.worldCOMy*k.gnormx-a.circle.worldCOMx*k.gnormy;if(i<=g.y*k.gnormx-g.x*k.gnormy)return j=a.circle.radius,i=e=0,e=g.x-a.circle.worldCOMx,i=g.y-a.circle.worldCOMy,h=e*e+i*i,h>j*j?j=null:h<m.epsilon*m.epsilon?
j=c.injectContact(a.circle.worldCOMx,a.circle.worldCOMy,1,0,-j,0,null):(h=1/Math.sqrt(h),n=h<m.epsilon?1.0E100:1/h,p=0.5+(a.circle.radius-0.5*j)*h,j=d?c.injectContact(a.circle.worldCOMx+e*p,a.circle.worldCOMy+i*p,-e*h,-i*h,n-j,0,null):c.injectContact(a.circle.worldCOMx+e*p,a.circle.worldCOMy+i*p,e*h,i*h,n-j,0,null)),null!=j&&(e=j.inner,c.ptype=2,h=i=0,i=g.x-b.polygon.body.posx,h=g.y-b.polygon.body.posy,c.__ref_edge1=k,c.__ref_vertex=-1,d?(e.lr1x=i*b.polygon.body.axisy+h*b.polygon.body.axisx,e.lr1y=
h*b.polygon.body.axisy-i*b.polygon.body.axisx,e.lr2x=a.circle.localCOMx,e.lr2y=a.circle.localCOMy):(e.lr2x=i*b.polygon.body.axisy+h*b.polygon.body.axisx,e.lr2y=h*b.polygon.body.axisy-i*b.polygon.body.axisx,e.lr1x=a.circle.localCOMx,e.lr1y=a.circle.localCOMy),c.radius=a.circle.radius),null!=j;if(i>=e.y*k.gnormx-e.x*k.gnormy)return g=a.circle.radius,i=j=0,j=e.x-a.circle.worldCOMx,i=e.y-a.circle.worldCOMy,h=j*j+i*i,h>g*g?g=null:h<m.epsilon*m.epsilon?g=c.injectContact(a.circle.worldCOMx,a.circle.worldCOMy,
1,0,-g,0,null):(h=1/Math.sqrt(h),n=h<m.epsilon?1.0E100:1/h,p=0.5+(a.circle.radius-0.5*g)*h,g=d?c.injectContact(a.circle.worldCOMx+j*p,a.circle.worldCOMy+i*p,-j*h,-i*h,n-g,0,null):c.injectContact(a.circle.worldCOMx+j*p,a.circle.worldCOMy+i*p,j*h,i*h,n-g,0,null)),null!=g&&(j=g.inner,c.ptype=2,h=i=0,i=e.x-b.polygon.body.posx,h=e.y-b.polygon.body.posy,c.__ref_edge1=k,c.__ref_vertex=1,d?(j.lr1x=i*b.polygon.body.axisy+h*b.polygon.body.axisx,j.lr1y=h*b.polygon.body.axisy-i*b.polygon.body.axisx,j.lr2x=a.circle.localCOMx,
j.lr2y=a.circle.localCOMy):(j.lr2x=i*b.polygon.body.axisy+h*b.polygon.body.axisx,j.lr2y=h*b.polygon.body.axisy-i*b.polygon.body.axisx,j.lr1x=a.circle.localCOMx,j.lr1y=a.circle.localCOMy),c.radius=a.circle.radius),null!=g;g=b=0;g=a.circle.radius+0.5*j;b=k.gnormx*g;g*=k.gnormy;i=e=0;e=a.circle.worldCOMx-b;i=a.circle.worldCOMy-g;b=d?c.injectContact(e,i,k.gnormx,k.gnormy,j,0,null):c.injectContact(e,i,-k.gnormx,-k.gnormy,j,0,null);c.ptype=d?0:1;c.lnormx=k.lnormx;c.lnormy=k.lnormy;c.rev=!d;c.lproj=k.lprojection;
c.radius=a.circle.radius;b.inner.lr1x=a.circle.localCOMx;b.inner.lr1y=a.circle.localCOMy;c.__ref_edge1=k;c.__ref_vertex=0;return!0}}else if(k=a.circle.radius+b.circle.radius,j=g=0,g=b.circle.worldCOMx-a.circle.worldCOMx,j=b.circle.worldCOMy-a.circle.worldCOMy,e=g*g+j*j,e>k*k?k=null:e<m.epsilon*m.epsilon?k=c.injectContact(a.circle.worldCOMx,a.circle.worldCOMy,1,0,-k,0,null):(e=1/Math.sqrt(e),i=e<m.epsilon?1.0E100:1/e,h=0.5+(a.circle.radius-0.5*k)*e,k=d?c.injectContact(a.circle.worldCOMx+g*h,a.circle.worldCOMy+
j*h,-g*e,-j*e,i-k,0,null):c.injectContact(a.circle.worldCOMx+g*h,a.circle.worldCOMy+j*h,g*e,j*e,i-k,0,null)),null!=k)return k=k.inner,d?(k.lr1x=b.circle.localCOMx,k.lr1y=b.circle.localCOMy,k.lr2x=a.circle.localCOMx,k.lr2y=a.circle.localCOMy):(k.lr1x=a.circle.localCOMx,k.lr1y=a.circle.localCOMy,k.lr2x=b.circle.localCOMx,k.lr2y=b.circle.localCOMy),c.radius=a.circle.radius+b.circle.radius,c.ptype=2,!0;return!1};t.testCollide_safe=function(a,b){if(b.type==f.id_ShapeType_CIRCLE)var c=a,a=b,b=c;return t.testCollide(a,
b)};t.testCollide=function(a,b){if(b.type==f.id_ShapeType_POLYGON){if(a.type==f.id_ShapeType_POLYGON){for(var c=!0,d=a.polygon.edges.head;null!=d;){for(var e=d.elt,i=1.0E100,k=b.polygon.gverts.next;null!=k;){var g=k,g=e.gnormx*g.x+e.gnormy*g.y;g<i&&(i=g);k=k.next}i-=e.gprojection;if(0<i){c=!1;break}d=d.next}if(c){for(d=b.polygon.edges.head;null!=d;){e=d.elt;i=1.0E100;for(k=a.polygon.gverts.next;null!=k;)g=k,g=e.gnormx*g.x+e.gnormy*g.y,g<i&&(i=g),k=k.next;i-=e.gprojection;if(0<i){c=!1;break}d=d.next}return c}}else{d=
c=null;e=!0;i=-1.0E100;k=b.polygon.gverts.next;for(g=b.polygon.edges.head;null!=g;){var h=g.elt,m=h.gnormx*a.circle.worldCOMx+h.gnormy*a.circle.worldCOMy-h.gprojection-a.circle.radius;if(0<m){e=!1;break}m>i&&(i=m,c=h,d=k);k=k.next;g=g.next}if(e){e=d;d=null==d.next?b.polygon.gverts.next:d.next;i=a.circle.worldCOMy*c.gnormx-a.circle.worldCOMx*c.gnormy;if(i<=e.y*c.gnormx-e.x*c.gnormy)return c=a.circle.radius,i=d=0,d=e.x-a.circle.worldCOMx,i=e.y-a.circle.worldCOMy,d*d+i*i<=c*c;return i>=d.y*c.gnormx-
d.x*c.gnormy?(c=a.circle.radius,i=e=0,e=d.x-a.circle.worldCOMx,i=d.y-a.circle.worldCOMy,e*e+i*i<=c*c):!0}}return!1}c=a.circle.radius+b.circle.radius;e=d=0;d=b.circle.worldCOMx-a.circle.worldCOMx;e=b.circle.worldCOMy-a.circle.worldCOMy;return d*d+e*e<=c*c};t.flowCollide=function(a,b,c){if(b.type==f.id_ShapeType_POLYGON){if(a.type==f.id_ShapeType_POLYGON){for(var d=[],e=[],i=!0,k=!0,g=a.polygon.edges.head;null!=g;){for(var h=g.elt,L=1.0E100,n=0,p=b.polygon.gverts.next;null!=p;){var r=p,o=h.gnormx*r.x+
h.gnormy*r.y;o<L&&(L=o);o>=h.gprojection+m.epsilon&&(e[n]=!0,k=!1);n++;p=p.next}L-=h.gprojection;if(0<L){i=!1;break}g=g.next}if(k)return b.polygon.validate_worldCOM(),c.overlap=b.polygon.area,c.centroidx=b.polygon.worldCOMx,c.centroidy=b.polygon.worldCOMy,null,!0;if(i){for(var k=!0,q=b.polygon.edges.head;null!=q;){for(var w=q.elt,v=1.0E100,y=0,u=a.polygon.gverts.next;null!=u;){var B=u,E=w.gnormx*B.x+w.gnormy*B.y;E<v&&(v=E);E>=w.gprojection+m.epsilon&&(d[y]=!0,k=!1);y++;u=u.next}v-=w.gprojection;if(0<
v){i=!1;break}q=q.next}if(k)return a.polygon.validate_worldCOM(),c.overlap=a.polygon.area,c.centroidx=a.polygon.worldCOMx,c.centroidy=a.polygon.worldCOMy,null,!0;if(i){for(;null!=t.flowpoly.head;){var G=t.flowpoly.pop_unsafe();if(!G._inuse){var D=G;null!=D.outer&&(D.outer.zpp_inner=null,D.outer=null);D._isimmutable=null;D._validate=null;D._invalidate=null;D.next=M.zpp_pool;M.zpp_pool=D}}for(var x=null,F=!1,A=a.polygon.gverts.next,I=0,C=b.polygon.gverts.next,ld=0,P=0,N=b.polygon.edgeCnt;P<N;){var H=
P++;if(e[H])C=C.next;else{ld=H;break}}if(null==C){for(var C=b.polygon.gverts.next,F=!0,da=0,J=a.polygon.edgeCnt;da<J;){var ha=da++;if(d[ha])A=A.next;else{I=ha;break}}null==A?A=a.polygon.gverts.next:(t.flowpoly.add(A),x=t.flowpoly.head.elt)}else t.flowpoly.add(C),x=t.flowpoly.head.elt;var K=1;if(null==t.flowpoly.head){for(var U=!0,V=a.polygon.gverts.next,lb=V,ba=V.next;null!=ba;){for(var aa=ba,Mf=2,Z=b.polygon.gverts.next,T=Z,Y=Z.next;null!=Y;){var $=Y,S=0;(function(){var a=0,b=0,a=lb.x-T.x,b=lb.y-
T.y,c=0,d=0,c=aa.x-lb.x,d=aa.y-lb.y,e=0,f=0,e=$.x-T.x,f=$.y-T.y,i=d*e-c*f;i*i>m.epsilon*m.epsilon?(i=1/i,e=(f*a-e*b)*i,e>m.epsilon&&e<1-m.epsilon?(a=(d*a-c*b)*i,a>m.epsilon&&a<1-m.epsilon?(S=e,a=!0):a=!1):a=!1):a=!1;return a})(this)&&S<Mf&&(Mf=S,C=Z);Z=Y;T=$;Y=Y.next}var ca=Y=b.polygon.gverts.next,na=0;(function(){var a=0,b=0,a=lb.x-T.x,b=lb.y-T.y,c=0,d=0,c=aa.x-lb.x,d=aa.y-lb.y,e=0,f=0,e=ca.x-T.x,f=ca.y-T.y,i=d*e-c*f;i*i>m.epsilon*m.epsilon?(i=1/i,e=(f*a-e*b)*i,e>m.epsilon&&e<1-m.epsilon?(a=(d*a-
c*b)*i,a>m.epsilon&&a<1-m.epsilon?(na=e,a=!0):a=!1):a=!1):a=!1;return a})(this)&&na<Mf&&(Mf=na,C=Z);if(2!=Mf){var ma=0,Ga=0,va=Mf,ma=lb.x+(aa.x-lb.x)*va,Ga=lb.y+(aa.y-lb.y)*va,x=M.get(ma,Ga,null);t.flowpoly.add(x);F=!0;A=V;U=!1;break}V=ba;lb=aa;ba=ba.next}if(U){for(var W=ba=a.polygon.gverts.next,s=2,ga=b.polygon.gverts.next,fa=ga,ka=ga.next;null!=ka;){var xa=ka,oa=0;(function(){var a=0,b=0,a=lb.x-fa.x,b=lb.y-fa.y,c=0,d=0,c=W.x-lb.x,d=W.y-lb.y,e=0,f=0,e=xa.x-fa.x,f=xa.y-fa.y,i=d*e-c*f;i*i>m.epsilon*
m.epsilon?(i=1/i,e=(f*a-e*b)*i,e>m.epsilon&&e<1-m.epsilon?(a=(d*a-c*b)*i,a>m.epsilon&&a<1-m.epsilon?(oa=e,a=!0):a=!1):a=!1):a=!1;return a})(this)&&oa<s&&(s=oa,C=ga);ga=ka;fa=xa;ka=ka.next}var ja=ka=b.polygon.gverts.next,Ha=0;(function(){var a=0,b=0,a=lb.x-fa.x,b=lb.y-fa.y,c=0,d=0,c=W.x-lb.x,d=W.y-lb.y,e=0,f=0,e=ja.x-fa.x,f=ja.y-fa.y,i=d*e-c*f;i*i>m.epsilon*m.epsilon?(i=1/i,e=(f*a-e*b)*i,e>m.epsilon&&e<1-m.epsilon?(a=(d*a-c*b)*i,a>m.epsilon&&a<1-m.epsilon?(Ha=e,a=!0):a=!1):a=!1):a=!1;return a})(this)&&
Ha<s&&(s=Ha,C=ga);if(2!=s){var ya=0,Ba=0,Nf=s,ya=lb.x+(W.x-lb.x)*Nf,Ba=lb.y+(W.y-lb.y)*Nf,x=M.get(ya,Ba,null);t.flowpoly.add(x);F=!0;A=V}}K=2}for(;;)if(F)if(A=A.next,I++,null==A&&(A=a.polygon.gverts.next,I=0),d[I]){var ia=t.flowpoly.head.elt,wb=A,je=C,xb=C.next;null==xb&&(xb=b.polygon.gverts.next);var xe=-1,Of=null,O=0,ab=0,ua=xb,Cc=xb;do{var wa=Cc,sa=0;if(function(){var a=0,b=0,a=je.x-ia.x,b=je.y-ia.y,c=0,d=0,c=wa.x-je.x,d=wa.y-je.y,e=0,f=0,e=wb.x-ia.x,f=wb.y-ia.y,i=d*e-c*f;i*i>m.epsilon*m.epsilon?
(i=1/i,e=(f*a-e*b)*i,e>m.epsilon&&e<1-m.epsilon?(a=(d*a-c*b)*i,a>m.epsilon&&a<1-m.epsilon?(sa=e,a=!0):a=!1):a=!1):a=!1;return a}(this)&&sa>=xe)if(Of=C,O=ld,++ab==K){xe=sa;Cc=ua;break}else xe=sa;je=wa;C=Cc;ld++;ld>=b.polygon.edgeCnt&&(ld=0);Cc=Cc.next;null==Cc&&(Cc=b.polygon.gverts.next)}while(0);for(;Cc!=ua;){var Xa=Cc,la=0;if(function(){var a=0,b=0,a=je.x-ia.x,b=je.y-ia.y,c=0,d=0,c=Xa.x-je.x,d=Xa.y-je.y,e=0,f=0,e=wb.x-ia.x,f=wb.y-ia.y,i=d*e-c*f;i*i>m.epsilon*m.epsilon?(i=1/i,e=(f*a-e*b)*i,e>m.epsilon&&
e<1-m.epsilon?(a=(d*a-c*b)*i,a>m.epsilon&&a<1-m.epsilon?(la=e,a=!0):a=!1):a=!1):a=!1;return a}(this)&&la>=xe)if(Of=C,O=ld,++ab==K){xe=la;Cc=ua;break}else xe=la;je=Xa;C=Cc;ld++;ld>=b.polygon.edgeCnt&&(ld=0);Cc=Cc.next;null==Cc&&(Cc=b.polygon.gverts.next)}if(null==Of)break;var Ma=Of,ib=Of.next;null==ib&&(ib=b.polygon.gverts.next);var Na=ib,Ia=0,Nh=0,Sa=xe,Ia=Ma.x+(Na.x-Ma.x)*Sa,Nh=Ma.y+(Na.y-Ma.y)*Sa;if(null!=x&&kb.vec_dsq(Ia,Nh,x.x,x.y)<m.epsilon)break;t.flowpoly.add(M.get(Ia,Nh,null));null==x&&(x=
t.flowpoly.head.elt);C=Of;ld=O;F=!F;K=2}else{var ra=A;if(null!=x&&kb.vec_dsq(ra.x,ra.y,x.x,x.y)<m.epsilon)break;t.flowpoly.add(ra);null==x&&(x=t.flowpoly.head.elt);K=1}else if(C=C.next,ld++,null==C&&(C=b.polygon.gverts.next,ld=0),e[ld]){var ta=t.flowpoly.head.elt,gb=C,z=A,hb=A.next;null==hb&&(hb=a.polygon.gverts.next);var Ya=-1,qa=null,Ea=0,cb=0,za=hb,Db=hb;do{var Fa=Db,Wa=0;if(function(){var a=0,b=0,a=z.x-ta.x,b=z.y-ta.y,c=0,d=0,c=Fa.x-z.x,d=Fa.y-z.y,e=0,f=0,e=gb.x-ta.x,f=gb.y-ta.y,i=d*e-c*f;i*i>
m.epsilon*m.epsilon?(i=1/i,e=(f*a-e*b)*i,e>m.epsilon&&e<1-m.epsilon?(a=(d*a-c*b)*i,a>m.epsilon&&a<1-m.epsilon?(Wa=e,a=!0):a=!1):a=!1):a=!1;return a}(this)&&Wa>=Ya)if(qa=A,Ea=I,++cb==K){Ya=Wa;Db=za;break}else Ya=Wa;z=Fa;A=Db;I++;I>=a.polygon.edgeCnt&&(I=0);Db=Db.next;null==Db&&(Db=a.polygon.gverts.next)}while(0);for(;Db!=za;){var Ra=Db,Qa=0;if(function(){var a=0,b=0,a=z.x-ta.x,b=z.y-ta.y,c=0,d=0,c=Ra.x-z.x,d=Ra.y-z.y,e=0,f=0,e=gb.x-ta.x,f=gb.y-ta.y,i=d*e-c*f;i*i>m.epsilon*m.epsilon?(i=1/i,e=(f*a-e*
b)*i,e>m.epsilon&&e<1-m.epsilon?(a=(d*a-c*b)*i,a>m.epsilon&&a<1-m.epsilon?(Qa=e,a=!0):a=!1):a=!1):a=!1;return a}(this)&&Qa>=Ya)if(qa=A,Ea=I,++cb==K){Ya=Qa;Db=za;break}else Ya=Qa;z=Ra;A=Db;I++;I>=a.polygon.edgeCnt&&(I=0);Db=Db.next;null==Db&&(Db=a.polygon.gverts.next)}if(null==qa)break;var Za=qa,Aa=qa.next;null==Aa&&(Aa=a.polygon.gverts.next);var $a=Aa,Oa=0,Oh=0,jb=Ya,Oa=Za.x+($a.x-Za.x)*jb,Oh=Za.y+($a.y-Za.y)*jb;if(null!=x&&kb.vec_dsq(Oa,Oh,x.x,x.y)<m.epsilon)break;t.flowpoly.add(M.get(Oa,Oh,null));
null==x&&(x=t.flowpoly.head.elt);A=qa;I=Ea;F=!F;K=2}else{var Ta=C;if(null!=x&&kb.vec_dsq(Ta.x,Ta.y,x.x,x.y)<m.epsilon)break;t.flowpoly.add(Ta);null==x&&(x=t.flowpoly.head.elt);K=1}if(null!=t.flowpoly.head&&null!=t.flowpoly.head.next&&null!=t.flowpoly.head.next.next){for(var Qd=0,ke=0,le=0,Qd=le=ke=0,yb=t.flowpoly.head,Ca=yb.elt,yb=yb.next,La=yb.elt,yb=yb.next;null!=yb;)var Pf=yb.elt,Qd=Qd+La.x*(Pf.y-Ca.y),ub=Pf.y*La.x-Pf.x*La.y,ke=ke+(La.x+Pf.x)*ub,le=le+(La.y+Pf.y)*ub,Ca=La,La=Pf,yb=yb.next;var yb=
t.flowpoly.head,me=yb.elt,Qd=Qd+La.x*(me.y-Ca.y),Th=me.y*La.x-me.x*La.y,ke=ke+(La.x+me.x)*Th,le=le+(La.y+me.y)*Th,Ca=La,La=me,yb=yb.next,Va=yb.elt,Qd=Qd+La.x*(Va.y-Ca.y),pb=Va.y*La.x-Va.x*La.y,ke=ke+(La.x+Va.x)*pb,le=le+(La.y+Va.y)*pb,Qd=0.5*Qd,Eb=1/(6*Qd),ke=ke*Eb,le=le*Eb;c.overlap=-Qd;c.centroidx=ke;c.centroidy=le;null;return!0}}}return!1}for(var qb=[],Gb=!0,Ka=null,db=null,Wb=-1.0E100,Yb=!0,sb=b.polygon.gverts.next,Zb=0,nb=b.polygon.edges.head;null!=nb;){var Ja=nb.elt,fb=Ja.gnormx*a.circle.worldCOMx+
Ja.gnormy*a.circle.worldCOMy;if(fb>Ja.gprojection+a.circle.radius){Yb=!1;break}else fb+a.circle.radius>Ja.gprojection+m.epsilon&&(Gb=!1,qb[Zb]=!0);fb-=Ja.gprojection+a.circle.radius;fb>Wb&&(Wb=fb,Ka=Ja,db=sb);sb=sb.next;Zb++;nb=nb.next}if(Yb){if(Gb)return c.overlap=a.circle.area,c.centroidx=a.circle.worldCOMx,c.centroidy=a.circle.worldCOMy,null,!0;var tb=db,Ua;Ua=null==db.next?b.polygon.gverts.next:db.next;var fc=a.circle.worldCOMy*Ka.gnormx-a.circle.worldCOMx*Ka.gnormy;if(fc<=tb.y*Ka.gnormx-tb.x*
Ka.gnormy?function(){var b=a.circle.radius,c=0,d=0,c=tb.x-a.circle.worldCOMx,d=tb.y-a.circle.worldCOMy;return c*c+d*d<=b*b}(this):fc>=Ua.y*Ka.gnormx-Ua.x*Ka.gnormy?function(){var b=a.circle.radius,c=0,d=0,c=Ua.x-a.circle.worldCOMx,d=Ua.y-a.circle.worldCOMy;return c*c+d*d<=b*b}(this):1){for(var rb=[],Qb=0,ic=!0,hc=null,pa=0,eb=b.polygon.gverts.next;null!=eb;){var pc=eb,Pc=kb.vec_dsq(pc.x,pc.y,a.circle.worldCOMx,a.circle.worldCOMy);(rb[Qb]=Pc<=a.circle.radius*a.circle.radius)?(pa=Qb,hc=eb):ic=!1;Qb++;
eb=eb.next}if(ic)return b.polygon.validate_worldCOM(),c.overlap=b.polygon.area,c.centroidx=b.polygon.worldCOMx,c.centroidy=b.polygon.worldCOMy,null,!0;for(;null!=t.flowpoly.head;){var sc=t.flowpoly.pop_unsafe();if(!sc._inuse){var Da=sc;null!=Da.outer&&(Da.outer.zpp_inner=null,Da.outer=null);Da._isimmutable=null;Da._validate=null;Da._invalidate=null;Da.next=M.zpp_pool;M.zpp_pool=Da}}t.flowsegs.clear();var zb=null,Pa=1;null==hc?(hc=b.polygon.gverts.next,Pa=2):t.flowpoly.add(zb=hc);for(;0!=Pa;)if(1==
Pa)if(hc=hc.next,null==hc&&(hc=b.polygon.gverts.next),pa++,pa>=b.polygon.edgeCnt&&(pa=0),rb[pa]){if(kb.vec_dsq(zb.x,zb.y,hc.x,hc.y)<m.epsilon)break;t.flowpoly.add(hc)}else{var ea=t.flowpoly.head.elt,Hb=hc,Ib=0,Jb=0,Ib=Hb.x-ea.x,Jb=Hb.y-ea.y,Kb=0,Mb=0,Kb=ea.x-a.circle.worldCOMx,Mb=ea.y-a.circle.worldCOMy,vb=Ib*Ib+Jb*Jb,Nb=2*(Kb*Ib+Mb*Jb),vc=Math.sqrt(Nb*Nb-4*vb*(Kb*Kb+Mb*Mb-a.circle.radius*a.circle.radius)),vb=1/(2*vb),wc=(-Nb-vc)*vb,dc=0,ec=0,zc=wc<m.epsilon?(-Nb+vc)*vb:wc,dc=ea.x+(Hb.x-ea.x)*zc,
ec=ea.y+(Hb.y-ea.y)*zc;if(kb.vec_dsq(zb.x,zb.y,dc,ec)<m.epsilon)break;t.flowpoly.add(M.get(dc,ec,null));Pa=2}else if(2==Pa){var Ob=hc.next;null==Ob&&(Ob=b.polygon.gverts.next);var X=hc,Pa=0,bb=Ob,Ab=Ob;do{var R=Ab,Pb=pa+1;Pb==b.polygon.edgeCnt&&(Pb=0);if(qb[pa])if(rb[Pb]){var Rb=0,Sb=0,Rb=R.x-X.x,Sb=R.y-X.y,Tb=0,Ub=0,Tb=X.x-a.circle.worldCOMx,Ub=X.y-a.circle.worldCOMy,mb=Rb*Rb+Sb*Sb,Xb=2*(Tb*Rb+Ub*Sb),Hc=Math.sqrt(Xb*Xb-4*mb*(Tb*Tb+Ub*Ub-a.circle.radius*a.circle.radius)),mb=1/(2*mb),Jc=(-Xb-Hc)*mb,
rc=0,yc=0,Vc=Jc<m.epsilon?(-Xb+Hc)*mb:Jc,rc=X.x+(R.x-X.x)*Vc,yc=X.y+(R.y-X.y)*Vc;if(kb.vec_dsq(zb.x,zb.y,rc,yc)<m.epsilon){Pa=0;Ab=bb;break}var Wc=M.get(rc,yc,null);t.flowsegs.add(t.flowpoly.head.elt);t.flowsegs.add(Wc);t.flowpoly.add(Wc);Pa=1;Ab=bb;break}else{var gc=0,jc=0,Kc,lc=0,mc=0,lc=R.x-X.x,mc=R.y-X.y,nc=0,oc=0,nc=X.x-a.circle.worldCOMx,oc=X.y-a.circle.worldCOMy,Fb=lc*lc+mc*mc,$b=2*(nc*lc+oc*mc),ob=$b*$b-4*Fb*(nc*nc+oc*oc-a.circle.radius*a.circle.radius);ob*ob<m.epsilon?(gc=0>ob?10:jc=-$b/
(2*Fb),Kc=!1):(ob=Math.sqrt(ob),Fb=1/(2*Fb),gc=(-$b-ob)*Fb,jc=(-$b+ob)*Fb,Kc=!0);if(gc<1-m.epsilon&&jc>m.epsilon){var Rc=0,Uc=0,cd=gc,Rc=X.x+(R.x-X.x)*cd,Uc=X.y+(R.y-X.y)*cd;if(null!=zb&&kb.vec_dsq(zb.x,zb.y,Rc,Uc)<m.epsilon){Pa=0;Ab=bb;break}var dd=M.get(Rc,Uc,null);null!=t.flowpoly.head&&(t.flowsegs.add(t.flowpoly.head.elt),t.flowsegs.add(dd));t.flowpoly.add(dd);null==zb&&(zb=t.flowpoly.head.elt);if(Kc){var hd=0,id=0,jd=jc,hd=X.x+(R.x-X.x)*jd,id=X.y+(R.y-X.y)*jd;t.flowpoly.add(M.get(hd,id,null))}}}X=
R;hc=Ab;pa=Pb;Ab=Ab.next;null==Ab&&(Ab=b.polygon.gverts.next)}while(0);for(;Ab!=bb;){var Rd=Ab,Ac=pa+1;Ac==b.polygon.edgeCnt&&(Ac=0);if(qb[pa])if(rb[Ac]){var Bc=0,Ec=0,Bc=Rd.x-X.x,Ec=Rd.y-X.y,Fc=0,Gc=0,Fc=X.x-a.circle.worldCOMx,Gc=X.y-a.circle.worldCOMy,kc=Bc*Bc+Ec*Ec,Ic=2*(Fc*Bc+Gc*Ec),nd=Math.sqrt(Ic*Ic-4*kc*(Fc*Fc+Gc*Gc-a.circle.radius*a.circle.radius)),kc=1/(2*kc),od=(-Ic-nd)*kc,Yc=0,Zc=0,qd=od<m.epsilon?(-Ic+nd)*kc:od,Yc=X.x+(Rd.x-X.x)*qd,Zc=X.y+(Rd.y-X.y)*qd;if(kb.vec_dsq(zb.x,zb.y,Yc,Zc)<m.epsilon){Pa=
0;Ab=bb;break}var rd=M.get(Yc,Zc,null);t.flowsegs.add(t.flowpoly.head.elt);t.flowsegs.add(rd);t.flowpoly.add(rd);Pa=1;Ab=bb;break}else{var Lc=0,Mc=0,$c,Nc=0,Oc=0,Nc=Rd.x-X.x,Oc=Rd.y-X.y,Qc=0,Sc=0,Qc=X.x-a.circle.worldCOMx,Sc=X.y-a.circle.worldCOMy,cc=Nc*Nc+Oc*Oc,tc=2*(Qc*Nc+Sc*Oc),Lb=tc*tc-4*cc*(Qc*Qc+Sc*Sc-a.circle.radius*a.circle.radius);Lb*Lb<m.epsilon?(Lc=0>Lb?10:Mc=-tc/(2*cc),$c=!1):(Lb=Math.sqrt(Lb),cc=1/(2*cc),Lc=(-tc-Lb)*cc,Mc=(-tc+Lb)*cc,$c=!0);if(Lc<1-m.epsilon&&Mc>m.epsilon){var fd=0,kd=
0,Bd=Lc,fd=X.x+(Rd.x-X.x)*Bd,kd=X.y+(Rd.y-X.y)*Bd;if(null!=zb&&kb.vec_dsq(zb.x,zb.y,fd,kd)<m.epsilon){Pa=0;Ab=bb;break}var Cd=M.get(fd,kd,null);null!=t.flowpoly.head&&(t.flowsegs.add(t.flowpoly.head.elt),t.flowsegs.add(Cd));t.flowpoly.add(Cd);null==zb&&(zb=t.flowpoly.head.elt);if($c){var Ed=0,Fd=0,Gd=Mc,Ed=X.x+(Rd.x-X.x)*Gd,Fd=X.y+(Rd.y-X.y)*Gd;t.flowpoly.add(M.get(Ed,Fd,null))}}}X=Rd;hc=Ab;pa=Ac;Ab=Ab.next;null==Ab&&(Ab=b.polygon.gverts.next)}}if(null==t.flowpoly.head)return!1;if(null==t.flowpoly.head.next){for(var Hd=
!0,ad=b.polygon.edges.head;null!=ad;){var td=ad.elt;if(td.gnormx*a.circle.worldCOMx+td.gnormy*a.circle.worldCOMy>td.gprojection){Hd=!1;break}ad=ad.next}return Hd?(c.overlap=a.circle.area,c.centroidx=a.circle.worldCOMx,c.centroidy=a.circle.worldCOMy,null,!0):!1}var ac=0,bc=0,qc=0;if(null!=t.flowpoly.head.next.next){for(var Ad=0,ne=0,oe=0,Ad=oe=ne=0,Dc=t.flowpoly.head,Tc=Dc.elt,Dc=Dc.next,Bb=Dc.elt,Dc=Dc.next;null!=Dc;)var uc=Dc.elt,Ad=Ad+Bb.x*(uc.y-Tc.y),Kd=uc.y*Bb.x-uc.x*Bb.y,ne=ne+(Bb.x+uc.x)*Kd,
oe=oe+(Bb.y+uc.y)*Kd,Tc=Bb,Bb=uc,Dc=Dc.next;var Dc=t.flowpoly.head,xc=Dc.elt,Ad=Ad+Bb.x*(xc.y-Tc.y),Nd=xc.y*Bb.x-xc.x*Bb.y,ne=ne+(Bb.x+xc.x)*Nd,oe=oe+(Bb.y+xc.y)*Nd,Tc=Bb,Bb=xc,Dc=Dc.next,Xc=Dc.elt,Ad=Ad+Bb.x*(Xc.y-Tc.y),Od=Xc.y*Bb.x-Xc.x*Bb.y,ne=ne+(Bb.x+Xc.x)*Od,oe=oe+(Bb.y+Xc.y)*Od,Ad=0.5*Ad,Pd=1/(6*Ad),ne=ne*Pd,oe=oe*Pd,Sd=-Ad,ac=ac+ne*Sd,bc=bc+oe*Sd,qc=qc-Ad}else t.flowsegs.add(t.flowpoly.head.elt),t.flowsegs.add(t.flowpoly.head.next.elt);for(;null!=t.flowsegs.head;)var md=t.flowsegs.pop_unsafe(),
pd=t.flowsegs.pop_unsafe(),Td=0,Ud=0,Td=pd.x-md.x,Ud=pd.y-md.y,se=0,te=0,se=Td,te=Ud,Vd=1/Math.sqrt(se*se+te*te),se=se*Vd,te=te*Vd,re=se,se=-te,te=re,pe=0,qe=0,pe=md.x+pd.x,qe=md.y+pd.y,pe=0.5*pe,qe=0.5*qe,pe=pe-1*a.circle.worldCOMx,qe=qe-1*a.circle.worldCOMy,Dd=0,Wd=0,Xd=se*pe+te*qe,sd=Xd/a.circle.radius,bd=Math.sqrt(1-sd*sd),Yd=Math.acos(sd),Dd=a.circle.radius*(a.circle.radius*Yd-Xd*bd),Wd=0.6666666666666666*a.circle.radius*bd*bd*bd/(Yd-sd*bd),pe=a.circle.worldCOMx,qe=a.circle.worldCOMy,Zd=Wd,pe=
pe+se*Zd,qe=qe+te*Zd,$d=Dd,ac=ac+pe*$d,bc=bc+qe*$d,qc=qc+Dd;var ae=1/qc,ac=ac*ae,bc=bc*ae;c.overlap=qc;c.centroidx=ac;c.centroidy=bc;null;return!0}}return!1}var Cb=a.circle,Vb=b.circle,ud=0,vd=0,ud=Vb.worldCOMx-Cb.worldCOMx,vd=Vb.worldCOMy-Cb.worldCOMy,be=Cb.radius+Vb.radius,Id=ud*ud+vd*vd;if(Id>be*be)return!1;if(Id<m.epsilon*m.epsilon)Cb.radius<Vb.radius?(c.overlap=Cb.area,c.centroidx=Cb.worldCOMx,c.centroidy=Cb.worldCOMy):(c.overlap=Vb.area,c.centroidx=Vb.worldCOMx,c.centroidy=Vb.worldCOMy);else{var wd=
Math.sqrt(Id),ce=1/wd,xd=0.5*(wd-(Vb.radius*Vb.radius-Cb.radius*Cb.radius)*ce);if(xd<=-Cb.radius)c.overlap=Cb.area,c.centroidx=Cb.worldCOMx,c.centroidy=Cb.worldCOMy;else{var Jd=wd-xd;if(Jd<=-Vb.radius)c.overlap=Vb.area,c.centroidx=Vb.worldCOMx,c.centroidy=Vb.worldCOMy;else{var Ld=0,de=0,Md=0,ee=0,yd=xd/Cb.radius,ed=Math.sqrt(1-yd*yd),fe=Math.acos(yd),Ld=Cb.radius*(Cb.radius*fe-xd*ed),de=0.6666666666666666*Cb.radius*ed*ed*ed/(fe-yd*ed),zd=Jd/Vb.radius,gd=Math.sqrt(1-zd*zd),ge=Math.acos(zd),Md=Vb.radius*
(Vb.radius*ge-Jd*gd),ee=0.6666666666666666*Vb.radius*gd*gd*gd/(ge-zd*gd),he=Ld+Md,ie=(de*Ld+(wd-ee)*Md)/he*ce;c.overlap=he;c.centroidx=Cb.worldCOMx+ud*ie;c.centroidy=Cb.worldCOMy+vd*ie}}}null;return!0};var yh=function(){this.toiDistance=0;this.inner=!1;this.shape=null};h["zpp_nape.geom.ZPP_ConvexRayResult"]=yh;yh.__name__=!0;yh.prototype={__class__:yh};var zh=function(){this.next=null;this.x=this.y=0};h["zpp_nape.geom.ZPP_GeomVert"]=zh;zh.__name__=!0;zh.prototype={__class__:zh};var Ah=function(){this.outer=
this.vertices=null};h["zpp_nape.geom.ZPP_GeomPoly"]=Ah;Ah.__name__=!0;Ah.prototype={__class__:Ah};var Bh=function(){this.a=this.b=this.c=this.d=this.tx=this.ty=0};h["zpp_nape.geom.ZPP_Mat23"]=Bh;Bh.__name__=!0;Bh.prototype={__class__:Bh};var Ch=function(){this.x=null;this.m=this.n=0};h["zpp_nape.geom.ZPP_MatMN"]=Ch;Ch.__name__=!0;Ch.prototype={__class__:Ch};var la=function(){this.slipped=this.failed=this.kinematic=!1;this.c1=this.c2=this.axis=null;this.frozen1=this.frozen2=!1;this.s1=this.s2=this.arbiter=
null;this.toi=0;this.next=null;this.c1=new M;this.c2=new M;this.axis=new M};h["zpp_nape.geom.ZPP_ToiEvent"]=la;la.__name__=!0;la.prototype={__class__:la};var ic=function(){};h["zpp_nape.geom.ZPP_SweepDistance"]=ic;ic.__name__=!0;ic.dynamicSweep=function(a,b,c,d,e){null==e&&(e=!1);var f=a.s1,k=a.s2,g=f.body,h=k.body,L=0,n=0,L=h.velx-g.velx,n=h.vely-g.vely,p=g.angvel;0>p&&(p=-p);var r=h.angvel;0>r&&(r=-r);var o=f.sweepCoef*p+k.sweepCoef*r;if(!e&&!a.kinematic&&L*L+n*n<m.dynamicSweepLinearThreshold*m.dynamicSweepLinearThreshold&&
o<m.dynamicSweepAngularThreshold)a.toi=-1,a.failed=!0;else{for(var q=a.c1,p=a.c2,r=a.axis,w=0;;){g.sweepIntegrate(c*b);g.sweepValidate(f);h.sweepIntegrate(c*b);h.sweepValidate(k);var v=ic.distance(f,k,q,p,r,null)+d,t=L*r.x+n*r.y;if(v<m.distanceThresholdCCD){if(e)break;var u=0,x=0,u=q.x-g.posx,x=q.y-g.posy,y=0,A=0,y=p.x-h.posx,A=p.y-h.posy,u=t-g.sweep_angvel*(r.y*u-r.x*x)+h.sweep_angvel*(r.y*y-r.x*A);0<u&&(a.slipped=!0);if(0>=u||v<0.5*m.distanceThresholdCCD)break}t=(o-t)*b;if(0>=t){c=-1;break}t=v/
t;1.0E-6>t&&(t=1.0E-6);c+=t;if(1<=c){c=1;g.sweepIntegrate(c*b);g.sweepValidate(f);h.sweepIntegrate(c*b);h.sweepValidate(k);b=ic.distance(f,k,q,p,r,null)+d;L=L*r.x+n*r.y;if(b<m.distanceThresholdCCD){if(e)break;n=e=0;e=q.x-g.posx;n=q.y-g.posy;d=q=0;q=p.x-h.posx;d=p.y-h.posy;g=L-g.sweep_angvel*(r.y*e-r.x*n)+h.sweep_angvel*(r.y*q-r.x*d);0<g&&(a.slipped=!0);if(0>=g||b<0.5*m.distanceThresholdCCD)break}c=-1;break}if(40<=++w){v>d&&(a.failed=!0);break}}a.toi=c}};ic.staticSweep=function(a,b,c,d){var e=a.s1,
f=a.s2,g=e.body,h=0,j=0,h=-g.velx,j=-g.vely,L=g.sweep_angvel;0>L&&(L=-L);for(var n=e.sweepCoef*L,L=a.c1,p=a.c2,r=a.axis,o=0;;){g.sweepIntegrate(c*b);g.sweepValidate(e);var q=ic.distance(e,f,L,p,r,null)+d,t=h*r.x+j*r.y;if(q<m.distanceThresholdCCD){var v=0,w=0,v=L.x-g.posx,w=L.y-g.posy,v=t-g.sweep_angvel*(r.y*v-r.x*w);0<v&&(a.slipped=!0);if(0>=v||q<0.5*m.distanceThresholdCCD)break}t=(n-t)*b;if(0>=t){c=-1;break}t=q/t;1.0E-6>t&&(t=1.0E-6);c+=t;if(1<=c){c=1;g.sweepIntegrate(c*b);g.sweepValidate(e);b=ic.distance(e,
f,L,p,r,null)+d;h=h*r.x+j*r.y;if(b<m.distanceThresholdCCD&&(d=j=0,j=L.x-g.posx,d=L.y-g.posy,g=h-g.sweep_angvel*(r.y*j-r.x*d),0<g&&(a.slipped=!0),0>=g||b<0.5*m.distanceThresholdCCD))break;c=-1;break}if(40<=++o){q>d&&(a.failed=!0);break}}a.toi=c};ic.distance=function(a,b,c,d,e,i){null==i&&(i=1.0E100);if(a.type==f.id_ShapeType_CIRCLE&&b.type==f.id_ShapeType_CIRCLE){var g=a.circle,h=b.circle,j,L=0,n=0,L=h.worldCOMx-g.worldCOMx,n=h.worldCOMy-g.worldCOMy,p=Math.sqrt(L*L+n*n);j=p-(g.radius+h.radius);if(j<
i){if(0==p)L=1,n=0;else var r=1/p,L=L*r,n=n*r;var o=g.radius;c.x=g.worldCOMx+L*o;c.y=g.worldCOMy+n*o;var q=-h.radius;d.x=h.worldCOMx+L*q;d.y=h.worldCOMy+n*q;e.x=L;e.y=n}return j}var t=!1;if(a.type==f.id_ShapeType_CIRCLE&&b.type==f.id_ShapeType_POLYGON)var v=a,a=b,b=v,w=c,c=d,d=w,t=!0;if(a.type==f.id_ShapeType_POLYGON&&b.type==f.id_ShapeType_CIRCLE){for(var u=b.circle,x=-1.0E100,y=null,A=a.polygon.edges.head;null!=A;){var C=A.elt,B=C.gnormx*u.worldCOMx+C.gnormy*u.worldCOMy-C.gprojection-u.radius;if(B>
i){x=B;break}0<B?B>x&&(x=B,y=C):0>x&&B>x&&(x=B,y=C);A=A.next}if(x<i){var D=y.gp0,E=y.gp1,I=u.worldCOMy*y.gnormx-u.worldCOMx*y.gnormy;if(I<=D.y*y.gnormx-D.x*y.gnormy){var F=0,G=0,F=u.worldCOMx-D.x,G=u.worldCOMy-D.y,M=Math.sqrt(F*F+G*G),x=M-u.radius;if(x<i){if(0==M)F=1,G=0;else var P=1/M,F=F*P,G=G*P;c.x=D.x+0*F;c.y=D.y+0*G;var N=-u.radius;d.x=u.worldCOMx+F*N;d.y=u.worldCOMy+G*N;e.x=F;e.y=G}}else if(I>=E.y*y.gnormx-E.x*y.gnormy){var H=0,K=0,H=u.worldCOMx-E.x,K=u.worldCOMy-E.y,T=Math.sqrt(H*H+K*K),x=
T-u.radius;if(x<i){if(0==T)H=1,K=0;else var aa=1/T,H=H*aa,K=K*aa;c.x=E.x+0*H;c.y=E.y+0*K;var ba=-u.radius;d.x=u.worldCOMx+H*ba;d.y=u.worldCOMy+K*ba;e.x=H;e.y=K}}else{var V=-u.radius;d.x=u.worldCOMx+y.gnormx*V;d.y=u.worldCOMy+y.gnormy*V;var da=-x;c.x=d.x+y.gnormx*da;c.y=d.y+y.gnormy*da;e.x=y.gnormx;e.y=y.gnormy}}t&&(e.x=-e.x,e.y=-e.y);return x}for(var ha=a.polygon,Z=b.polygon,J=-1.0E100,Y=null,U=null,fa=0,$=ha.edges.head;null!=$;){for(var W=$.elt,S=1.0E100,ka=Z.gverts.next;null!=ka;){var ia=ka,na=
W.gnormx*ia.x+W.gnormy*ia.y;na<S&&(S=na);ka=ka.next}S-=W.gprojection;if(S>i){J=S;break}0<S?S>J&&(J=S,Y=W,fa=1):0>J&&S>J&&(J=S,Y=W,fa=1);$=$.next}if(J<i){for(var ga=Z.edges.head;null!=ga;){for(var ca=ga.elt,s=1.0E100,ma=ha.gverts.next;null!=ma;){var ta=ma,Ga=ca.gnormx*ta.x+ca.gnormy*ta.y;Ga<s&&(s=Ga);ma=ma.next}s-=ca.gprojection;if(s>i){J=s;break}0<s?s>J&&(J=s,U=ca,fa=2):0>J&&s>J&&(J=s,U=ca,fa=2);ga=ga.next}if(J<i){var va,oa;if(1==fa)va=Z,oa=Y;else{va=ha;oa=U;var Pa=c,c=d,d=Pa,t=!t}for(var xa=null,
Ya=1.0E100,pa=va.edges.head;null!=pa;){var Nf=pa.elt,Ha=oa.gnormx*Nf.gnormx+oa.gnormy*Nf.gnormy;Ha<Ya&&(Ya=Ha,xa=Nf);pa=pa.next}t?(e.x=-oa.gnormx,e.y=-oa.gnormy):(e.x=oa.gnormx,e.y=oa.gnormy);if(0<=J){var wb=oa.gp0,R=oa.gp1,xb=xa.gp0,qa=xa.gp1,ja=0,sa=0,ya=0,la=0,ja=R.x-wb.x,sa=R.y-wb.y,ya=qa.x-xb.x,la=qa.y-xb.y,Ma=1/(ja*ja+sa*sa),Ba=1/(ya*ya+la*la),O=-(ja*(wb.x-xb.x)+sa*(wb.y-xb.y))*Ma,ua=-(ja*(wb.x-qa.x)+sa*(wb.y-qa.y))*Ma,wa=-(ya*(xb.x-wb.x)+la*(xb.y-wb.y))*Ba,Ka=-(ya*(xb.x-R.x)+la*(xb.y-R.y))*
Ba;0>O?O=0:1<O&&(O=1);0>ua?ua=0:1<ua&&(ua=1);0>wa?wa=0:1<wa&&(wa=1);0>Ka?Ka=0:1<Ka&&(Ka=1);var gb=0,hb=0,Xa=O,gb=wb.x+ja*Xa,hb=wb.y+sa*Xa,ib=0,Ia=0,ab=ua,ib=wb.x+ja*ab,Ia=wb.y+sa*ab,Ca=0,Da=0,z=wa,Ca=xb.x+ya*z,Da=xb.y+la*z,ra=0,ea=0,Va=Ka,ra=xb.x+ya*Va,ea=xb.y+la*Va,Wa=kb.vec_dsq(gb,hb,xb.x,xb.y),Qa=kb.vec_dsq(ib,Ia,qa.x,qa.y),Za=kb.vec_dsq(Ca,Da,wb.x,wb.y),Db=kb.vec_dsq(ra,ea,R.x,R.y),Na=0,Sa=0,Ra=null;Wa<Qa?(Na=gb,Sa=hb,Ra=xb):(Na=ib,Sa=Ia,Ra=qa,Wa=Qa);var Ja=0,fb=0,Ea=null;Za<Db?(Ja=Ca,fb=Da,Ea=
wb):(Ja=ra,fb=ea,Ea=R,Za=Db);Wa<Za?(c.x=Na,c.y=Sa,d.x=Ra.x,d.y=Ra.y,J=Math.sqrt(Wa)):(d.x=Ja,d.y=fb,c.x=Ea.x,c.y=Ea.y,J=Math.sqrt(Za));if(0!=J){e.x=d.x-c.x;e.y=d.y-c.y;var bb=1/J;e.x*=bb;e.y*=bb;t&&(e.x=-e.x,e.y=-e.y)}return J}var za=0,Fa=0,za=xa.gp0.x,Fa=xa.gp0.y,Aa=0,Oa=0,Aa=xa.gp1.x,Oa=xa.gp1.y,Ta=0,Ua=0,Ta=Aa-za,Ua=Oa-Fa,cb=oa.gnormy*za-oa.gnormx*Fa,yb=oa.gnormy*Aa-oa.gnormx*Oa,db=1/(yb-cb),La=(-oa.tp1-cb)*db;La>m.epsilon&&(za+=Ta*La,Fa+=Ua*La);var $a=(-oa.tp0-yb)*db;$a<-m.epsilon&&(Aa+=Ta*$a,
Oa+=Ua*$a);var jb=za*oa.gnormx+Fa*oa.gnormy-oa.gprojection,me=Aa*oa.gnormx+Oa*oa.gnormy-oa.gprojection;if(jb<me){d.x=za;d.y=Fa;var nb=-jb;c.x=d.x+oa.gnormx*nb;c.y=d.y+oa.gnormy*nb;return jb}d.x=Aa;d.y=Oa;var eb=-me;c.x=d.x+oa.gnormx*eb;c.y=d.y+oa.gnormy*eb;return me}}return i};var M=function(){this.length=this.x=this.y=0;this._inuse=this.modified=this.pushmod=!1;this.next=null;this.weak=!1;this._isimmutable=this.outer=null;this._immutable=!1;this._invalidate=this._validate=null};h["zpp_nape.geom.ZPP_Vec2"]=
M;M.__name__=!0;M.get=function(a,b,c){null==c&&(c=!1);var d;null==M.zpp_pool?d=new M:(d=M.zpp_pool,M.zpp_pool=d.next,d.next=null);d.weak=!1;d._immutable=c;d.x=a;d.y=b;return d};M.prototype={validate:function(){null!=this._validate&&this._validate()},invalidate:function(){null!=this._invalidate&&this._invalidate(this)},wrapper:function(){if(null==this.outer){this.outer=new B;var a=this.outer.zpp_inner;null!=a.outer&&(a.outer.zpp_inner=null,a.outer=null);a._isimmutable=null;a._validate=null;a._invalidate=
null;a.next=M.zpp_pool;M.zpp_pool=a;this.outer.zpp_inner=this}return this.outer},add:function(a){return this.inlined_add(a)},inlined_add:function(a){a._inuse=!0;a.next=this.next;this.next=a;this.modified=!0;this.length++;return a},insert:function(a,b){return this.inlined_insert(a,b)},inlined_insert:function(a,b){b._inuse=!0;null==a?(b.next=this.next,this.next=b):(b.next=a.next,a.next=b);this.pushmod=this.modified=!0;this.length++;return b},erase:function(a){return this.inlined_erase(a)},inlined_erase:function(a){var b,
c;null==a?(b=this.next,this.next=c=b.next,null==this.next&&(this.pushmod=!0)):(b=a.next,c=b.next,a.next=c,null==c&&(this.pushmod=!0));b._inuse=!1;this.modified=!0;this.length--;this.pushmod=!0;return c},reverse:function(){for(var a=this.next,b=null;null!=a;){var c=a.next;a.next=b;b=this.next=a;a=c}this.pushmod=this.modified=!0},iterator_at:function(a){for(var b=this.next;0<a--&&null!=b;)b=b.next;return b},toString:function(){return"{ x: "+this.x+" y: "+this.y+" }"},__class__:M};var Dh=function(){this._validate=
null;this.x=this.y=this.z=0};h["zpp_nape.geom.ZPP_Vec3"]=Dh;Dh.__name__=!0;Dh.prototype={validate:function(){null!=this._validate&&this._validate()},__class__:Dh};var kb=function(){};h["zpp_nape.geom.ZPP_VecMath"]=kb;kb.__name__=!0;kb.vec_dsq=function(a,b,c,d){var e=0,f=0,e=a-c,f=b-d;return e*e+f*f};var ha=function(){this.userData=this.ishape=this.ibody=this.icompound=this.cbsets=this.group=this.cbTypes=this.cbSet=this.wrap_cbTypes=null;this.id=0;this.outer_i=null;this.id=W.Interactor();this.cbsets=
new Qg;this.cbTypes=new Qb};h["zpp_nape.phys.ZPP_Interactor"]=ha;ha.__name__=!0;ha.get=function(a,b){var c;c=a.id<b.id?a.id:b.id;var d;d=a.id<b.id?b.id:a.id;for(var e=null,f=(a.cbsets.length<b.cbsets.length?a.cbsets:b.cbsets).head;null!=f;){var g=f.elt;if(g.id==c&&g.di==d){e=g;break}f=f.next}return e};ha.int_callback=function(a,b,c){var d=a.int1,a=a.int2;b.options1.compatible(d.cbTypes)&&b.options2.compatible(a.cbTypes)?(c.int1=d,c.int2=a):(c.int1=a,c.int2=d)};ha.prototype={__iaddedToSpace:function(){null!=
this.group&&this.group.interactors.add(this);for(var a=this.cbTypes.head;null!=a;)a.elt.interactors.add(this),a=a.next;this.alloc_cbSet()},__iremovedFromSpace:function(){null!=this.group&&this.group.interactors.remove(this);for(var a=this.cbTypes.head;null!=a;)a.elt.interactors.remove(this),a=a.next;this.dealloc_cbSet()},wake:function(){if(null!=this.ishape){var a=this.ishape.body;null!=a&&null!=a.space&&a.space.non_inlined_wake(a);!0}else null!=this.ibody?null!=this.ibody.space?this.ibody.space.non_inlined_wake(this.ibody):
!1:(null!=this.icompound.space&&this.icompound.space.wakeCompound(this.icompound),!0)},setupcbTypes:function(){this.wrap_cbTypes=Hb.get(this.cbTypes);this.wrap_cbTypes.zpp_inner.adder=q(this,this.wrap_cbTypes_adder);this.wrap_cbTypes.zpp_inner.subber=q(this,this.wrap_cbTypes_subber);this.wrap_cbTypes.zpp_inner.dontremove=!0},wrap_cbTypes_subber:function(a){a=a.zpp_inner;if(this.cbTypes.has(a)){var b;b=null!=this.ishape?null==this.ishape.body?null:this.ishape.body.space:null!=this.ibody?this.ibody.space:
this.icompound.space;null!=b&&(this.dealloc_cbSet(),a.interactors.remove(this));this.cbTypes.remove(a);null!=b&&(this.alloc_cbSet(),this.wake())}},wrap_cbTypes_adder:function(a){this.insert_cbtype(a.zpp_inner);return!1},insert_cbtype:function(a){if(!this.cbTypes.has(a)){var b;b=null!=this.ishape?null==this.ishape.body?null:this.ishape.body.space:null!=this.ibody?this.ibody.space:this.icompound.space;null!=b&&(this.dealloc_cbSet(),a.interactors.add(this));for(var c=null,d=this.cbTypes.head;null!=d&&
!(a.id<d.elt.id);){c=d;d=d.next}this.cbTypes.inlined_insert(c,a);null!=b&&(this.alloc_cbSet(),this.wake())}},alloc_cbSet:function(){var a;a=null!=this.ishape?null==this.ishape.body?null:this.ishape.body.space:null!=this.ibody?this.ibody.space:this.icompound.space;if(null!=(this.cbSet=a.cbsets.get(this.cbTypes)))this.cbSet.count++,this.cbSet.interactors.add(this),this.cbSet.validate(),a.freshInteractorType(this)},dealloc_cbSet:function(){var a;a=null!=this.ishape?null==this.ishape.body?null:this.ishape.body.space:
null!=this.ibody?this.ibody.space:this.icompound.space;null!=this.cbSet&&(this.cbSet.interactors.remove(this),a.nullInteractorType(this),0==--this.cbSet.count&&(a.cbsets.remove(this.cbSet),a=this.cbSet,a.free(),a.next=K.zpp_pool,K.zpp_pool=a),this.cbSet=null)},immutable_midstep:function(a){null!=this.ibody?null:null!=this.ishape?this.ishape.__immutable_midstep(a):this.icompound.__imutable_midstep(a)},lookup_group:function(){for(var a=this;null!=a&&null==a.group;)a=null!=a.ishape?a.ishape.body:null!=
a.icompound?a.icompound.compound:a.ibody.compound;return null==a?null:a.group},copyto:function(a){a.zpp_inner_i.group=this.group;for(var b=this.outer_i.get_cbTypes().iterator();b.hasNext();){var c;b.zpp_critical=!1;c=b.zpp_inner.at(b.zpp_i++);null==a.zpp_inner_i.wrap_cbTypes&&a.zpp_inner_i.setupcbTypes();a.zpp_inner_i.wrap_cbTypes.add(c)}null!=this.userData&&(a.zpp_inner_i.userData=ca.copy(this.userData))},__class__:ha};var yc=function(){this.wrap_localCOM=this.wrap_worldCOM=null;this.zip_worldCOM=
!1;this.worldCOMx=this.worldCOMy=0;this.zip_localCOM=!1;this.localCOMx=this.localCOMy=0;this.zip_aabb=!1;this.aabb=null;this.norotate=!1;this.cinertia=this.iinertia=this.sinertia=0;this.zip_inertia=!1;this.inertiaMode=this.inertia=0;this.zip_gravMassScale=!1;this.gravMassMode=this.gravMassScale=0;this.zip_gravMass=!1;this.gravMass=0;this.nomove=!1;this.massMode=this.imass=this.smass=this.cmass=0;this.zip_mass=!1;this.mass=0;this.zip_axis=!1;this.forcex=this.forcey=this.kinvelx=this.kinvely=this.svelx=
this.svely=this.angvel=this.torque=this.kinangvel=this.pre_rot=this.rot=this.axisx=this.axisy=0;this.wrap_vel=null;this.velx=this.vely=0;this.wrap_pos=null;this.pre_posx=this.pre_posy=this.posx=this.posy=0;this.bullet=this.bulletEnabled=this.disableCCD=!1;this.sweepRadius=0;this.sweepFrozen=!1;this.sweepTime=this.sweep_angvel=0;this.compound=this.shapes=this.wrap_shapes=this.space=this.arbiters=this.constraints=this.component=null;this.type=0;this.world=!1;this.outer=null;ha.call(this);this.ibody=
this;this.bulletEnabled=this.world=!1;this.sweep_angvel=this.sweepTime=0;this.disableCCD=this.norotate=this.nomove=!1;this.axisx=this.rot=this.posy=this.posx=0;this.axisy=1;this.torque=this.angvel=this.kinangvel=this.forcey=this.forcex=this.kinvely=this.kinvelx=this.vely=this.velx=this.svely=this.svelx=0;this.pre_rot=this.pre_posy=this.pre_posx=Infinity;this.worldCOMy=this.worldCOMx=this.localCOMy=this.localCOMx=0;this.zip_aabb=!0;this.aabb=ga.get(0,0,0,0);this.aabb._immutable=!0;this.aabb._validate=
q(this,this.aabb_validate);this.massMode=f.id_MassMode_DEFAULT;this.gravMassMode=f.id_GravMassMode_DEFAULT;this.gravMassScale=1;this.inertiaMode=f.id_InertiaMode_DEFAULT;this.arbiters=new ye;this.constraints=new gc;this.shapes=new kd;this.wrap_shapes=jd.get(this.shapes);this.wrap_shapes.zpp_inner.adder=q(this,this.shapes_adder);this.wrap_shapes.zpp_inner.subber=q(this,this.shapes_subber);this.wrap_shapes.zpp_inner._invalidate=q(this,this.shapes_invalidate);this.kinematicDelaySleep=!1};h["zpp_nape.phys.ZPP_Body"]=
yc;yc.__name__=!0;yc.__static=function(){var a=Rc;null==f.BodyType_STATIC&&(f.internal=!0,f.BodyType_STATIC=new Ga,f.internal=!1);var a=new a(f.BodyType_STATIC),b=a.zpp_inner;b.world=!0;b.wrap_shapes.zpp_inner.immutable=!0;b.smass=b.imass=b.cmass=b.mass=b.gravMass=0;b.sinertia=b.iinertia=b.cinertia=b.inertia=0;b.cbTypes.clear();return a};yc.__super__=ha;yc.prototype=w(ha.prototype,{invalidate_type:function(){this.invalidate_mass();this.invalidate_inertia()},invalidate_shapes:function(){this.zip_worldCOM=
this.zip_localCOM=this.zip_aabb=!0;this.invalidate_mass();this.invalidate_inertia()},atRest:function(a){if(this.type!=f.id_BodyType_DYNAMIC)return this.component.sleeping;var b=m.linearSleepThreshold,b=b*b;if(this.velx*this.velx+this.vely*this.vely>b)a=!1;else if(kb.vec_dsq(this.posx,this.posy,this.pre_posx,this.pre_posy)>0.25*b*a*a)a=!1;else{var c=b=0,b=this.aabb.maxx-this.aabb.minx,c=this.aabb.maxy-this.aabb.miny,b=b*b+c*c,c=m.angularSleepThreshold,c=c*c;if(4*this.angvel*this.angvel*b>c)a=!1;else var d=
this.rot-this.pre_rot,a=d*d*b>c*a*a?!1:!0}a||(this.component.waket=this.space.stamp);return this.component.waket+m.sleepDelay<this.space.stamp},refreshArbiters:function(){for(var a=this.arbiters.head;null!=a;)a.elt.invalidated=!0,a=a.next},sweepIntegrate:function(a){var b=a-this.sweepTime;0!=b&&(this.sweepTime=a,this.posx+=this.velx*b,this.posy+=this.vely*b,0!=this.angvel&&this.delta_rot(this.sweep_angvel*b))},sweepValidate:function(a){if(a.type==f.id_ShapeType_CIRCLE)a.worldCOMx=this.posx+(this.axisy*
a.localCOMx-this.axisx*a.localCOMy),a.worldCOMy=this.posy+(a.localCOMx*this.axisx+a.localCOMy*this.axisy);else{for(var a=a.polygon,b=a.lverts.next,c=a.gverts.next;null!=c;){var d=c,e=b,b=b.next;d.x=this.posx+(this.axisy*e.x-this.axisx*e.y);d.y=this.posy+(e.x*this.axisx+e.y*this.axisy);c=c.next}c=a.edges.head;b=d=a.gverts.next;for(d=d.next;null!=d;){var e=d,i=c.elt,c=c.next;i.gnormx=this.axisy*i.lnormx-this.axisx*i.lnormy;i.gnormy=i.lnormx*this.axisx+i.lnormy*this.axisy;i.gprojection=this.posx*i.gnormx+
this.posy*i.gnormy+i.lprojection;i.tp0=b.y*i.gnormx-b.x*i.gnormy;i.tp1=e.y*i.gnormx-e.x*i.gnormy;b=e;d=d.next}a=a.gverts.next;c=c.elt;c.gnormx=this.axisy*c.lnormx-this.axisx*c.lnormy;c.gnormy=c.lnormx*this.axisx+c.lnormy*this.axisy;c.gprojection=this.posx*c.gnormx+this.posy*c.gnormy+c.lprojection;c.tp0=b.y*c.gnormx-b.x*c.gnormy;c.tp1=a.y*c.gnormx-a.x*c.gnormy}},invalidate_pos:function(){for(var a=this.shapes.head;null!=a;){var b=a.elt;b.type==f.id_ShapeType_POLYGON&&(b.polygon.invalidate_gverts(),
b.polygon.invalidate_gaxi());b.invalidate_worldCOM();a=a.next}this.zip_worldCOM=!0},pos_invalidate:function(a){this.immutable_midstep("Body::position");this.posx==a.x&&this.posy==a.y||(this.posx=a.x,this.posy=a.y,this.invalidate_pos(),this.wake())},pos_validate:function(){this.wrap_pos.zpp_inner.x=this.posx;this.wrap_pos.zpp_inner.y=this.posy},vel_invalidate:function(a){this.velx=a.x;this.vely=a.y;this.wake()},vel_validate:function(){this.wrap_vel.zpp_inner.x=this.velx;this.wrap_vel.zpp_inner.y=this.vely},
setupPosition:function(){this.wrap_pos=B.get(this.posx,this.posy,null);this.wrap_pos.zpp_inner._inuse=!0;this.world?this.wrap_pos.zpp_inner._immutable=!0:(this.wrap_pos.zpp_inner._invalidate=q(this,this.pos_invalidate),this.wrap_pos.zpp_inner._validate=q(this,this.pos_validate))},setupVelocity:function(){this.wrap_vel=B.get(this.velx,this.vely,null);this.wrap_vel.zpp_inner._inuse=!0;this.world?this.wrap_vel.zpp_inner._immutable=!0:(this.wrap_vel.zpp_inner._invalidate=q(this,this.vel_invalidate),this.wrap_vel.zpp_inner._validate=
q(this,this.vel_validate))},invalidate_rot:function(){this.zip_axis=!0;for(var a=this.shapes.head;null!=a;){var b=a.elt;b.type==f.id_ShapeType_POLYGON&&(b.polygon.invalidate_gverts(),b.polygon.invalidate_gaxi());b.invalidate_worldCOM();a=a.next}this.zip_worldCOM=!0},validate_axis:function(){this.zip_axis&&(this.zip_axis=!1,this.axisx=Math.sin(this.rot),this.axisy=Math.cos(this.rot),null)},delta_rot:function(a){this.rot+=a;if(1.0E-4<a*a)this.axisx=Math.sin(this.rot),this.axisy=Math.cos(this.rot),null;
else{var b=a*a,c=1-0.5*b,b=1-b*b/8,d=(c*this.axisx+a*this.axisy)*b;this.axisy=(c*this.axisy-a*this.axisx)*b;this.axisx=d}},invalidate_mass:function(){this.zip_mass=!0;this.invalidate_gravMass()},validate_mass:function(){if(this.zip_mass){this.zip_mass=!1;if(this.massMode==f.id_MassMode_DEFAULT){this.cmass=0;for(var a=this.shapes.head;null!=a;){var b=a.elt;b.refmaterial.density=b.material.density;b.validate_area_inertia();this.cmass+=b.area*b.material.density;a=a.next}}this.type==f.id_BodyType_DYNAMIC&&
!this.nomove?(this.mass=this.cmass,this.imass=this.smass=1/this.mass):(this.mass=Infinity,this.imass=this.smass=0)}},invalidate_gravMass:function(){this.gravMassMode!=f.id_GravMassMode_FIXED&&(this.zip_gravMass=!0);this.gravMassMode!=f.id_GravMassMode_SCALED&&(this.zip_gravMassScale=!0);this.wake()},validate_gravMass:function(){this.zip_gravMass&&(this.zip_gravMass=!1,this.validate_mass(),this.gravMassMode==f.id_GravMassMode_DEFAULT?(this.validate_mass(),this.gravMass=this.cmass):this.gravMassMode==
f.id_GravMassMode_SCALED&&(this.validate_mass(),this.gravMass=this.cmass*this.gravMassScale))},invalidate_gravMassScale:function(){this.gravMassMode!=f.id_GravMassMode_SCALED?this.zip_gravMassScale=!0:this.invalidate_gravMass()},invalidate_inertia:function(){this.zip_inertia=!0;this.wake()},validate_inertia:function(){if(this.zip_inertia){this.zip_inertia=!1;if(this.inertiaMode==f.id_InertiaMode_DEFAULT){this.cinertia=0;for(var a=this.shapes.head;null!=a;){var b=a.elt;b.refmaterial.density=b.material.density;
b.validate_area_inertia();this.cinertia+=b.inertia*b.area*b.material.density;a=a.next}}this.type==f.id_BodyType_DYNAMIC&&!this.norotate?(this.inertia=this.cinertia,this.sinertia=this.iinertia=1/this.inertia):(this.inertia=Infinity,this.sinertia=this.iinertia=0)}},validate_aabb:function(){if(this.zip_aabb){this.zip_aabb=!1;this.aabb.minx=Infinity;this.aabb.miny=Infinity;this.aabb.maxx=-Infinity;this.aabb.maxy=-Infinity;for(var a=this.shapes.head;null!=a;){var b=a.elt;b.zip_aabb&&null!=b.body&&(b.zip_aabb=
!1,b.type==f.id_ShapeType_CIRCLE?b.circle.__validate_aabb():b.polygon.__validate_aabb());this.aabb.combine(b.aabb);a=a.next}}},invalidate_localCOM:function(){this.zip_worldCOM=this.zip_localCOM=!0},validate_localCOM:function(){if(this.zip_localCOM){this.zip_localCOM=!1;for(var a=0,b=0,c=0,d=this.shapes.head;null!=d;){var e=d.elt;e.zip_localCOM&&(e.zip_localCOM=!1,e.type==f.id_ShapeType_POLYGON&&e.polygon.__validate_localCOM(),null!=e.wrap_localCOM&&(e.wrap_localCOM.zpp_inner.x=e.localCOMx,e.wrap_localCOM.zpp_inner.y=
e.localCOMy));e.validate_area_inertia();var i=e.area*e.material.density,a=a+e.localCOMx*i,b=b+e.localCOMy*i,c=c+e.area*e.material.density,d=d.next}0!=c&&(d=1/c,this.localCOMx=a*d,this.localCOMy=b*d);null!=this.wrap_localCOM&&(this.wrap_localCOM.zpp_inner.x=this.localCOMx,this.wrap_localCOM.zpp_inner.y=this.localCOMy);this.zip_mass&&this.massMode==f.id_MassMode_DEFAULT&&(this.zip_mass=!1,this.cmass=c,this.type==f.id_BodyType_DYNAMIC?(this.mass=this.cmass,this.imass=this.smass=1/this.mass):(this.mass=
Infinity,this.imass=this.smass=0))}},validate_worldCOM:function(){this.zip_worldCOM&&(this.zip_worldCOM=!1,this.validate_localCOM(),this.zip_axis&&(this.zip_axis=!1,this.axisx=Math.sin(this.rot),this.axisy=Math.cos(this.rot),null),this.worldCOMx=this.posx+(this.axisy*this.localCOMx-this.axisx*this.localCOMy),this.worldCOMy=this.posy+(this.localCOMx*this.axisx+this.localCOMy*this.axisy),null!=this.wrap_worldCOM&&(this.wrap_worldCOM.zpp_inner.x=this.worldCOMx,this.wrap_worldCOM.zpp_inner.y=this.worldCOMy))},
getlocalCOM:function(){this.validate_localCOM()},aabb_validate:function(){this.validate_aabb()},shapes_adder:function(a){return a.zpp_inner.body!=this?(null!=a.zpp_inner.body&&a.zpp_inner.body.wrap_shapes.remove(a),a.zpp_inner.body=this,a.zpp_inner.addedToBody(),null!=this.space&&this.space.added_shape(a.zpp_inner,null),a.zpp_inner.type==f.id_ShapeType_POLYGON&&(a.zpp_inner.polygon.invalidate_gaxi(),a.zpp_inner.polygon.invalidate_gverts()),!0):!1},shapes_subber:function(a){null!=this.space&&this.space.removed_shape(a.zpp_inner);
a.zpp_inner.body=null;a.zpp_inner.removedFromBody()},shapes_invalidate:function(){this.invalidate_shapes()},addedToSpace:function(){null==Wa.zpp_pool?this.component=new Wa:(this.component=Wa.zpp_pool,Wa.zpp_pool=this.component.next,this.component.next=null);null;this.component.isBody=!0;this.component.body=this;this.__iaddedToSpace()},removedFromSpace:function(){for(;null!=this.arbiters.head;){var a=this.arbiters.pop_unsafe();a.cleared=!0;a.b2==this&&a.b1.arbiters.inlined_try_remove(a);a.b1==this&&
a.b2.arbiters.inlined_try_remove(a);null!=a.pair&&(a.pair.arb=null,a.pair=null);a.active=!1;this.space.f_arbiters.modified=!0}a=this.component;a.body=null;a.constraint=null;null;a.next=Wa.zpp_pool;Wa.zpp_pool=a;this.component=null;this.__iremovedFromSpace()},copy:function(){var a=(new Rc).zpp_inner;a.type=this.type;a.bulletEnabled=this.bulletEnabled;a.disableCCD=this.disableCCD;for(var b=this.shapes.head;null!=b;)a.outer.zpp_inner.wrap_shapes.add(b.elt.outer.copy()),b=b.next;a.posx=this.posx;a.posy=
this.posy;a.velx=this.velx;a.vely=this.vely;a.forcex=this.forcex;a.forcey=this.forcey;a.rot=this.rot;a.angvel=this.angvel;a.torque=this.torque;a.kinvelx=this.kinvelx;a.kinvely=this.kinvely;a.kinangvel=this.kinangvel;a.svelx=this.svelx;a.svely=this.svely;this.zip_axis?a.invalidate_rot():(a.axisx=this.axisx,a.axisy=this.axisy);a.rot=this.rot;a.massMode=this.massMode;a.gravMassMode=this.gravMassMode;a.inertiaMode=this.inertiaMode;a.norotate=this.norotate;a.nomove=this.nomove;a.cmass=this.cmass;a.cinertia=
this.cinertia;this.zip_mass?a.invalidate_mass():a.mass=this.mass;this.zip_gravMass?a.invalidate_gravMass():a.gravMass=this.gravMass;this.zip_gravMassScale?a.invalidate_gravMassScale():a.gravMassScale=this.gravMassScale;this.zip_inertia?a.invalidate_inertia():a.inertia=this.inertia;this.zip_aabb?a.zip_aabb=!0:(a.aabb.minx=this.aabb.minx,a.aabb.miny=this.aabb.miny,a.aabb.maxx=this.aabb.maxx,a.aabb.maxy=this.aabb.maxy);this.zip_localCOM?(a.zip_localCOM=!0,a.zip_worldCOM=!0):(a.localCOMx=this.localCOMx,
a.localCOMy=this.localCOMy);this.zip_worldCOM?a.zip_worldCOM=!0:(a.worldCOMx=this.worldCOMx,a.worldCOMy=this.worldCOMy);this.copyto(a.outer);return a.outer},__class__:yc});var Cf=function(){this.compound=this.space=null;this.depth=0;this.outer=this.bodies=this.constraints=this.compounds=this.wrap_bodies=this.wrap_constraints=this.wrap_compounds=null;ha.call(this);this.icompound=this;this.depth=1;this.bodies=new Ec;this.wrap_bodies=zc.get(this.bodies);this.wrap_bodies.zpp_inner.adder=q(this,this.bodies_adder);
this.wrap_bodies.zpp_inner.subber=q(this,this.bodies_subber);this.constraints=new gc;this.wrap_constraints=Kb.get(this.constraints);this.wrap_constraints.zpp_inner.adder=q(this,this.constraints_adder);this.wrap_constraints.zpp_inner.subber=q(this,this.constraints_subber);this.compounds=new Sd;this.wrap_compounds=Vc.get(this.compounds);this.wrap_compounds.zpp_inner.adder=q(this,this.compounds_adder);this.wrap_compounds.zpp_inner.subber=q(this,this.compounds_subber)};h["zpp_nape.phys.ZPP_Compound"]=
Cf;Cf.__name__=!0;Cf.__super__=ha;Cf.prototype=w(ha.prototype,{__imutable_midstep:function(){},addedToSpace:function(){this.__iaddedToSpace()},removedFromSpace:function(){this.__iremovedFromSpace()},bodies_adder:function(a){return a.zpp_inner.compound!=this?(null!=a.zpp_inner.compound?a.zpp_inner.compound.wrap_bodies.remove(a):null!=a.zpp_inner.space&&a.zpp_inner.space.wrap_bodies.remove(a),a.zpp_inner.compound=this,null!=this.space&&this.space.addBody(a.zpp_inner),!0):!1},bodies_subber:function(a){a.zpp_inner.compound=
null;null!=this.space&&this.space.remBody(a.zpp_inner)},constraints_adder:function(a){return a.zpp_inner.compound!=this?(null!=a.zpp_inner.compound?a.zpp_inner.compound.wrap_constraints.remove(a):null!=a.zpp_inner.space&&a.zpp_inner.space.wrap_constraints.remove(a),a.zpp_inner.compound=this,null!=this.space&&this.space.addConstraint(a.zpp_inner),!0):!1},constraints_subber:function(a){a.zpp_inner.compound=null;null!=this.space&&this.space.remConstraint(a.zpp_inner)},compounds_adder:function(a){return a.zpp_inner.compound!=
this?(null!=a.zpp_inner.compound?a.zpp_inner.compound.wrap_compounds.remove(a):null!=a.zpp_inner.space&&a.zpp_inner.space.wrap_compounds.remove(a),a.zpp_inner.compound=this,a.zpp_inner.depth=this.depth+1,null!=this.space&&this.space.addCompound(a.zpp_inner),!0):!1},compounds_subber:function(a){a.zpp_inner.compound=null;a.zpp_inner.depth=1;null!=this.space&&this.space.remCompound(a.zpp_inner)},__class__:Cf});var id=function(){this.wrap_gravity=null;this.viscosity=this.density=this.gravityx=this.gravityy=
0;this.next=this.outer=this.shapes=null;this.shapes=new kd;this.density=this.viscosity=1;this.wrap_gravity=null;this.gravityy=this.gravityx=0};h["zpp_nape.phys.ZPP_FluidProperties"]=id;id.__name__=!0;id.prototype={wrapper:function(){if(null==this.outer){this.outer=new Fb;var a=this.outer.zpp_inner;a.outer=null;a.next=id.zpp_pool;id.zpp_pool=a;this.outer.zpp_inner=this}return this.outer},invalidate:function(){for(var a=this.shapes.head;null!=a;)a.elt.invalidate_fluidprops(),a=a.next},__class__:id};
var N=function(){this.dynamicFriction=this.staticFriction=this.density=this.elasticity=this.rollingFriction=0;this.next=this.outer=this.shapes=null;this.shapes=new kd;this.elasticity=0;this.dynamicFriction=1;this.staticFriction=2;this.density=0.0010;this.rollingFriction=0.01};h["zpp_nape.phys.ZPP_Material"]=N;N.__name__=!0;N.prototype={wrapper:function(){if(null==this.outer){this.outer=new Ba;var a=this.outer.zpp_inner;a.outer=null;a.next=N.zpp_pool;N.zpp_pool=a;this.outer.zpp_inner=this}return this.outer},
set:function(a){this.dynamicFriction=a.dynamicFriction;this.staticFriction=a.staticFriction;this.density=a.density;this.elasticity=a.elasticity;this.rollingFriction=a.rollingFriction},invalidate:function(a){for(var b=this.shapes.head;null!=b;)b.elt.invalidate_material(a),b=b.next},__class__:N};var jc=function(a){this.zip_aabb=!1;this.sweep=this.node=this.pairs=this.aabb=null;this.fluidEnabled=this.sensorEnabled=!1;this.circle=this.polygon=this.refmaterial=this.material=this.filter=this.fluidProperties=
null;this.sweepCoef=0;this.zip_sweepRadius=!1;this.sweepRadius=0;this.wrap_localCOM=null;this.zip_worldCOM=!1;this.worldCOMx=this.worldCOMy=0;this.zip_localCOM=!1;this.localCOMx=this.localCOMy=0;this.zip_angDrag=!1;this.inertia=this.angDrag=0;this.zip_area_inertia=!1;this.type=this.area=0;this.outer=this.body=null;ha.call(this);this.pairs=new Rg;this.ishape=this;this.type=a;this.aabb=ga.get(0,0,0,0);this.aabb._immutable=!0;this.aabb._validate=q(this,this.aabb_validate);this.zip_area_inertia=this.zip_angDrag=
this.zip_localCOM=this.zip_sweepRadius=!0;this.worldCOMy=this.worldCOMx=this.localCOMy=this.localCOMx=0;this.sensorEnabled=this.fluidEnabled=!1;this.body=this.fluidProperties=null;this.refmaterial=new N;this.sweepRadius=this.sweepCoef=0};h["zpp_nape.shape.ZPP_Shape"]=jc;jc.__name__=!0;jc.__super__=ha;jc.prototype=w(ha.prototype,{validate_sweepRadius:function(){this.zip_sweepRadius&&(this.zip_sweepRadius=!1,this.type==f.id_ShapeType_CIRCLE?this.circle.__validate_sweepRadius():this.polygon.__validate_sweepRadius())},
validate_area_inertia:function(){this.zip_area_inertia&&(this.zip_area_inertia=!1,this.type==f.id_ShapeType_CIRCLE?this.circle.__validate_area_inertia():this.polygon.__validate_area_inertia())},validate_angDrag:function(){if(this.zip_angDrag||this.refmaterial.dynamicFriction!=this.material.dynamicFriction)this.zip_angDrag=!1,this.refmaterial.dynamicFriction=this.material.dynamicFriction,this.type==f.id_ShapeType_CIRCLE?this.circle.__validate_angDrag():this.polygon.__validate_angDrag()},validate_worldCOM:function(){this.zip_worldCOM&&
null!=this.body&&(this.zip_worldCOM=!1,this.zip_localCOM&&(this.zip_localCOM=!1,this.type==f.id_ShapeType_POLYGON&&this.polygon.__validate_localCOM(),null!=this.wrap_localCOM&&(this.wrap_localCOM.zpp_inner.x=this.localCOMx,this.wrap_localCOM.zpp_inner.y=this.localCOMy)),this.body.validate_axis(),this.worldCOMx=this.body.posx+(this.body.axisy*this.localCOMx-this.body.axisx*this.localCOMy),this.worldCOMy=this.body.posy+(this.localCOMx*this.body.axisx+this.localCOMy*this.body.axisy))},invalidate_area_inertia:function(){this.zip_area_inertia=
!0;null!=this.body&&(this.body.invalidate_localCOM(),this.body.invalidate_mass(),this.body.invalidate_inertia())},invalidate_angDrag:function(){this.zip_angDrag=!0},invalidate_localCOM:function(){this.zip_localCOM=!0;this.invalidate_area_inertia();this.type==f.id_ShapeType_CIRCLE&&(this.zip_sweepRadius=!0);this.invalidate_angDrag();this.invalidate_worldCOM();null!=this.body&&this.body.invalidate_localCOM()},invalidate_worldCOM:function(){this.zip_aabb=this.zip_worldCOM=!0;null!=this.body&&(this.body.zip_aabb=
!0)},invalidate_material:function(a){0!=(a&N.WAKE)&&this.wake();0!=(a&N.ARBITERS)&&null!=this.body&&this.body.refreshArbiters();0!=(a&N.PROPS)&&null!=this.body&&(this.body.invalidate_localCOM(),this.body.invalidate_mass(),this.body.invalidate_inertia());0!=(a&N.ANGDRAG)&&this.invalidate_angDrag();this.refmaterial.set(this.material)},invalidate_filter:function(){this.wake()},invalidate_fluidprops:function(){this.fluidEnabled&&this.wake()},aabb_validate:function(){this.zip_aabb&&null!=this.body&&(this.zip_aabb=
!1,this.type==f.id_ShapeType_CIRCLE?this.circle.__validate_aabb():this.polygon.__validate_aabb())},setMaterial:function(a){this.material!=a&&(null!=this.body&&null!=this.body.space&&null!=this.material&&this.material.shapes.remove(this),this.material=a,null!=this.body&&null!=this.body.space&&a.shapes.add(this),this.wake(),null!=this.body&&this.body.refreshArbiters())},setFilter:function(a){this.filter!=a&&(null!=this.body&&null!=this.body.space&&null!=this.filter&&this.filter.shapes.remove(this),
this.filter=a,null!=this.body&&null!=this.body.space&&a.shapes.add(this),this.wake())},setFluid:function(a){this.fluidProperties!=a&&(null!=this.body&&null!=this.body.space&&null!=this.fluidProperties&&this.fluidProperties.shapes.remove(this),this.fluidProperties=a,null!=this.body&&null!=this.body.space&&a.shapes.add(this),this.fluidEnabled&&this.wake())},__immutable_midstep:function(){},addedToBody:function(){this.invalidate_worldCOM();this.zip_aabb=!0;null!=this.body&&(this.body.zip_aabb=!0)},removedFromBody:function(){},
addedToSpace:function(){this.__iaddedToSpace();this.material.shapes.add(this);this.filter.shapes.add(this);null!=this.fluidProperties&&this.fluidProperties.shapes.add(this)},removedFromSpace:function(){this.__iremovedFromSpace();this.material.shapes.remove(this);this.filter.shapes.remove(this);null!=this.fluidProperties&&this.fluidProperties.shapes.remove(this)},copy:function(){var a=null,a=this.type==f.id_ShapeType_CIRCLE?this.circle.__copy():this.polygon.__copy();this.zip_area_inertia?a.invalidate_area_inertia():
(a.area=this.area,a.inertia=this.inertia);this.zip_sweepRadius?a.zip_sweepRadius=!0:(a.sweepRadius=this.sweepRadius,a.sweepCoef=this.sweepCoef);this.zip_angDrag?a.invalidate_angDrag():a.angDrag=this.angDrag;this.zip_aabb?(a.zip_aabb=!0,null!=a.body&&(a.body.zip_aabb=!0)):(a.aabb.minx=this.aabb.minx,a.aabb.miny=this.aabb.miny,a.aabb.maxx=this.aabb.maxx,a.aabb.maxy=this.aabb.maxy);var b=a.material;b.outer=null;b.next=N.zpp_pool;N.zpp_pool=b;b=a.filter;b.outer=null;b.next=ya.zpp_pool;ya.zpp_pool=b;a.material=
this.material;a.filter=this.filter;null!=this.fluidProperties&&(a.fluidProperties=this.fluidProperties);a.fluidEnabled=this.fluidEnabled;a.sensorEnabled=this.sensorEnabled;null!=this.userData&&(a.userData=ca.copy(this.userData));this.copyto(a.outer);return a.outer},__class__:jc});var Ff=function(){this.radius=0;this.outer_zn=null;jc.call(this,f.id_ShapeType_CIRCLE);this.circle=this;this.zip_localCOM=!1};h["zpp_nape.shape.ZPP_Circle"]=Ff;Ff.__name__=!0;Ff.__super__=jc;Ff.prototype=w(jc.prototype,{invalidate_radius:function(){this.invalidate_area_inertia();
this.invalidate_angDrag();this.zip_aabb=!0;null!=this.body&&(this.body.zip_aabb=!0);null!=this.body&&this.body.wake()},__validate_aabb:function(){this.zip_worldCOM&&null!=this.body&&(this.zip_worldCOM=!1,this.zip_localCOM&&(this.zip_localCOM=!1,this.type==f.id_ShapeType_POLYGON&&this.polygon.__validate_localCOM(),null!=this.wrap_localCOM&&(this.wrap_localCOM.zpp_inner.x=this.localCOMx,this.wrap_localCOM.zpp_inner.y=this.localCOMy)),this.body.validate_axis(),this.worldCOMx=this.body.posx+(this.body.axisy*
this.localCOMx-this.body.axisx*this.localCOMy),this.worldCOMy=this.body.posy+(this.localCOMx*this.body.axisx+this.localCOMy*this.body.axisy));var a=this.radius,b=this.radius;this.aabb.minx=this.worldCOMx-a;this.aabb.miny=this.worldCOMy-b;this.aabb.maxx=this.worldCOMx+a;this.aabb.maxy=this.worldCOMy+b},_force_validate_aabb:function(){this.worldCOMx=this.body.posx+(this.body.axisy*this.localCOMx-this.body.axisx*this.localCOMy);this.worldCOMy=this.body.posy+(this.localCOMx*this.body.axisx+this.localCOMy*
this.body.axisy);this.aabb.minx=this.worldCOMx-this.radius;this.aabb.miny=this.worldCOMy-this.radius;this.aabb.maxx=this.worldCOMx+this.radius;this.aabb.maxy=this.worldCOMy+this.radius},__validate_sweepRadius:function(){this.sweepCoef=Math.sqrt(this.localCOMx*this.localCOMx+this.localCOMy*this.localCOMy);this.sweepRadius=this.sweepCoef+this.radius},__validate_area_inertia:function(){var a=this.radius*this.radius;this.area=a*Math.PI;this.inertia=0.5*a+(this.localCOMx*this.localCOMx+this.localCOMy*
this.localCOMy)},__validate_angDrag:function(){var a=this.localCOMx*this.localCOMx+this.localCOMy*this.localCOMy,b=this.radius*this.radius;this.angDrag=(a+2*b)*this.material.dynamicFriction*m.fluidAngularDragFriction+0.5*m.fluidAngularDrag*(1+m.fluidVacuumDrag)*a;this.angDrag/=2*(a+0.5*b)},__scale:function(a,b){var c;c=((0>a?-a:a)+(0>b?-b:b))/2;this.radius=0>c?this.radius*-c:this.radius*c;this.invalidate_radius();0<this.localCOMx*this.localCOMx+this.localCOMy*this.localCOMy&&(this.localCOMx*=a,this.localCOMy*=
b,this.invalidate_localCOM())},__translate:function(a,b){this.localCOMx+=1*a;this.localCOMy+=1*b;this.invalidate_localCOM()},__copy:function(){var a=(new Gf(this.radius)).zpp_inner_zn;a.localCOMx=this.localCOMx;a.localCOMy=this.localCOMy;a.zip_localCOM=!1;return a},__class__:Ff});var S=function(){this.tp0=this.tp1=0;this.lp0=this.gp0=this.lp1=this.gp1=null;this.length=this.lprojection=this.gprojection=0;this.wrap_gnorm=null;this.gnormx=this.gnormy=0;this.wrap_lnorm=null;this.lnormx=this.lnormy=0;
this.next=this.polygon=this.outer=null;this.gprojection=this.lprojection=this.length=this.gnormy=this.gnormx=this.lnormy=this.lnormx=0};h["zpp_nape.shape.ZPP_Edge"]=S;S.__name__=!0;S.prototype={wrapper:function(){null==this.outer&&(S.internal=!0,this.outer=new Kg,S.internal=!1,this.outer.zpp_inner=this);return this.outer},__class__:S};var Hf=function(){this.reverse_flag=this.zip_lverts=this.zip_laxi=this.zip_gverts=this.zip_gaxi=this.zip_valid=this.zip_sanitation=!1;this.edgeCnt=0;this.outer_zn=this.lverts=
this.wrap_lverts=this.gverts=this.wrap_gverts=this.edges=this.wrap_edges=null;jc.call(this,f.id_ShapeType_POLYGON);this.polygon=this;this.lverts=new M;this.gverts=new M;this.edges=new Sg;this.edgeCnt=0};h["zpp_nape.shape.ZPP_Polygon"]=Hf;Hf.__name__=!0;Hf.__super__=jc;Hf.prototype=w(jc.prototype,{lverts_pa_invalidate:function(){this.invalidate_lverts()},gverts_pa_validate:function(){this.validate_gverts()},lverts_post_adder:function(a){a.zpp_inner._invalidate=q(this,this.lverts_pa_invalidate);for(var b=
null,c=null,d=this.lverts.next;null!=d&&!(d==a.zpp_inner);){b=null==b?this.gverts.next:b.next,c=null==c?this.edges.head:c.next;d=d.next}a=M.get(0,0,!0);this.gverts.insert(b,a);null!=this.lverts.next.next&&(null==this.lverts.next.next.next?(null==S.zpp_pool?c=new S:(c=S.zpp_pool,S.zpp_pool=c.next,c.next=null),null,c.polygon=this,this.edges.add(c),null==S.zpp_pool?c=new S:(c=S.zpp_pool,S.zpp_pool=c.next,c.next=null),null,c.polygon=this,this.edges.add(c),this.edgeCnt+=2):(null==S.zpp_pool?b=new S:(b=
S.zpp_pool,S.zpp_pool=b.next,b.next=null),null,b.polygon=this,this.edges.insert(c,b),this.edgeCnt++));a._validate=q(this,this.gverts_pa_validate)},lverts_subber:function(a){this.cleanup_lvert(a.zpp_inner)},lverts_invalidate:function(){this.invalidate_lverts()},lverts_validate:function(){this.validate_lverts()},getlverts:function(){this.wrap_lverts=md.get(this.lverts);this.wrap_lverts.zpp_inner.post_adder=q(this,this.lverts_post_adder);this.wrap_lverts.zpp_inner.subber=q(this,this.lverts_subber);this.wrap_lverts.zpp_inner._invalidate=
q(this,this.lverts_invalidate);this.wrap_lverts.zpp_inner._validate=q(this,this.lverts_validate);this.wrap_lverts.zpp_inner.reverse_flag=this.reverse_flag},invalidate_lverts:function(){this.invalidate_laxi();this.invalidate_area_inertia();this.invalidate_angDrag();this.invalidate_localCOM();this.invalidate_gverts();this.zip_sanitation=this.zip_valid=this.zip_lverts=!0;null!=this.body&&this.body.wake()},invalidate_laxi:function(){this.invalidate_gaxi();this.zip_laxi=this.zip_sweepRadius=!0},invalidate_gverts:function(){this.zip_aabb=
!0;null!=this.body&&(this.body.zip_aabb=!0);this.zip_gverts=!0},invalidate_gaxi:function(){this.zip_gaxi=!0},validate_lverts:function(){this.zip_lverts&&(this.zip_lverts=!1,2<this.lverts.length&&(this.validate_area_inertia(),0>this.area&&(this.reverse_vertices(),this.area=-this.area)))},cleanup_lvert:function(a){for(var b=null,c=null,d=this.lverts.next;null!=d&&!(d==a);){b=null==b?this.gverts.next:b.next,c=null==c?this.edges.head:c.next;d=d.next}a=null==b?this.gverts.next:b.next;this.gverts.erase(b);
null!=a.outer&&(a.outer.zpp_inner=null,a.outer=null);a._isimmutable=null;a._validate=null;a._invalidate=null;a.next=M.zpp_pool;M.zpp_pool=a;2==this.edgeCnt?(c=this.edges.pop_unsafe(),c.polygon=null,c.next=S.zpp_pool,S.zpp_pool=c,c=this.edges.pop_unsafe(),c.polygon=null,c.next=S.zpp_pool,S.zpp_pool=c,this.edgeCnt=0):0!=this.edgeCnt&&(b=null==c?this.edges.head.elt:c.next.elt,this.edges.erase(c),b.polygon=null,b.next=S.zpp_pool,S.zpp_pool=b,this.edgeCnt--)},splice_collinear:function(){this.zip_sanitation&&
(this.zip_sanitation=!1,this.splice_collinear_real())},splice_collinear_real:function(){if(!(null==this.lverts.next||null==this.lverts.next.next)&&null!=this.lverts.next.next.next){for(var a=null,b=this.lverts.next;null!=b;){var c=b,d=null==b.next?this.lverts.next:b.next;kb.vec_dsq(c.x,c.y,d.x,d.y)<m.epsilon*m.epsilon?(this.cleanup_lvert(b),b=this.lverts.erase(a)):(a=b,b=b.next)}if(null!=this.lverts.next){do{a=!1;for(b=this.lverts.next;null!=b;){var c=null==b.next?this.lverts.next:b.next,e=b,d=c,
f=null==c.next?this.lverts.next:c.next,g=0,h=0,g=d.x-e.x,h=d.y-e.y,j=e=0,e=f.x-d.x,j=f.y-d.y,d=j*g-e*h;d*d>=m.epsilon*m.epsilon||(this.cleanup_lvert(c),this.lverts.erase(null==b.next?null:b),a=!0);b=b.next}}while(a)}}},reverse_vertices:function(){this.lverts.reverse();this.gverts.reverse();this.edges.reverse();var a=this.edges.iterator_at(this.edgeCnt-1),b=this.edges.pop_unsafe();this.edges.insert(a,b);this.reverse_flag=!this.reverse_flag;null!=this.wrap_lverts&&(this.wrap_lverts.zpp_inner.reverse_flag=
this.reverse_flag);null!=this.wrap_gverts&&(this.wrap_gverts.zpp_inner.reverse_flag=this.reverse_flag);null!=this.wrap_edges&&(this.wrap_edges.zpp_inner.reverse_flag=this.reverse_flag)},validate_laxi:function(){if(this.zip_laxi){this.zip_laxi=!1;this.validate_lverts();for(var a=this.edges.head,b=this.lverts.next,c=b,b=b.next;null!=b;){var d=b,e=a.elt,a=a.next;e.lp0=c;e.lp1=d;var f=0,g=0,f=c.x-d.x,g=c.y-d.y,h=Math.sqrt(f*f+g*g);e.length=h;h=1/h;f*=h;g*=h;h=f;f=-g;g=h;e.lprojection=f*c.x+g*c.y;e.lnormx=
f;e.lnormy=g;null!=e.wrap_lnorm&&(e.wrap_lnorm.zpp_inner.x=f,e.wrap_lnorm.zpp_inner.y=g);c=d;b=b.next}e=this.lverts.next;a=a.elt;a.lp0=c;a.lp1=e;d=b=0;b=c.x-e.x;d=c.y-e.y;e=Math.sqrt(b*b+d*d);a.length=e;e=1/e;f=b*e;b=-(d*e);d=f;a.lprojection=b*c.x+d*c.y;a.lnormx=b;a.lnormy=d;null!=a.wrap_lnorm&&(a.wrap_lnorm.zpp_inner.x=b,a.wrap_lnorm.zpp_inner.y=d)}},validate_gverts:function(){if(this.zip_gverts&&null!=this.body){this.zip_gverts=!1;this.validate_lverts();this.body.validate_axis();for(var a=this.lverts.next,
b=this.gverts.next;null!=b;){var c=b,d=a,a=a.next;c.x=this.body.posx+(this.body.axisy*d.x-this.body.axisx*d.y);c.y=this.body.posy+(d.x*this.body.axisx+d.y*this.body.axisy);b=b.next}}},validate_gaxi:function(){if(this.zip_gaxi&&null!=this.body){this.zip_gaxi=!1;this.validate_laxi();this.body.validate_axis();this.validate_gverts();for(var a=this.edges.head,b=this.gverts.next,c=b,b=b.next;null!=b;){var d=b,e=a.elt,a=a.next;e.gp0=c;e.gp1=d;e.gnormx=this.body.axisy*e.lnormx-this.body.axisx*e.lnormy;e.gnormy=
e.lnormx*this.body.axisx+e.lnormy*this.body.axisy;e.gprojection=this.body.posx*e.gnormx+this.body.posy*e.gnormy+e.lprojection;null!=e.wrap_gnorm&&(e.wrap_gnorm.zpp_inner.x=e.gnormx,e.wrap_gnorm.zpp_inner.y=e.gnormy);e.tp0=e.gp0.y*e.gnormx-e.gp0.x*e.gnormy;e.tp1=e.gp1.y*e.gnormx-e.gp1.x*e.gnormy;c=d;b=b.next}b=this.gverts.next;a=a.elt;a.gp0=c;a.gp1=b;a.gnormx=this.body.axisy*a.lnormx-this.body.axisx*a.lnormy;a.gnormy=a.lnormx*this.body.axisx+a.lnormy*this.body.axisy;a.gprojection=this.body.posx*a.gnormx+
this.body.posy*a.gnormy+a.lprojection;null!=a.wrap_gnorm&&(a.wrap_gnorm.zpp_inner.x=a.gnormx,a.wrap_gnorm.zpp_inner.y=a.gnormy);a.tp0=a.gp0.y*a.gnormx-a.gp0.x*a.gnormy;a.tp1=a.gp1.y*a.gnormx-a.gp1.x*a.gnormy}},__validate_aabb:function(){this.validate_gverts();var a=this.gverts.next;this.aabb.minx=a.x;this.aabb.miny=a.y;this.aabb.maxx=a.x;this.aabb.maxy=a.y;for(a=this.gverts.next.next;null!=a;){var b=a;b.x<this.aabb.minx&&(this.aabb.minx=b.x);b.x>this.aabb.maxx&&(this.aabb.maxx=b.x);b.y<this.aabb.miny&&
(this.aabb.miny=b.y);b.y>this.aabb.maxy&&(this.aabb.maxy=b.y);a=a.next}},_force_validate_aabb:function(){var a=this.lverts.next,b=this.gverts.next,c=a,a=a.next;b.x=this.body.posx+(this.body.axisy*c.x-this.body.axisx*c.y);b.y=this.body.posy+(c.x*this.body.axisx+c.y*this.body.axisy);this.aabb.minx=b.x;this.aabb.miny=b.y;this.aabb.maxx=b.x;this.aabb.maxy=b.y;for(b=this.gverts.next.next;null!=b;){var c=b,d=a,a=a.next;c.x=this.body.posx+(this.body.axisy*d.x-this.body.axisx*d.y);c.y=this.body.posy+(d.x*
this.body.axisx+d.y*this.body.axisy);c.x<this.aabb.minx&&(this.aabb.minx=c.x);c.x>this.aabb.maxx&&(this.aabb.maxx=c.x);c.y<this.aabb.miny&&(this.aabb.miny=c.y);c.y>this.aabb.maxy&&(this.aabb.maxy=c.y);b=b.next}},__validate_sweepRadius:function(){var a=0,b=0;this.validate_laxi();for(var c=this.lverts.next;null!=c;){var d=c,d=d.x*d.x+d.y*d.y;d>a&&(a=d);c=c.next}for(c=this.edges.head;null!=c;){d=c.elt;if(d.lprojection<b&&(b=d.lprojection,0>b))break;c=c.next}0>b&&(b=0);this.sweepRadius=Math.sqrt(a);this.sweepCoef=
this.sweepRadius-b},__validate_area_inertia:function(){if(null==this.lverts.next||null==this.lverts.next.next||null==this.lverts.next.next.next)this.inertia=this.area=0;else{for(var a=this.area=0,b=0,c=this.lverts.next,d=c,e=c=c.next,c=c.next;null!=c;){var f=c,g=e.y*d.x-e.x*d.y,a=a+g*(e.x*e.x+e.y*e.y+(e.x*d.x+e.y*d.y)+(d.x*d.x+d.y*d.y)),b=b+g;this.area+=e.x*(f.y-d.y);d=e;e=f;c=c.next}g=c=this.lverts.next;f=e.y*d.x-e.x*d.y;a+=f*(e.x*e.x+e.y*e.y+(e.x*d.x+e.y*d.y)+(d.x*d.x+d.y*d.y));this.area+=e.x*(g.y-
d.y);d=e;e=g;c=c.next;g=e.y*d.x-e.x*d.y;a+=g*(e.x*e.x+e.y*e.y+(e.x*d.x+e.y*d.y)+(d.x*d.x+d.y*d.y));this.area+=e.x*(c.y-d.y);this.inertia=a/(6*(b+f+g));this.area*=0.5;0>this.area&&(this.area=-this.area,this.reverse_vertices())}},__validate_angDrag:function(){this.validate_area_inertia();this.validate_laxi();for(var a=0,b=this.edges.head,c=0,d=this.lverts.next,e=d,d=d.next;null!=d;){var f=d,g=b.elt,b=b.next,c=c+g.length,h=0,j=0,h=f.x-e.x,j=f.y-e.y,a=a+g.length*m.fluidAngularDragFriction*this.material.dynamicFriction*
g.lprojection*g.lprojection,L=-(e.y*g.lnormx-e.x*g.lnormy)/(j*g.lnormx-h*g.lnormy);if(0<L){var n;n=1<L?1:L;var p=0,r=0,p=e.x,r=e.y,o=n,p=p+h*o,r=r+j*o,o=g.lnormy*e.x-g.lnormx*e.y,p=g.lnormy*p-g.lnormx*r,a=a+(p*p*p-o*o*o)/(3*(p-o))*n*g.length*m.fluidAngularDrag}1>L&&(L=0>L?0:L,p=n=0,n=e.x,p=e.y,e=L,n+=h*e,p+=j*e,e=g.lnormy*n-g.lnormx*p,h=g.lnormy*f.x-g.lnormx*f.y,a+=(h*h*h-e*e*e)/(3*(h-e))*m.fluidVacuumDrag*(1-L)*g.length*m.fluidAngularDrag);e=f;d=d.next}d=this.lverts.next;b=b.elt;c+=b.length;g=f=
0;f=d.x-e.x;g=d.y-e.y;a+=b.length*m.fluidAngularDragFriction*this.material.dynamicFriction*b.lprojection*b.lprojection;h=-(e.y*b.lnormx-e.x*b.lnormy)/(g*b.lnormx-f*b.lnormy);0<h&&(j=1<h?1:h,p=n=0,n=e.x,p=e.y,L=b.lnormy*e.x-b.lnormx*e.y,n=b.lnormy*(n+f*j)-b.lnormx*(p+g*j),a+=(n*n*n-L*L*L)/(3*(n-L))*j*b.length*m.fluidAngularDrag);1>h&&(h=0>h?0:h,L=j=0,j=e.x,L=e.y,e=b.lnormy*(j+f*h)-b.lnormx*(L+g*h),d=b.lnormy*d.x-b.lnormx*d.y,a+=(d*d*d-e*e*e)/(3*(d-e))*m.fluidVacuumDrag*(1-h)*b.length*m.fluidAngularDrag);
this.angDrag=a/(this.inertia*c)},__validate_localCOM:function(){if(null==this.lverts.next.next)this.localCOMx=this.lverts.next.x,this.localCOMy=this.lverts.next.y;else if(null==this.lverts.next.next.next)this.localCOMx=this.lverts.next.x,this.localCOMy=this.lverts.next.y,this.localCOMx+=1*this.lverts.next.next.x,this.localCOMy+=1*this.lverts.next.next.y,this.localCOMx*=0.5,this.localCOMy*=0.5;else{for(var a=this.localCOMy=this.localCOMx=0,b=this.lverts.next,c=b,d=b=b.next,b=b.next;null!=b;){var e=
b,a=a+d.x*(e.y-c.y),c=e.y*d.x-e.x*d.y;this.localCOMx+=(d.x+e.x)*c;this.localCOMy+=(d.y+e.y)*c;c=d;d=e;b=b.next}e=b=this.lverts.next;a+=d.x*(e.y-c.y);c=e.y*d.x-e.x*d.y;this.localCOMx+=(d.x+e.x)*c;this.localCOMy+=(d.y+e.y)*c;c=d;d=e;b=b.next;a+=d.x*(b.y-c.y);c=b.y*d.x-b.x*d.y;this.localCOMx+=(d.x+b.x)*c;this.localCOMy+=(d.y+b.y)*c;a=1/(3*a);this.localCOMx*=a;this.localCOMy*=a}},__translate:function(a,b){for(var c=this.lverts.next;null!=c;){var d=c;d.x+=1*a;d.y+=1*b;c=c.next}this.invalidate_lverts()},
__scale:function(a,b){for(var c=this.lverts.next;null!=c;){var d=c;d.x*=a;d.y*=b;c=c.next}this.invalidate_lverts()},__copy:function(){return(new sc(this.outer_zn.get_localVerts())).zpp_inner_zn},__class__:Hf});var Fc=function(){this.sweep=this.dynab=null;this.is_sweep=!1;this.space=null};h["zpp_nape.space.ZPP_Broadphase"]=Fc;Fc.__name__=!0;Fc.prototype={insert:function(a){this.is_sweep?this.sweep.__insert(a):this.dynab.__insert(a)},remove:function(a){this.is_sweep?this.sweep.__remove(a):this.dynab.__remove(a)},
sync:function(a){this.is_sweep?!this.sweep.space.continuous&&a.zip_aabb&&null!=a.body&&(a.zip_aabb=!1,a.type==f.id_ShapeType_CIRCLE?a.circle.__validate_aabb():a.polygon.__validate_aabb()):this.dynab.__sync(a)},broadphase:function(){},bodiesUnderPoint:function(){return null},__class__:Fc};var Ma=function(){this.synced=this.first_sync=!1;this.snext=null;this.moved=!1;this.next=this.mnext=null;this.height=0;this.parent=this.child1=this.child2=null;this.dyn=!1;this.aabb=this.shape=null;this.height=-1};
h["zpp_nape.space.ZPP_AABBNode"]=Ma;Ma.__name__=!0;Ma.prototype={free:function(){this.height=-1;var a=this.aabb;null!=a.outer&&(a.outer.zpp_inner=null,a.outer=null);a.wrap_min=a.wrap_max=null;a._invalidate=null;a._validate=null;a.next=ga.zpp_pool;ga.zpp_pool=a;this.mnext=this.snext=this.next=this.child1=this.child2=this.parent=null},__class__:Ma};var Y=function(){this.arb=this.next=null;this.id=this.di=0;this.first=this.sleeping=!1;this.n1=this.n2=null};h["zpp_nape.space.ZPP_AABBPair"]=Y;Y.__name__=
!0;Y.prototype={__class__:Y};var pb=function(){this.root=null};h["zpp_nape.space.ZPP_AABBTree"]=pb;pb.__name__=!0;pb.prototype={inlined_insertLeaf:function(a){if(null==this.root)this.root=a,this.root.parent=null;else{for(var b=a.aabb,c=this.root;null!=c.child1;){var d=c.child1,e=c.child2,f=c.aabb.perimeter();pb.tmpaabb.setCombine(c.aabb,b);var g=pb.tmpaabb.perimeter(),h=2*g,f=2*(g-f);pb.tmpaabb.setCombine(b,d.aabb);null==d.child1?g=pb.tmpaabb.perimeter()+f:(g=d.aabb.perimeter(),g=pb.tmpaabb.perimeter()-
g+f);pb.tmpaabb.setCombine(b,e.aabb);if(null==e.child1)f=pb.tmpaabb.perimeter()+f;else var j=e.aabb.perimeter(),f=pb.tmpaabb.perimeter()-j+f;if(h<g&&h<f)break;else c=g<f?d:e}d=c.parent;null==Ma.zpp_pool?e=new Ma:(e=Ma.zpp_pool,Ma.zpp_pool=e.next,e.next=null);null==ga.zpp_pool?e.aabb=new ga:(e.aabb=ga.zpp_pool,ga.zpp_pool=e.aabb.next,e.aabb.next=null);null;e.moved=!1;e.synced=!1;e.first_sync=!1;e.parent=d;e.aabb.setCombine(b,c.aabb);e.height=c.height+1;null!=d?(d.child1==c?d.child1=e:d.child2=e,e.child1=
c,e.child2=a,c.parent=e,a.parent=e):(e.child1=c,e.child2=a,c.parent=e,this.root=a.parent=e);for(c=a.parent;null!=c;)c=this.balance(c),a=c.child1,b=c.child2,d=a.height,e=b.height,c.height=1+(d>e?d:e),c.aabb.setCombine(a.aabb,b.aabb),c=c.parent}},removeLeaf:function(a){this.inlined_removeLeaf(a)},inlined_removeLeaf:function(a){if(a==this.root)this.root=null;else{var b=a.parent,c=b.parent,a=b.child1==a?b.child2:b.child1;if(null!=c){c.child1==b?c.child1=a:c.child2=a;a.parent=c;b.free();b.next=Ma.zpp_pool;
Ma.zpp_pool=b;for(b=c;null!=b;)b=this.balance(b),a=b.child1,c=b.child2,b.aabb.setCombine(a.aabb,c.aabb),a=a.height,c=c.height,b.height=1+(a>c?a:c),b=b.parent}else this.root=a,a.parent=null,b.free(),b.next=Ma.zpp_pool,Ma.zpp_pool=b}},balance:function(a){if(null==a.child1||2>a.height)return a;var b=a.child1,c=a.child2,d=c.height-b.height;if(1<d){var e=c.child1,f=c.child2;c.child1=a;c.parent=a.parent;a.parent=c;null!=c.parent?c.parent.child1==a?c.parent.child1=c:c.parent.child2=c:this.root=c;e.height>
f.height?(c.child2=e,a.child2=f,f.parent=a,a.aabb.setCombine(b.aabb,f.aabb),c.aabb.setCombine(a.aabb,e.aabb),a.height=1+function(){var a=b.height,c=f.height;return a>c?a:c}(this),c.height=1+function(){var b=a.height,c=e.height;return b>c?b:c}(this)):(c.child2=f,a.child2=e,e.parent=a,a.aabb.setCombine(b.aabb,e.aabb),c.aabb.setCombine(a.aabb,f.aabb),a.height=1+function(){var a=b.height,c=e.height;return a>c?a:c}(this),c.height=1+function(){var b=a.height,c=f.height;return b>c?b:c}(this));return c}if(-1>
d){var g=b.child1,h=b.child2;b.child1=a;b.parent=a.parent;a.parent=b;null!=b.parent?b.parent.child1==a?b.parent.child1=b:b.parent.child2=b:this.root=b;g.height>h.height?(b.child2=g,a.child1=h,h.parent=a,a.aabb.setCombine(c.aabb,h.aabb),b.aabb.setCombine(a.aabb,g.aabb),a.height=1+function(){var a=c.height,b=h.height;return a>b?a:b}(this),b.height=1+function(){var b=a.height,c=g.height;return b>c?b:c}(this)):(b.child2=h,a.child1=g,g.parent=a,a.aabb.setCombine(c.aabb,g.aabb),b.aabb.setCombine(a.aabb,
h.aabb),a.height=1+function(){var a=c.height,b=g.height;return a>b?a:b}(this),b.height=1+function(){var b=a.height,c=h.height;return b>c?b:c}(this));return b}return a},__class__:pb};var Qf=function(a){this.stree=this.dtree=this.pairs=this.syncs=this.moves=this.treeStack=null;Fc.call(this);this.space=a;this.is_sweep=!1;this.dynab=this;this.stree=new pb;this.dtree=new pb};h["zpp_nape.space.ZPP_DynAABBPhase"]=Qf;Qf.__name__=!0;Qf.__super__=Fc;Qf.prototype=w(Fc.prototype,{__insert:function(a){var b;null==
Ma.zpp_pool?b=new Ma:(b=Ma.zpp_pool,Ma.zpp_pool=b.next,b.next=null);null==ga.zpp_pool?b.aabb=new ga:(b.aabb=ga.zpp_pool,ga.zpp_pool=b.aabb.next,b.aabb.next=null);null;b.moved=!1;b.synced=!1;b.first_sync=!1;b.shape=a;a.node=b;b.synced=!0;b.first_sync=!0;b.snext=this.syncs;this.syncs=b},__remove:function(a){var b=a.node;b.first_sync||(b.dyn?this.dtree.removeLeaf(b):this.stree.removeLeaf(b));a.node=null;if(b.synced){for(var c=null,d=this.syncs;null!=d&&!(d==b);){c=d;d=d.snext}null==c?this.syncs=d.snext:
c.snext=d.snext;d.snext=null;b.synced=!1}if(b.moved){c=null;for(d=this.moves;null!=d&&!(d==b);){c=d;d=d.mnext}null==c?this.moves=d.mnext:c.mnext=d.mnext;d.mnext=null;b.moved=!1}for(var c=null,e=this.pairs;null!=e;)d=e.next,e.n1==b||e.n2==b?(null==c?this.pairs=d:c.next=d,null!=e.arb&&(e.arb.pair=null),e.arb=null,e.n1.shape.pairs.remove(e),e.n2.shape.pairs.remove(e),e.n1=e.n2=null,e.sleeping=!1,e.next=Y.zpp_pool,Y.zpp_pool=e):c=e,e=d;for(;null!=a.pairs.head;)c=a.pairs.pop_unsafe(),c.n1==b?c.n2.shape.pairs.remove(c):
c.n1.shape.pairs.remove(c),null!=c.arb&&(c.arb.pair=null),c.arb=null,c.n1=c.n2=null,c.sleeping=!1,c.next=Y.zpp_pool,Y.zpp_pool=c;b.free();b.next=Ma.zpp_pool;Ma.zpp_pool=b},__sync:function(a){var b=a.node;if(!b.synced&&(!this.space.continuous&&a.zip_aabb&&null!=a.body&&(a.zip_aabb=!1,a.type==f.id_ShapeType_CIRCLE?a.circle.__validate_aabb():a.polygon.__validate_aabb()),b.dyn!=(a.body.type==f.id_BodyType_STATIC?!1:!a.body.component.sleeping)||!b.aabb.contains(a.aabb)))b.synced=!0,b.snext=this.syncs,
this.syncs=b},sync_broadphase:function(){this.space.validation();if(null!=this.syncs)if(null==this.moves){for(var a=this.syncs;null!=a;){var b=a.shape;a.first_sync?a.first_sync=!1:(a.dyn?this.dtree:this.stree).inlined_removeLeaf(a);var c=a.aabb;!this.space.continuous&&b.zip_aabb&&null!=b.body&&(b.zip_aabb=!1,b.type==f.id_ShapeType_CIRCLE?b.circle.__validate_aabb():b.polygon.__validate_aabb());c.setExpand(b.aabb,3);((b.body.type==f.id_BodyType_STATIC?a.dyn=!1:a.dyn=!b.body.component.sleeping)?this.dtree:
this.stree).inlined_insertLeaf(a);a.synced=!1;a.moved=!0;a.mnext=a.snext;a.snext=null;a=a.mnext}a=this.syncs;this.syncs=this.moves;this.moves=a}else for(;null!=this.syncs;)a=this.syncs,this.syncs=a.snext,a.snext=null,b=a.shape,a.first_sync?a.first_sync=!1:(a.dyn?this.dtree:this.stree).inlined_removeLeaf(a),c=a.aabb,!this.space.continuous&&b.zip_aabb&&null!=b.body&&(b.zip_aabb=!1,b.type==f.id_ShapeType_CIRCLE?b.circle.__validate_aabb():b.polygon.__validate_aabb()),c.setExpand(b.aabb,3),((b.body.type==
f.id_BodyType_STATIC?a.dyn=!1:a.dyn=!b.body.component.sleeping)?this.dtree:this.stree).inlined_insertLeaf(a),a.synced=!1,a.moved||(a.moved=!0,a.mnext=this.moves,this.moves=a)},broadphase:function(a,b){for(var c=this.syncs;null!=c;){var d=c.shape;c.first_sync?c.first_sync=!1:(c.dyn?this.dtree:this.stree).inlined_removeLeaf(c);var e=c.aabb;!a.continuous&&d.zip_aabb&&null!=d.body&&(d.zip_aabb=!1,d.type==f.id_ShapeType_CIRCLE?d.circle.__validate_aabb():d.polygon.__validate_aabb());e.setExpand(d.aabb,
3);((d.body.type==f.id_BodyType_STATIC?c.dyn=!1:c.dyn=!d.body.component.sleeping)?this.dtree:this.stree).inlined_insertLeaf(c);c.synced=!1;c=c.snext}for(;null!=this.syncs;)if(c=this.syncs,this.syncs=c.snext,c.snext=null,!c.moved&&(c.moved=!1,d=c.shape,!d.body.component.sleeping)){var e=c.aabb,i=null;null!=this.dtree.root&&(this.dtree.root.next=i,i=this.dtree.root);for(;null!=i;){var g;g=i;i=g.next;g.next=null;if(g!=c)if(null==g.child1){var h=g.shape;if(h.body!=d.body&&!(h.body.type==f.id_BodyType_STATIC&&
d.body.type==f.id_BodyType_STATIC)&&e.intersect(g.aabb)){var j,m;d.id<h.id?(j=d.id,m=h.id):(j=h.id,m=d.id);for(var n=null,p=(d.pairs.length<h.pairs.length?d:h).pairs.head;null!=p;){var r=p.elt;if(r.id==j&&r.di==m){n=r;break}p=p.next}null!=n?n.sleeping&&(n.sleeping=!1,n.next=this.pairs,this.pairs=n,n.first=!0):(null==Y.zpp_pool?n=new Y:(n=Y.zpp_pool,Y.zpp_pool=n.next,n.next=null),null,n.n1=c,n.n2=g,n.id=j,n.di=m,n.next=this.pairs,this.pairs=n,n.first=!0,d.pairs.inlined_add(n),h.pairs.inlined_add(n))}}else e.intersect(g.aabb)&&
(null!=g.child1&&(g.child1.next=i,i=g.child1),null!=g.child2&&(g.child2.next=i,i=g.child2))}null!=this.stree.root&&(this.stree.root.next=i,i=this.stree.root);for(;null!=i;)if(g=i,i=g.next,g.next=null,g!=c)if(null==g.child1){if(h=g.shape,h.body!=d.body&&!(h.body.type==f.id_BodyType_STATIC&&d.body.type==f.id_BodyType_STATIC)&&e.intersect(g.aabb)){d.id<h.id?(j=d.id,m=h.id):(j=h.id,m=d.id);n=null;for(p=(d.pairs.length<h.pairs.length?d:h).pairs.head;null!=p;){r=p.elt;if(r.id==j&&r.di==m){n=r;break}p=p.next}null!=
n?n.sleeping&&(n.sleeping=!1,n.next=this.pairs,this.pairs=n,n.first=!0):(null==Y.zpp_pool?n=new Y:(n=Y.zpp_pool,Y.zpp_pool=n.next,n.next=null),null,n.n1=c,n.n2=g,n.id=j,n.di=m,n.next=this.pairs,this.pairs=n,n.first=!0,d.pairs.inlined_add(n),h.pairs.inlined_add(n))}}else e.intersect(g.aabb)&&(null!=g.child1&&(g.child1.next=i,i=g.child1),null!=g.child2&&(g.child2.next=i,i=g.child2))}for(;null!=this.moves;)if(c=this.moves,this.moves=c.mnext,c.mnext=null,c.moved=!1,d=c.shape,!d.body.component.sleeping){e=
c.aabb;i=null;null!=this.dtree.root&&(this.dtree.root.next=i,i=this.dtree.root);for(;null!=i;)if(g=i,i=g.next,g.next=null,g!=c)if(null==g.child1){if(h=g.shape,h.body!=d.body&&!(h.body.type==f.id_BodyType_STATIC&&d.body.type==f.id_BodyType_STATIC)&&e.intersect(g.aabb)){d.id<h.id?(j=d.id,m=h.id):(j=h.id,m=d.id);n=null;for(p=(d.pairs.length<h.pairs.length?d:h).pairs.head;null!=p;){r=p.elt;if(r.id==j&&r.di==m){n=r;break}p=p.next}null!=n?n.sleeping&&(n.sleeping=!1,n.next=this.pairs,this.pairs=n,n.first=
!0):(null==Y.zpp_pool?n=new Y:(n=Y.zpp_pool,Y.zpp_pool=n.next,n.next=null),null,n.n1=c,n.n2=g,n.id=j,n.di=m,n.next=this.pairs,this.pairs=n,n.first=!0,d.pairs.inlined_add(n),h.pairs.inlined_add(n))}}else e.intersect(g.aabb)&&(null!=g.child1&&(g.child1.next=i,i=g.child1),null!=g.child2&&(g.child2.next=i,i=g.child2));null!=this.stree.root&&(this.stree.root.next=i,i=this.stree.root);for(;null!=i;)if(g=i,i=g.next,g.next=null,g!=c)if(null==g.child1){if(h=g.shape,h.body!=d.body&&!(h.body.type==f.id_BodyType_STATIC&&
d.body.type==f.id_BodyType_STATIC)&&e.intersect(g.aabb)){d.id<h.id?(j=d.id,m=h.id):(j=h.id,m=d.id);n=null;for(p=(d.pairs.length<h.pairs.length?d:h).pairs.head;null!=p;){r=p.elt;if(r.id==j&&r.di==m){n=r;break}p=p.next}null!=n?n.sleeping&&(n.sleeping=!1,n.next=this.pairs,this.pairs=n,n.first=!0):(null==Y.zpp_pool?n=new Y:(n=Y.zpp_pool,Y.zpp_pool=n.next,n.next=null),null,n.n1=c,n.n2=g,n.id=j,n.di=m,n.next=this.pairs,this.pairs=n,n.first=!0,d.pairs.inlined_add(n),h.pairs.inlined_add(n))}}else e.intersect(g.aabb)&&
(null!=g.child1&&(g.child1.next=i,i=g.child1),null!=g.child2&&(g.child2.next=i,i=g.child2))}c=null;for(d=this.pairs;null!=d;)!d.first&&!d.n1.aabb.intersect(d.n2.aabb)?(null==c?this.pairs=d.next:c.next=d.next,d.n1.shape.pairs.inlined_try_remove(d),d.n2.shape.pairs.inlined_try_remove(d),e=d.next,null!=d.arb&&(d.arb.pair=null),d.arb=null,d.n1=d.n2=null,d.sleeping=!1,d.next=Y.zpp_pool,Y.zpp_pool=d,d=e):(e=d.n1.shape,i=e.body,g=d.n2.shape,h=g.body,!d.first&&(i.component.sleeping||i.type==f.id_BodyType_STATIC)&&
(h.component.sleeping||h.type==f.id_BodyType_STATIC)?(d.sleeping=!0,null==c?this.pairs=d.next:c.next=d.next):(d.first=!1,e.aabb.intersect(g.aabb)&&(c=d.arb,d.arb=b?a.narrowPhase(e,g,i.type!=f.id_BodyType_DYNAMIC||h.type!=f.id_BodyType_DYNAMIC,d.arb,!1):a.continuousEvent(e,g,i.type!=f.id_BodyType_DYNAMIC||h.type!=f.id_BodyType_DYNAMIC,d.arb,!1),null==d.arb?null!=c&&(c.pair=null):d.arb.pair=d),c=d),d=d.next)},bodiesUnderPoint:function(a,b,c,d){this.sync_broadphase();a=M.get(a,b,null);d=null==d?new ge:
d;if(null!=this.stree.root){null==this.treeStack&&(this.treeStack=new Rf);for(this.treeStack.add(this.stree.root);null!=this.treeStack.head;)if(b=this.treeStack.pop_unsafe(),b.aabb.containsPoint(a))if(null==b.child1){var e=b.shape.body.outer;if(!d.has(e)&&(null==c||b.shape.filter.shouldCollide(c)))b.shape.type==f.id_ShapeType_CIRCLE?t.circleContains(b.shape.circle,a)&&d.push(e):t.polyContains(b.shape.polygon,a)&&d.push(e)}else null!=b.child1&&this.treeStack.add(b.child1),null!=b.child2&&this.treeStack.add(b.child2)}if(null!=
this.dtree.root){null==this.treeStack&&(this.treeStack=new Rf);for(this.treeStack.add(this.dtree.root);null!=this.treeStack.head;)if(b=this.treeStack.pop_unsafe(),b.aabb.containsPoint(a))if(null==b.child1){if(e=b.shape.body.outer,!d.has(e)&&(null==c||b.shape.filter.shouldCollide(c)))b.shape.type==f.id_ShapeType_CIRCLE?t.circleContains(b.shape.circle,a)&&d.push(e):t.polyContains(b.shape.polygon,a)&&d.push(e)}else null!=b.child1&&this.treeStack.add(b.child1),null!=b.child2&&this.treeStack.add(b.child2)}null!=
a.outer&&(a.outer.zpp_inner=null,a.outer=null);a._isimmutable=null;a._validate=null;a._invalidate=null;a.next=M.zpp_pool;M.zpp_pool=a;return d},__class__:Qf});var pa=function(){this.waket=0;this.sleep=!1;this.comps=null;this.length=0;this._inuse=this.modified=this.pushmod=!1;this.next=null;this.comps=new Tg};h["zpp_nape.space.ZPP_Island"]=pa;pa.__name__=!0;pa.prototype={inlined_add:function(a){a._inuse=!0;a.next=this.next;this.next=a;this.modified=!0;this.length++;return a},pop:function(){this.inlined_pop()},
inlined_pop:function(){var a=this.next;this.next=a.next;a._inuse=!1;null==this.next&&(this.pushmod=!0);this.modified=!0;this.length--},inlined_pop_unsafe:function(){var a=this.next;this.pop();return a},__class__:pa};var Wa=function(){this.woken=!1;this.waket=0;this.sleeping=!1;this.body=this.constraint=this.island=null;this.isBody=!1;this.rank=0;this.next=this.parent=null;this.sleeping=!1;this.island=null;this.parent=this;this.rank=0;this.woken=!1};h["zpp_nape.space.ZPP_Component"]=Wa;Wa.__name__=
!0;Wa.prototype={__class__:Wa};var ib=function(){this.freed=this.lazydel=!1;this.length=0;this._inuse=this.modified=this.pushmod=!1;this.int1=this.int2=this.next=null;this.id=this.di=0;this.arbiters=new ye};h["zpp_nape.space.ZPP_CallbackSet"]=ib;ib.__name__=!0;ib.get=function(a,b){var c;null==ib.zpp_pool?c=new ib:(c=ib.zpp_pool,ib.zpp_pool=c.next,c.next=null);c.freed=!1;c.lazydel=!1;c.COLLISIONstate=f.id_PreFlag_ACCEPT;c.COLLISIONstamp=0;c.SENSORstate=f.id_PreFlag_ACCEPT;c.SENSORstamp=0;c.FLUIDstate=
f.id_PreFlag_ACCEPT;c.FLUIDstamp=0;a.id<b.id?(c.int1=a,c.int2=b):(c.int1=b,c.int2=a);c.id=c.int1.id;c.di=c.int2.id;return c};ib.prototype={inlined_add:function(a){a._inuse=!0;a.next=this.next;this.next=a;this.modified=!0;this.length++;return a},inlined_erase:function(a){var b,c;null==a?(b=this.next,this.next=c=b.next,null==this.next&&(this.pushmod=!0)):(b=a.next,c=b.next,a.next=c,null==c&&(this.pushmod=!0));b._inuse=!1;this.modified=!0;this.length--;this.pushmod=!0;return c},remove_arb:function(a){this.arbiters.inlined_try_remove(a)},
empty_arb:function(a){var b;b=!0;for(var c=this.arbiters.head;null!=c;)if(0==(c.elt.type&a))c=c.next;else{b=!1;break}return b},sleeping:function(){var a;a=!0;for(var b=this.arbiters.head;null!=b;)if(b.elt.sleeping)b=b.next;else{a=!1;break}return a},__class__:ib};var Ug=function(a){this.cbsets=this.space=null;null==db.zpp_pool?this.cbsets=new db:(this.cbsets=db.zpp_pool,db.zpp_pool=this.cbsets.next,this.cbsets.next=null);null;this.cbsets.lt=K.setlt;this.space=a};h["zpp_nape.space.ZPP_CbSetManager"]=
Ug;Ug.__name__=!0;Ug.prototype={get:function(a){if(null==a.head)return null;var b;null==K.zpp_pool?b=new K:(b=K.zpp_pool,K.zpp_pool=b.next,b.next=null);null;var c=b.cbTypes;b.cbTypes=a;var d=this.cbsets.find_weak(b);null!=d?a=d.data:(a=K.get(a),this.cbsets.insert(a),a.manager=this);b.cbTypes=c;b.free();b.next=K.zpp_pool;K.zpp_pool=b;return a},remove:function(a){for(this.cbsets.remove(a);null!=a.cbpairs.head;){var b=a.cbpairs.pop_unsafe();b.a!=b.b&&(a==b.a?b.b.cbpairs.remove(b):b.a.cbpairs.remove(b));
b.a=b.b=null;b.listeners.clear();b.next=ta.zpp_pool;ta.zpp_pool=b}a.manager=null},validate:function(){if(!this.cbsets.empty()){for(var a=this.cbsets.parent;null!=a.prev;)a=a.prev;for(;null!=a;)if(a.data.validate(),null!=a.next)for(a=a.next;null!=a.prev;)a=a.prev;else{for(;null!=a.parent&&a==a.parent.next;)a=a.parent;a=a.parent}}},pair:function(a,b){for(var c=null,d=(a.cbpairs.length<b.cbpairs.length?a.cbpairs:b.cbpairs).head;null!=d;){var e=d.elt;if(e.a==a&&e.b==b||e.a==b&&e.b==a){c=e;break}d=d.next}null==
c&&(c=ta.get(a,b),a.cbpairs.add(c),b!=a&&b.cbpairs.add(c));c.zip_listeners&&(c.zip_listeners=!1,c.__validate());return c},__class__:Ug};var Mg=function(a,b){this.precb=this.prelisteners=null;this.continuous=!1;this.toiEvents=null;this.pre_dt=0;this.c_arbiters_true=this.c_arbiters_false=this.f_arbiters=this.s_arbiters=this.live=this.wrap_live=this.live_constraints=this.wrap_livecon=this.staticsleep=this.islands=this.listeners=this.wrap_listeners=this.callbacks=this.callbackset_list=this.cbsets=null;
this.sortcontacts=!1;this.time=0;this.midstep=!1;this.global_lin_drag=this.global_ang_drag=this.stamp=0;this.wrap_gravity=this.bodies=this.wrap_bodies=this.compounds=this.wrap_compounds=this.constraints=this.wrap_constraints=this.kinematics=this.bphase=this.__static=null;this.gravityx=this.gravityy=0;this.outer=null;this.toiEvents=new Vg;this.global_ang_drag=this.global_lin_drag=0.015;this.precb=new xf;this.precb.zpp_inner=new Pb;this.sortcontacts=!0;this.pre_dt=0;var c;if(!(c=null==b))null==f.Broadphase_DYNAMIC_AABB_TREE&&
(f.internal=!0,f.Broadphase_DYNAMIC_AABB_TREE=new Xc,f.internal=!1),c=b==f.Broadphase_DYNAMIC_AABB_TREE;c?this.bphase=new Qf(this):(null==f.Broadphase_SWEEP_AND_PRUNE&&(f.internal=!0,f.Broadphase_SWEEP_AND_PRUNE=new Xc,f.internal=!1),b==f.Broadphase_SWEEP_AND_PRUNE&&(this.bphase=new Sf(this)));this.time=0;null!=a?(this.gravityx=a.x,this.gravityy=a.y):this.gravityy=this.gravityx=0;this.bodies=new Ec;this.wrap_bodies=zc.get(this.bodies);this.wrap_bodies.zpp_inner.adder=q(this,this.bodies_adder);this.wrap_bodies.zpp_inner.subber=
q(this,this.bodies_subber);this.compounds=new Sd;this.wrap_compounds=Vc.get(this.compounds);this.wrap_compounds.zpp_inner.adder=q(this,this.compounds_adder);this.wrap_compounds.zpp_inner.subber=q(this,this.compounds_subber);this.kinematics=new Ec;this.c_arbiters_true=new Tf;this.c_arbiters_false=new Tf;this.f_arbiters=new Wg;this.s_arbiters=new Xg;this.islands=new pa;this.live=new Ec;this.wrap_live=zc.get(this.live,!0);this.staticsleep=new Ec;this.constraints=new gc;this.wrap_constraints=Kb.get(this.constraints);
this.wrap_constraints.zpp_inner.adder=q(this,this.constraints_adder);this.wrap_constraints.zpp_inner.subber=q(this,this.constraints_subber);this.live_constraints=new gc;this.wrap_livecon=Kb.get(this.live_constraints,!0);this.__static=yc.__static();this.__static.zpp_inner.space=this;this.callbacks=new Pb;this.midstep=!1;this.listeners=new Uf;this.wrap_listeners=Uc.get(this.listeners);this.wrap_listeners.zpp_inner.adder=q(this,this.listeners_adder);this.wrap_listeners.zpp_inner.subber=q(this,this.listeners_subber);
this.callbackset_list=new ib;this.mrca1=new Ac;this.mrca2=new Ac;this.prelisteners=new Od;this.cbsets=new Ug(this)};h["zpp_nape.space.ZPP_Space"]=Mg;Mg.__name__=!0;Mg.prototype={getgravity:function(){this.wrap_gravity=B.get(this.gravityx,this.gravityy,null);this.wrap_gravity.zpp_inner._inuse=!0;this.wrap_gravity.zpp_inner._invalidate=q(this,this.gravity_invalidate);this.wrap_gravity.zpp_inner._validate=q(this,this.gravity_validate)},gravity_invalidate:function(a){this.gravityx=a.x;this.gravityy=a.y;
for(var a=new Sd,b=this.bodies.head;null!=b;){var c=b.elt;c.world||(c.component.waket=this.stamp+(this.midstep?0:1),c.type==f.id_BodyType_KINEMATIC&&(c.kinematicDelaySleep=!0),c.component.sleeping&&this.really_wake(c,!1));b=b.next}for(b=this.compounds.head;null!=b;)a.add(b.elt),b=b.next;for(;null!=a.head;){b=a.pop_unsafe();for(c=b.bodies.head;null!=c;){var d=c.elt;d.world||(d.component.waket=this.stamp+(this.midstep?0:1),d.type==f.id_BodyType_KINEMATIC&&(d.kinematicDelaySleep=!0),d.component.sleeping&&
this.really_wake(d,!1));c=c.next}for(b=b.compounds.head;null!=b;)a.add(b.elt),b=b.next}},gravity_validate:function(){this.wrap_gravity.zpp_inner.x=this.gravityx;this.wrap_gravity.zpp_inner.y=this.gravityy},bodies_adder:function(a){return a.zpp_inner.space!=this?(null!=a.zpp_inner.space&&a.zpp_inner.space.outer.zpp_inner.wrap_bodies.remove(a),this.addBody(a.zpp_inner),!0):!1},bodies_subber:function(a){this.remBody(a.zpp_inner)},compounds_adder:function(a){return a.zpp_inner.space!=this?(null!=a.zpp_inner.space&&
a.zpp_inner.space.wrap_compounds.remove(a),this.addCompound(a.zpp_inner),!0):!1},compounds_subber:function(a){this.remCompound(a.zpp_inner)},constraints_adder:function(a){return a.zpp_inner.space!=this?(null!=a.zpp_inner.space&&a.zpp_inner.space.outer.zpp_inner.wrap_constraints.remove(a),this.addConstraint(a.zpp_inner),!0):!1},constraints_subber:function(a){this.remConstraint(a.zpp_inner)},listeners_adder:function(a){return a.zpp_inner.space!=this?(null!=a.zpp_inner.space&&a.zpp_inner.space.outer.zpp_inner.wrap_listeners.remove(a),
this.addListener(a.zpp_inner),!0):!1},listeners_subber:function(a){this.remListener(a.zpp_inner)},addListener:function(a){a.space=this;a.addedToSpace();null!=a.interaction&&null},remListener:function(a){null!=a.interaction&&null;a.removedFromSpace();a.space=null},add_callbackset:function(a){a.int1.cbsets.inlined_add(a);a.int2.cbsets.inlined_add(a);this.callbackset_list.inlined_add(a)},remove_callbackset:function(a){a.lazydel=!0;a.int1.cbsets.inlined_try_remove(a);a.int2.cbsets.inlined_try_remove(a)},
transmitType:function(a,b){a.world||(a.component.waket=this.stamp+(this.midstep?0:1),a.type==f.id_BodyType_KINEMATIC&&(a.kinematicDelaySleep=!0),a.component.sleeping&&this.really_wake(a,!1));a.type==f.id_BodyType_DYNAMIC?this.live.remove(a):a.type==f.id_BodyType_KINEMATIC?(this.kinematics.remove(a),this.staticsleep.remove(a)):a.type==f.id_BodyType_STATIC&&this.staticsleep.remove(a);a.type=b;a.type==f.id_BodyType_KINEMATIC&&this.kinematics.add(a);a.type==f.id_BodyType_STATIC&&this.static_validation(a);
a.component.sleeping=!0;a.world||(a.component.waket=this.stamp+(this.midstep?0:1),a.type==f.id_BodyType_KINEMATIC&&(a.kinematicDelaySleep=!0),a.component.sleeping&&this.really_wake(a,!0))},added_shape:function(a,b){null==b&&(b=!1);if(!b){var c=a.body;c.world||(c.component.waket=this.stamp+(this.midstep?0:1),c.type==f.id_BodyType_KINEMATIC&&(c.kinematicDelaySleep=!0),c.component.sleeping&&this.really_wake(c,!1))}this.bphase.insert(a);a.addedToSpace()},removed_shape:function(a,b){null==b&&(b=!1);var c=
this,d=a.body;b||d.wake();for(var e=null,i=d.arbiters.head;null!=i;){var g=[i.elt];if(g[0].ws1==a||g[0].ws2==a){if(0!=g[0].present){this.MRCA_chains(g[0].ws1,g[0].ws2);for(i=this.mrca1.head;null!=i;){for(var h=i.elt,j=this.mrca2.head;null!=j;){var m=j.elt,n=h.cbSet,p=m.cbSet;n.validate();p.validate();n.manager.pair(n,p).empty_intersection()||(m=[ha.get(h,m)],m[0].remove_arb(g[0]),g[0].present--,n.manager.pair(n,p).forall(f.id_CbEvent_END,function(a,b){return function(d){if(0!=(d.itype&b[0].type)&&
a[0].empty_arb(d.itype)){var e=c.push_callback(d);e.event=f.id_CbEvent_END;ha.int_callback(a[0],d,e);e.set=a[0]}}}(m,g)),null==m[0].arbiters.head&&this.remove_callbackset(m[0]));j=j.next}i=i.next}}g[0].b1!=d&&g[0].b1.type==f.id_BodyType_DYNAMIC&&(i=g[0].b1,i.world||(i.component.waket=this.stamp+(this.midstep?0:1),i.type==f.id_BodyType_KINEMATIC&&(i.kinematicDelaySleep=!0),i.component.sleeping&&this.really_wake(i,!1)));g[0].b2!=d&&g[0].b2.type==f.id_BodyType_DYNAMIC&&(i=g[0].b2,i.world||(i.component.waket=
this.stamp+(this.midstep?0:1),i.type==f.id_BodyType_KINEMATIC&&(i.kinematicDelaySleep=!0),i.component.sleeping&&this.really_wake(i,!1)));g[0].cleared=!0;(null==d||g[0].b2==d)&&g[0].b1.arbiters.inlined_try_remove(g[0]);(null==d||g[0].b1==d)&&g[0].b2.arbiters.inlined_try_remove(g[0]);null!=g[0].pair&&(g[0].pair.arb=null,g[0].pair=null);g[0].active=!1;this.f_arbiters.modified=!0;i=d.arbiters.erase(e)}else e=i,i=i.next}this.bphase.remove(a);a.removedFromSpace()},addConstraint:function(a){a.space=this;
a.addedToSpace();a.active&&(a.component.sleeping=!0,this.wake_constraint(a,!0))},remConstraint:function(a){a.active&&(this.wake_constraint(a,!0),this.live_constraints.remove(a));a.removedFromSpace();a.space=null},addCompound:function(a){a.space=this;a.addedToSpace();for(var b=a.bodies.head;null!=b;)this.addBody(b.elt),b=b.next;for(b=a.constraints.head;null!=b;)this.addConstraint(b.elt),b=b.next;for(a=a.compounds.head;null!=a;)this.addCompound(a.elt),a=a.next},remCompound:function(a){for(var b=a.bodies.head;null!=
b;)this.remBody(b.elt),b=b.next;for(b=a.constraints.head;null!=b;)this.remConstraint(b.elt),b=b.next;for(b=a.compounds.head;null!=b;)this.remCompound(b.elt),b=b.next;a.removedFromSpace();a.space=null},addBody:function(a,b){null==b&&(b=-1);a.space=this;a.addedToSpace();a.component.sleeping=!0;a.world||(a.component.waket=this.stamp+(this.midstep?0:1),a.type==f.id_BodyType_KINEMATIC&&(a.kinematicDelaySleep=!0),a.component.sleeping&&this.really_wake(a,!0));for(var c=a.shapes.head;null!=c;)this.added_shape(c.elt,
!0),c=c.next;a.type==f.id_BodyType_STATIC?this.static_validation(a):a.type!=f.id_BodyType_DYNAMIC&&b!=f.id_BodyType_KINEMATIC&&this.kinematics.add(a)},remBody:function(a,b){null==b&&(b=-1);a.type==f.id_BodyType_STATIC?(a.world||(a.component.waket=this.stamp+(this.midstep?0:1),a.type==f.id_BodyType_KINEMATIC&&(a.kinematicDelaySleep=!0),a.component.sleeping&&this.really_wake(a,!0)),this.staticsleep.remove(a)):a.type==f.id_BodyType_DYNAMIC?(a.world||(a.component.waket=this.stamp+(this.midstep?0:1),a.type==
f.id_BodyType_KINEMATIC&&(a.kinematicDelaySleep=!0),a.component.sleeping&&this.really_wake(a,!0)),this.live.remove(a)):(b!=f.id_BodyType_KINEMATIC&&this.kinematics.remove(a),a.world||(a.component.waket=this.stamp+(this.midstep?0:1),a.type==f.id_BodyType_KINEMATIC&&(a.kinematicDelaySleep=!0),a.component.sleeping&&this.really_wake(a,!0)),this.staticsleep.remove(a));for(var c=a.shapes.head;null!=c;)this.removed_shape(c.elt,!0),c=c.next;a.removedFromSpace();a.space=null},bodiesUnderPoint:function(a,b,
c,d){return this.bphase.bodiesUnderPoint(a,b,c,d)},push_callback:function(a){var b;null==Pb.zpp_pool?b=new Pb:(b=Pb.zpp_pool,Pb.zpp_pool=b.next,b.next=null);null;this.callbacks.push(b);b.listener=a;return b},step:function(a,b,c){var d=this;this.time+=a;this.pre_dt=a;this.midstep=!0;this.stamp++;this.validation();this.bphase.broadphase(this,!0);this.prestep(a);if(this.sortcontacts){var e=this.c_arbiters_false;if(null!=e.head&&null!=e.head.next){var g=e.head,h=null,l=null,j=null,m=null,n=1,p,r,o;do{p=
0;l=g;for(h=g=null;null!=l;){p++;j=l;r=0;for(o=n;null!=j&&r<n;)r++,j=j.next;for(;0<r||0<o&&null!=j;)0==r?(m=j,j=j.next,o--):0==o||null==j?(m=l,l=l.next,r--):(l.elt.active&&j.elt.active?l.elt.oc1.dist<j.elt.oc1.dist:1)?(m=l,l=l.next,r--):(m=j,j=j.next,o--),null!=h?h.next=m:g=m,h=m;l=j}h.next=null;n<<=1}while(1<p);e.head=g;e.modified=!0;e.pushmod=!0}}this.updateVel(a);this.warmStart();this.iterateVel(b);for(b=this.kinematics.head;null!=b;)e=b.elt,e.pre_posx=e.posx,e.pre_posy=e.posy,e.pre_rot=e.rot,
b=b.next;for(b=this.live.head;null!=b;)e=b.elt,e.pre_posx=e.posx,e.pre_posy=e.posy,e.pre_rot=e.rot,b=b.next;this.updatePos(a);this.continuous=!0;this.continuousCollisions(a);this.continuous=!1;this.iteratePos(c);for(c=this.kinematics.head;null!=c;)b=c.elt,e=b.pre_rot!=b.rot,!(b.posx==b.pre_posx&&b.posy==b.pre_posy)&&b.invalidate_pos(),e&&b.invalidate_rot(),c=c.next;for(c=this.live.head;null!=c;)b=c.elt,e=b.pre_rot!=b.rot,!(b.posx==b.pre_posx&&b.posy==b.pre_posy)&&b.invalidate_pos(),e&&b.invalidate_rot(),
c=c.next;c=null;for(b=this.staticsleep.head;null!=b;)e=b.elt,e.type!=f.id_BodyType_KINEMATIC||0==e.velx&&0==e.vely&&0==e.angvel?e.kinematicDelaySleep?(e.kinematicDelaySleep=!1,b=b.next):(e.component.sleeping=!0,b=this.staticsleep.inlined_erase(c)):(c=b,b=b.next);this.doForests(a);this.sleepArbiters();this.midstep=!1;c=null;for(a=this.callbackset_list.next;null!=a;)b=[a],null==b[0].arbiters.head?(a=this.callbackset_list.inlined_erase(c),b=b[0],b.int1=b.int2=null,b.id=b.di=-1,b.freed=!0,null,b.next=
ib.zpp_pool,ib.zpp_pool=b):(c=[b[0].sleeping()],K.find_all(b[0].int1.cbSet,b[0].int2.cbSet,f.id_CbEvent_ONGOING,function(a,b){return function(c){if((!a[0]||c.allowSleepingCallbacks)&&!b[0].empty_arb(c.itype)){var e=d.push_callback(c);e.event=f.id_CbEvent_ONGOING;ha.int_callback(b[0],c,e);e.set=b[0]}}}(c,b)),c=a,a=a.next);for(;!this.callbacks.empty();)a=this.callbacks.pop(),a.listener.type==f.id_ListenerType_BODY?a.listener.body.handler(a.wrapper_body()):a.listener.type==f.id_ListenerType_CONSTRAINT?
a.listener.constraint.handler(a.wrapper_con()):a.listener.type==f.id_ListenerType_INTERACTION&&a.listener.interaction.handleri(a.wrapper_int()),a.int1=a.int2=null,a.body=null,a.constraint=null,a.listener=null,null!=a.wrap_arbiters&&(a.wrap_arbiters.zpp_inner.inner=null),a.set=null,a.next=Pb.zpp_pool,Pb.zpp_pool=a},continuousCollisions:function(a){var b=2*Math.PI/a;this.bphase.broadphase(this,!1);for(var c=0;1>c&&null!=this.toiEvents.head;){for(var d=null,c=2,e=!1,g=null,h=null,l=this.toiEvents.head;null!=
l;){var j=l.elt,o=j.s1.body,n=j.s2.body;if(o.sweepFrozen&&n.sweepFrozen)if(0!=j.toi&&t.testCollide_safe(j.s1,j.s2))j.toi=0;else{l=this.toiEvents.erase(h);j.next=la.zpp_pool;la.zpp_pool=j;continue}if(j.frozen1!=o.sweepFrozen||j.frozen2!=n.sweepFrozen)if(j.kinematic){l=this.toiEvents.erase(h);j.next=la.zpp_pool;la.zpp_pool=j;continue}else if(j.frozen1=o.sweepFrozen,j.frozen2=n.sweepFrozen,j.frozen1&&(o=j.s1,j.s1=j.s2,j.s2=o,j.frozen1=!1,j.frozen2=!0),ic.staticSweep(j,a,0,m.collisionSlopCCD),0>j.toi){l=
this.toiEvents.erase(h);j.next=la.zpp_pool;la.zpp_pool=j;continue}if(0<=j.toi&&(j.toi<c||!e&&j.kinematic))d=j,c=j.toi,e=j.kinematic,g=h;h=l;l=l.next}if(null==d)break;this.toiEvents.erase(g);c=d.toi;e=d.s1.body;g=d.s2.body;e.sweepFrozen||(e.sweepIntegrate(c*a),e.sweepValidate(d.s1));g.sweepFrozen||(g.sweepIntegrate(c*a),g.sweepValidate(d.s2));h=this.narrowPhase(d.s1,d.s2,!0,d.arbiter,!0);null==h?null!=d.arbiter&&null!=d.arbiter.pair&&(d.arbiter.pair.arb=null,d.arbiter.pair=null):!this.presteparb(h,
a,!0)&&h.type==H.COL&&h.active&&0!=(h.immState&f.id_ImmState_ACCEPT)&&(h.colarb.warmStart(),h.colarb.applyImpulseVel(),h.colarb.applyImpulseVel(),h.colarb.applyImpulseVel(),h.colarb.applyImpulseVel(),e.sweep_angvel=e.angvel%b,g.sweep_angvel=g.angvel%b);null!=h&&h.active&&0!=(h.immState&f.id_ImmState_ACCEPT)&&h.type==H.COL&&(!e.sweepFrozen&&e.type!=f.id_BodyType_KINEMATIC&&(e.sweepFrozen=!0,e.angvel=d.failed?e.sweep_angvel=0:d.slipped?e.sweep_angvel*=m.angularCCDSlipScale:e.sweep_angvel),!g.sweepFrozen&&
g.type!=f.id_BodyType_KINEMATIC&&(g.sweepFrozen=!0,g.angvel=d.failed?g.sweep_angvel=0:d.slipped?g.sweep_angvel*=m.angularCCDSlipScale:g.sweep_angvel))}for(;null!=this.toiEvents.head;)b=this.toiEvents.pop_unsafe(),b.next=la.zpp_pool,la.zpp_pool=b;for(b=this.kinematics.head;null!=b;)d=b.elt,d.sweepIntegrate(a),d.sweepTime=0,b=b.next;for(b=this.live.head;null!=b;)d=b.elt,d.sweepFrozen||d.sweepIntegrate(a),d.sweepTime=0,b=b.next},continuousEvent:function(a,b,c,d){if(a.body.sweepFrozen&&b.body.sweepFrozen||
a.body.disableCCD||b.body.disableCCD||null!=d&&null==d.colarb||0>=this.interactionType(a,b,a.body,b.body))return d;var e=a.body,g=b.body;if(c||e.bullet||g.bullet){var h;null==la.zpp_pool?h=new la:(h=la.zpp_pool,la.zpp_pool=h.next,h.next=null);h.failed=!1;h.s1=h.s2=null;h.arbiter=null;e=e.type==f.id_BodyType_KINEMATIC||g.type==f.id_BodyType_KINEMATIC;c&&!e?(a.body.type!=f.id_BodyType_DYNAMIC?(h.s2=a,h.s1=b):(h.s1=a,h.s2=b),h.kinematic=!1,ic.staticSweep(h,this.pre_dt,0,m.collisionSlopCCD)):(h.s1=a,
h.s2=b,h.kinematic=e,h.s1.body.sweepFrozen||h.s2.body.sweepFrozen?(h.s1.body.sweepFrozen&&(a=h.s1,h.s1=h.s2,h.s2=a,h.frozen1=!1,h.frozen2=!0),ic.staticSweep(h,this.pre_dt,0,m.collisionSlopCCD)):ic.dynamicSweep(h,this.pre_dt,0,m.collisionSlopCCD));c&&0>h.toi||h.failed?(c=h,c.next=la.zpp_pool,la.zpp_pool=c):(this.toiEvents.add(h),h.frozen1=h.s1.body.sweepFrozen,h.frozen2=h.s2.body.sweepFrozen,h.arbiter=null!=d?d.colarb:null)}return d},bodyCbWake:function(a){if(a.type==f.id_BodyType_DYNAMIC&&null!=a.cbSet)if(this.midstep)for(var b=
a.cbSet.bodylisteners.head;null!=b;){var c=b.elt;c.event==f.id_CbEvent_WAKE&&(c=this.push_callback(c),c.event=f.id_CbEvent_WAKE,c.body=a);b=b.next}else a.component.woken=!0},bodyCbSleep:function(a){if(a.type==f.id_BodyType_DYNAMIC&&null!=a.cbSet)for(var b=a.cbSet.bodylisteners.head;null!=b;){var c=b.elt;c.event==f.id_CbEvent_SLEEP&&(c=this.push_callback(c),c.event=f.id_CbEvent_SLEEP,c.body=a);b=b.next}},constraintCbWake:function(a){if(null!=a.cbSet)if(this.midstep)for(var b=a.cbSet.conlisteners.head;null!=
b;){var c=b.elt;c.event==f.id_CbEvent_WAKE&&(c=this.push_callback(c),c.event=f.id_CbEvent_WAKE,c.constraint=a);b=b.next}else a.component.woken=!0},constraintCbSleep:function(a){if(null!=a.cbSet)for(var b=a.cbSet.conlisteners.head;null!=b;){var c=b.elt;c.event==f.id_CbEvent_SLEEP&&(c=this.push_callback(c),c.event=f.id_CbEvent_SLEEP,c.constraint=a);b=b.next}},constraintCbBreak:function(a){if(null!=a.cbSet)for(var b=a.cbSet.conlisteners.head;null!=b;){var c=b.elt;c.event==f.id_CbEvent_BREAK&&(c=this.push_callback(c),
c.event=f.id_CbEvent_BREAK,c.constraint=a);b=b.next}},nullListenerType:function(a,b){for(var c=new Ac,d=a.interactors.head;null!=d;)c.add(d.elt),d=d.next;if(a!=b)for(d=b.interactors.head;null!=d;)c.add(d.elt),d=d.next;for(;null!=c.head;)if(d=c.pop_unsafe(),null!=d.icompound){for(var d=d.icompound,e=d.bodies.head;null!=e;)c.add(e.elt),e=e.next;for(d=d.compounds.head;null!=d;)c.add(d.elt),d=d.next}else{e=null!=d.ibody?d.ibody:d.ishape.body;d=null!=d.ishape?d.ishape:null;for(e=e.arbiters.head;null!=
e;){var f=e.elt;if(0!=f.present&&(null==d||f.ws1==d||f.ws2==d)){this.MRCA_chains(f.ws1,f.ws2);for(f=this.mrca1.head;null!=f;){var g=f.elt;if(!(g.cbSet!=a&&g.cbSet!=b))for(var h=this.mrca2.head;null!=h;){var j=h.elt;if(!(g.cbSet==a&&j.cbSet!=b||g.cbSet==b&&j.cbSet!=a))if(j=ha.get(g,j),null!=j){for(;null!=j.arbiters.head;)j.arbiters.pop_unsafe().present--;this.remove_callbackset(j)}h=h.next}f=f.next}}e=e.next}}},nullInteractorType:function(a,b){null==b&&(b=a);if(null!=a.icompound){for(var c=a.icompound,
d=c.bodies.head;null!=d;)this.nullInteractorType(d.elt,b),d=d.next;for(c=c.compounds.head;null!=c;)this.nullInteractorType(c.elt,b),c=c.next}else{d=null!=a.ibody?a.ibody:a.ishape.body;c=null!=a.ishape?a.ishape:null;for(d=d.arbiters.head;null!=d;){var e=d.elt;if(0!=e.present&&(null==c||e.ws1==c||e.ws2==c)){this.MRCA_chains(e.ws1,e.ws2);for(var f=this.mrca1.head;null!=f;){for(var g=f.elt,h=this.mrca2.head;null!=h;){var j=h.elt;g!=b&&j!=b||(j=ha.get(g,j),null!=j&&(e.present--,j.remove_arb(e),null==j.arbiters.head&&
this.remove_callbackset(j)));h=h.next}f=f.next}}d=d.next}}},freshListenerType:function(a,b){for(var c=new Ac,d=a.interactors.head;null!=d;)c.add(d.elt),d=d.next;if(a!=b)for(d=b.interactors.head;null!=d;)c.add(d.elt),d=d.next;for(;null!=c.head;)if(d=c.pop_unsafe(),null!=d.icompound){for(var d=d.icompound,e=d.bodies.head;null!=e;)c.add(e.elt),e=e.next;for(d=d.compounds.head;null!=d;)c.add(d.elt),d=d.next}else{e=null!=d.ibody?d.ibody:d.ishape.body;d=null!=d.ishape?d.ishape:null;for(e=e.arbiters.head;null!=
e;){var f=e.elt;if(f.presentable&&(null==d||f.ws1==d||f.ws2==d)){this.MRCA_chains(f.ws1,f.ws2);for(var g=this.mrca1.head;null!=g;){var h=g.elt;if(!(h.cbSet!=a&&h.cbSet!=b))for(var j=this.mrca2.head;null!=j;){var m=j.elt;if(!(h.cbSet==a&&m.cbSet!=b||h.cbSet==b&&m.cbSet!=a)){var n=ha.get(h,m);null==n&&(n=ib.get(h,m),this.add_callbackset(n));if(m=!n.arbiters.inlined_has(f))n.arbiters.inlined_add(f),m=!0;m&&f.present++}j=j.next}g=g.next}}e=e.next}}},freshInteractorType:function(a,b){null==b&&(b=a);if(null!=
a.icompound){for(var c=a.icompound,d=c.bodies.head;null!=d;)this.freshInteractorType(d.elt,b),d=d.next;for(c=c.compounds.head;null!=c;)this.freshInteractorType(c.elt,b),c=c.next}else{d=null!=a.ibody?a.ibody:a.ishape.body;c=null!=a.ishape?a.ishape:null;for(d=d.arbiters.head;null!=d;){var e=d.elt;if(e.presentable&&(null==c||e.ws1==c||e.ws2==c)){this.MRCA_chains(e.ws1,e.ws2);for(var f=this.mrca1.head;null!=f;){for(var g=f.elt,h=this.mrca2.head;null!=h;){var j=h.elt;if(!(g!=b&&j!=b)){var m=g.cbSet,n=
j.cbSet;m.validate();n.validate();if(!m.manager.pair(m,n).empty_intersection()){m=ha.get(g,j);null==m&&(m=ib.get(g,j),this.add_callbackset(m));if(j=!m.arbiters.inlined_has(e))m.arbiters.inlined_add(e),j=!0;j&&e.present++}}h=h.next}f=f.next}}d=d.next}}},wakeCompound:function(a){for(var b=a.bodies.head;null!=b;){var c=b.elt;c.world||(c.component.waket=this.stamp+(this.midstep?0:1),c.type==f.id_BodyType_KINEMATIC&&(c.kinematicDelaySleep=!0),c.component.sleeping&&this.really_wake(c,!1));b=b.next}for(b=
a.constraints.head;null!=b;)this.wake_constraint(b.elt),b=b.next;for(a=a.compounds.head;null!=a;)this.wakeCompound(a.elt),a=a.next},wakeIsland:function(a){for(;null!=a.comps.head;){var b=a.comps.pop_unsafe();b.waket=this.stamp+(this.midstep?0:1);if(b.isBody){var c=b.body;this.live.add(c);for(var d=c.arbiters.head;null!=d;){var e=d.elt;e.sleeping&&(e.sleeping=!1,e.up_stamp+=this.stamp-e.sleep_stamp,e.type==H.COL?(e=e.colarb,e.stat?this.c_arbiters_true.inlined_add(e):this.c_arbiters_false.inlined_add(e)):
e.type==H.FLUID?this.f_arbiters.inlined_add(e.fluidarb):this.s_arbiters.inlined_add(e.sensorarb));d=d.next}this.bodyCbWake(c);b.sleeping=!1;b.island=null;b.parent=b;b.rank=0;if(c.type!=f.id_BodyType_STATIC)for(b=c.shapes.head;null!=b;)c=b.elt,null!=c.node&&this.bphase.sync(c),b=b.next}else c=b.constraint,this.live_constraints.inlined_add(c),this.constraintCbWake(c),b.sleeping=!1,b.island=null,b.parent=b,b.rank=0}a.next=pa.zpp_pool;pa.zpp_pool=a},non_inlined_wake:function(a,b){null==b&&(b=!1);a.world||
(a.component.waket=this.stamp+(this.midstep?0:1),a.type==f.id_BodyType_KINEMATIC&&(a.kinematicDelaySleep=!0),a.component.sleeping&&this.really_wake(a,b))},really_wake:function(a,b){null==b&&(b=!1);if(null==a.component.island){a.component.sleeping=!1;a.type==f.id_BodyType_KINEMATIC||a.type==f.id_BodyType_STATIC?this.staticsleep.inlined_add(a):this.live.inlined_add(a);for(var c=a.constraints.head;null!=c;){var d=c.elt;d.space==this&&this.wake_constraint(d);c=c.next}for(c=a.arbiters.head;null!=c;){d=
c.elt;if(d.sleeping)if(d.sleeping=!1,d.up_stamp+=this.stamp+(this.midstep?0:1)-d.sleep_stamp,d.type==H.COL){var e=d.colarb;e.stat?this.c_arbiters_true.inlined_add(e):this.c_arbiters_false.inlined_add(e)}else d.type==H.FLUID?this.f_arbiters.inlined_add(d.fluidarb):this.s_arbiters.inlined_add(d.sensorarb);d.type!=H.SENSOR&&!d.cleared&&d.up_stamp>=this.stamp&&0!=(d.immState&f.id_ImmState_ACCEPT)&&(d.b1.type==f.id_BodyType_DYNAMIC&&d.b1.component.sleeping&&(e=d.b1,e.world||(e.component.waket=this.stamp+
(this.midstep?0:1),e.type==f.id_BodyType_KINEMATIC&&(e.kinematicDelaySleep=!0),e.component.sleeping&&this.really_wake(e,!1))),d.b2.type==f.id_BodyType_DYNAMIC&&d.b2.component.sleeping&&(d=d.b2,d.world||(d.component.waket=this.stamp+(this.midstep?0:1),d.type==f.id_BodyType_KINEMATIC&&(d.kinematicDelaySleep=!0),d.component.sleeping&&this.really_wake(d,!1))));c=c.next}!b&&a.type==f.id_BodyType_DYNAMIC&&this.bodyCbWake(a);if(!b&&!this.bphase.is_sweep&&a.type!=f.id_BodyType_STATIC)for(c=a.shapes.head;null!=
c;)d=c.elt,null!=d.node&&this.bphase.sync(d),c=c.next}else this.wakeIsland(a.component.island)},wake_constraint:function(a,b){null==b&&(b=!1);return a.active&&(a.component.waket=this.stamp+(this.midstep?0:1),a.component.sleeping)?(null==a.component.island?(a.component.sleeping=!1,this.live_constraints.inlined_add(a),a.wake_connected(),b||this.constraintCbWake(a)):this.wakeIsland(a.component.island),!0):!1},doForests:function(a){for(var b=this.c_arbiters_false.head;null!=b;){var c=b.elt;if(!c.cleared&&
c.up_stamp==this.stamp&&0!=(c.immState&f.id_ImmState_ACCEPT)&&c.b1.type==f.id_BodyType_DYNAMIC&&c.b2.type==f.id_BodyType_DYNAMIC){var d;if(c.b1.component==c.b1.component.parent)d=c.b1.component;else{d=c.b1.component;for(var e=null;d!=d.parent;){var g=d.parent;d.parent=e;e=d;d=g}for(;null!=e;)g=e.parent,e.parent=d,e=g}if(c.b2.component==c.b2.component.parent)c=c.b2.component;else{c=c.b2.component;for(e=null;c!=c.parent;)g=c.parent,c.parent=e,e=c,c=g;for(;null!=e;)g=e.parent,e.parent=c,e=g}d!=c&&(d.rank<
c.rank?d.parent=c:d.rank>c.rank?c.parent=d:(c.parent=d,d.rank++))}b=b.next}for(b=this.f_arbiters.head;null!=b;){c=b.elt;if(!c.cleared&&c.up_stamp==this.stamp&&0!=(c.immState&f.id_ImmState_ACCEPT)&&c.b1.type==f.id_BodyType_DYNAMIC&&c.b2.type==f.id_BodyType_DYNAMIC){if(c.b1.component==c.b1.component.parent)d=c.b1.component;else{d=c.b1.component;for(e=null;d!=d.parent;)g=d.parent,d.parent=e,e=d,d=g;for(;null!=e;)g=e.parent,e.parent=d,e=g}if(c.b2.component==c.b2.component.parent)c=c.b2.component;else{c=
c.b2.component;for(e=null;c!=c.parent;)g=c.parent,c.parent=e,e=c,c=g;for(;null!=e;)g=e.parent,e.parent=c,e=g}d!=c&&(d.rank<c.rank?d.parent=c:d.rank>c.rank?c.parent=d:(c.parent=d,d.rank++))}b=b.next}for(b=this.live_constraints.head;null!=b;)b.elt.forest(),b=b.next;for(;null!=this.live.head;){d=this.live.inlined_pop_unsafe();b=d.component;if(b==b.parent)c=b;else{c=b;for(e=null;c!=c.parent;)g=c.parent,c.parent=e,e=c,c=g;for(;null!=e;)g=e.parent,e.parent=c,e=g}null==c.island&&(null==pa.zpp_pool?c.island=
new pa:(c.island=pa.zpp_pool,pa.zpp_pool=c.island.next,c.island.next=null),c.island.waket=0,this.islands.inlined_add(c.island),c.island.sleep=!0);b.island=c.island;b.island.comps.inlined_add(b);d=d.atRest(a);b.island.sleep=b.island.sleep&&d;b.waket>b.island.waket&&(b.island.waket=b.waket)}for(;null!=this.live_constraints.head;){a=this.live_constraints.inlined_pop_unsafe().component;if(a==a.parent)b=a;else{b=a;for(d=null;b!=b.parent;)c=b.parent,b.parent=d,d=b,b=c;for(;null!=d;)c=d.parent,d.parent=
b,d=c}a.island=b.island;a.island.comps.inlined_add(a);a.waket>a.island.waket&&(a.island.waket=a.waket)}for(;null!=this.islands.next;)if(a=this.islands.inlined_pop_unsafe(),a.sleep)for(a=a.comps.head;null!=a;){d=a.elt;if(d.isBody){b=d.body;b.velx=0;b.vely=0;b.angvel=0;d.sleeping=!0;for(d=b.shapes.head;null!=d;)this.bphase.sync(d.elt),d=d.next;this.bodyCbSleep(b)}else this.constraintCbSleep(d.constraint),d.sleeping=!0;a=a.next}else{for(;null!=a.comps.head;)b=a.comps.inlined_pop_unsafe(),b.waket=a.waket,
b.isBody?this.live.inlined_add(b.body):this.live_constraints.inlined_add(b.constraint),b.sleeping=!1,b.island=null,b.parent=b,b.rank=0;a.next=pa.zpp_pool;pa.zpp_pool=a}},sleepArbiters:function(){var a=null,b=this.c_arbiters_true,c=b.head,d=null!=this.c_arbiters_false;d&&null==c&&(d=!1,c=this.c_arbiters_false.head,b=this.c_arbiters_false,a=null);for(;null!=c;){var e=c.elt;e.b1.component.sleeping&&e.b2.component.sleeping?(e.sleep_stamp=this.stamp,e.sleeping=!0,c=b.inlined_erase(a)):(a=c,c=c.next);d&&
null==c&&(d=!1,c=this.c_arbiters_false.head,b=this.c_arbiters_false,a=null)}a=null;b=this.f_arbiters;c=b.head;d=!1;for(;null!=c;)e=c.elt,e.b1.component.sleeping&&e.b2.component.sleeping?(e.sleep_stamp=this.stamp,e.sleeping=!0,c=b.inlined_erase(a)):(a=c,c=c.next),d&&null==c&&(d=!1,c=null.begin(),a=b=null);a=null;b=this.s_arbiters;c=b.head;d=!1;for(;null!=c;)e=c.elt,e.b1.component.sleeping&&e.b2.component.sleeping?(e.sleep_stamp=this.stamp,e.sleeping=!0,c=b.inlined_erase(a)):(a=c,c=c.next),d&&null==
c&&(d=!1,c=null.begin(),a=b=null)},static_validation:function(a){null!=a.shapes.head&&a.validate_aabb();a.validate_mass();a.validate_inertia();for(var b=a.shapes.head;null!=b;){var c=b.elt;c.type==f.id_ShapeType_POLYGON&&(c.polygon.splice_collinear(),c.polygon.validate_gaxi());b=b.next}a.sweepFrozen=!0},validation:function(){this.cbsets.validate();for(var a=this.live.head;null!=a;){var b=a.elt;b.sweepRadius=0;for(var c=b.shapes.head;null!=c;){var d=c.elt;d.type==f.id_ShapeType_POLYGON&&(d.polygon.splice_collinear(),
d.polygon.validate_gaxi());d.validate_sweepRadius();d.sweepRadius>b.sweepRadius&&(b.sweepRadius=d.sweepRadius);c=c.next}b.validate_mass();b.validate_inertia();null!=b.shapes.head&&(b.validate_aabb(),b.validate_worldCOM());b.validate_gravMass();b.zip_axis&&(b.zip_axis=!1,b.axisx=Math.sin(b.rot),b.axisy=Math.cos(b.rot),null);if(b.component.woken&&null!=b.cbSet)for(c=b.cbSet.bodylisteners.head;null!=c;)d=c.elt,d.event==f.id_CbEvent_WAKE&&(d=this.push_callback(d),d.event=f.id_CbEvent_WAKE,d.body=b),c=
c.next;b.component.woken=!1;for(b=b.shapes.head;null!=b;)this.bphase.sync(b.elt),b=b.next;a=a.next}for(a=this.kinematics.head;null!=a;){b=a.elt;b.sweepRadius=0;for(c=b.shapes.head;null!=c;)d=c.elt,d.type==f.id_ShapeType_POLYGON&&(d.polygon.splice_collinear(),d.polygon.validate_gaxi()),d.validate_sweepRadius(),d.sweepRadius>b.sweepRadius&&(b.sweepRadius=d.sweepRadius),c=c.next;b.validate_mass();b.validate_inertia();null!=b.shapes.head&&(b.validate_aabb(),b.validate_worldCOM());b.validate_gravMass();
b.zip_axis&&(b.zip_axis=!1,b.axisx=Math.sin(b.rot),b.axisy=Math.cos(b.rot),null);for(b=b.shapes.head;null!=b;)this.bphase.sync(b.elt),b=b.next;a=a.next}for(a=this.live_constraints.head;null!=a;){b=a.elt;if(b.active){if(b.component.woken&&null!=b.cbSet)for(c=b.cbSet.conlisteners.head;null!=c;)d=c.elt,d.event==f.id_CbEvent_WAKE&&(d=this.push_callback(d),d.event=f.id_CbEvent_WAKE,d.constraint=b),c=c.next;b.component.woken=!1}a=a.next}},updateVel:function(a){for(var b=1-a*this.global_lin_drag,c=1-a*this.global_ang_drag,
d=this.live.head;null!=d;){var e=d.elt;if(0!=e.smass){var f=a*e.imass;e.velx=b*e.velx+(e.forcex+this.gravityx*e.gravMass)*f;e.vely=b*e.vely+(e.forcey+this.gravityy*e.gravMass)*f}if(0!=e.sinertia){var g=f=0,f=e.worldCOMx-e.posx,g=e.worldCOMy-e.posy;e.angvel=c*e.angvel+(e.torque+(this.gravityy*f-this.gravityx*g)*e.gravMass)*a*e.iinertia}d=d.next}},updatePos:function(a){for(var b=2*Math.PI/a,c=this.live.head;null!=c;){var d=c.elt;d.pre_posx=d.posx;d.pre_posy=d.posy;d.pre_rot=d.rot;d.sweepTime=0;d.sweep_angvel=
d.angvel%b;d.sweepIntegrate(a);if(d.disableCCD)d.sweepFrozen=!0,d.bullet=!1;else{var e=m.staticCCDLinearThreshold*d.sweepRadius,g=m.staticCCDAngularThreshold;if((d.velx*d.velx+d.vely*d.vely)*a*a>e*e||d.angvel*d.angvel*a*a>g*g||d.type==f.id_BodyType_KINEMATIC){e=d.sweep_angvel;0>e&&(e=-e);for(var g=1/e,h=d.shapes.head;null!=h;){var l=h.elt,j=l.aabb,o=j.minx,n=j.miny,p=j.maxx,r=j.maxy,q=0.008333333333333333*e*a*l.sweepCoef|0;8<q&&(q=8);var t=e*a/q;d.sweepIntegrate(a);l.type==f.id_ShapeType_CIRCLE?l.circle._force_validate_aabb():
l.polygon._force_validate_aabb();o<j.minx?j.minx=o:o=j.minx;n<j.miny?j.miny=n:n=j.miny;p>j.maxx?j.maxx=p:p=j.maxx;r>j.maxy?j.maxy=r:r=j.maxy;for(var v=1;v<q;){var w=v++;d.sweepIntegrate(t*w*g);l.type==f.id_ShapeType_CIRCLE?l.circle._force_validate_aabb():l.polygon._force_validate_aabb();o<j.minx?j.minx=o:o=j.minx;n<j.miny?j.miny=n:n=j.miny;p>j.maxx?j.maxx=p:p=j.maxx;r>j.maxy?j.maxy=r:r=j.maxy}this.bphase.sync(l);h=h.next}d.sweepFrozen=!1;if(d.type==f.id_BodyType_DYNAMIC&&d.bulletEnabled&&(e=m.bulletCCDLinearThreshold*
d.sweepRadius,g=m.bulletCCDAngularThreshold,(d.velx*d.velx+d.vely*d.vely)*a*a>e*e||d.angvel*d.angvel*a*a>g*g))d.bullet=!0}else d.sweepFrozen=!0,d.bullet=!1}c=c.next}for(c=this.kinematics.head;null!=c;){d=c.elt;d.pre_posx=d.posx;d.pre_posy=d.posy;d.pre_rot=d.rot;d.sweepTime=0;d.sweep_angvel=d.angvel%b;d.sweepIntegrate(a);if(d.disableCCD)d.sweepFrozen=!0,d.bullet=!1;else if(e=m.staticCCDLinearThreshold*d.sweepRadius,g=m.staticCCDAngularThreshold,(d.velx*d.velx+d.vely*d.vely)*a*a>e*e||d.angvel*d.angvel*
a*a>g*g||d.type==f.id_BodyType_KINEMATIC){e=d.sweep_angvel;0>e&&(e=-e);g=1/e;for(h=d.shapes.head;null!=h;){l=h.elt;j=l.aabb;o=j.minx;n=j.miny;p=j.maxx;r=j.maxy;q=0.008333333333333333*e*a*l.sweepCoef|0;8<q&&(q=8);t=e*a/q;d.sweepIntegrate(a);l.type==f.id_ShapeType_CIRCLE?l.circle._force_validate_aabb():l.polygon._force_validate_aabb();o<j.minx?j.minx=o:o=j.minx;n<j.miny?j.miny=n:n=j.miny;p>j.maxx?j.maxx=p:p=j.maxx;r>j.maxy?j.maxy=r:r=j.maxy;for(v=1;v<q;)w=v++,d.sweepIntegrate(t*w*g),l.type==f.id_ShapeType_CIRCLE?
l.circle._force_validate_aabb():l.polygon._force_validate_aabb(),o<j.minx?j.minx=o:o=j.minx,n<j.miny?j.miny=n:n=j.miny,p>j.maxx?j.maxx=p:p=j.maxx,r>j.maxy?j.maxy=r:r=j.maxy;this.bphase.sync(l);h=h.next}d.sweepFrozen=!1;if(d.type==f.id_BodyType_DYNAMIC&&d.bulletEnabled&&(e=m.bulletCCDLinearThreshold*d.sweepRadius,g=m.bulletCCDAngularThreshold,(d.velx*d.velx+d.vely*d.vely)*a*a>e*e||d.angvel*d.angvel*a*a>g*g))d.bullet=!0}else d.sweepFrozen=!0,d.bullet=!1;c=c.next}},presteparb:function(a,b,c){null==c&&
(c=!1);var d=this;if(!a.cleared&&a.b1.component.sleeping&&a.b2.component.sleeping)return a.sleep_stamp=this.stamp,a.sleeping=!0;if(!a.cleared||0!=a.present||a.intchange){var e=!c&&a.up_stamp==this.stamp-1&&!a.cleared&&!a.intchange,c=a.fresh&&!a.cleared&&!a.intchange;e&&(a.endGenerated=this.stamp);if(c||e||a.cleared||a.intchange){this.inlined_MRCA_chains(a.ws1,a.ws2);for(e=this.mrca1.head;null!=e;){for(var g=e.elt,h=this.mrca2.head;null!=h;){var l=h.elt,j=g.cbSet,o=l.cbSet;if(!j.manager.pair(j,o).empty_intersection()){var n=
[ha.get(g,l)];if(c||a.intchange){null==n[0]&&(n[0]=ib.get(g,l),this.add_callbackset(n[0]));j.manager.pair(j,o).forall(f.id_CbEvent_BEGIN,function(b){return function(c){if(0!=(c.itype&a.type)&&b[0].empty_arb(c.itype)){var e=d.push_callback(c);e.event=f.id_CbEvent_BEGIN;ha.int_callback(b[0],c,e);e.set=b[0]}}}(n));if(l=!n[0].arbiters.inlined_has(a))n[0].arbiters.inlined_add(a),l=!0;l&&a.present++}else a.present--,n[0].remove_arb(a),j.manager.pair(j,o).forall(f.id_CbEvent_END,function(b){return function(c){if(0!=
(c.itype&a.type)&&b[0].empty_arb(c.itype)){var e=d.push_callback(c);e.event=f.id_CbEvent_END;ha.int_callback(b[0],c,e);e.set=b[0]}}}(n)),null==n[0].arbiters.head&&this.remove_callbackset(n[0])}h=h.next}e=e.next}}a.fresh=!1;a.intchange=!1}if(a.cleared||a.up_stamp+(a.type==H.COL?m.arbiterExpirationDelay:0)<this.stamp)return a.type==H.SENSOR?a.sensorarb.retire():a.type==H.FLUID?a.fluidarb.retire():a.colarb.retire(),!0;c=a.active;a.active=a.presentable=a.up_stamp==this.stamp;0!=(a.immState&f.id_ImmState_ACCEPT)?
a.active&&a.type!=H.SENSOR&&(null!=a.colarb?a.colarb.preStep(b)&&(a.active=!1):a.fluidarb.preStep(this,b)):null!=a.colarb&&a.colarb.cleanupContacts()&&(a.active=!1);c!=a.active&&(a.b1.arbiters.modified=!0,a.b2.arbiters.modified=!0,this.c_arbiters_true.modified=this.c_arbiters_false.modified=!0,this.s_arbiters.modified=this.f_arbiters.modified=!0);return!1},prestep:function(a){for(var b=null,c=this.live_constraints.head;null!=c;){var d=c.elt;d.preStep(a)?(c=this.live_constraints.erase(b),d.broken(),
this.constraintCbBreak(d),d.removeOnBreak?(d.component.sleeping=!0,this.midstep=!1,null!=d.compound?d.compound.wrap_constraints.remove(d.outer):this.wrap_constraints.remove(d.outer),this.midstep=!0):d.active=!1,d.clearcache()):(b=c,c=c.next)}var b=null,c=this.c_arbiters_true,d=c.head,e=null!=this.c_arbiters_false;e&&null==d&&(e=!1,d=this.c_arbiters_false.head,c=this.c_arbiters_false,b=null);for(;null!=d;)this.presteparb(d.elt,a)?d=c.inlined_erase(b):(b=d,d=d.next),e&&null==d&&(e=!1,d=this.c_arbiters_false.head,
c=this.c_arbiters_false,b=null);b=null;c=this.f_arbiters;d=c.head;e=!1;for(;null!=d;)this.presteparb(d.elt,a)?d=c.inlined_erase(b):(b=d,d=d.next),e&&null==d&&(e=!1,d=null.begin(),b=c=null);b=null;c=this.s_arbiters;d=c.head;e=!1;for(;null!=d;)this.presteparb(d.elt,a)?d=c.inlined_erase(b):(b=d,d=d.next),e&&null==d&&(e=!1,d=null.begin(),b=c=null)},warmStart:function(){for(var a=this.f_arbiters.head;null!=a;){var b=a.elt;b.active&&0!=(b.immState&f.id_ImmState_ACCEPT)&&b.warmStart();a=a.next}a=this.c_arbiters_false.head;
b=!0;null==a&&(a=this.c_arbiters_true.head,b=!1);for(;null!=a;){var c=a.elt;c.active&&0!=(c.immState&f.id_ImmState_ACCEPT)&&c.warmStart();a=a.next;b&&null==a&&(a=this.c_arbiters_true.head,b=!1)}for(a=this.live_constraints.head;null!=a;)a.elt.warmStart(),a=a.next},iterateVel:function(a){for(var b=0;b<a;){b++;for(var c=this.f_arbiters.head;null!=c;){var d=c.elt;d.active&&0!=(d.immState&f.id_ImmState_ACCEPT)&&d.applyImpulseVel();c=c.next}c=null;for(d=this.live_constraints.head;null!=d;){var e=d.elt;
e.applyImpulseVel()?(d=this.live_constraints.erase(c),e.broken(),this.constraintCbBreak(e),e.removeOnBreak?(e.component.sleeping=!0,this.midstep=!1,null!=e.compound?e.compound.wrap_constraints.remove(e.outer):this.wrap_constraints.remove(e.outer),this.midstep=!0):e.active=!1,e.clearcache()):(c=d,d=d.next)}c=this.c_arbiters_false.head;d=!0;null==c&&(c=this.c_arbiters_true.head,d=!1);for(;null!=c;)e=c.elt,e.active&&0!=(e.immState&f.id_ImmState_ACCEPT)&&e.applyImpulseVel(),c=c.next,d&&null==c&&(c=this.c_arbiters_true.head,
d=!1)}},iteratePos:function(a){for(var b=0;b<a;){b++;for(var c=null,d=this.live_constraints.head;null!=d;){var e=d.elt;!e.__velocity&&e.stiff&&e.applyImpulsePos()?(d=this.live_constraints.erase(c),e.broken(),this.constraintCbBreak(e),e.removeOnBreak?(e.component.sleeping=!0,this.midstep=!1,null!=e.compound?e.compound.wrap_constraints.remove(e.outer):this.wrap_constraints.remove(e.outer),this.midstep=!0):e.active=!1,e.clearcache()):(c=d,d=d.next)}c=this.c_arbiters_false.head;d=!0;null==c&&(c=this.c_arbiters_true.head,
d=!1);for(;null!=c;)e=c.elt,e.active&&0!=(e.immState&f.id_ImmState_ACCEPT)&&e.applyImpulsePos(),c=c.next,d&&null==c&&(c=this.c_arbiters_true.head,d=!1)}},group_ignore:function(a,b){var c=a.lookup_group();if(null==c)return!1;var d=b.lookup_group();if(null==d)return!1;for(var e=!1;null!=c&&null!=d;){if(c==d){e=c.ignore;break}c.depth<d.depth?d=d.group:c=c.group}return e},interactionType:function(a,b,c,d){var e;e=!1;for(var f=c.constraints.head;null!=f;){var g=f.elt;if(g.ignore&&g.pair_exists(c.id,d.id)){e=
!0;break}f=f.next}return!e&&!this.group_ignore(a,b)?(a.sensorEnabled||b.sensorEnabled)&&a.filter.shouldSense(b.filter)?2:(a.fluidEnabled||b.fluidEnabled)&&a.filter.shouldFlow(b.filter)&&!(0==c.imass&&0==d.imass&&0==c.iinertia&&0==d.iinertia)?0:a.filter.shouldCollide(b.filter)&&!(0==c.imass&&0==d.imass&&0==c.iinertia&&0==d.iinertia)?1:-1:-1},narrowPhase:function(a,b,c,d,e){var g=this,h=null,l=a.body,j=b.body,m=this.interactionType(a,b,l,j);if(-1!=m){var n,o;a.type>b.type?(n=b,o=a):a.type==b.type?a.id<
b.id?(n=a,o=b):(o=a,n=b):(n=a,o=b);var r=n==b;if(0==m){var q;if(null==d){for(var v=null,w=(l.arbiters.length<j.arbiters.length?l:j).arbiters.head;null!=w;){var x=w.elt;if(x.id==n.id&&x.di==o.id){v=x;break}w=w.next}q=v}else q=d;var y=null==q,u,A=!1;y?(null==hb.zpp_pool?u=new hb:(u=hb.zpp_pool,hb.zpp_pool=u.next,u.next=null),null):null==q.fluidarb?(q.cleared=!0,q.b1.arbiters.inlined_try_remove(q),q.b2.arbiters.inlined_try_remove(q),null!=q.pair&&(q.pair.arb=null,q.pair=null),q.active=!1,this.f_arbiters.modified=
!0,null==hb.zpp_pool?u=new hb:(u=hb.zpp_pool,hb.zpp_pool=u.next,u.next=null),null,A=y=u.intchange=!0):u=q.fluidarb;var C=f.id_InteractionType_FLUID;if(y||u.stamp!=this.stamp||e)if(u.stamp=this.stamp,t.flowCollide(n,o,u)){y?(u.b1=a.body,u.ws1=a,u.b2=b.body,u.ws2=b,u.id=n.id,u.di=o.id,u.b1.arbiters.inlined_add(u),u.b2.arbiters.inlined_add(u),u.active=!0,u.present=0,u.cleared=!1,u.sleeping=!1,u.fresh=!1,u.presentable=!1,u.nx=0,u.ny=1,u.dampx=0,u.dampy=0,u.adamp=0,this.f_arbiters.inlined_add(u),u.fresh=
!A):u.fresh=u.up_stamp<this.stamp-1||u.endGenerated==this.stamp&&e;u.up_stamp=u.stamp;if(u.fresh||0==(u.immState&f.id_ImmState_ALWAYS)){u.immState=f.id_ImmState_ACCEPT;var B=!1;this.inlined_MRCA_chains(u.ws1.id>u.ws2.id?u.ws2:u.ws1,u.ws1.id>u.ws2.id?u.ws1:u.ws2);for(var D=this.mrca1.head;null!=D;){for(var E=D.elt,F=this.mrca2.head;null!=F;){var G=F.elt,I=E.cbSet,J=G.cbSet;if(!I.manager.pair(I,J).empty_intersection()){var H=null,K=null;this.prelisteners.inlined_clear();I.manager.pair(I,J).forall(f.id_CbEvent_PRE,
function(a){return function(b){0!=(b.itype&C)&&(a[0]=g.prelisteners.inlined_insert(a[0],b),B=B||!b.pure)}}([null]));if(null!=this.prelisteners.head)if(H=ha.get(E,G),null==H&&(K=ib.get(E,G),this.add_callbackset(K)),null==H||(H.FLUIDstamp!=this.stamp||e)&&0==(H.FLUIDstate&f.id_ImmState_ALWAYS)){null!=K&&(H=K);if(null!=H)for(var M=this.prelisteners.head;null!=M;)M.elt.itype==f.id_InteractionType_ANY&&(H.COLLISIONstamp=this.stamp,H.SENSORstamp=this.stamp),H.FLUIDstamp=this.stamp,M=M.next;var P=u.active;
u.active=!0;this.precb.zpp_inner.pre_arbiter=u;this.precb.zpp_inner.set=H;for(var N=this.prelisteners.head;null!=N;){var T=N.elt;this.precb.zpp_inner.listener=T;ha.int_callback(H,T,this.precb.zpp_inner);this.precb.zpp_inner.pre_swapped=E!=this.precb.zpp_inner.int1;var S=T.handlerp(this.precb);if(null!=S){var aa=u,ba=S,V;null==f.PreFlag_ACCEPT&&(f.internal=!0,f.PreFlag_ACCEPT=new xa,f.internal=!1);if(ba==f.PreFlag_ACCEPT)V=f.id_ImmState_ACCEPT|f.id_ImmState_ALWAYS;else{var da=S,Z;null==f.PreFlag_ACCEPT_ONCE&&
(f.internal=!0,f.PreFlag_ACCEPT_ONCE=new xa,f.internal=!1);if(da==f.PreFlag_ACCEPT_ONCE)Z=f.id_ImmState_ACCEPT;else{var fa=S;null==f.PreFlag_IGNORE&&(f.internal=!0,f.PreFlag_IGNORE=new xa,f.internal=!1);Z=fa==f.PreFlag_IGNORE?f.id_ImmState_IGNORE|f.id_ImmState_ALWAYS:f.id_ImmState_IGNORE}V=Z}aa.immState=V}N=N.next}u.active=P;if(null!=H)for(var Y=this.prelisteners.head;null!=Y;)Y.elt.itype==f.id_InteractionType_ANY&&(H.COLLISIONstate=u.immState,H.SENSORstate=u.immState),H.FLUIDstate=u.immState,Y=Y.next}else null==
H?0==(u.immState&f.id_ImmState_ALWAYS)&&(u.immState=f.id_ImmState_ACCEPT):u.immState=H.FLUIDstate}F=F.next}D=D.next}if(B&&0==(u.immState&f.id_ImmState_ALWAYS)){if(u.b1.type==f.id_BodyType_DYNAMIC){var U=u.b1;U.world||(U.component.waket=this.stamp+(this.midstep?0:1),U.type==f.id_BodyType_KINEMATIC&&(U.kinematicDelaySleep=!0),U.component.sleeping&&this.really_wake(U,!1))}if(u.b1.type==f.id_BodyType_DYNAMIC){var W=u.b2;W.world||(W.component.waket=this.stamp+(this.midstep?0:1),W.type==f.id_BodyType_KINEMATIC&&
(W.kinematicDelaySleep=!0),W.component.sleeping&&this.really_wake(W,!1))}}}if(0!=(u.immState&f.id_ImmState_ACCEPT)){if(u.b1.type==f.id_BodyType_DYNAMIC&&u.b1.component.sleeping){var $=u.b1;$.world||($.component.waket=this.stamp+(this.midstep?0:1),$.type==f.id_BodyType_KINEMATIC&&($.kinematicDelaySleep=!0),$.component.sleeping&&this.really_wake($,!1))}if(u.b2.type==f.id_BodyType_DYNAMIC&&u.b2.component.sleeping){var ca=u.b2;ca.world||(ca.component.waket=this.stamp+(this.midstep?0:1),ca.type==f.id_BodyType_KINEMATIC&&
(ca.kinematicDelaySleep=!0),ca.component.sleeping&&this.really_wake(ca,!1))}}u.sleeping&&(u.sleeping=!1,this.f_arbiters.inlined_add(u));h=u}else if(y){var ka=u;ka.next=hb.zpp_pool;hb.zpp_pool=ka;h=null}else h=u;else h=u}else if(1==m){var ga;ga=c?this.c_arbiters_true:this.c_arbiters_false;var R;if(null==d){for(var qa=null,ja=(l.arbiters.length<j.arbiters.length?l:j).arbiters.head;null!=ja;){var ma=ja.elt;if(ma.id==n.id&&ma.di==o.id){qa=ma;break}ja=ja.next}R=qa}else R=d;var ia=null==R,s,sa=!1;ia?(null==
Ya.zpp_pool?s=new Ya:(s=Ya.zpp_pool,Ya.zpp_pool=s.next,s.next=null),null,s.stat=c):null==R.colarb?(R.cleared=!0,R.b1.arbiters.inlined_try_remove(R),R.b2.arbiters.inlined_try_remove(R),null!=R.pair&&(R.pair.arb=null,R.pair=null),R.active=!1,this.f_arbiters.modified=!0,null==Ya.zpp_pool?s=new Ya:(s=Ya.zpp_pool,Ya.zpp_pool=s.next,s.next=null),null,s.intchange=!0,s.stat=c,sa=ia=!0):(s=R.colarb,r=n!=s.s1,s.stat!=c&&(s.stat=c,s.sleeping||((c?this.c_arbiters_false:this.c_arbiters_true).remove(s),ga.add(s))));
var ya=f.id_InteractionType_COLLISION;if(ia||s.stamp!=this.stamp||e)if(s.stamp=this.stamp,t.contactCollide(n,o,s,r)){ia?(s.b1=a.body,s.ws1=a,s.b2=b.body,s.ws2=b,s.id=n.id,s.di=o.id,s.b1.arbiters.inlined_add(s),s.b2.arbiters.inlined_add(s),s.active=!0,s.present=0,s.cleared=!1,s.sleeping=!1,s.fresh=!1,s.presentable=!1,s.s1=a,s.s2=b,s.userdef_restitution||(s.restitution=-Infinity>=s.s1.material.elasticity||-Infinity>=s.s2.material.elasticity?0:Infinity<=s.s1.material.elasticity||Infinity<=s.s2.material.elasticity?
1:(s.s1.material.elasticity+s.s2.material.elasticity)/2,0>s.restitution&&(s.restitution=0),1<s.restitution&&(s.restitution=1)),s.userdef_dyn_fric||(s.dyn_fric=Math.sqrt(s.s1.material.dynamicFriction*s.s2.material.dynamicFriction)),s.userdef_stat_fric||(s.stat_fric=Math.sqrt(s.s1.material.staticFriction*s.s2.material.staticFriction)),s.userdef_rfric||(s.rfric=Math.sqrt(s.s1.material.rollingFriction*s.s2.material.rollingFriction)),ga.inlined_add(s),s.fresh=!sa):s.fresh=s.up_stamp<this.stamp-1||s.endGenerated==
this.stamp&&e;s.up_stamp=s.stamp;if(s.fresh||0==(s.immState&f.id_ImmState_ALWAYS)){s.immState=f.id_ImmState_ACCEPT;var na=!1;this.inlined_MRCA_chains(s.ws1.id>s.ws2.id?s.ws2:s.ws1,s.ws1.id>s.ws2.id?s.ws1:s.ws2);for(var la=this.mrca1.head;null!=la;){for(var oa=la.elt,pa=this.mrca2.head;null!=pa;){var va=pa.elt,ta=oa.cbSet,Ga=va.cbSet;if(!ta.manager.pair(ta,Ga).empty_intersection()){var O=null,ua=null;this.prelisteners.inlined_clear();ta.manager.pair(ta,Ga).forall(f.id_CbEvent_PRE,function(a){return function(b){0!=
(b.itype&ya)&&(a[0]=g.prelisteners.inlined_insert(a[0],b),na=na||!b.pure)}}([null]));if(null!=this.prelisteners.head)if(O=ha.get(oa,va),null==O&&(ua=ib.get(oa,va),this.add_callbackset(ua)),null==O||(O.COLLISIONstamp!=this.stamp||e)&&0==(O.COLLISIONstate&f.id_ImmState_ALWAYS)){null!=ua&&(O=ua);if(null!=O)for(var wa=this.prelisteners.head;null!=wa;)wa.elt.itype==f.id_InteractionType_ANY?(O.COLLISIONstamp=this.stamp,O.SENSORstamp=this.stamp,O.FLUIDstamp=this.stamp):O.COLLISIONstamp=this.stamp,wa=wa.next;
var Ka=s.active;s.active=!0;s.cleanupContacts();this.precb.zpp_inner.pre_arbiter=s;this.precb.zpp_inner.set=O;for(var za=this.prelisteners.head;null!=za;){var Fa=za.elt;this.precb.zpp_inner.listener=Fa;ha.int_callback(O,Fa,this.precb.zpp_inner);this.precb.zpp_inner.pre_swapped=oa!=this.precb.zpp_inner.int1;var Aa=Fa.handlerp(this.precb);if(null!=Aa){var Oa=s,Ha,Pa=Aa;null==f.PreFlag_ACCEPT&&(f.internal=!0,f.PreFlag_ACCEPT=new xa,f.internal=!1);if(Pa==f.PreFlag_ACCEPT)Ha=f.id_ImmState_ACCEPT|f.id_ImmState_ALWAYS;
else{var Wa=Aa,Ma;null==f.PreFlag_ACCEPT_ONCE&&(f.internal=!0,f.PreFlag_ACCEPT_ONCE=new xa,f.internal=!1);if(Wa==f.PreFlag_ACCEPT_ONCE)Ma=f.id_ImmState_ACCEPT;else{var Za=Aa;null==f.PreFlag_IGNORE&&(f.internal=!0,f.PreFlag_IGNORE=new xa,f.internal=!1);Ma=Za==f.PreFlag_IGNORE?f.id_ImmState_IGNORE|f.id_ImmState_ALWAYS:f.id_ImmState_IGNORE}Ha=Ma}Oa.immState=Ha}za=za.next}s.active=Ka;if(null!=O)for(var Ia=this.prelisteners.head;null!=Ia;)Ia.elt.itype==f.id_InteractionType_ANY?(O.COLLISIONstate=s.immState,
O.SENSORstate=s.immState,O.FLUIDstate=s.immState):O.COLLISIONstate=s.immState,Ia=Ia.next}else null==O?0==(s.immState&f.id_ImmState_ALWAYS)&&(s.immState=f.id_ImmState_ACCEPT):s.immState=O.COLLISIONstate}pa=pa.next}la=la.next}if(na&&0==(s.immState&f.id_ImmState_ALWAYS)){if(s.b1.type==f.id_BodyType_DYNAMIC){var Ba=s.b1;Ba.world||(Ba.component.waket=this.stamp+(this.midstep?0:1),Ba.type==f.id_BodyType_KINEMATIC&&(Ba.kinematicDelaySleep=!0),Ba.component.sleeping&&this.really_wake(Ba,!1))}if(s.b1.type==
f.id_BodyType_DYNAMIC){var Ca=s.b2;Ca.world||(Ca.component.waket=this.stamp+(this.midstep?0:1),Ca.type==f.id_BodyType_KINEMATIC&&(Ca.kinematicDelaySleep=!0),Ca.component.sleeping&&this.really_wake(Ca,!1))}}}if(0!=(s.immState&f.id_ImmState_ACCEPT)){if(s.b1.type==f.id_BodyType_DYNAMIC&&s.b1.component.sleeping){var Da=s.b1;Da.world||(Da.component.waket=this.stamp+(this.midstep?0:1),Da.type==f.id_BodyType_KINEMATIC&&(Da.kinematicDelaySleep=!0),Da.component.sleeping&&this.really_wake(Da,!1))}if(s.b2.type==
f.id_BodyType_DYNAMIC&&s.b2.component.sleeping){var Ea=s.b2;Ea.world||(Ea.component.waket=this.stamp+(this.midstep?0:1),Ea.type==f.id_BodyType_KINEMATIC&&(Ea.kinematicDelaySleep=!0),Ea.component.sleeping&&this.really_wake(Ea,!1))}}s.sleeping&&(s.sleeping=!1,ga.inlined_add(s));h=s}else if(ia){var ra=s;ra.userdef_dyn_fric=!1;ra.userdef_stat_fric=!1;ra.userdef_restitution=!1;ra.userdef_rfric=!1;ra.__ref_edge1=ra.__ref_edge2=null;ra.next=Ya.zpp_pool;Ya.zpp_pool=ra;h=null}else h=s;else h=s}else{var ea;
if(null==d){for(var Xa=null,Na=(l.arbiters.length<j.arbiters.length?l:j).arbiters.head;null!=Na;){var Sa=Na.elt;if(Sa.id==n.id&&Sa.di==o.id){Xa=Sa;break}Na=Na.next}ea=Xa}else ea=d;var Ja=null==ea,z,ab=!1;Ja?(null==gb.zpp_pool?z=new gb:(z=gb.zpp_pool,gb.zpp_pool=z.next,z.next=null),null):null==ea.sensorarb?(ea.cleared=!0,ea.b1.arbiters.inlined_try_remove(ea),ea.b2.arbiters.inlined_try_remove(ea),null!=ea.pair&&(ea.pair.arb=null,ea.pair=null),ea.active=!1,this.f_arbiters.modified=!0,null==gb.zpp_pool?
z=new gb:(z=gb.zpp_pool,gb.zpp_pool=z.next,z.next=null),null,ab=Ja=z.intchange=!0):z=ea.sensorarb;var fb=f.id_InteractionType_SENSOR;if(Ja||z.stamp!=this.stamp||e)if(z.stamp=this.stamp,t.testCollide(n,o)){Ja?(z.b1=a.body,z.ws1=a,z.b2=b.body,z.ws2=b,z.id=n.id,z.di=o.id,z.b1.arbiters.inlined_add(z),z.b2.arbiters.inlined_add(z),z.active=!0,z.present=0,z.cleared=!1,z.sleeping=!1,z.fresh=!1,z.presentable=!1,this.s_arbiters.inlined_add(z),z.fresh=!ab):z.fresh=z.up_stamp<this.stamp-1||z.endGenerated==this.stamp&&
e;z.up_stamp=z.stamp;if(z.fresh||0==(z.immState&f.id_ImmState_ALWAYS)){z.immState=f.id_ImmState_ACCEPT;var Va=!1;this.inlined_MRCA_chains(z.ws1.id>z.ws2.id?z.ws2:z.ws1,z.ws1.id>z.ws2.id?z.ws1:z.ws2);for(var Qa=this.mrca1.head;null!=Qa;){for(var Ta=Qa.elt,Ua=this.mrca2.head;null!=Ua;){var bb=Ua.elt,$a=Ta.cbSet,jb=bb.cbSet;if(!$a.manager.pair($a,jb).empty_intersection()){var Ra=null,cb=null;this.prelisteners.inlined_clear();$a.manager.pair($a,jb).forall(f.id_CbEvent_PRE,function(a){return function(b){0!=
(b.itype&fb)&&(a[0]=g.prelisteners.inlined_insert(a[0],b),Va=Va||!b.pure)}}([null]));if(null!=this.prelisteners.head)if(Ra=ha.get(Ta,bb),null==Ra&&(cb=ib.get(Ta,bb),this.add_callbackset(cb)),null==Ra||(Ra.SENSORstamp!=this.stamp||e)&&0==(Ra.SENSORstate&f.id_ImmState_ALWAYS)){null!=cb&&(Ra=cb);if(null!=Ra)for(var db=this.prelisteners.head;null!=db;)db.elt.itype==f.id_InteractionType_ANY?(Ra.COLLISIONstamp=this.stamp,Ra.SENSORstamp=this.stamp,Ra.FLUIDstamp=this.stamp):Ra.SENSORstamp=this.stamp,db=db.next;
var nb=z.active;z.active=!0;this.precb.zpp_inner.pre_arbiter=z;this.precb.zpp_inner.set=Ra;for(var eb=this.prelisteners.head;null!=eb;){var kb=eb.elt;this.precb.zpp_inner.listener=kb;ha.int_callback(Ra,kb,this.precb.zpp_inner);this.precb.zpp_inner.pre_swapped=Ta!=this.precb.zpp_inner.int1;var ob=kb.handlerp(this.precb);if(null!=ob){var tb=z,qb,ub=ob;null==f.PreFlag_ACCEPT&&(f.internal=!0,f.PreFlag_ACCEPT=new xa,f.internal=!1);if(ub==f.PreFlag_ACCEPT)qb=f.id_ImmState_ACCEPT|f.id_ImmState_ALWAYS;else{var vb=
ob,rb;null==f.PreFlag_ACCEPT_ONCE&&(f.internal=!0,f.PreFlag_ACCEPT_ONCE=new xa,f.internal=!1);if(vb==f.PreFlag_ACCEPT_ONCE)rb=f.id_ImmState_ACCEPT;else{var yb=ob;null==f.PreFlag_IGNORE&&(f.internal=!0,f.PreFlag_IGNORE=new xa,f.internal=!1);rb=yb==f.PreFlag_IGNORE?f.id_ImmState_IGNORE|f.id_ImmState_ALWAYS:f.id_ImmState_IGNORE}qb=rb}tb.immState=qb}eb=eb.next}z.active=nb;if(null!=Ra)for(var pb=this.prelisteners.head;null!=pb;)pb.elt.itype==f.id_InteractionType_ANY?(Ra.COLLISIONstate=z.immState,Ra.SENSORstate=
z.immState,Ra.FLUIDstate=z.immState):Ra.SENSORstate=z.immState,pb=pb.next}else null==Ra?0==(z.immState&f.id_ImmState_ALWAYS)&&(z.immState=f.id_ImmState_ACCEPT):z.immState=Ra.SENSORstate}Ua=Ua.next}Qa=Qa.next}if(Va&&0==(z.immState&f.id_ImmState_ALWAYS)){if(z.b1.type!=f.id_BodyType_STATIC){var La=z.b1;La.world||(La.component.waket=this.stamp+(this.midstep?0:1),La.type==f.id_BodyType_KINEMATIC&&(La.kinematicDelaySleep=!0),La.component.sleeping&&this.really_wake(La,!1))}if(z.b2.type!=f.id_BodyType_STATIC){var mb=
z.b2;mb.world||(mb.component.waket=this.stamp+(this.midstep?0:1),mb.type==f.id_BodyType_KINEMATIC&&(mb.kinematicDelaySleep=!0),mb.component.sleeping&&this.really_wake(mb,!1))}}}z.sleeping&&(z.sleeping=!1,this.s_arbiters.inlined_add(z));h=z}else if(Ja){var sb=z;sb.next=gb.zpp_pool;gb.zpp_pool=sb;h=null}else h=z;else h=z}}return h},MRCA_chains:function(a,b){this.inlined_MRCA_chains(a,b)},inlined_MRCA_chains:function(a,b){this.mrca1.inlined_clear();this.mrca2.inlined_clear();null!=a.cbSet&&this.mrca1.inlined_add(a);
null!=a.body.cbSet&&this.mrca1.inlined_add(a.body);null!=b.cbSet&&this.mrca2.inlined_add(b);null!=b.body.cbSet&&this.mrca2.inlined_add(b.body);for(var c=a.body.compound,d=b.body.compound;c!=d;)(null==c?0:c.depth)<(null==d?0:d.depth)?(null!=d.cbSet&&this.mrca2.inlined_add(d),d=d.compound):(null!=c.cbSet&&this.mrca1.inlined_add(c),c=c.compound)},__class__:Mg};var Gc=function(){this.next=this.prev=this.shape=this.aabb=null};h["zpp_nape.space.ZPP_SweepData"]=Gc;Gc.__name__=!0;Gc.prototype={__class__:Gc};
var Sf=function(a){this.list=null;Fc.call(this);this.space=a;this.is_sweep=!0;this.sweep=this};h["zpp_nape.space.ZPP_SweepPhase"]=Sf;Sf.__name__=!0;Sf.__super__=Fc;Sf.prototype=w(Fc.prototype,{__insert:function(a){var b;null==Gc.zpp_pool?b=new Gc:(b=Gc.zpp_pool,Gc.zpp_pool=b.next,b.next=null);null;a.sweep=b;b.shape=a;b.aabb=a.aabb;b.next=this.list;null!=this.list&&(this.list.prev=b);this.list=b},__remove:function(a){var b=a.sweep;null==b.prev?this.list=b.next:b.prev.next=b.next;null!=b.next&&(b.next.prev=
b.prev);a.sweep=null;b.prev=null;b.shape=null;b.aabb=null;b.next=Gc.zpp_pool;Gc.zpp_pool=b},sync_broadphase:function(){this.space.validation();null!=this.list&&this.sync_broadphase_fast()},sync_broadphase_fast:function(){for(var a=this.list.next;null!=a;){var b=a.next,c=a.prev;if(!(a.aabb.minx>c.aabb.minx)){for(;null!=c.prev&&c.prev.aabb.minx>a.aabb.minx;)c=c.prev;var d=a.prev;d.next=a.next;null!=a.next&&(a.next.prev=d);null==c.prev?(a.prev=null,this.list=a,a.next=c,c.prev=a):(a.prev=c.prev,c.prev=
a,a.prev.next=a,a.next=c)}a=b}},broadphase:function(a,b){if(null!=this.list){this.sync_broadphase_fast();for(var c=this.list;null!=c;){for(var d=c.next,e=c.shape,g=e.body,h=c.aabb.maxx;null!=d&&!(d.aabb.minx>h);){var l=d.shape,j=l.body;if(j!=g&&!(g.type==f.id_BodyType_STATIC&&j.type==f.id_BodyType_STATIC)&&(!g.component.sleeping||!j.component.sleeping))e.aabb.intersectY(l.aabb)&&(b?a.narrowPhase(e,l,g.type!=f.id_BodyType_DYNAMIC||j.type!=f.id_BodyType_DYNAMIC,null,!1):a.continuousEvent(e,l,g.type!=
f.id_BodyType_DYNAMIC||j.type!=f.id_BodyType_DYNAMIC,null,!1));d=d.next}c=c.next}}},bodiesUnderPoint:function(a,b,c,d){this.sync_broadphase();for(var e=M.get(a,b,null),d=null==d?new ge:d,g=this.list;null!=g&&g.aabb.minx>a;)g=g.next;for(;null!=g&&g.aabb.minx<=a;){if(g.aabb.maxx>=a&&g.aabb.miny<=b&&g.aabb.maxy>=b){var h=g.shape,l=h.body.outer;if(!d.has(l)&&(null==c||h.filter.shouldCollide(c)))h.type==f.id_ShapeType_CIRCLE?t.circleContains(h.circle,e)&&d.push(l):t.polyContains(h.polygon,e)&&d.push(l)}g=
g.next}null!=e.outer&&(e.outer.zpp_inner=null,e.outer=null);e._isimmutable=null;e._validate=null;e._invalidate=null;e.next=M.zpp_pool;M.zpp_pool=e;return d},__class__:Sf});var Qg=function(){this.length=0;this.modified=this.pushmod=!1;this.head=null};h["zpp_nape.util.ZNPList_ZPP_CallbackSet"]=Qg;Qg.__name__=!0;Qg.prototype={inlined_add:function(a){var b;null==kc.zpp_pool?b=new kc:(b=kc.zpp_pool,kc.zpp_pool=b.next,b.next=null);null;b.elt=a;b.next=this.head;this.head=b;this.modified=!0;this.length++;
return a},inlined_try_remove:function(a){for(var b=null,c=this.head,d=!1;null!=c;){if(c.elt==a){this.inlined_erase(b);d=!0;break}b=c;c=c.next}return d},inlined_erase:function(a){var b,c;null==a?(b=this.head,this.head=c=b.next,null==this.head&&(this.pushmod=!0)):(b=a.next,c=b.next,a.next=c,null==c&&(this.pushmod=!0));a=b;a.elt=null;a.next=kc.zpp_pool;kc.zpp_pool=a;this.modified=!0;this.length--;this.pushmod=!0;return c},__class__:Qg};var kd=function(){this.length=0;this.modified=this.pushmod=!1;this.head=
null};h["zpp_nape.util.ZNPList_ZPP_Shape"]=kd;kd.__name__=!0;kd.prototype={add:function(a){return this.inlined_add(a)},inlined_add:function(a){var b;null==Wb.zpp_pool?b=new Wb:(b=Wb.zpp_pool,Wb.zpp_pool=b.next,b.next=null);null;b.elt=a;b.next=this.head;this.head=b;this.modified=!0;this.length++;return a},insert:function(a,b){return this.inlined_insert(a,b)},inlined_insert:function(a,b){var c;null==Wb.zpp_pool?c=new Wb:(c=Wb.zpp_pool,Wb.zpp_pool=c.next,c.next=null);null;c.elt=b;null==a?(c.next=this.head,
this.head=c):(c.next=a.next,a.next=c);this.pushmod=this.modified=!0;this.length++;return c},remove:function(a){this.inlined_try_remove(a)},inlined_try_remove:function(a){for(var b=null,c=this.head,d=!1;null!=c;){if(c.elt==a){this.inlined_erase(b);d=!0;break}b=c;c=c.next}return d},inlined_erase:function(a){var b,c;null==a?(b=this.head,this.head=c=b.next,null==this.head&&(this.pushmod=!0)):(b=a.next,c=b.next,a.next=c,null==c&&(this.pushmod=!0));a=b;a.elt=null;a.next=Wb.zpp_pool;Wb.zpp_pool=a;this.modified=
!0;this.length--;this.pushmod=!0;return c},iterator_at:function(a){for(var b=this.head;0<a--&&null!=b;)b=b.next;return b},__class__:kd};var Ec=function(){this.length=0;this.modified=this.pushmod=!1;this.head=null};h["zpp_nape.util.ZNPList_ZPP_Body"]=Ec;Ec.__name__=!0;Ec.prototype={add:function(a){return this.inlined_add(a)},inlined_add:function(a){var b;null==Za.zpp_pool?b=new Za:(b=Za.zpp_pool,Za.zpp_pool=b.next,b.next=null);null;b.elt=a;b.next=this.head;this.head=b;this.modified=!0;this.length++;
return a},insert:function(a,b){return this.inlined_insert(a,b)},inlined_insert:function(a,b){var c;null==Za.zpp_pool?c=new Za:(c=Za.zpp_pool,Za.zpp_pool=c.next,c.next=null);null;c.elt=b;null==a?(c.next=this.head,this.head=c):(c.next=a.next,a.next=c);this.pushmod=this.modified=!0;this.length++;return c},pop:function(){this.inlined_pop()},inlined_pop:function(){var a=this.head;this.head=a.next;a.elt=null;a.next=Za.zpp_pool;Za.zpp_pool=a;null==this.head&&(this.pushmod=!0);this.modified=!0;this.length--},
inlined_pop_unsafe:function(){var a=this.head.elt;this.pop();return a},remove:function(a){this.inlined_try_remove(a)},inlined_try_remove:function(a){for(var b=null,c=this.head,d=!1;null!=c;){if(c.elt==a){this.inlined_erase(b);d=!0;break}b=c;c=c.next}return d},inlined_erase:function(a){var b,c;null==a?(b=this.head,this.head=c=b.next,null==this.head&&(this.pushmod=!0)):(b=a.next,c=b.next,a.next=c,null==c&&(this.pushmod=!0));a=b;a.elt=null;a.next=Za.zpp_pool;Za.zpp_pool=a;this.modified=!0;this.length--;
this.pushmod=!0;return c},has:function(a){return this.inlined_has(a)},inlined_has:function(a){var b;b=!1;for(var c=this.head;null!=c;){if(c.elt==a){b=!0;break}c=c.next}return b},iterator_at:function(a){for(var b=this.head;0<a--&&null!=b;)b=b.next;return b},__class__:Ec};var Sd=function(){this.length=0;this.modified=this.pushmod=!1;this.head=null};h["zpp_nape.util.ZNPList_ZPP_Compound"]=Sd;Sd.__name__=!0;Sd.prototype={add:function(a){return this.inlined_add(a)},inlined_add:function(a){var b;null==
Aa.zpp_pool?b=new Aa:(b=Aa.zpp_pool,Aa.zpp_pool=b.next,b.next=null);null;b.elt=a;b.next=this.head;this.head=b;this.modified=!0;this.length++;return a},insert:function(a,b){return this.inlined_insert(a,b)},inlined_insert:function(a,b){var c;null==Aa.zpp_pool?c=new Aa:(c=Aa.zpp_pool,Aa.zpp_pool=c.next,c.next=null);null;c.elt=b;null==a?(c.next=this.head,this.head=c):(c.next=a.next,a.next=c);this.pushmod=this.modified=!0;this.length++;return c},pop:function(){this.inlined_pop()},inlined_pop:function(){var a=
this.head;this.head=a.next;a.elt=null;a.next=Aa.zpp_pool;Aa.zpp_pool=a;null==this.head&&(this.pushmod=!0);this.modified=!0;this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var a=this.head.elt;this.pop();return a},remove:function(a){this.inlined_try_remove(a)},inlined_try_remove:function(a){for(var b=null,c=this.head,d=!1;null!=c;){if(c.elt==a){this.inlined_erase(b);d=!0;break}b=c;c=c.next}return d},inlined_erase:function(a){var b,c;null==a?(b=this.head,
this.head=c=b.next,null==this.head&&(this.pushmod=!0)):(b=a.next,c=b.next,a.next=c,null==c&&(this.pushmod=!0));a=b;a.elt=null;a.next=Aa.zpp_pool;Aa.zpp_pool=a;this.modified=!0;this.length--;this.pushmod=!0;return c},iterator_at:function(a){for(var b=this.head;0<a--&&null!=b;)b=b.next;return b},__class__:Sd};var ye=function(){this.length=0;this.modified=this.pushmod=!1;this.head=null};h["zpp_nape.util.ZNPList_ZPP_Arbiter"]=ye;ye.__name__=!0;ye.prototype={inlined_add:function(a){var b;null==mb.zpp_pool?
b=new mb:(b=mb.zpp_pool,mb.zpp_pool=b.next,b.next=null);null;b.elt=a;b.next=this.head;this.head=b;this.modified=!0;this.length++;return a},pop:function(){this.inlined_pop()},inlined_pop:function(){var a=this.head;this.head=a.next;a.elt=null;a.next=mb.zpp_pool;mb.zpp_pool=a;null==this.head&&(this.pushmod=!0);this.modified=!0;this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var a=this.head.elt;this.pop();return a},inlined_try_remove:function(a){for(var b=
null,c=this.head,d=!1;null!=c;){if(c.elt==a){this.inlined_erase(b);d=!0;break}b=c;c=c.next}return d},erase:function(a){return this.inlined_erase(a)},inlined_erase:function(a){var b,c;null==a?(b=this.head,this.head=c=b.next,null==this.head&&(this.pushmod=!0)):(b=a.next,c=b.next,a.next=c,null==c&&(this.pushmod=!0));a=b;a.elt=null;a.next=mb.zpp_pool;mb.zpp_pool=a;this.modified=!0;this.length--;this.pushmod=!0;return c},inlined_has:function(a){var b;b=!1;for(var c=this.head;null!=c;){if(c.elt==a){b=!0;
break}c=c.next}return b},__class__:ye};var Ng=function(){this.length=0;this.modified=this.pushmod=!1;this.head=null};h["zpp_nape.util.ZNPList_ZPP_CbSetPair"]=Ng;Ng.__name__=!0;Ng.prototype={add:function(a){return this.inlined_add(a)},inlined_add:function(a){var b;null==Xb.zpp_pool?b=new Xb:(b=Xb.zpp_pool,Xb.zpp_pool=b.next,b.next=null);null;b.elt=a;b.next=this.head;this.head=b;this.modified=!0;this.length++;return a},pop:function(){this.inlined_pop()},inlined_pop:function(){var a=this.head;this.head=
a.next;a.elt=null;a.next=Xb.zpp_pool;Xb.zpp_pool=a;null==this.head&&(this.pushmod=!0);this.modified=!0;this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var a=this.head.elt;this.pop();return a},remove:function(a){this.inlined_try_remove(a)},inlined_try_remove:function(a){for(var b=null,c=this.head,d=!1;null!=c;){if(c.elt==a){this.inlined_erase(b);d=!0;break}b=c;c=c.next}return d},inlined_erase:function(a){var b,c;null==a?(b=this.head,this.head=c=
b.next,null==this.head&&(this.pushmod=!0)):(b=a.next,c=b.next,a.next=c,null==c&&(this.pushmod=!0));a=b;a.elt=null;a.next=Xb.zpp_pool;Xb.zpp_pool=a;this.modified=!0;this.length--;this.pushmod=!0;return c},__class__:Ng};var Rg=function(){this.length=0;this.modified=this.pushmod=!1;this.head=null};h["zpp_nape.util.ZNPList_ZPP_AABBPair"]=Rg;Rg.__name__=!0;Rg.prototype={inlined_add:function(a){var b;null==Hc.zpp_pool?b=new Hc:(b=Hc.zpp_pool,Hc.zpp_pool=b.next,b.next=null);null;b.elt=a;b.next=this.head;
this.head=b;this.modified=!0;this.length++;return a},pop:function(){this.inlined_pop()},inlined_pop:function(){var a=this.head;this.head=a.next;a.elt=null;a.next=Hc.zpp_pool;Hc.zpp_pool=a;null==this.head&&(this.pushmod=!0);this.modified=!0;this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var a=this.head.elt;this.pop();return a},remove:function(a){this.inlined_try_remove(a)},inlined_try_remove:function(a){for(var b=null,c=this.head,d=!1;null!=c;){if(c.elt==
a){this.inlined_erase(b);d=!0;break}b=c;c=c.next}return d},inlined_erase:function(a){var b,c;null==a?(b=this.head,this.head=c=b.next,null==this.head&&(this.pushmod=!0)):(b=a.next,c=b.next,a.next=c,null==c&&(this.pushmod=!0));a=b;a.elt=null;a.next=Hc.zpp_pool;Hc.zpp_pool=a;this.modified=!0;this.length--;this.pushmod=!0;return c},__class__:Rg};var Sg=function(){this.length=0;this.modified=this.pushmod=!1;this.head=null};h["zpp_nape.util.ZNPList_ZPP_Edge"]=Sg;Sg.__name__=!0;Sg.prototype={add:function(a){return this.inlined_add(a)},
inlined_add:function(a){var b;null==$a.zpp_pool?b=new $a:(b=$a.zpp_pool,$a.zpp_pool=b.next,b.next=null);null;b.elt=a;b.next=this.head;this.head=b;this.modified=!0;this.length++;return a},insert:function(a,b){return this.inlined_insert(a,b)},inlined_insert:function(a,b){var c;null==$a.zpp_pool?c=new $a:(c=$a.zpp_pool,$a.zpp_pool=c.next,c.next=null);null;c.elt=b;null==a?(c.next=this.head,this.head=c):(c.next=a.next,a.next=c);this.pushmod=this.modified=!0;this.length++;return c},pop:function(){this.inlined_pop()},
inlined_pop:function(){var a=this.head;this.head=a.next;a.elt=null;a.next=$a.zpp_pool;$a.zpp_pool=a;null==this.head&&(this.pushmod=!0);this.modified=!0;this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var a=this.head.elt;this.pop();return a},erase:function(a){return this.inlined_erase(a)},inlined_erase:function(a){var b,c;null==a?(b=this.head,this.head=c=b.next,null==this.head&&(this.pushmod=!0)):(b=a.next,c=b.next,a.next=c,null==c&&(this.pushmod=
!0));a=b;a.elt=null;a.next=$a.zpp_pool;$a.zpp_pool=a;this.modified=!0;this.length--;this.pushmod=!0;return c},reverse:function(){for(var a=this.head,b=null;null!=a;){var c=a.next;a.next=b;b=this.head=a;a=c}this.pushmod=this.modified=!0},iterator_at:function(a){for(var b=this.head;0<a--&&null!=b;)b=b.next;return b},__class__:Sg};var Rf=function(){this.length=0;this.modified=this.pushmod=!1;this.head=null};h["zpp_nape.util.ZNPList_ZPP_AABBNode"]=Rf;Rf.__name__=!0;Rf.prototype={add:function(a){return this.inlined_add(a)},
inlined_add:function(a){var b;null==Ic.zpp_pool?b=new Ic:(b=Ic.zpp_pool,Ic.zpp_pool=b.next,b.next=null);null;b.elt=a;b.next=this.head;this.head=b;this.modified=!0;this.length++;return a},pop:function(){this.inlined_pop()},inlined_pop:function(){var a=this.head;this.head=a.next;a.elt=null;a.next=Ic.zpp_pool;Ic.zpp_pool=a;null==this.head&&(this.pushmod=!0);this.modified=!0;this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var a=this.head.elt;this.pop();
return a},__class__:Rf};var Tg=function(){this.length=0;this.modified=this.pushmod=!1;this.head=null};h["zpp_nape.util.ZNPList_ZPP_Component"]=Tg;Tg.__name__=!0;Tg.prototype={inlined_add:function(a){var b;null==nd.zpp_pool?b=new nd:(b=nd.zpp_pool,nd.zpp_pool=b.next,b.next=null);null;b.elt=a;b.next=this.head;this.head=b;this.modified=!0;this.length++;return a},pop:function(){this.inlined_pop()},inlined_pop:function(){var a=this.head;this.head=a.next;a.elt=null;a.next=nd.zpp_pool;nd.zpp_pool=a;null==
this.head&&(this.pushmod=!0);this.modified=!0;this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var a=this.head.elt;this.pop();return a},__class__:Tg};var Eh=function(){this.length=0;this.modified=this.pushmod=!1;this.head=null};h["zpp_nape.util.ZNPList_ZPP_InteractionGroup"]=Eh;Eh.__name__=!0;Eh.prototype={iterator_at:function(a){for(var b=this.head;0<a--&&null!=b;)b=b.next;return b},__class__:Eh};var Tf=function(){this.length=0;this.modified=this.pushmod=
!1;this.head=null};h["zpp_nape.util.ZNPList_ZPP_ColArbiter"]=Tf;Tf.__name__=!0;Tf.prototype={add:function(a){return this.inlined_add(a)},inlined_add:function(a){var b;null==od.zpp_pool?b=new od:(b=od.zpp_pool,od.zpp_pool=b.next,b.next=null);null;b.elt=a;b.next=this.head;this.head=b;this.modified=!0;this.length++;return a},remove:function(a){this.inlined_try_remove(a)},inlined_try_remove:function(a){for(var b=null,c=this.head,d=!1;null!=c;){if(c.elt==a){this.inlined_erase(b);d=!0;break}b=c;c=c.next}return d},
inlined_erase:function(a){var b,c;null==a?(b=this.head,this.head=c=b.next,null==this.head&&(this.pushmod=!0)):(b=a.next,c=b.next,a.next=c,null==c&&(this.pushmod=!0));a=b;a.elt=null;a.next=od.zpp_pool;od.zpp_pool=a;this.modified=!0;this.length--;this.pushmod=!0;return c},__class__:Tf};var Wg=function(){this.length=0;this.modified=this.pushmod=!1;this.head=null};h["zpp_nape.util.ZNPList_ZPP_FluidArbiter"]=Wg;Wg.__name__=!0;Wg.prototype={inlined_add:function(a){var b;null==Yc.zpp_pool?b=new Yc:(b=Yc.zpp_pool,
Yc.zpp_pool=b.next,b.next=null);null;b.elt=a;b.next=this.head;this.head=b;this.modified=!0;this.length++;return a},inlined_erase:function(a){var b,c;null==a?(b=this.head,this.head=c=b.next,null==this.head&&(this.pushmod=!0)):(b=a.next,c=b.next,a.next=c,null==c&&(this.pushmod=!0));a=b;a.elt=null;a.next=Yc.zpp_pool;Yc.zpp_pool=a;this.modified=!0;this.length--;this.pushmod=!0;return c},__class__:Wg};var Xg=function(){this.length=0;this.modified=this.pushmod=!1;this.head=null};h["zpp_nape.util.ZNPList_ZPP_SensorArbiter"]=
Xg;Xg.__name__=!0;Xg.prototype={inlined_add:function(a){var b;null==Zc.zpp_pool?b=new Zc:(b=Zc.zpp_pool,Zc.zpp_pool=b.next,b.next=null);null;b.elt=a;b.next=this.head;this.head=b;this.modified=!0;this.length++;return a},inlined_erase:function(a){var b,c;null==a?(b=this.head,this.head=c=b.next,null==this.head&&(this.pushmod=!0)):(b=a.next,c=b.next,a.next=c,null==c&&(this.pushmod=!0));a=b;a.elt=null;a.next=Zc.zpp_pool;Zc.zpp_pool=a;this.modified=!0;this.length--;this.pushmod=!0;return c},__class__:Xg};
var Uf=function(){this.length=0;this.modified=this.pushmod=!1;this.head=null};h["zpp_nape.util.ZNPList_ZPP_Listener"]=Uf;Uf.__name__=!0;Uf.prototype={add:function(a){return this.inlined_add(a)},inlined_add:function(a){var b;null==Yb.zpp_pool?b=new Yb:(b=Yb.zpp_pool,Yb.zpp_pool=b.next,b.next=null);null;b.elt=a;b.next=this.head;this.head=b;this.modified=!0;this.length++;return a},insert:function(a,b){return this.inlined_insert(a,b)},inlined_insert:function(a,b){var c;null==Yb.zpp_pool?c=new Yb:(c=Yb.zpp_pool,
Yb.zpp_pool=c.next,c.next=null);null;c.elt=b;null==a?(c.next=this.head,this.head=c):(c.next=a.next,a.next=c);this.pushmod=this.modified=!0;this.length++;return c},remove:function(a){this.inlined_try_remove(a)},inlined_try_remove:function(a){for(var b=null,c=this.head,d=!1;null!=c;){if(c.elt==a){this.inlined_erase(b);d=!0;break}b=c;c=c.next}return d},inlined_erase:function(a){var b,c;null==a?(b=this.head,this.head=c=b.next,null==this.head&&(this.pushmod=!0)):(b=a.next,c=b.next,a.next=c,null==c&&(this.pushmod=
!0));a=b;a.elt=null;a.next=Yb.zpp_pool;Yb.zpp_pool=a;this.modified=!0;this.length--;this.pushmod=!0;return c},iterator_at:function(a){for(var b=this.head;0<a--&&null!=b;)b=b.next;return b},__class__:Uf};var Vg=function(){this.length=0;this.modified=this.pushmod=!1;this.head=null};h["zpp_nape.util.ZNPList_ZPP_ToiEvent"]=Vg;Vg.__name__=!0;Vg.prototype={add:function(a){return this.inlined_add(a)},inlined_add:function(a){var b;null==Jc.zpp_pool?b=new Jc:(b=Jc.zpp_pool,Jc.zpp_pool=b.next,b.next=null);
null;b.elt=a;b.next=this.head;this.head=b;this.modified=!0;this.length++;return a},pop:function(){this.inlined_pop()},inlined_pop:function(){var a=this.head;this.head=a.next;a.elt=null;a.next=Jc.zpp_pool;Jc.zpp_pool=a;null==this.head&&(this.pushmod=!0);this.modified=!0;this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var a=this.head.elt;this.pop();return a},erase:function(a){return this.inlined_erase(a)},inlined_erase:function(a){var b,c;null==a?
(b=this.head,this.head=c=b.next,null==this.head&&(this.pushmod=!0)):(b=a.next,c=b.next,a.next=c,null==c&&(this.pushmod=!0));a=b;a.elt=null;a.next=Jc.zpp_pool;Jc.zpp_pool=a;this.modified=!0;this.length--;this.pushmod=!0;return c},__class__:Vg};var Fh=function(){this.length=0;this.modified=this.pushmod=!1;this.head=null};h["zpp_nape.util.ZNPList_ConvexResult"]=Fh;Fh.__name__=!0;Fh.prototype={iterator_at:function(a){for(var b=this.head;0<a--&&null!=b;)b=b.next;return b},__class__:Fh};var Gh=function(){this.length=
0;this.modified=this.pushmod=!1;this.head=null};h["zpp_nape.util.ZNPList_ZPP_GeomPoly"]=Gh;Gh.__name__=!0;Gh.prototype={iterator_at:function(a){for(var b=this.head;0<a--&&null!=b;)b=b.next;return b},__class__:Gh};var Hh=function(){this.length=0;this.modified=this.pushmod=!1;this.head=null};h["zpp_nape.util.ZNPList_RayResult"]=Hh;Hh.__name__=!0;Hh.prototype={iterator_at:function(a){for(var b=this.head;0<a--&&null!=b;)b=b.next;return b},__class__:Hh};var Fa=function(){this.next=this.elt=null};h["zpp_nape.util.ZNPNode_ZPP_CbType"]=
Fa;Fa.__name__=!0;Fa.prototype={__class__:Fa};var kc=function(){this.next=this.elt=null};h["zpp_nape.util.ZNPNode_ZPP_CallbackSet"]=kc;kc.__name__=!0;kc.prototype={__class__:kc};var Wb=function(){this.next=this.elt=null};h["zpp_nape.util.ZNPNode_ZPP_Shape"]=Wb;Wb.__name__=!0;Wb.prototype={__class__:Wb};var Za=function(){this.next=this.elt=null};h["zpp_nape.util.ZNPNode_ZPP_Body"]=Za;Za.__name__=!0;Za.prototype={__class__:Za};var za=function(){this.next=this.elt=null};h["zpp_nape.util.ZNPNode_ZPP_Constraint"]=
za;za.__name__=!0;za.prototype={__class__:za};var Aa=function(){this.next=this.elt=null};h["zpp_nape.util.ZNPNode_ZPP_Compound"]=Aa;Aa.__name__=!0;Aa.prototype={__class__:Aa};var mb=function(){this.next=this.elt=null};h["zpp_nape.util.ZNPNode_ZPP_Arbiter"]=mb;mb.__name__=!0;mb.prototype={__class__:mb};var cb=function(){this.next=this.elt=null};h["zpp_nape.util.ZNPNode_ZPP_InteractionListener"]=cb;cb.__name__=!0;cb.prototype={__class__:cb};var Ub=function(){this.next=this.elt=null};h["zpp_nape.util.ZNPNode_ZPP_CbSet"]=
Ub;Ub.__name__=!0;Ub.prototype={__class__:Ub};var Tb=function(){this.next=this.elt=null};h["zpp_nape.util.ZNPNode_ZPP_Interactor"]=Tb;Tb.__name__=!0;Tb.prototype={__class__:Tb};var Rb=function(){this.next=this.elt=null};h["zpp_nape.util.ZNPNode_ZPP_BodyListener"]=Rb;Rb.__name__=!0;Rb.prototype={__class__:Rb};var Xb=function(){this.next=this.elt=null};h["zpp_nape.util.ZNPNode_ZPP_CbSetPair"]=Xb;Xb.__name__=!0;Xb.prototype={__class__:Xb};var Sb=function(){this.next=this.elt=null};h["zpp_nape.util.ZNPNode_ZPP_ConstraintListener"]=
Sb;Sb.__name__=!0;Sb.prototype={__class__:Sb};var Hc=function(){this.next=this.elt=null};h["zpp_nape.util.ZNPNode_ZPP_AABBPair"]=Hc;Hc.__name__=!0;Hc.prototype={__class__:Hc};var Qa=function(){this.next=this.elt=null};h["zpp_nape.util.ZNPNode_ZPP_Vec2"]=Qa;Qa.__name__=!0;Qa.prototype={__class__:Qa};var $a=function(){this.next=this.elt=null};h["zpp_nape.util.ZNPNode_ZPP_Edge"]=$a;$a.__name__=!0;$a.prototype={__class__:$a};var Ic=function(){this.next=this.elt=null};h["zpp_nape.util.ZNPNode_ZPP_AABBNode"]=
Ic;Ic.__name__=!0;Ic.prototype={__class__:Ic};var nd=function(){this.next=this.elt=null};h["zpp_nape.util.ZNPNode_ZPP_Component"]=nd;nd.__name__=!0;nd.prototype={__class__:nd};var Ih=function(){this.next=this.elt=null};h["zpp_nape.util.ZNPNode_ZPP_InteractionGroup"]=Ih;Ih.__name__=!0;Ih.prototype={__class__:Ih};var od=function(){this.next=this.elt=null};h["zpp_nape.util.ZNPNode_ZPP_ColArbiter"]=od;od.__name__=!0;od.prototype={__class__:od};var Yc=function(){this.next=this.elt=null};h["zpp_nape.util.ZNPNode_ZPP_FluidArbiter"]=
Yc;Yc.__name__=!0;Yc.prototype={__class__:Yc};var Zc=function(){this.next=this.elt=null};h["zpp_nape.util.ZNPNode_ZPP_SensorArbiter"]=Zc;Zc.__name__=!0;Zc.prototype={__class__:Zc};var Yb=function(){this.next=this.elt=null};h["zpp_nape.util.ZNPNode_ZPP_Listener"]=Yb;Yb.__name__=!0;Yb.prototype={__class__:Yb};var Jc=function(){this.next=this.elt=null};h["zpp_nape.util.ZNPNode_ZPP_ToiEvent"]=Jc;Jc.__name__=!0;Jc.prototype={__class__:Jc};var Jh=function(){this.next=this.elt=null};h["zpp_nape.util.ZNPNode_ConvexResult"]=
Jh;Jh.__name__=!0;Jh.prototype={__class__:Jh};var Kh=function(){this.next=this.elt=null};h["zpp_nape.util.ZNPNode_ZPP_GeomPoly"]=Kh;Kh.__name__=!0;Kh.prototype={__class__:Kh};var Lh=function(){this.next=this.elt=null};h["zpp_nape.util.ZNPNode_RayResult"]=Lh;Lh.__name__=!0;Lh.prototype={__class__:Lh};var md=function(){this.at_index=0;this.at_ite=null;this.zip_length=!1;this._length=0;this.inner=null;fd.call(this);this.at_ite=null;this.at_index=0;this.zip_length=!0;this._length=0};h["zpp_nape.util.ZPP_MixVec2List"]=
md;md.__name__=!0;md.get=function(a,b){null==b&&(b=!1);var c=new md;c.inner=a;c.zpp_inner.immutable=b;return c};md.__super__=fd;md.prototype=w(fd.prototype,{zpp_gl:function(){this.zpp_vm();if(this.zip_length){this._length=0;for(var a=this.inner.next;null!=a;)this._length++,a=a.next;this.zip_length=!1}return this._length},zpp_vm:function(){this.zpp_inner.validate();this.inner.modified&&(this.zip_length=!0,this._length=0,this.at_ite=null)},at:function(a){this.zpp_vm();this.zpp_inner.reverse_flag&&(a=
this.zpp_gl()-1-a);if(a<this.at_index||null==this.at_ite){this.at_index=0;for(this.at_ite=this.inner.next;;)break}for(;this.at_index!=a;){this.at_index++;for(this.at_ite=this.at_ite.next;;)break}return this.at_ite.wrapper()},push:function(a){this.zpp_inner.modify_test();this.zpp_vm();var b;if(b=null!=this.zpp_inner.adder?this.zpp_inner.adder(a):!0)this.zpp_inner.reverse_flag?this.inner.add(a.zpp_inner):this.inner.insert(this.inner.iterator_at(this.zpp_gl()-1),a.zpp_inner),this.zpp_inner.invalidate(),
null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(a);return b},__class__:md});var Kb=function(){this.user_length=0;this.zip_length=!1;this.at_ite=this.push_ite=null;this.at_index=0;this.dontremove=this.reverse_flag=!1;this._invalidate=this._validate=this.adder=this.post_adder=this.subber=null;this.immutable=this._invalidated=!1;this.outer=this.inner=null;this.inner=new gc;this._invalidated=!0};h["zpp_nape.util.ZPP_ConstraintList"]=Kb;Kb.__name__=!0;Kb.get=function(a,b){null==b&&(b=!1);var c=
new Fg;c.zpp_inner.inner=a;b&&(c.zpp_inner.immutable=!0);c.zpp_inner.zip_length=!0;return c};Kb.prototype={valmod:function(){this.validate();this.inner.modified&&(this.inner.pushmod&&(this.push_ite=null),this.at_ite=null,this.inner.modified=!1,this.inner.pushmod=!1,this.zip_length=!0)},modify_test:function(){},validate:function(){this._invalidated&&(this._invalidated=!1,null!=this._validate&&this._validate())},invalidate:function(){this._invalidated=!0;null!=this._invalidate&&this._invalidate(this)},
__class__:Kb};var zc=function(){this.user_length=0;this.zip_length=!1;this.at_ite=this.push_ite=null;this.at_index=0;this.dontremove=this.reverse_flag=!1;this._invalidate=this._validate=this.adder=this.post_adder=this.subber=null;this.immutable=this._invalidated=!1;this.outer=this.inner=null;this.inner=new Ec;this._invalidated=!0};h["zpp_nape.util.ZPP_BodyList"]=zc;zc.__name__=!0;zc.get=function(a,b){null==b&&(b=!1);var c=new ge;c.zpp_inner.inner=a;b&&(c.zpp_inner.immutable=!0);c.zpp_inner.zip_length=
!0;return c};zc.prototype={valmod:function(){this.validate();this.inner.modified&&(this.inner.pushmod&&(this.push_ite=null),this.at_ite=null,this.inner.modified=!1,this.inner.pushmod=!1,this.zip_length=!0)},modify_test:function(){},validate:function(){this._invalidated&&(this._invalidated=!1,null!=this._validate&&this._validate())},invalidate:function(){this._invalidated=!0;null!=this._invalidate&&this._invalidate(this)},__class__:zc};var ie=function(){this.user_length=0;this.zip_length=!1;this.at_ite=
this.push_ite=null;this.at_index=0;this.reverse_flag=!1;this._validate=null;this._invalidated=!1;this.inner=null};h["zpp_nape.util.ZPP_InteractorList"]=ie;ie.__name__=!0;ie.prototype={valmod:function(){this.validate();this.inner.modified&&(this.inner.pushmod&&(this.push_ite=null),this.at_ite=null,this.inner.modified=!1,this.inner.pushmod=!1,this.zip_length=!0)},validate:function(){this._invalidated&&(this._invalidated=!1,null!=this._validate&&this._validate())},__class__:ie};var Vc=function(){this.user_length=
0;this.zip_length=!1;this.at_ite=this.push_ite=null;this.at_index=0;this.dontremove=this.reverse_flag=!1;this._invalidate=this._validate=this.adder=this.post_adder=this.subber=null;this.immutable=this._invalidated=!1;this.outer=this.inner=null;this.inner=new Sd;this._invalidated=!0};h["zpp_nape.util.ZPP_CompoundList"]=Vc;Vc.__name__=!0;Vc.get=function(a,b){null==b&&(b=!1);var c=new Jg;c.zpp_inner.inner=a;b&&(c.zpp_inner.immutable=!0);c.zpp_inner.zip_length=!0;return c};Vc.prototype={valmod:function(){this.validate();
this.inner.modified&&(this.inner.pushmod&&(this.push_ite=null),this.at_ite=null,this.inner.modified=!1,this.inner.pushmod=!1,this.zip_length=!0)},modify_test:function(){},validate:function(){this._invalidated&&(this._invalidated=!1,null!=this._validate&&this._validate())},invalidate:function(){this._invalidated=!0;null!=this._invalidate&&this._invalidate(this)},__class__:Vc};var Uc=function(){this.user_length=0;this.zip_length=!1;this.at_ite=this.push_ite=null;this.at_index=0;this.dontremove=this.reverse_flag=
!1;this._invalidate=this._validate=this.adder=this.post_adder=this.subber=null;this.immutable=this._invalidated=!1;this.outer=this.inner=null;this.inner=new Uf;this._invalidated=!0};h["zpp_nape.util.ZPP_ListenerList"]=Uc;Uc.__name__=!0;Uc.get=function(a,b){null==b&&(b=!1);var c=new Dg;c.zpp_inner.inner=a;b&&(c.zpp_inner.immutable=!0);c.zpp_inner.zip_length=!0;return c};Uc.prototype={valmod:function(){this.validate();this.inner.modified&&(this.inner.pushmod&&(this.push_ite=null),this.at_ite=null,this.inner.modified=
!1,this.inner.pushmod=!1,this.zip_length=!0)},modify_test:function(){},validate:function(){this._invalidated&&(this._invalidated=!1,null!=this._validate&&this._validate())},invalidate:function(){this._invalidated=!0;null!=this._invalidate&&this._invalidate(this)},__class__:Uc};var Hb=function(){this.user_length=0;this.zip_length=!1;this.at_ite=this.push_ite=null;this.at_index=0;this.dontremove=this.reverse_flag=!1;this._invalidate=this._validate=this.adder=this.post_adder=this.subber=null;this.immutable=
this._invalidated=!1;this.outer=this.inner=null;this.inner=new Qb;this._invalidated=!0};h["zpp_nape.util.ZPP_CbTypeList"]=Hb;Hb.__name__=!0;Hb.get=function(a,b){null==b&&(b=!1);var c=new uf;c.zpp_inner.inner=a;b&&(c.zpp_inner.immutable=!0);c.zpp_inner.zip_length=!0;return c};Hb.prototype={valmod:function(){this.validate();this.inner.modified&&(this.inner.pushmod&&(this.push_ite=null),this.at_ite=null,this.inner.modified=!1,this.inner.pushmod=!1,this.zip_length=!0)},modify_test:function(){},validate:function(){this._invalidated&&
(this._invalidated=!1,null!=this._validate&&this._validate())},invalidate:function(){this._invalidated=!0;null!=this._invalidate&&this._invalidate(this)},__class__:Hb};var xc=function(){this.user_length=0;this.zip_length=!1;this.at_ite=this.push_ite=null;this.at_index=0;this.reverse_flag=!1;this._invalidate=this._validate=this.adder=this.post_adder=this.subber=null;this.immutable=this._invalidated=!1;this.outer=this.inner=null;this.inner=new we;this._invalidated=!0};h["zpp_nape.util.ZPP_Vec2List"]=
xc;xc.__name__=!0;xc.prototype={valmod:function(){this.validate();this.inner.modified&&(this.inner.pushmod&&(this.push_ite=null),this.at_ite=null,this.inner.modified=!1,this.inner.pushmod=!1,this.zip_length=!0)},modify_test:function(){},validate:function(){this._invalidated&&(this._invalidated=!1,null!=this._validate&&this._validate())},invalidate:function(){this._invalidated=!0;null!=this._invalidate&&this._invalidate(this)},__class__:xc};var ed=function(){this.user_length=0;this.zip_length=!1;this.at_ite=
this.push_ite=null;this.at_index=0;this.reverse_flag=!1;this._validate=null;this._invalidated=!1;this.inner=null};h["zpp_nape.util.ZPP_GeomPolyList"]=ed;ed.__name__=!0;ed.prototype={valmod:function(){this.validate();this.inner.modified&&(this.inner.pushmod&&(this.push_ite=null),this.at_ite=null,this.inner.modified=!1,this.inner.pushmod=!1,this.zip_length=!0)},validate:function(){this._invalidated&&(this._invalidated=!1,null!=this._validate&&this._validate())},__class__:ed};var fe=function(){this.user_length=
0;this.zip_length=!1;this.at_ite=this.push_ite=null;this.at_index=0;this.reverse_flag=!1;this._validate=null;this._invalidated=!1;this.inner=null};h["zpp_nape.util.ZPP_RayResultList"]=fe;fe.__name__=!0;fe.prototype={valmod:function(){this.validate();this.inner.modified&&(this.inner.pushmod&&(this.push_ite=null),this.at_ite=null,this.inner.modified=!1,this.inner.pushmod=!1,this.zip_length=!0)},validate:function(){this._invalidated&&(this._invalidated=!1,null!=this._validate&&this._validate())},__class__:fe};
var yd=function(){this.user_length=0;this.zip_length=!1;this.at_ite=this.push_ite=null;this.at_index=0;this.reverse_flag=!1;this._validate=null;this._invalidated=!1;this.inner=null};h["zpp_nape.util.ZPP_ConvexResultList"]=yd;yd.__name__=!0;yd.prototype={valmod:function(){this.validate();this.inner.modified&&(this.inner.pushmod&&(this.push_ite=null),this.at_ite=null,this.inner.modified=!1,this.inner.pushmod=!1,this.zip_length=!0)},validate:function(){this._invalidated&&(this._invalidated=!1,null!=
this._validate&&this._validate())},__class__:yd};var ue=function(){this.user_length=0;this.zip_length=!1;this.at_ite=this.push_ite=null;this.at_index=0;this.reverse_flag=!1;this._validate=null;this._invalidated=!1;this.inner=null};h["zpp_nape.util.ZPP_EdgeList"]=ue;ue.__name__=!0;ue.prototype={valmod:function(){this.validate();this.inner.modified&&(this.inner.pushmod&&(this.push_ite=null),this.at_ite=null,this.inner.modified=!1,this.inner.pushmod=!1,this.zip_length=!0)},validate:function(){this._invalidated&&
(this._invalidated=!1,null!=this._validate&&this._validate())},__class__:ue};var jd=function(){this.user_length=0;this.zip_length=!1;this.at_ite=this.push_ite=null;this.at_index=0;this.dontremove=this.reverse_flag=!1;this._invalidate=this._validate=this.adder=this.post_adder=this.subber=null;this.immutable=this._invalidated=!1;this.outer=this.inner=null;this.inner=new kd;this._invalidated=!0};h["zpp_nape.util.ZPP_ShapeList"]=jd;jd.__name__=!0;jd.get=function(a,b){null==b&&(b=!1);var c=new Lg;c.zpp_inner.inner=
a;b&&(c.zpp_inner.immutable=!0);c.zpp_inner.zip_length=!0;return c};jd.prototype={valmod:function(){this.validate();this.inner.modified&&(this.inner.pushmod&&(this.push_ite=null),this.at_ite=null,this.inner.modified=!1,this.inner.pushmod=!1,this.zip_length=!0)},modify_test:function(){},validate:function(){this._invalidated&&(this._invalidated=!1,null!=this._validate&&this._validate())},invalidate:function(){this._invalidated=!0;null!=this._invalidate&&this._invalidate(this)},__class__:jd};var ee=
function(){this.user_length=0;this.zip_length=!1;this.at_ite=this.push_ite=null;this.at_index=0;this.reverse_flag=!1;this._validate=null;this._invalidated=!1;this.inner=null};h["zpp_nape.util.ZPP_InteractionGroupList"]=ee;ee.__name__=!0;ee.prototype={valmod:function(){this.validate();this.inner.modified&&(this.inner.pushmod&&(this.push_ite=null),this.at_ite=null,this.inner.modified=!1,this.inner.pushmod=!1,this.zip_length=!0)},validate:function(){this._invalidated&&(this._invalidated=!1,null!=this._validate&&
this._validate())},__class__:ee};var dd=function(){this.user_length=0;this.zip_length=!1;this.at_ite=this.push_ite=null;this.at_index=0;this.reverse_flag=!1;this._validate=null;this.immutable=this._invalidated=!1;this.outer=this.inner=null;this.inner=new ye;this._invalidated=!0};h["zpp_nape.util.ZPP_ArbiterList"]=dd;dd.__name__=!0;dd.get=function(a,b){null==b&&(b=!1);var c=new Gg;c.zpp_inner.inner=a;b&&(c.zpp_inner.immutable=!0);c.zpp_inner.zip_length=!0;return c};dd.prototype={valmod:function(){this.validate();
this.inner.modified&&(this.inner.pushmod&&(this.push_ite=null),this.at_ite=null,this.inner.modified=!1,this.inner.pushmod=!1,this.zip_length=!0)},validate:function(){this._invalidated&&(this._invalidated=!1,null!=this._validate&&this._validate())},__class__:dd};var Md=function(){this.user_length=0;this.zip_length=!1;this.at_ite=this.push_ite=null;this.at_index=0;this.reverse_flag=!1;this._validate=null;this._invalidated=!1;this.inner=null};h["zpp_nape.util.ZPP_ContactList"]=Md;Md.__name__=!0;Md.prototype=
{valmod:function(){this.validate();this.inner.modified&&(this.inner.pushmod&&(this.push_ite=null),this.at_ite=null,this.inner.modified=!1,this.inner.pushmod=!1,this.zip_length=!0)},validate:function(){this._invalidated&&(this._invalidated=!1,null!=this._validate&&this._validate())},__class__:Md};var ve=function(){};h["zpp_nape.util.ZPP_Math"]=ve;ve.__name__=!0;ve.sqr=function(a){return a*a};var zd=function(){};h["zpp_nape.util.ZPP_PubPool"]=zd;zd.__name__=!0;var na=function(){this.colour=0;this.lt=
this.swapped=this.data=this.prev=this.next=this.parent=null};h["zpp_nape.util.ZPP_Set_ZPP_CbSetPair"]=na;na.__name__=!0;na.prototype={clear_with:function(a){if(null!=this.parent){for(var b=this.parent;null!=b;)b=null!=b.prev?b.prev:null!=b.next?b.next:this.clear_node(b,a);this.parent=null}},clear_node:function(a,b){b(a.data);var c=a.parent;null!=c&&(a==c.prev?c.prev=null:c.next=null,a.parent=null);a.data=null;a.lt=null;a.swapped=null;a.next=na.zpp_pool;na.zpp_pool=a;return c},__fix_dbl_red:function(a){for(;;){var b=
a.parent,c=b.parent;if(null==c){b.colour=1;break}var d,e,f,g,h,j,m;b==c.prev?(f=c,m=c.next,a==b.prev?(d=a,e=b,g=a.prev,h=a.next,j=b.next):(d=b,e=a,g=b.prev,h=a.prev,j=a.next)):(d=c,g=c.prev,a==b.prev?(e=a,f=b,h=a.prev,j=a.next,m=b.next):(e=b,f=a,h=b.prev,j=a.prev,m=a.next));a=c.parent;null==a?this.parent=e:a.prev==c?a.prev=e:a.next=e;null!=e&&(e.parent=a);d.prev=g;null!=g&&(g.parent=d);d.next=h;null!=h&&(h.parent=d);e.prev=d;null!=d&&(d.parent=e);e.next=f;null!=f&&(f.parent=e);f.prev=j;null!=j&&(j.parent=
f);f.next=m;null!=m&&(m.parent=f);e.colour=c.colour-1;d.colour=1;f.colour=1;if(e==this.parent)this.parent.colour=1;else if(0==e.colour&&0==e.parent.colour){a=e;continue}break}},try_insert:function(a){var b=null,c=null;if(null==this.parent)null==na.zpp_pool?b=new na:(b=na.zpp_pool,na.zpp_pool=b.next,b.next=null),null,b.data=a,this.parent=b;else for(c=this.parent;;)if(this.lt(a,c.data))if(null==c.prev){null==na.zpp_pool?b=new na:(b=na.zpp_pool,na.zpp_pool=b.next,b.next=null);null;b.data=a;c.prev=b;
b.parent=c;break}else c=c.prev;else if(this.lt(c.data,a))if(null==c.next){null==na.zpp_pool?b=new na:(b=na.zpp_pool,na.zpp_pool=b.next,b.next=null);null;b.data=a;c.next=b;b.parent=c;break}else c=c.next;else break;if(null==b)return c;null==b.parent?b.colour=1:(b.colour=0,0==b.parent.colour&&this.__fix_dbl_red(b));return b},__class__:na};var db=function(){this.colour=0;this.lt=this.swapped=this.data=this.prev=this.next=this.parent=null};h["zpp_nape.util.ZPP_Set_ZPP_CbSet"]=db;db.__name__=!0;db.prototype=
{empty:function(){return null==this.parent},find:function(a){for(var b=this.parent;null!=b&&b.data!=a;)b=this.lt(a,b.data)?b.prev:b.next;return b},find_weak:function(a){for(var b=this.parent;null!=b;)if(this.lt(a,b.data))b=b.prev;else if(this.lt(b.data,a))b=b.next;else break;return b},remove:function(a){this.remove_node(this.find(a))},remove_node:function(a){if(null!=a.next&&null!=a.prev){for(var b=a.next;null!=b.prev;)b=b.prev;var c=a.data;a.data=b.data;b.data=c;null!=this.swapped&&this.swapped(a.data,
b.data);a=b}b=null==a.prev?a.next:a.prev;if(1==a.colour)if(null!=a.prev||null!=a.next)b.colour=1;else if(null!=a.parent)for(c=a.parent;;){c.colour++;c.prev.colour--;c.next.colour--;var d=c.prev;if(-1==d.colour){this.__fix_neg_red(d);break}else if(0==d.colour){if(null!=d.prev&&0==d.prev.colour){this.__fix_dbl_red(d.prev);break}if(null!=d.next&&0==d.next.colour){this.__fix_dbl_red(d.next);break}}d=c.next;if(-1==d.colour){this.__fix_neg_red(d);break}else if(0==d.colour){if(null!=d.prev&&0==d.prev.colour){this.__fix_dbl_red(d.prev);
break}if(null!=d.next&&0==d.next.colour){this.__fix_dbl_red(d.next);break}}if(2==c.colour)if(null==c.parent)c.colour=1;else{c=c.parent;continue}break}c=a.parent;null==c?this.parent=b:c.prev==a?c.prev=b:c.next=b;null!=b&&(b.parent=c);a.parent=a.prev=a.next=null;a.data=null;a.lt=null;a.swapped=null;a.next=db.zpp_pool;db.zpp_pool=a},__fix_neg_red:function(a){var b=a.parent;if(b.prev==a){var c=a.prev,d=a.next,e=d.prev,f=d.next;c.colour=0;a.colour=b.colour=1;a.next=e;null!=e&&(e.parent=a);a=b.data;b.data=
d.data;d.data=a;null!=this.swapped&&this.swapped(b.data,d.data);d.prev=f;null!=f&&(f.parent=d);d.next=b.next;null!=b.next&&(b.next.parent=d);b.next=d}else c=a.next,d=a.prev,e=d.next,f=d.prev,c.colour=0,a.colour=b.colour=1,a.prev=e,null!=e&&(e.parent=a),a=b.data,b.data=d.data,d.data=a,null!=this.swapped&&this.swapped(b.data,d.data),d.next=f,null!=f&&(f.parent=d),d.prev=b.prev,null!=b.prev&&(b.prev.parent=d),b.prev=d;null!=d&&(d.parent=b);b=c;null!=b.prev&&0==b.prev.colour?this.__fix_dbl_red(b.prev):
null!=b.next&&0==b.next.colour&&this.__fix_dbl_red(b.next)},__fix_dbl_red:function(a){for(;;){var b=a.parent,c=b.parent;if(null==c){b.colour=1;break}var d,e,f,g,h,j,m;b==c.prev?(f=c,m=c.next,a==b.prev?(d=a,e=b,g=a.prev,h=a.next,j=b.next):(d=b,e=a,g=b.prev,h=a.prev,j=a.next)):(d=c,g=c.prev,a==b.prev?(e=a,f=b,h=a.prev,j=a.next,m=b.next):(e=b,f=a,h=b.prev,j=a.prev,m=a.next));a=c.parent;null==a?this.parent=e:a.prev==c?a.prev=e:a.next=e;null!=e&&(e.parent=a);d.prev=g;null!=g&&(g.parent=d);d.next=h;null!=
h&&(h.parent=d);e.prev=d;null!=d&&(d.parent=e);e.next=f;null!=f&&(f.parent=e);f.prev=j;null!=j&&(j.parent=f);f.next=m;null!=m&&(m.parent=f);e.colour=c.colour-1;d.colour=1;f.colour=1;if(e==this.parent)this.parent.colour=1;else if(0==e.colour&&0==e.parent.colour){a=e;continue}break}},insert:function(a){var b;null==db.zpp_pool?b=new db:(b=db.zpp_pool,db.zpp_pool=b.next,b.next=null);null;b.data=a;if(null==this.parent)this.parent=b;else for(a=this.parent;;)if(this.lt(b.data,a.data))if(null==a.prev){a.prev=
b;b.parent=a;break}else a=a.prev;else if(null==a.next){a.next=b;b.parent=a;break}else a=a.next;null==b.parent?b.colour=1:(b.colour=0,0==b.parent.colour&&this.__fix_dbl_red(b));return b},__class__:db};var Fe,Wh=0;h.Math=Math;String.prototype.__class__=h.String=String;String.__name__=!0;h.Array=Array;Array.__name__=!0;Date.prototype.__class__=h.Date=Date;Date.__name__=["Date"];var Xh=h.Int={__name__:["Int"]},Yh=h.Dynamic={__name__:["Dynamic"]},Rh=h.Float=Number;Rh.__name__=["Float"];var Sh=h.Bool=Boolean;
Sh.__ename__=["Bool"];var Zh=h.Class={__name__:["Class"]},$h={};E.Element="element";E.PCData="pcdata";E.CData="cdata";E.Comment="comment";E.DocType="doctype";E.ProcessingInstruction="processingInstruction";E.Document="document";Mc.NAME="DanglerComponent_0";Mc.NUM_SECTIONS=4;pc.instance=new pc;ja.DISPATCHING_SENTINEL=new ac(null,null);o.root=new x;o.uncaughtError=new V;o.hidden=new ab(!1);o.volume=new y(1);o._platform=pc.instance;o._calledInit=!1;Eb.__meta__={obj:{assets:[{critters:[{bytes:12989,md5:"d3769fadaddf6317d4814db5342936c9",
name:"animations/atlas0.png"},{bytes:454,md5:"4a0f29bf522b373d0a0bbe5bbdd1bb25",name:"animations/atlas1.png"},{bytes:43547,md5:"cba25c2ef2729aa14059da94c40a1760",name:"animations/library.json"},{bytes:333353,md5:"8bdf9834f29a4314616bf5cb28443db8",name:"audio/music/ingame_slow.mp3"},{bytes:424999,md5:"4ec885fbc45f95b4b0769bac9152f875",name:"audio/music/ingame_slow.ogg"},{bytes:17553,md5:"62b42d661ccf57536bb7e803940e30ac",name:"audio/sfx/blep.mp3"},{bytes:9761,md5:"f37388ce9a91a2a98e0e0c580712e240",
name:"audio/sfx/blep.ogg"},{bytes:25912,md5:"ab772ef4251a148071500d0d8afe6871",name:"audio/sfx/blesdfpk.mp3"},{bytes:9358,md5:"954e22f136a7f93caf341a3b6c79ddfd",name:"audio/sfx/blesdfpk.ogg"},{bytes:35943,md5:"c60b89a85f4a68b75d856777d06714de",name:"audio/sfx/blooweep.mp3"},{bytes:7511,md5:"322dcdd7d1930963435d15ce03bcf3e4",name:"audio/sfx/blooweep.ogg"},{bytes:3342,md5:"172ba47ce9667f99233cc13b33fbcf77",name:"audio/sfx/boop.mp3"},{bytes:5073,md5:"4e382b84ecc10198c8227c95fdf20522",name:"audio/sfx/boop.ogg"},
{bytes:25912,md5:"1441217c49a648b15d3a472b4ca7fb66",name:"audio/sfx/dangg.mp3"},{bytes:9953,md5:"7fa52d88b196ada808fce98641c0febd",name:"audio/sfx/dangg.ogg"},{bytes:226566,md5:"2a4c646979986be843a6034a7d265865",name:"danglers/oblongo-debug.png"},{bytes:216137,md5:"57cec1716705a0afaf522b165f8ade7b",name:"danglers/oblongo.png"},{bytes:2643,md5:"52f6d09cdb9bb198ac7dbf46e280525b",name:"danglers/oblongo.xml"},{bytes:310,md5:"21b9c01610b6f4b0e0804b265a809c54",name:"danglers/oblongo_settings.json"},{bytes:23661,
md5:"b025fbab25009cf32110542da820e076",name:"danglers/oblongo_shapes.json"},{bytes:23246,md5:"f35d9b6e90c3bf68cc29e1870993d95c",name:"font/amatic_24.fnt"},{bytes:23442,md5:"1deb8156ccaa63fbbe7c4479697722cb",name:"font/amatic_24_0.png"},{bytes:29925,md5:"ac98b317cee314947029bf242282e70c",name:"font/amatic_48.fnt"},{bytes:61337,md5:"e25fec1f6b14f13642493af4c36016fb",name:"font/amatic_48_0.png"},{bytes:1410,md5:"0bdd05a72a273852aa19ecb7392a39a7",name:"particles/sleepZ.pex"},{bytes:708,md5:"b34b19623d8d42a55cddebbb9b14027d",
name:"particles/sleepZ.png"}]}]}};Eb._supportsCrossOrigin=function(){var a;a=0<=window.navigator.userAgent.indexOf("Linux; U; Android")?!1:null!=(new XMLHttpRequest).withCredentials;a||null;return a}();F._scratchPoint=new $c;qd.NEWLINE=new Xe(10);Ia.moveToleSqr=1;Zd.NAME="BodyComponent_10";Oa.FixedTimeStep=0.016666666666666666;Oa.VelocityIterationsPerTimeStep=10;Oa.PositionIterationsPerTimeStep=10;Ja._sharedEvent=new ig;Ca._sharedEvent=new jg;O._sharedEvent=new kg;td.CANVAS_TEXTURES=(new Kc("(iPhone|iPod|iPad)",
"")).match(window.navigator.userAgent);da._mediaRefCount=0;da._detectBlobSupport=!0;I.VENDOR_PREFIXES=["webkit","moz","ms","o","khtml"];I.SHOULD_HIDE_MOBILE_BROWSER=window.top==window&&(new Kc("Mobile(/.*)? Safari","")).match(window.navigator.userAgent);J._detectSupport=!0;Ua._scratchMatrix=new Pc;mc.escapes=function(){var a=new Na;a.set("lt","<");a.set("gt",">");a.set("amp","&");a.set("quot",'"');a.set("apos","'");a.set("nbsp",String.fromCharCode(160));return a}(this);m.epsilon=1.0E-8;m.fluidAngularDragFriction=
2.5;m.fluidAngularDrag=100;m.fluidVacuumDrag=0.5;m.fluidLinearDrag=0.5;m.collisionSlop=0.2;m.collisionSlopCCD=0.5;m.distanceThresholdCCD=0.05;m.staticCCDLinearThreshold=0.05;m.staticCCDAngularThreshold=0.0050;m.bulletCCDLinearThreshold=0.125;m.bulletCCDAngularThreshold=0.0125;m.dynamicSweepLinearThreshold=17;m.dynamicSweepAngularThreshold=0.6;m.angularCCDSlipScale=0.75;m.arbiterExpirationDelay=6;m.staticFrictionThreshold=2;m.elasticThreshold=20;m.sleepDelay=60;m.linearSleepThreshold=0.2;m.angularSleepThreshold=
0.4;m.contactBiasCoef=0.3;m.contactStaticBiasCoef=0.6;m.contactContinuousBiasCoef=0.4;m.contactContinuousStaticBiasCoef=0.5;m.constraintLinearSlop=0.1;m.illConditionedThreshold=2E8;W._Constraint=0;W._Interactor=0;W._CbType=0;W._CbSet=0;W._Listener=0;wa.ANY_SHAPE=new $b;wa.ANY_BODY=new $b;wa.ANY_COMPOUND=new $b;wa.ANY_CONSTRAINT=new $b;f.internal=!1;f.id_ImmState_ACCEPT=1;f.id_ImmState_IGNORE=2;f.id_ImmState_ALWAYS=4;f.id_GravMassMode_DEFAULT=0;f.id_GravMassMode_FIXED=1;f.id_GravMassMode_SCALED=2;
f.id_InertiaMode_DEFAULT=0;f.id_MassMode_DEFAULT=0;f.id_BodyType_STATIC=1;f.id_BodyType_DYNAMIC=2;f.id_BodyType_KINEMATIC=3;f.id_ListenerType_BODY=0;f.id_PreFlag_ACCEPT=1;f.id_ListenerType_CONSTRAINT=1;f.id_ListenerType_INTERACTION=2;f.id_ListenerType_PRE=3;f.id_CbEvent_BEGIN=0;f.id_InteractionType_COLLISION=1;f.id_CbEvent_ONGOING=6;f.id_InteractionType_SENSOR=2;f.id_CbEvent_END=1;f.id_InteractionType_FLUID=4;f.id_CbEvent_WAKE=2;f.id_InteractionType_ANY=7;f.id_CbEvent_SLEEP=3;f.id_CbEvent_BREAK=4;
f.id_CbEvent_PRE=5;f.id_ShapeType_CIRCLE=0;f.id_ShapeType_POLYGON=1;sa.UCbSet=new Pd;sa.VCbSet=new Pd;sa.WCbSet=new Pd;sa.UCbType=new Qb;sa.VCbType=new Qb;sa.WCbType=new Qb;H.internal=!1;H.COL=1;H.FLUID=4;H.SENSOR=2;Xa.internal=!1;t.flowpoly=new we;t.flowsegs=new we;var Uh;null==f.BodyType_STATIC&&(f.internal=!0,f.BodyType_STATIC=new Ga,f.internal=!1);Uh=f.BodyType_STATIC;var Vh;null==f.BodyType_DYNAMIC&&(f.internal=!0,f.BodyType_DYNAMIC=new Ga,f.internal=!1);Vh=f.BodyType_DYNAMIC;null==f.BodyType_KINEMATIC&&
(f.internal=!0,f.BodyType_KINEMATIC=new Ga,f.internal=!1);yc.types=[null,Uh,Vh,f.BodyType_KINEMATIC];N.WAKE=1;N.PROPS=2;N.ANGDRAG=4;N.ARBITERS=8;S.internal=!1;pb.tmpaabb=new ga;Kb.internal=!1;zc.internal=!1;ie.internal=!1;Vc.internal=!1;Uc.internal=!1;Hb.internal=!1;xc.internal=!1;ed.internal=!1;fe.internal=!1;yd.internal=!1;ue.internal=!1;jd.internal=!1;ee.internal=!1;dd.internal=!1;Md.internal=!1;sb.main()})();
